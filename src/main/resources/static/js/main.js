/*! For license information please see main.js.LICENSE.txt */
!function webpackUniversalModuleDefinition(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.lect=r():t.lect=r()}(self,(()=>(()=>{var __webpack_modules__={591:(t,r,i)=>{var o=i(8).default;function _regeneratorRuntime(){"use strict";t.exports=_regeneratorRuntime=function _regeneratorRuntime(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var r={},i=Object.prototype,a=i.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function define(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,i){return t[r]=i}}function wrap(t,r,i,o){var a=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(a.prototype),l=new Context(o||[]);return c._invoke=function(t,r,i){var o="suspendedStart";return function(a,c){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw c;return doneResult()}for(i.method=a,i.arg=c;;){var l=i.delegate;if(l){var u=maybeInvokeDelegate(l,i);if(u){if(u===h)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===o)throw o="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o="executing";var d=tryCatch(t,r,i);if("normal"===d.type){if(o=i.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:i.done}}"throw"===d.type&&(o="completed",i.method="throw",i.arg=d.arg)}}}(t,i,l),c}function tryCatch(t,r,i){try{return{type:"normal",arg:t.call(r,i)}}catch(t){return{type:"throw",arg:t}}}r.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,l,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(values([])));m&&m!==i&&a.call(m,l)&&(p=m);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,c,l,u){var d=tryCatch(t[i],t,c);if("throw"!==d.type){var h=d.arg,p=h.value;return p&&"object"==o(p)&&a.call(p,"__await")?r.resolve(p.__await).then((function(t){invoke("next",t,l,u)}),(function(t){invoke("throw",t,l,u)})):r.resolve(p).then((function(t){h.value=t,l(h)}),(function(t){return invoke("throw",t,l,u)}))}u(d.arg)}var i;this._invoke=function(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return i=i?i.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(t,r){var i=t.iterator[r.method];if(void 0===i){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=tryCatch(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function next(){for(;++i<t.length;)if(a.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(y,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,d,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,d,"GeneratorFunction")),t.prototype=Object.create(y),t},r.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),r.AsyncIterator=AsyncIterator,r.async=function(t,i,o,a,c){void 0===c&&(c=Promise);var l=new AsyncIterator(wrap(t,i,o,a),c);return r.isGeneratorFunction(i)?l:l.next().then((function(t){return t.done?t.value:l.next()}))},defineIteratorMethods(y),define(y,d,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=[];for(var i in t)r.push(i);return r.reverse(),function next(){for(;r.length;){var i=r.pop();if(i in t)return next.value=i,next.done=!1,next}return next.done=!0,next}},r.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(i,o){return c.type="throw",c.arg=t,r.next=i,o&&(r.method="next",r.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],c=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),u=a.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var c=o;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var l=c?c.completion:{};return l.type=t,l.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(l)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var a=o.arg;resetTryEntry(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,i){return this.delegate={iterator:values(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},r}t.exports=_regeneratorRuntime,t.exports.__esModule=!0,t.exports.default=t.exports},8:t=>{function _typeof(r){return t.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,_typeof(r)}t.exports=_typeof,t.exports.__esModule=!0,t.exports.default=t.exports},757:(t,r,i)=>{t.exports=i(591)()},576:(t,r,i)=>{"use strict";i.d(r,{Z:()=>d});var o=i(645),a=i.n(o),c=i(516),l=i(849),u=a()((function(t){return t[1]}));u.i(c.Z),u.i(l.Z),u.push([t.id,".fullscreen {\r\n\tz-index: 1000; \r\n\twidth: 100%; \r\n\theight: 100%; \r\n\tposition: fixed; \r\n\ttop: 0; \r\n\tleft: 0; \r\n}",""]);const d=u},516:(t,r,i)=>{"use strict";i.d(r,{Z:()=>p});var o=i(645),a=i.n(o),c=i(667),l=i.n(c),u=i(67),d=a()((function(t){return t[1]})),h=l()(u);d.push([t.id,"@font-face {\r\n\tfont-family: 'player-icons';\r\n\tsrc: url("+h+') format(\'truetype\');\r\n\tfont-weight: normal;\r\n\tfont-style: normal;\r\n}\r\n\r\n[class^="icon-"], [class*=" icon-"] {\r\n\t/* use !important to prevent issues with browser extensions that change fonts */\r\n\tfont-family: \'player-icons\' !important;\r\n\tspeak: none;\r\n\tfont-style: normal;\r\n\tfont-weight: normal;\r\n\tfont-variant: normal;\r\n\ttext-transform: none;\r\n\tline-height: 1;\r\n\r\n\t/* Better Font Rendering =========== */\r\n\t-webkit-font-smoothing: antialiased;\r\n\t-moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\n.icon-document:before {\r\n\tcontent: "\\ed43";\r\n}\r\n.icon-sidebar-left:before {\r\n\tcontent: "\\e900";\r\n}\r\n.icon-sidebar-none:before {\r\n\tcontent: "\\e901";\r\n}\r\n.icon-sidebar-right:before {\r\n\tcontent: "\\e902";\r\n}\r\n.icon-search:before {\r\n\tcontent: "\\e908";\r\n}\r\n.icon-contract:before {\r\n\tcontent: "\\e906";\r\n}\r\n.icon-expand:before {\r\n\tcontent: "\\e905";\r\n}\r\n.icon-arrow-dropdown:before {\r\n\tcontent: "\\e903";\r\n}\r\n.icon-arrow-dropup:before {\r\n\tcontent: "\\e904";\r\n}\r\n.icon-close-circle-outline:before {\r\n\tcontent: "\\e907";\r\n}\r\n.icon-previous:before {\r\n\tcontent: "\\ed7f";\r\n}\r\n.icon-next:before {\r\n\tcontent: "\\ed16";\r\n}\r\n.icon-pause:before {\r\n\tcontent: "\\ed4f";\r\n}\r\n.icon-play:before {\r\n\tcontent: "\\ed6c";\r\n}\r\n.icon-playback-rate:before {\r\n\tcontent: "\\ed72";\r\n}\r\n.icon-mute:before {\r\n\tcontent: "\\ecf9";\r\n}\r\n.icon-volume0:before {\r\n\tcontent: "\\ef0c";\r\n}\r\n.icon-volume1:before {\r\n\tcontent: "\\ef0d";\r\n}\r\n.icon-volume2:before {\r\n\tcontent: "\\ef0e";\r\n}\r\n.icon-volume3:before {\r\n\tcontent: "\\ef0f";\r\n}\r\n',""]);const p=d},849:(t,r,i)=>{"use strict";i.d(r,{Z:()=>c});var o=i(645),a=i.n(o)()((function(t){return t[1]}));a.push([t.id,"[tooltip],\r\n[tooltip-bottom],\r\n[tooltip-left],\r\n[tooltip-right] {\r\n\tposition: relative;\r\n}\r\n\r\n[tooltip]:before,\r\n[tooltip]:after,\r\n[tooltip-bottom]:before,\r\n[tooltip-bottom]:after,\r\n[tooltip-left]:before,\r\n[tooltip-left]:after,\r\n[tooltip-right]:before,\r\n[tooltip-right]:after {\r\n\tposition: absolute;\r\n\tvisibility: hidden;\r\n\topacity: 0;\r\n\tpointer-events: none;\r\n\r\n\t-webkit-transition:\r\n\t\topacity 0.2s ease-in-out,\r\n\t\tvisibility 0.2s ease-in-out;\r\n\t-moz-transition:\r\n\t\topacity 0.2s ease-in-out,\r\n\t\tvisibility 0.2s ease-in-out;\r\n\ttransition:\r\n\t\topacity 0.2s ease-in-out,\r\n\t\tvisibility 0.2s ease-in-out;\r\n}\r\n\r\n[tooltip]:hover:before,\r\n[tooltip]:hover:after,\r\n[tooltip]:focus:before,\r\n[tooltip]:focus:after,\r\n[tooltip-bottom]:hover:before,\r\n[tooltip-bottom]:hover:after,\r\n[tooltip-bottom]:focus:before,\r\n[tooltip-bottom]:focus:after,\r\n[tooltip-left]:hover:before,\r\n[tooltip-left]:hover:after,\r\n[tooltip-left]:focus:before,\r\n[tooltip-left]:focus:after,\r\n[tooltip-right]:hover:before,\r\n[tooltip-right]:hover:after,\r\n[tooltip-right]:focus:before,\r\n[tooltip-right]:focus:after {\r\n\tvisibility: visible;\r\n\topacity: 1;\r\n}\r\n\r\n/* Base styles for the tooltip's directional arrow */\r\n[tooltip]:before,\r\n[tooltip-bottom]:before,\r\n[tooltip-left]:before,\r\n[tooltip-right]:before {\r\n\tz-index: 1001;\r\n\tborder: 6px solid transparent;\r\n\tbackground: transparent;\r\n\tcontent: \"\";\r\n}\r\n\r\n/* Base styles for the tooltip's content area */\r\n[tooltip]:after,\r\n[tooltip-bottom]:after,\r\n[tooltip-left]:after,\r\n[tooltip-right]:after {\r\n\tz-index: 1000;\r\n\tpadding: 8px;\r\n\tmargin: 0;\r\n\tbackground-color: #000;\r\n\tbackground-color: hsl(0, 0%, 20%);\r\n\tcolor: #fff;\r\n\tfont-size: 14px;\r\n\tline-height: 1.2;\r\n\twhite-space: pre;\r\n}\r\n\r\n/* Top (default) */\r\n[tooltip]:after {\r\n\tmargin-bottom: 12px;\r\n\tcontent: attr(tooltip);\r\n}\r\n\r\n[tooltip]:before,\r\n[tooltip]:after {\r\n\tbottom: 100%;\r\n\tleft: 50%;\r\n\r\n\t-webkit-transform: translateX(-50%);\r\n\ttransform: translateX(-50%);\r\n}\r\n\r\n[tooltip]:before {\r\n\tborder-top-color: #000;\r\n\tborder-top-color: hsl(0, 0%, 20%);\r\n}\r\n\r\n/* Bottom */\r\n[tooltip-bottom]:after {\r\n\tmargin-top: 12px;\r\n\tcontent: attr(tooltip-bottom);\r\n}\r\n\r\n[tooltip-bottom]:before,\r\n[tooltip-bottom]:after {\r\n\ttop: 100%;\r\n\tleft: 50%;\r\n\r\n\t-webkit-transform: translateX(-50%);\r\n\ttransform: translateX(-50%);\r\n}\r\n\r\n[tooltip-bottom]:before {\r\n\tborder-bottom-color: #000;\r\n\tborder-bottom-color: hsl(0, 0%, 20%);\r\n}\r\n\r\n/* Left */\r\n[tooltip-left]:before,\r\n[tooltip-left]:after {\r\n\ttop: 50%;\r\n\tright: 100%;\r\n\t-webkit-transform: translateY(-50%);\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n[tooltip-left]:before {\r\n\tbottom: 50%;\r\n\tmargin-bottom: 0;\r\n\tborder-top-color: transparent;\r\n\tborder-left-color: #000;\r\n\tborder-left-color: hsl(0, 0%, 20%);\r\n}\r\n\r\n[tooltip-left]:after {\r\n\tmargin-right: 12px;\r\n\tcontent: attr(tooltip-left);\r\n}\r\n\r\n/* Right */\r\n[tooltip-right]:before,\r\n[tooltip-right]:after {\r\n\ttop: 50%;\r\n\tleft: 100%;\r\n\t-webkit-transform: translateY(-50%);\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n[tooltip-right]:before {\r\n\tbottom: 50%;\r\n\tmargin-bottom: 0;\r\n\tborder-top-color: transparent;\r\n\tborder-right-color: #000;\r\n\tborder-right-color: hsl(0, 0%, 20%);\r\n}\r\n\r\n[tooltip-right]:after {\r\n\tmargin-left: 12px;\r\n\tcontent: attr(tooltip-right);\r\n}",""]);const c=a},645:t=>{"use strict";t.exports=function(t){var r=[];return r.toString=function toString(){return this.map((function(r){var i=t(r);return r[2]?"@media ".concat(r[2]," {").concat(i,"}"):i})).join("")},r.i=function(t,i,o){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(o)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var d=[].concat(t[u]);o&&a[d[0]]||(i&&(d[2]?d[2]="".concat(i," and ").concat(d[2]):d[2]=i),r.push(d))}},r}},667:t=>{"use strict";t.exports=function(t,r){return r||(r={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),r.hash&&(t+=r.hash),/["'() \t\n]/.test(t)||r.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},299:function(module,__unused_webpack_exports,__webpack_require__){!function webpackUniversalModuleDefinition(t,r){module.exports=r()}(0,(()=>(()=>{"use strict";var __webpack_modules__=[,(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.UNSUPPORTED_FEATURES=r.TextRenderingMode=r.StreamType=r.RenderingIntentFlag=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMode=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.arrayByteLength=arrayByteLength,r.arraysToBytes=function arraysToBytes(t){const r=t.length;if(1===r&&t[0]instanceof Uint8Array)return t[0];let i=0;for(let o=0;o<r;o++)i+=arrayByteLength(t[o]);let o=0;const a=new Uint8Array(i);for(let i=0;i<r;i++){let r=t[i];r instanceof Uint8Array||(r="string"==typeof r?stringToBytes(r):new Uint8Array(r));const c=r.byteLength;a.set(r,o),o+=c}return a},r.assert=function assert(t,r){t||unreachable(r)},r.bytesToString=function bytesToString(t){"object"==typeof t&&null!==t&&void 0!==t.length||unreachable("Invalid argument for bytesToString");const r=t.length,i=8192;if(r<i)return String.fromCharCode.apply(null,t);const o=[];for(let a=0;a<r;a+=i){const c=Math.min(a+i,r),l=t.subarray(a,c);o.push(String.fromCharCode.apply(null,l))}return o.join("")},r.createPromiseCapability=function createPromiseCapability(){const t=Object.create(null);let r=!1;return Object.defineProperty(t,"settled",{get:()=>r}),t.promise=new Promise((function(i,o){t.resolve=function(t){r=!0,i(t)},t.reject=function(t){r=!0,o(t)}})),t},r.createValidAbsoluteUrl=function createValidAbsoluteUrl(t,r=null,i=null){if(!t)return null;try{if(i&&"string"==typeof t){if(i.addDefaultProtocol&&t.startsWith("www.")){const r=t.match(/\./g);r&&r.length>=2&&(t=`http://${t}`)}if(i.tryConvertEncoding)try{t=stringToUTF8String(t)}catch(t){}}const o=r?new URL(t,r):new URL(t);if(function _isValidProtocol(t){if(!t)return!1;switch(t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(o))return o}catch(t){}return null},r.escapeString=function escapeString(t){return t.replace(/([()\\\n\r])/g,(t=>"\n"===t?"\\n":"\r"===t?"\\r":`\\${t}`))},r.getModificationDate=function getModificationDate(t=new Date){return[t.getUTCFullYear().toString(),(t.getUTCMonth()+1).toString().padStart(2,"0"),t.getUTCDate().toString().padStart(2,"0"),t.getUTCHours().toString().padStart(2,"0"),t.getUTCMinutes().toString().padStart(2,"0"),t.getUTCSeconds().toString().padStart(2,"0")].join("")},r.getVerbosityLevel=function getVerbosityLevel(){return a},r.info=function info(t){a>=o.INFOS&&console.log(`Info: ${t}`)},r.isArrayBuffer=function isArrayBuffer(t){return"object"==typeof t&&null!==t&&void 0!==t.byteLength},r.isArrayEqual=function isArrayEqual(t,r){if(t.length!==r.length)return!1;for(let i=0,o=t.length;i<o;i++)if(t[i]!==r[i])return!1;return!0},r.isAscii=function isAscii(t){return/^[\x00-\x7F]*$/.test(t)},r.objectFromMap=function objectFromMap(t){const r=Object.create(null);for(const[i,o]of t)r[i]=o;return r},r.objectSize=function objectSize(t){return Object.keys(t).length},r.setVerbosityLevel=function setVerbosityLevel(t){Number.isInteger(t)&&(a=t)},r.shadow=shadow,r.string32=function string32(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)},r.stringToBytes=stringToBytes,r.stringToPDFString=function stringToPDFString(t){if(t[0]>="ï"){let r;if("þ"===t[0]&&"ÿ"===t[1]?r="utf-16be":"ÿ"===t[0]&&"þ"===t[1]?r="utf-16le":"ï"===t[0]&&"»"===t[1]&&"¿"===t[2]&&(r="utf-8"),r)try{const i=new TextDecoder(r,{fatal:!0}),o=stringToBytes(t);return i.decode(o)}catch(t){warn(`stringToPDFString: "${t}".`)}}const r=[];for(let i=0,o=t.length;i<o;i++){const o=u[t.charCodeAt(i)];r.push(o?String.fromCharCode(o):t.charAt(i))}return r.join("")},r.stringToUTF16BEString=function stringToUTF16BEString(t){const r=["þÿ"];for(let i=0,o=t.length;i<o;i++){const o=t.charCodeAt(i);r.push(String.fromCharCode(o>>8&255),String.fromCharCode(255&o))}return r.join("")},r.stringToUTF8String=stringToUTF8String,r.unreachable=unreachable,r.utf8StringToString=function utf8StringToString(t){return unescape(encodeURIComponent(t))},r.warn=warn,i(2);r.IDENTITY_MATRIX=[1,0,0,1,0,0];r.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0];r.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"};r.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReplyType={GROUP:"Group",REPLY:"R"};r.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.PageActionEventType={O:"PageOpen",C:"PageClose"};r.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const o={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=o;r.CMapCompressionType={NONE:0,BINARY:1,STREAM:2};r.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};r.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let a=o.WARNINGS;function warn(t){a>=o.WARNINGS&&console.log(`Warning: ${t}`)}function unreachable(t){throw new Error(t)}function shadow(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!1}),i}const c=function BaseExceptionClosure(){function BaseException(t,r){this.constructor===BaseException&&unreachable("Cannot initialize BaseException."),this.message=t,this.name=r}return BaseException.prototype=new Error,BaseException.constructor=BaseException,BaseException}();r.BaseException=c;r.PasswordException=class PasswordException extends c{constructor(t,r){super(t,"PasswordException"),this.code=r}};r.UnknownErrorException=class UnknownErrorException extends c{constructor(t,r){super(t,"UnknownErrorException"),this.details=r}};r.InvalidPDFException=class InvalidPDFException extends c{constructor(t){super(t,"InvalidPDFException")}};r.MissingPDFException=class MissingPDFException extends c{constructor(t){super(t,"MissingPDFException")}};r.UnexpectedResponseException=class UnexpectedResponseException extends c{constructor(t,r){super(t,"UnexpectedResponseException"),this.status=r}};r.FormatError=class FormatError extends c{constructor(t){super(t,"FormatError")}};function stringToBytes(t){"string"!=typeof t&&unreachable("Invalid argument for stringToBytes");const r=t.length,i=new Uint8Array(r);for(let o=0;o<r;++o)i[o]=255&t.charCodeAt(o);return i}function arrayByteLength(t){return void 0!==t.length?t.length:void 0!==t.byteLength?t.byteLength:void unreachable("Invalid argument for arrayByteLength")}r.AbortException=class AbortException extends c{constructor(t){super(t,"AbortException")}};r.FeatureTest=class FeatureTest{static get isLittleEndian(){return shadow(this,"isLittleEndian",function isLittleEndian(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return shadow(this,"isEvalSupported",function isEvalSupported(){try{return new Function(""),!0}catch(t){return!1}}())}static get isOffscreenCanvasSupported(){return shadow(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}};const l=[...Array(256).keys()].map((t=>t.toString(16).padStart(2,"0")));class Util{static makeHexColor(t,r,i){return`#${l[t]}${l[r]}${l[i]}`}static scaleMinMax(t,r){let i;t[0]?(t[0]<0&&(i=r[0],r[0]=r[1],r[1]=i),r[0]*=t[0],r[1]*=t[0],t[3]<0&&(i=r[2],r[2]=r[3],r[3]=i),r[2]*=t[3],r[3]*=t[3]):(i=r[0],r[0]=r[2],r[2]=i,i=r[1],r[1]=r[3],r[3]=i,t[1]<0&&(i=r[2],r[2]=r[3],r[3]=i),r[2]*=t[1],r[3]*=t[1],t[2]<0&&(i=r[0],r[0]=r[1],r[1]=i),r[0]*=t[2],r[1]*=t[2]),r[0]+=t[4],r[1]+=t[4],r[2]+=t[5],r[3]+=t[5]}static transform(t,r){return[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1],t[0]*r[2]+t[2]*r[3],t[1]*r[2]+t[3]*r[3],t[0]*r[4]+t[2]*r[5]+t[4],t[1]*r[4]+t[3]*r[5]+t[5]]}static applyTransform(t,r){return[t[0]*r[0]+t[1]*r[2]+r[4],t[0]*r[1]+t[1]*r[3]+r[5]]}static applyInverseTransform(t,r){const i=r[0]*r[3]-r[1]*r[2];return[(t[0]*r[3]-t[1]*r[2]+r[2]*r[5]-r[4]*r[3])/i,(-t[0]*r[1]+t[1]*r[0]+r[4]*r[1]-r[5]*r[0])/i]}static getAxialAlignedBoundingBox(t,r){const i=Util.applyTransform(t,r),o=Util.applyTransform(t.slice(2,4),r),a=Util.applyTransform([t[0],t[3]],r),c=Util.applyTransform([t[2],t[1]],r);return[Math.min(i[0],o[0],a[0],c[0]),Math.min(i[1],o[1],a[1],c[1]),Math.max(i[0],o[0],a[0],c[0]),Math.max(i[1],o[1],a[1],c[1])]}static inverseTransform(t){const r=t[0]*t[3]-t[1]*t[2];return[t[3]/r,-t[1]/r,-t[2]/r,t[0]/r,(t[2]*t[5]-t[4]*t[3])/r,(t[4]*t[1]-t[5]*t[0])/r]}static apply3dTransform(t,r){return[t[0]*r[0]+t[1]*r[1]+t[2]*r[2],t[3]*r[0]+t[4]*r[1]+t[5]*r[2],t[6]*r[0]+t[7]*r[1]+t[8]*r[2]]}static singularValueDecompose2dScale(t){const r=[t[0],t[2],t[1],t[3]],i=t[0]*r[0]+t[1]*r[2],o=t[0]*r[1]+t[1]*r[3],a=t[2]*r[0]+t[3]*r[2],c=t[2]*r[1]+t[3]*r[3],l=(i+c)/2,u=Math.sqrt((i+c)**2-4*(i*c-a*o))/2,d=l+u||1,h=l-u||1;return[Math.sqrt(d),Math.sqrt(h)]}static normalizeRect(t){const r=t.slice(0);return t[0]>t[2]&&(r[0]=t[2],r[2]=t[0]),t[1]>t[3]&&(r[1]=t[3],r[3]=t[1]),r}static intersect(t,r){const i=Math.max(Math.min(t[0],t[2]),Math.min(r[0],r[2])),o=Math.min(Math.max(t[0],t[2]),Math.max(r[0],r[2]));if(i>o)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(r[1],r[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(r[1],r[3]));return a>c?null:[i,a,o,c]}static bezierBoundingBox(t,r,i,o,a,c,l,u){const d=[],h=[[],[]];let p,g,m,y,v,_,b,A;for(let h=0;h<2;++h)if(0===h?(g=6*t-12*i+6*a,p=-3*t+9*i-9*a+3*l,m=3*i-3*t):(g=6*r-12*o+6*c,p=-3*r+9*o-9*c+3*u,m=3*o-3*r),Math.abs(p)<1e-12){if(Math.abs(g)<1e-12)continue;y=-m/g,0<y&&y<1&&d.push(y)}else b=g*g-4*m*p,A=Math.sqrt(b),b<0||(v=(-g+A)/(2*p),0<v&&v<1&&d.push(v),_=(-g-A)/(2*p),0<_&&_<1&&d.push(_));let S,C=d.length;const P=C;for(;C--;)y=d[C],S=1-y,h[0][C]=S*S*S*t+3*S*S*y*i+3*S*y*y*a+y*y*y*l,h[1][C]=S*S*S*r+3*S*S*y*o+3*S*y*y*c+y*y*y*u;return h[0][P]=t,h[1][P]=r,h[0][P+1]=l,h[1][P+1]=u,h[0].length=h[1].length=P+2,[Math.min(...h[0]),Math.min(...h[1]),Math.max(...h[0]),Math.max(...h[1])]}}r.Util=Util;const u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToUTF8String(t){return decodeURIComponent(escape(t))}},(t,r,i)=>{i(3)},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const i=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);r.isNodeJS=i},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(5),_font_loader=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(13),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(14),_metadata=__w_pdfjs_require__(15),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_xfa_text=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:t,NodeCMapReaderFactory:r,NodeStandardFontDataFactory:i}=__w_pdfjs_require__(19);exports.DefaultCanvasFactory=DefaultCanvasFactory=t,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=r,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=i}function setPDFNetworkStreamFactory(t){createPDFNetworkStream=t}function getDocument(t){const r=new PDFDocumentLoadingTask;let i;if("string"==typeof t||t instanceof URL)i={url:t};else if((0,_util.isArrayBuffer)(t))i={data:t};else if(t instanceof PDFDataRangeTransport)i={range:t};else{if("object"!=typeof t)throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");i=t}const o=Object.create(null);let a=null,c=null;for(const t in i){const r=i[t];switch(t){case"url":if("undefined"!=typeof window)try{o[t]=new URL(r,window.location).href;continue}catch(t){(0,_util.warn)(`Cannot create valid URL: "${t}".`)}else if("string"==typeof r||r instanceof URL){o[t]=r.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":a=r;continue;case"worker":c=r;continue;case"data":if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&r instanceof Buffer)o[t]=new Uint8Array(r);else{if(r instanceof Uint8Array)break;if("string"==typeof r)o[t]=(0,_util.stringToBytes)(r);else if("object"!=typeof r||null===r||isNaN(r.length)){if(!(0,_util.isArrayBuffer)(r))throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.");o[t]=new Uint8Array(r)}else o[t]=new Uint8Array(r)}continue}o[t]=r}if(o.CMapReaderFactory=o.CMapReaderFactory||DefaultCMapReaderFactory,o.StandardFontDataFactory=o.StandardFontDataFactory||DefaultStandardFontDataFactory,o.ignoreErrors=!0!==o.stopAtErrors,o.fontExtraProperties=!0===o.fontExtraProperties,o.pdfBug=!0===o.pdfBug,o.enableXfa=!0===o.enableXfa,(!Number.isInteger(o.rangeChunkSize)||o.rangeChunkSize<1)&&(o.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof o.docBaseUrl||(0,_display_utils.isDataScheme)(o.docBaseUrl))&&(o.docBaseUrl=null),(!Number.isInteger(o.maxImageSize)||o.maxImageSize<-1)&&(o.maxImageSize=-1),"string"!=typeof o.cMapUrl&&(o.cMapUrl=null),"string"!=typeof o.standardFontDataUrl&&(o.standardFontDataUrl=null),"boolean"!=typeof o.useWorkerFetch&&(o.useWorkerFetch=o.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&o.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof o.isEvalSupported&&(o.isEvalSupported=!0),"boolean"!=typeof o.disableFontFace&&(o.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof o.useSystemFonts&&(o.useSystemFonts=!_is_node.isNodeJS&&!o.disableFontFace),"object"==typeof o.ownerDocument&&null!==o.ownerDocument||(o.ownerDocument=globalThis.document),"boolean"!=typeof o.disableRange&&(o.disableRange=!1),"boolean"!=typeof o.disableStream&&(o.disableStream=!1),"boolean"!=typeof o.disableAutoFetch&&(o.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(o.verbosity),!c){const t={verbosity:o.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};c=t.port?PDFWorker.fromPort(t):new PDFWorker(t),r._worker=c}const l=r.docId;return c.promise.then((function(){if(r.destroyed)throw new Error("Loading aborted");const t=_fetchDocument(c,o,a,l),i=new Promise((function(t){let r;a?r=new _transport_stream.PDFDataTransportStream({length:o.length,initialData:o.initialData,progressiveDone:o.progressiveDone,contentDispositionFilename:o.contentDispositionFilename,disableRange:o.disableRange,disableStream:o.disableStream},a):o.data||(r=createPDFNetworkStream({url:o.url,length:o.length,httpHeaders:o.httpHeaders,withCredentials:o.withCredentials,rangeChunkSize:o.rangeChunkSize,disableRange:o.disableRange,disableStream:o.disableStream})),t(r)}));return Promise.all([t,i]).then((function([t,i]){if(r.destroyed)throw new Error("Loading aborted");const a=new _message_handler.MessageHandler(l,t,c.port),u=new WorkerTransport(a,r,i,o);r._transport=u,a.send("Ready",null)}))})).catch(r._capability.reject),r}async function _fetchDocument(t,r,i,o){if(t.destroyed)throw new Error("Worker was destroyed");i&&(r.length=i.length,r.initialData=i.initialData,r.progressiveDone=i.progressiveDone,r.contentDispositionFilename=i.contentDispositionFilename);const a=await t.messageHandler.sendWithPromise("GetDocRequest",{docId:o,apiVersion:"2.14.305",source:{data:r.data,url:r.url,password:r.password,disableAutoFetch:r.disableAutoFetch,rangeChunkSize:r.rangeChunkSize,length:r.length},maxImageSize:r.maxImageSize,disableFontFace:r.disableFontFace,docBaseUrl:r.docBaseUrl,ignoreErrors:r.ignoreErrors,isEvalSupported:r.isEvalSupported,fontExtraProperties:r.fontExtraProperties,enableXfa:r.enableXfa,useSystemFonts:r.useSystemFonts,cMapUrl:r.useWorkerFetch?r.cMapUrl:null,standardFontDataUrl:r.useWorkerFetch?r.standardFontDataUrl:null});if(t.destroyed)throw new Error("Worker was destroyed");return a}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#e++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await(this._transport?.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,r,i=!1,o=null){this.length=t,this.initialData=r,this.progressiveDone=i,this.contentDispositionFilename=o,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,r){for(const i of this._rangeListeners)i(t,r)}onDataProgress(t,r){this._readyCapability.promise.then((()=>{for(const i of this._progressListeners)i(t,r)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const r of this._progressiveReadListeners)r(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,r){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,r){this._pdfInfo=t,this._transport=r,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,r,i,o,a=!1){this._pageIndex=t,this._pageInfo=r,this._ownerDocument=o,this._transport=i,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:r=this.rotate,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:r,offsetX:i,offsetY:o,dontFlip:a})}getAnnotations({intent:t="display"}={}){const r=this._transport.getRenderingIntent(t);let i=this._annotationPromises.get(r.cacheKey);return i||(i=this._transport.getAnnotations(this._pageIndex,r.renderingIntent),this._annotationPromises.set(r.cacheKey,i),i=i.then((t=>{for(const r of t)void 0!==r.titleObj&&Object.defineProperty(r,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),r.titleObj.str)}),void 0!==r.contentsObj&&Object.defineProperty(r,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),r.contentsObj.str)});return t}))),i}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:r,intent:i="display",annotationMode:o=_util.AnnotationMode.ENABLE,transform:a=null,imageLayer:c=null,canvasFactory:l=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:h=null,pageColors:p=null}){void 0!==arguments[0]?.renderInteractiveForms&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&o===_util.AnnotationMode.ENABLE&&(o=_util.AnnotationMode.ENABLE_FORMS)),void 0!==arguments[0]?.includeAnnotationStorage&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&o===_util.AnnotationMode.ENABLE&&(o=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const g=this._transport.getRenderingIntent(i,o);this.pendingCleanup=!1,d||(d=this._transport.getOptionalContentConfig());let m=this._intentStates.get(g.cacheKey);m||(m=Object.create(null),this._intentStates.set(g.cacheKey,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const y=l||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),v=!!(g.renderingIntent&_util.RenderingIntentFlag.PRINT);m.displayReadyCapability||(m.displayReadyCapability=(0,_util.createPromiseCapability)(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(g));const complete=t=>{m.renderTasks.delete(_),(this.cleanupAfterRender||v)&&(this.pendingCleanup=!0),this._tryCleanup(),t?(_.capability.reject(t),this._abortOperatorList({intentState:m,reason:t instanceof Error?t:new Error(t)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},_=new InternalRenderTask({callback:complete,params:{canvasContext:t,viewport:r,transform:a,imageLayer:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:y,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:p});(m.renderTasks||=new Set).add(_);const b=_.task;return Promise.all([m.displayReadyCapability.promise,d]).then((([t,r])=>{this.pendingCleanup?complete():(this._stats&&this._stats.time("Rendering"),_.initializeGraphics({transparency:t,optionalContentConfig:r}),_.operatorListChanged())})).catch(complete),b}getOperatorList({intent:t="display",annotationMode:r=_util.AnnotationMode.ENABLE}={}){const i=this._transport.getRenderingIntent(t,r,!0);let o,a=this._intentStates.get(i.cacheKey);return a||(a=Object.create(null),this._intentStates.set(i.cacheKey,a)),a.opListReadCapability||(o=Object.create(null),o.operatorListChanged=function operatorListChanged(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(o))},a.opListReadCapability=(0,_util.createPromiseCapability)(),(a.renderTasks||=new Set).add(o),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(i)),a.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:r=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==t,includeMarkedContent:!0===r},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>_xfa_text.XfaText.textContent(t)));const r=this.streamTextContent(t);return new Promise((function(t,i){const o=r.getReader(),a={items:[],styles:Object.create(null)};!function pump(){o.read().then((function({value:r,done:i}){i?t(a):(Object.assign(a.styles,r.styles),a.items.push(...r.items),pump())}),i)}()}))}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const r of this._intentStates.values())if(this._abortOperatorList({intentState:r,reason:new Error("Page was destroyed."),force:!0}),!r.opListReadCapability)for(const i of r.renderTasks)t.push(i.completed),i.cancel();this.objs.clear();for(const t of this._bitmaps)t.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const t of this._bitmaps)t.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,r){const i=this._intentStates.get(r);i&&(this._stats&&this._stats.timeEnd("Page Request"),i.displayReadyCapability&&i.displayReadyCapability.resolve(t))}_renderPageChunk(t,r){for(let i=0,o=t.length;i<o;i++)r.operatorList.fnArray.push(t.fnArray[i]),r.operatorList.argsArray.push(t.argsArray[i]);r.operatorList.lastChunk=t.lastChunk;for(const t of r.renderTasks)t.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:r}){const i=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:r,annotationStorage:t&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),o=this._intentStates.get(r);o.streamReader=i;const pump=()=>{i.read().then((({value:t,done:r})=>{r?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),pump())}),(t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();this._tryCleanup()}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}}))};pump()}_abortOperatorList({intentState:t,reason:r,force:i=!1}){if(t.streamReader){if(!i){if(t.renderTasks.size>0)return;if(r instanceof _display_utils.RenderingCancelledException)return void(t.streamReaderCancelTimeout=setTimeout((()=>{this._abortOperatorList({intentState:t,reason:r,force:!0}),t.streamReaderCancelTimeout=null}),RENDERING_CANCELLED_TIMEOUT))}if(t.streamReader.cancel(new _util.AbortException(r.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,r){const i={data:structuredClone(t,r)};this._deferred.then((()=>{for(const t of this._listeners)t.call(this,i)}))}addEventListener(t,r){this._listeners.push(r)}removeEventListener(t,r){const i=this._listeners.indexOf(r);this._listeners.splice(i,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const t=document?.currentScript?.src;t&&(PDFWorkerUtil.fallbackWorkerSrc=t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(t,r){let i;try{if(i=new URL(t),!i.origin||"null"===i.origin)return!1}catch(t){return!1}const o=new URL(r,i);return i.origin===o.origin},PDFWorkerUtil.createCDNWrapper=function(t){const r=`importScripts("${t}");`;return URL.createObjectURL(new Blob([r]))};class PDFWorker{static#t=new WeakMap;constructor({name:t=null,port:r=null,verbosity:i=(0,_util.getVerbosityLevel)()}={}){if(r&&PDFWorker.#t.has(r))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,r)return PDFWorker.#t.set(r,this),void this._initializeFromPort(r);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new _message_handler.MessageHandler("main","worker",t),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}_initialize(){if("undefined"!=typeof Worker&&!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let t=PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,t)||(t=PDFWorkerUtil.createCDNWrapper(new URL(t,window.location).href));const r=new Worker(t),i=new _message_handler.MessageHandler("main","worker",r),terminateEarly=()=>{r.removeEventListener("error",onWorkerError),i.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},onWorkerError=()=>{this._webWorker||terminateEarly()};r.addEventListener("error",onWorkerError),i.on("test",(t=>{r.removeEventListener("error",onWorkerError),this.destroyed?terminateEarly():t?(this._messageHandler=i,this._port=r,this._webWorker=r,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),r.terminate())})),i.on("ready",(t=>{if(r.removeEventListener("error",onWorkerError),this.destroyed)terminateEarly();else try{sendTest()}catch(t){this._setupFakeWorker()}}));const sendTest=()=>{const t=new Uint8Array;i.send("test",t,[t.buffer])};return void sendTest()}catch(t){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const r=new LoopbackPort;this._port=r;const i="fake"+PDFWorkerUtil.fakeWorkerId++,o=new _message_handler.MessageHandler(i+"_worker",i,r);t.setup(o,r);const a=new _message_handler.MessageHandler(i,i+"_worker",r);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#t.has(t.port)?this.#t.get(t.port):new PDFWorker(t)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch(t){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#n=null;#r=new Map;#i=new Map;#o=null;constructor(t,r,i,o){this.messageHandler=t,this.loadingTask=r,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:r.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this._params=o,o.useWorkerFetch||(this.CMapReaderFactory=new o.CMapReaderFactory({baseUrl:o.cMapUrl,isCompressed:o.cMapPacked}),this.StandardFontDataFactory=new o.StandardFontDataFactory({baseUrl:o.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#n}getRenderingIntent(t,r=_util.AnnotationMode.ENABLE,i=!1){let o=_util.RenderingIntentFlag.DISPLAY,a="";switch(t){case"any":o=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":o=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(r){case _util.AnnotationMode.DISABLE:o+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:o+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:o+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,a=this.annotationStorage.hash;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${r}`)}return i&&(o+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:o,cacheKey:`${o}_${a}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of this.#r.values())t.push(r._destroy());this.#r.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const r=this.messageHandler.sendWithPromise("Terminate",null);return t.push(r),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#o=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:r}=this;t.on("GetReader",((t,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},r.onPull=()=>{this._fullReader.read().then((function({value:t,done:i}){i?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(t),"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{r.error(t)}))},r.onCancel=t=>{this._fullReader.cancel(t),r.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(t=>{const i=(0,_util.createPromiseCapability)(),o=this._fullReader;return o.headersReady.then((()=>{o.isStreamingSupported&&o.isRangeSupported||(this._lastProgress&&r.onProgress?.(this._lastProgress),o.onProgress=t=>{r.onProgress?.({loaded:t.loaded,total:t.total})}),i.resolve({isStreamingSupported:o.isStreamingSupported,isRangeSupported:o.isRangeSupported,contentLength:o.contentLength})}),i.reject),i.promise})),t.on("GetRangeReader",((t,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(t.begin,t.end);i?(r.onPull=()=>{i.read().then((function({value:t,done:i}){i?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(t),"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{r.error(t)}))},r.onCancel=t=>{i.cancel(t),r.ready.catch((t=>{if(!this.destroyed)throw t}))}):r.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,r._capability.resolve(new PDFDocumentProxy(t,this))})),t.on("DocException",(function(t){let i;switch(t.name){case"PasswordException":i=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":i=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(t.message,t.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}r._capability.reject(i)})),t.on("PasswordRequest",(t=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),r.onPassword){const updatePassword=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{r.onPassword(updatePassword,t.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise})),t.on("DataLoaded",(t=>{r.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{if(this.destroyed)return;this.#r.get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(([r,i,o])=>{if(!this.destroyed&&!this.commonObjs.has(r))switch(i){case"Font":const a=this._params;if("error"in o){const t=o.error;(0,_util.warn)(`Error during font loading: ${t}`),this.commonObjs.resolve(r,t);break}let c=null;a.pdfBug&&globalThis.FontInspector?.enabled&&(c={registerFont(t,r){globalThis.FontInspector.fontAdded(t,r)}});const l=new _font_loader.FontFaceObject(o,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:c});this.fontLoader.bind(l).catch((i=>t.sendWithPromise("FontFallback",{id:r}))).finally((()=>{!a.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(r,l)}));break;case"FontPath":case"Image":this.commonObjs.resolve(r,o);break;default:throw new Error(`Got unknown common object type ${i}`)}})),t.on("obj",(([t,r,i,o])=>{if(this.destroyed)return;const a=this.#r.get(r);if(!a.objs.has(t))switch(i){case"Image":a.objs.resolve(t,o);const r=8e6;if(o){let t;if(o.bitmap){const{bitmap:r,width:i,height:c}=o;t=i*c*4,a._bitmaps.add(r)}else t=o.data?.length||0;t>r&&(a.cleanupAfterRender=!0)}break;case"Pattern":a.objs.resolve(t,o);break;default:throw new Error(`Got unknown object type ${i}`)}})),t.on("DocProgress",(t=>{this.destroyed||r.onProgress?.({loaded:t.loaded,total:t.total})})),t.on("DocStats",(t=>{this.destroyed||(this.#n=Object.freeze({streamTypes:Object.freeze(t.streamTypes),fontTypes:Object.freeze(t.fontTypes)}))})),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.")))),t.on("FetchStandardFontData",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))))}_onUnsupportedFeature({featureId:t}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const r=t-1,i=this.#i.get(r);if(i)return i;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then((t=>{if(this.destroyed)throw new Error("Transport destroyed");const i=new PDFPageProxy(r,t,this,this._params.ownerDocument,this._params.pdfBug);return this.#r.set(r,i),i}));return this.#i.set(r,o),o}getPageIndex(t){return"object"!=typeof t||null===t||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,r){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:r})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally((()=>{this.annotationStorage.resetModified()}))}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((t=>new _optional_content_config.OptionalContentConfig(t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#o||=this.messageHandler.sendWithPromise("GetMetadata",null).then((t=>({info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const t of this.#r.values()){if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`)}this.commonObjs.clear(),t||this.fontLoader.clear(),this.#o=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}class PDFObjects{#a=Object.create(null);#s(t){const r=this.#a[t];return r||(this.#a[t]={capability:(0,_util.createPromiseCapability)(),data:null})}get(t,r=null){if(r){const i=this.#s(t);return i.capability.promise.then((()=>r(i.data))),null}const i=this.#a[t];if(!i?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){return this.#a[t]?.capability.settled||!1}resolve(t,r=null){const i=this.#s(t);i.data=r,i.capability.resolve()}clear(){this.#a=Object.create(null)}}class RenderTask{constructor(t){this._internalRenderTask=t,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;class InternalRenderTask{static#c=new WeakSet;constructor({callback:t,params:r,objs:i,commonObjs:o,annotationCanvasMap:a,operatorList:c,pageIndex:l,canvasFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:p=null}){this.callback=t,this.params=r,this.objs=i,this.commonObjs=o,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=l,this.canvasFactory=u,this._pdfBug=h,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:r}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#c.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#c.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:o,transform:a,imageLayer:c,background:l}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,c,r,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:o,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#c.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#c.delete(this._canvas),this.callback())))}}const version="2.14.305";exports.version=version;const build="eaaa8b4ad";exports.build=build},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=void 0,r.deprecated=function deprecated(t){console.log("Deprecated API usage: "+t)},r.getFilenameFromUrl=function getFilenameFromUrl(t){const r=t.indexOf("#"),i=t.indexOf("?"),o=Math.min(r>0?r:t.length,i>0?i:t.length);return t.substring(t.lastIndexOf("/",o)+1,o)},r.getPdfFilenameFromUrl=function getPdfFilenameFromUrl(t,r="document.pdf"){if("string"!=typeof t)return r;if(isDataScheme(t))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),r;const i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,o=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let c=i.exec(o[1])||i.exec(o[2])||i.exec(o[3]);if(c&&(c=c[0],c.includes("%")))try{c=i.exec(decodeURIComponent(c))[0]}catch(t){}return c||r},r.getXfaPageViewport=function getXfaPageViewport(t,{scale:r=1,rotation:i=0}){const{width:o,height:a}=t.attributes.style,c=[0,0,parseInt(o),parseInt(a)];return new PageViewport({viewBox:c,scale:r,rotation:i})},r.isDataScheme=isDataScheme,r.isPdfFile=function isPdfFile(t){return"string"==typeof t&&/\.pdf$/i.test(t)},r.isValidFetchUrl=isValidFetchUrl,r.loadScript=function loadScript(t,r=!1){return new Promise(((i,o)=>{const a=document.createElement("script");a.src=t,a.onload=function(t){r&&a.remove(),i(t)},a.onerror=function(){o(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).appendChild(a)}))};var o=i(6),a=i(1);class PixelsPerInch{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}r.PixelsPerInch=PixelsPerInch;class DOMCanvasFactory extends o.BaseCanvasFactory{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,r){const i=this._document.createElement("canvas");return i.width=t,i.height=r,i}}async function fetchData(t,r=!1){if(isValidFetchUrl(t,document.baseURI)){const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);return r?new Uint8Array(await i.arrayBuffer()):(0,a.stringToBytes)(await i.text())}return new Promise(((i,o)=>{const c=new XMLHttpRequest;c.open("GET",t,!0),r&&(c.responseType="arraybuffer"),c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE){if(200===c.status||0===c.status){let t;if(r&&c.response?t=new Uint8Array(c.response):!r&&c.responseText&&(t=(0,a.stringToBytes)(c.responseText)),t)return void i(t)}o(new Error(c.statusText))}},c.send(null)}))}r.DOMCanvasFactory=DOMCanvasFactory;class DOMCMapReaderFactory extends o.BaseCMapReaderFactory{_fetchData(t,r){return fetchData(t,this.isCompressed).then((t=>({cMapData:t,compressionType:r})))}}r.DOMCMapReaderFactory=DOMCMapReaderFactory;class DOMStandardFontDataFactory extends o.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t,!0)}}r.DOMStandardFontDataFactory=DOMStandardFontDataFactory;class DOMSVGFactory extends o.BaseSVGFactory{_createSVG(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}}r.DOMSVGFactory=DOMSVGFactory;class PageViewport{constructor({viewBox:t,scale:r,rotation:i,offsetX:o=0,offsetY:a=0,dontFlip:c=!1}){this.viewBox=t,this.scale=r,this.rotation=i,this.offsetX=o,this.offsetY=a;const l=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let d,h,p,g,m,y,v,_;switch((i%=360)<0&&(i+=360),i){case 180:d=-1,h=0,p=0,g=1;break;case 90:d=0,h=1,p=1,g=0;break;case 270:d=0,h=-1,p=-1,g=0;break;case 0:d=1,h=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(p=-p,g=-g),0===d?(m=Math.abs(u-t[1])*r+o,y=Math.abs(l-t[0])*r+a,v=Math.abs(t[3]-t[1])*r,_=Math.abs(t[2]-t[0])*r):(m=Math.abs(l-t[0])*r+o,y=Math.abs(u-t[1])*r+a,v=Math.abs(t[2]-t[0])*r,_=Math.abs(t[3]-t[1])*r),this.transform=[d*r,h*r,p*r,g*r,m-d*r*l-p*r*u,y-h*r*l-g*r*u],this.width=v,this.height=_}clone({scale:t=this.scale,rotation:r=this.rotation,offsetX:i=this.offsetX,offsetY:o=this.offsetY,dontFlip:a=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),scale:t,rotation:r,offsetX:i,offsetY:o,dontFlip:a})}convertToViewportPoint(t,r){return a.Util.applyTransform([t,r],this.transform)}convertToViewportRectangle(t){const r=a.Util.applyTransform([t[0],t[1]],this.transform),i=a.Util.applyTransform([t[2],t[3]],this.transform);return[r[0],r[1],i[0],i[1]]}convertToPdfPoint(t,r){return a.Util.applyInverseTransform([t,r],this.transform)}}r.PageViewport=PageViewport;class RenderingCancelledException extends a.BaseException{constructor(t,r){super(t,"RenderingCancelledException"),this.type=r}}function isDataScheme(t){const r=t.length;let i=0;for(;i<r&&""===t[i].trim();)i++;return"data:"===t.substring(i,i+5).toLowerCase()}r.RenderingCancelledException=RenderingCancelledException;function isValidFetchUrl(t,r){try{const{protocol:i}=r?new URL(t,r):new URL(t);return"http:"===i||"https:"===i}catch(t){return!1}}let c;r.StatTimer=class StatTimer{constructor(){this.started=Object.create(null),this.times=[]}time(t){t in this.started&&(0,a.warn)(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||(0,a.warn)(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let r=0;for(const t of this.times){const i=t.name;i.length>r&&(r=i.length)}for(const i of this.times){const o=i.end-i.start;t.push(`${i.name.padEnd(r)} ${o}ms\n`)}return t.join("")}};r.PDFDateString=class PDFDateString{static toDateObject(t){if(!t||"string"!=typeof t)return null;c||(c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const r=c.exec(t);if(!r)return null;const i=parseInt(r[1],10);let o=parseInt(r[2],10);o=o>=1&&o<=12?o-1:0;let a=parseInt(r[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(r[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(r[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(r[6],10);d=d>=0&&d<=59?d:0;const h=r[7]||"Z";let p=parseInt(r[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(r[9],10)||0;return g=g>=0&&g<=59?g:0,"-"===h?(l+=p,u+=g):"+"===h&&(l-=p,u-=g),new Date(Date.UTC(i,o,a,l,u,d))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var o=i(1);class BaseCanvasFactory{constructor(){this.constructor===BaseCanvasFactory&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,r){if(t<=0||r<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,r);return{canvas:i,context:i.getContext("2d")}}reset(t,r,i){if(!t.canvas)throw new Error("Canvas is not specified");if(r<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=r,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,r){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=BaseCanvasFactory;class BaseCMapReaderFactory{constructor({baseUrl:t=null,isCompressed:r=!1}){this.constructor===BaseCMapReaderFactory&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=r}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const r=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData(r,i).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${r}`)}))}_fetchData(t,r){(0,o.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=BaseCMapReaderFactory;class BaseStandardFontDataFactory{constructor({baseUrl:t=null}){this.constructor===BaseStandardFontDataFactory&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const r=`${this.baseUrl}${t}`;return this._fetchData(r).catch((t=>{throw new Error(`Unable to load font data at: ${r}`)}))}_fetchData(t){(0,o.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=BaseStandardFontDataFactory;class BaseSVGFactory{constructor(){this.constructor===BaseSVGFactory&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,r){if(t<=0||r<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),i.setAttribute("width",`${t}px`),i.setAttribute("height",`${r}px`),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${r}`),i}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,o.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=BaseSVGFactory},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var o=i(1);class BaseFontLoader{constructor({docId:t,onUnsupportedFeature:r,ownerDocument:i=globalThis.document,styleElement:a=null}){this.constructor===BaseFontLoader&&(0,o.unreachable)("Cannot initialize BaseFontLoader."),this.docId=t,this._onUnsupportedFeature=r,this._document=i,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(t){this.nativeFontFaces.push(t),this._document.fonts.add(t)}insertRule(t){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(r));const i=r.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(t){if(t.attached||t.missingFile)return;if(t.attached=!0,this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,o.warn)(`Failed to load font '${r.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const r=t.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise((i=>{const o=this._queueLoadingCallback(i);this._prepareFontLoadEvent([r],[t],o)}))}}_queueLoadingCallback(t){(0,o.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return(0,o.shadow)(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){(0,o.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,o.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(t,r,i){(0,o.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;r.FontLoader=a,r.FontLoader=a=class GenericFontLoader extends BaseFontLoader{constructor(t){super(t),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let t=!1;if("undefined"==typeof navigator)t=!0;else{/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14&&(t=!0)}return(0,o.shadow)(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const r=this.loadingContext,i={id:"pdfjs-font-loading-"+r.nextRequestId++,done:!1,complete:function completeRequest(){for((0,o.assert)(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.requests.length>0&&r.requests[0].done;){const t=r.requests.shift();setTimeout(t.callback,0)}},callback:t};return r.requests.push(i),i}get _loadTestFont(){return(0,o.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,r,i){function int32(t,r){return t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|255&t.charCodeAt(r+3)}function spliceString(t,r,i,o){return t.substring(0,r)+o+t.substring(r+i)}let a,c;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let d=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=spliceString(p,976,h.length,h);const g=1482184792;let m=int32(p,16);for(a=0,c=h.length-3;a<c;a+=4)m=m-g+int32(h,a)|0;a<h.length&&(m=m-g+int32(h+"XXX",a)|0),p=spliceString(p,16,4,(0,o.string32)(m));const y=`@font-face {font-family:"${h}";src:${`url(data:font/opentype;base64,${btoa(p)});`}}`;this.insertRule(y);const v=[];for(const t of r)v.push(t.loadedName);v.push(h);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const t of v){const r=this._document.createElement("span");r.textContent="Hi",r.style.fontFamily=t,_.appendChild(r)}this._document.body.appendChild(_),function isFontReady(t,r){if(d++,d>30)return(0,o.warn)("Load test font never loaded."),void r();u.font="30px "+t,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0?r():setTimeout(isFontReady.bind(null,t,r))}(h,(()=>{_.remove(),i.complete()}))}};r.FontFaceObject=class FontFaceObject{constructor(t,{isEvalSupported:r=!0,disableFontFace:i=!1,ignoreErrors:o=!1,onUnsupportedFeature:a,fontRegistry:c=null}){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this.isEvalSupported=!1!==r,this.disableFontFace=!0===i,this.ignoreErrors=!0===o,this._onUnsupportedFeature=a,this.fontRegistry=c}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}else t=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=(0,o.bytesToString)(this.data),r=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${r}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${r}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,r),i}getPathGenerator(t,r){if(void 0!==this.compiledGlyphs[r])return this.compiledGlyphs[r];let i;try{i=t.get(this.loadedName+"_path_"+r)}catch(t){if(!this.ignoreErrors)throw t;return this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,o.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[r]=function(t,r){}}if(this.isEvalSupported&&o.FeatureTest.isEvalSupported){const t=[];for(const r of i){const i=void 0!==r.args?r.args.join(","):"";t.push("c.",r.cmd,"(",i,");\n")}return this.compiledGlyphs[r]=new Function("c","size",t.join(""))}return this.compiledGlyphs[r]=function(t,r){for(const o of i)"scale"===o.cmd&&(o.args=[r,-r]),t[o.cmd].apply(t,o.args)}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationStorage=void 0;var o=i(9),a=i(1);r.AnnotationStorage=class AnnotationStorage{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(t,r){const i=this._storage.get(t);return void 0===i?r:Object.assign(r,i)}getRawValue(t){return this._storage.get(t)}setValue(t,r){const i=this._storage.get(t);let o=!1;if(void 0!==i)for(const[t,a]of Object.entries(r))i[t]!==a&&(o=!0,i[t]=a);else o=!0,this._storage.set(t,r);o&&this._setModified()}getAll(){return this._storage.size>0?(0,a.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get hash(){const t=new o.MurmurHash3_64;for(const[r,i]of this._storage)t.update(`${r}:${JSON.stringify(i)}`);return t.hexdigest()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var o=i(1);const a=3285377520,c=4294901760,l=65535;r.MurmurHash3_64=class MurmurHash3_64{constructor(t){this.h1=t?4294967295&t:a,this.h2=t?4294967295&t:a}update(t){let r,i;if("string"==typeof t){r=new Uint8Array(2*t.length),i=0;for(let o=0,a=t.length;o<a;o++){const a=t.charCodeAt(o);a<=255?r[i++]=a:(r[i++]=a>>>8,r[i++]=255&a)}}else{if(!(0,o.isArrayBuffer)(t))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");r=t.slice(),i=r.byteLength}const a=i>>2,u=i-4*a,d=new Uint32Array(r.buffer,0,a);let h=0,p=0,g=this.h1,m=this.h2;const y=3432918353,v=461845907,_=11601,b=13715;for(let t=0;t<a;t++)1&t?(h=d[t],h=h*y&c|h*_&l,h=h<<15|h>>>17,h=h*v&c|h*b&l,g^=h,g=g<<13|g>>>19,g=5*g+3864292196):(p=d[t],p=p*y&c|p*_&l,p=p<<15|p>>>17,p=p*v&c|p*b&l,m^=p,m=m<<13|m>>>19,m=5*m+3864292196);switch(h=0,u){case 3:h^=r[4*a+2]<<16;case 2:h^=r[4*a+1]<<8;case 1:h^=r[4*a],h=h*y&c|h*_&l,h=h<<15|h>>>17,h=h*v&c|h*b&l,1&a?g^=h:m^=h}this.h1=g,this.h2=m}hexdigest(){let t=this.h1,r=this.h2;t^=r>>>1,t=3981806797*t&c|36045*t&l,r=4283543511*r&c|(2950163797*(r<<16|t>>>16)&c)>>>16,t^=r>>>1,t=444984403*t&c|60499*t&l,r=3301882366*r&c|(3120437893*(r<<16|t>>>16)&c)>>>16,t^=r>>>1;const i=(t>>>0).toString(16),o=(r>>>0).toString(16);return i.padStart(8,"0")+o.padStart(8,"0")}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var o=i(1),a=i(11),c=i(12),l=i(3),u=i(5);const d=4096,h=16;function addContextCurrentTransform(t){if(t._transformStack&&(t._transformStack=[]),!t.mozCurrentTransform){t._originalSave=t.save,t._originalRestore=t.restore,t._originalRotate=t.rotate,t._originalScale=t.scale,t._originalTranslate=t.translate,t._originalTransform=t.transform,t._originalSetTransform=t.setTransform,t._originalResetTransform=t.resetTransform,t._transformMatrix=t._transformMatrix||[1,0,0,1,0,0],t._transformStack=[];try{const r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"lineWidth");t._setLineWidth=r.set,t._getLineWidth=r.get,Object.defineProperty(t,"lineWidth",{set:function setLineWidth(t){this._setLineWidth(1.000001*t)},get:function getLineWidth(){return this._getLineWidth()}})}catch(t){}Object.defineProperty(t,"mozCurrentTransform",{get:function getCurrentTransform(){return this._transformMatrix}}),Object.defineProperty(t,"mozCurrentTransformInverse",{get:function getCurrentTransformInverse(){const[t,r,i,o,a,c]=this._transformMatrix,l=t*o-r*i,u=r*i-t*o;return[o/l,r/u,i/u,t/l,(o*a-i*c)/u,(r*a-t*c)/l]}}),t.save=function ctxSave(){const t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},t.restore=function ctxRestore(){0===this._transformStack.length&&(0,o.warn)("Tried to restore a ctx when the stack was already empty.");const t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},t.translate=function ctxTranslate(t,r){const i=this._transformMatrix;i[4]=i[0]*t+i[2]*r+i[4],i[5]=i[1]*t+i[3]*r+i[5],this._originalTranslate(t,r)},t.scale=function ctxScale(t,r){const i=this._transformMatrix;i[0]*=t,i[1]*=t,i[2]*=r,i[3]*=r,this._originalScale(t,r)},t.transform=function ctxTransform(r,i,o,a,c,l){const u=this._transformMatrix;this._transformMatrix=[u[0]*r+u[2]*i,u[1]*r+u[3]*i,u[0]*o+u[2]*a,u[1]*o+u[3]*a,u[0]*c+u[2]*l+u[4],u[1]*c+u[3]*l+u[5]],t._originalTransform(r,i,o,a,c,l)},t.setTransform=function ctxSetTransform(r,i,o,a,c,l){this._transformMatrix=[r,i,o,a,c,l],t._originalSetTransform(r,i,o,a,c,l)},t.resetTransform=function ctxResetTransform(){this._transformMatrix=[1,0,0,1,0,0],t._originalResetTransform()},t.rotate=function ctxRotate(t){const r=Math.cos(t),i=Math.sin(t),o=this._transformMatrix;this._transformMatrix=[o[0]*r+o[2]*i,o[1]*r+o[3]*i,o[0]*-i+o[2]*r,o[1]*-i+o[3]*r,o[4],o[5]],this._originalRotate(t)}}}class CachedCanvases{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,r,i,o){let a;return void 0!==this.cache[t]?(a=this.cache[t],this.canvasFactory.reset(a,r,i),a.context.setTransform(1,0,0,1,0,0)):(a=this.canvasFactory.create(r,i),this.cache[t]=a),o&&addContextCurrentTransform(a.context),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const r=this.cache[t];this.canvasFactory.destroy(r),delete this.cache[t]}}}function drawImageAtIntegerCoords(t,r,i,o,a,c,l,u,d,h){const[p,g,m,y,v,_]=t.mozCurrentTransform;if(0===g&&0===m){const b=l*p+v,A=Math.round(b),S=u*y+_,C=Math.round(S),P=(l+d)*p+v,w=Math.abs(Math.round(P)-A)||1,x=(u+h)*y+_,k=Math.abs(Math.round(x)-C)||1;return t.setTransform(Math.sign(p),0,0,Math.sign(y),A,C),t.drawImage(r,i,o,a,c,0,0,w,k),t.setTransform(p,g,m,y,v,_),[w,k]}if(0===p&&0===y){const b=u*m+v,A=Math.round(b),S=l*g+_,C=Math.round(S),P=(u+h)*m+v,w=Math.abs(Math.round(P)-A)||1,x=(l+d)*g+_,k=Math.abs(Math.round(x)-C)||1;return t.setTransform(0,Math.sign(g),Math.sign(m),0,A,C),t.drawImage(r,i,o,a,c,0,0,k,w),t.setTransform(p,g,m,y,v,_),[k,w]}t.drawImage(r,i,o,a,c,l,u,d,h);return[Math.hypot(p,g)*d,Math.hypot(m,y)*h]}class CanvasExtraState{constructor(t,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=o.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,t,r])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,r){this.x=t,this.y=r}updatePathMinMax(t,r,i){[r,i]=o.Util.applyTransform([r,i],t),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,r){const i=o.Util.applyTransform(r,t),a=o.Util.applyTransform(r.slice(2),t);this.minX=Math.min(this.minX,i[0],a[0]),this.minY=Math.min(this.minY,i[1],a[1]),this.maxX=Math.max(this.maxX,i[0],a[0]),this.maxY=Math.max(this.maxY,i[1],a[1])}updateScalingPathMinMax(t,r){o.Util.scaleMinMax(t,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(t,r,i,a,c,l,u,d,h,p){const g=o.Util.bezierBoundingBox(r,i,a,c,l,u,d,h);if(p)return p[0]=Math.min(p[0],g[0],g[2]),p[1]=Math.max(p[1],g[0],g[2]),p[2]=Math.min(p[2],g[1],g[3]),void(p[3]=Math.max(p[3],g[1],g[3]));this.updateRectMinMax(t,g)}getPathBoundingBox(t=a.PathType.FILL,r=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===a.PathType.STROKE){r||(0,o.unreachable)("Stroke bounding box must include transform.");const t=o.Util.singularValueDecompose2dScale(r),a=t[0]*this.lineWidth/2,c=t[1]*this.lineWidth/2;i[0]-=a,i[1]-=c,i[2]+=a,i[3]+=c}return i}updateClipFromPath(){const t=o.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=a.PathType.FILL,r=null){return o.Util.intersect(this.clipBox,this.getPathBoundingBox(t,r))}}function putBinaryImageData(t,r,i=null){if("undefined"!=typeof ImageData&&r instanceof ImageData)return void t.putImageData(r,0,0);const a=r.height,c=r.width,l=a%h,u=(a-l)/h,d=0===l?u:u+1,p=t.createImageData(c,h);let g,m=0;const y=r.data,v=p.data;let _,b,A,S,C,P,w,x;if(i)switch(i.length){case 1:C=i[0],P=i[0],w=i[0],x=i[0];break;case 4:C=i[0],P=i[1],w=i[2],x=i[3]}if(r.kind===o.ImageKind.GRAYSCALE_1BPP){const r=y.byteLength,i=new Uint32Array(v.buffer,0,v.byteLength>>2),a=i.length,S=c+7>>3;let C=4294967295,P=o.FeatureTest.isLittleEndian?4278190080:255;for(x&&255===x[0]&&0===x[255]&&([C,P]=[P,C]),_=0;_<d;_++){for(A=_<u?h:l,g=0,b=0;b<A;b++){const t=r-m;let o=0;const a=t>S?c:8*t-7,l=-8&a;let u=0,d=0;for(;o<l;o+=8)d=y[m++],i[g++]=128&d?C:P,i[g++]=64&d?C:P,i[g++]=32&d?C:P,i[g++]=16&d?C:P,i[g++]=8&d?C:P,i[g++]=4&d?C:P,i[g++]=2&d?C:P,i[g++]=1&d?C:P;for(;o<a;o++)0===u&&(d=y[m++],u=128),i[g++]=d&u?C:P,u>>=1}for(;g<a;)i[g++]=0;t.putImageData(p,0,_*h)}}else if(r.kind===o.ImageKind.RGBA_32BPP){const r=!!(C||P||w);for(b=0,S=c*h*4,_=0;_<u;_++){if(v.set(y.subarray(m,m+S)),m+=S,r)for(let t=0;t<S;t+=4)C&&(v[t+0]=C[v[t+0]]),P&&(v[t+1]=P[v[t+1]]),w&&(v[t+2]=w[v[t+2]]);t.putImageData(p,0,b),b+=h}if(_<d){if(S=c*l*4,v.set(y.subarray(m,m+S)),r)for(let t=0;t<S;t+=4)C&&(v[t+0]=C[v[t+0]]),P&&(v[t+1]=P[v[t+1]]),w&&(v[t+2]=w[v[t+2]]);t.putImageData(p,0,b)}}else{if(r.kind!==o.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${r.kind}`);{const r=!!(C||P||w);for(A=h,S=c*A,_=0;_<d;_++){for(_>=u&&(A=l,S=c*A),g=0,b=S;b--;)v[g++]=y[m++],v[g++]=y[m++],v[g++]=y[m++],v[g++]=255;if(r)for(let t=0;t<g;t+=4)C&&(v[t+0]=C[v[t+0]]),P&&(v[t+1]=P[v[t+1]]),w&&(v[t+2]=w[v[t+2]]);t.putImageData(p,0,_*h)}}}}function putBinaryImageMask(t,r){if(r.bitmap)return void t.drawImage(r.bitmap,0,0);const i=r.height,o=r.width,a=i%h,l=(i-a)/h,u=0===a?l:l+1,d=t.createImageData(o,h);let p=0;const g=r.data,m=d.data;for(let r=0;r<u;r++){const i=r<l?h:a;({srcPos:p}=(0,c.applyMaskImageData)({src:g,srcPos:p,dest:m,width:o,height:i})),t.putImageData(d,0,r*h)}}function copyCtxState(t,r){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let o=0,a=i.length;o<a;o++){const a=i[o];void 0!==t[a]&&(r[a]=t[a])}void 0!==t.setLineDash&&(r.setLineDash(t.getLineDash()),r.lineDashOffset=t.lineDashOffset)}function resetCtxToDefault(t,r){t.strokeStyle=t.fillStyle=r||"#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0)}function composeSMaskBackdrop(t,r,i,o){const a=t.length;for(let c=3;c<a;c+=4){const a=t[c];if(0===a)t[c-3]=r,t[c-2]=i,t[c-1]=o;else if(a<255){const l=255-a;t[c-3]=t[c-3]*a+r*l>>8,t[c-2]=t[c-2]*a+i*l>>8,t[c-1]=t[c-1]*a+o*l>>8}}}function composeSMaskAlpha(t,r,i){const o=t.length;for(let a=3;a<o;a+=4){const o=i?i[t[a]]:t[a];r[a]=r[a]*o*.00392156862745098|0}}function composeSMaskLuminosity(t,r,i){const o=t.length;for(let a=3;a<o;a+=4){const o=77*t[a-3]+152*t[a-2]+28*t[a-1];r[a]=i?r[a]*i[o>>8]>>8:r[a]*o>>16}}function composeSMask(t,r,i,o){const a=o[0],c=o[1],l=o[2]-a,u=o[3]-c;0!==l&&0!==u&&(!function genericComposeSMask(t,r,i,o,a,c,l,u,d,h,p){const g=!!c,m=g?c[0]:0,y=g?c[1]:0,v=g?c[2]:0;let _;_="Luminosity"===a?composeSMaskLuminosity:composeSMaskAlpha;const b=Math.min(o,Math.ceil(1048576/i));for(let a=0;a<o;a+=b){const c=Math.min(b,o-a),A=t.getImageData(u-h,a+(d-p),i,c),S=r.getImageData(u,a+d,i,c);g&&composeSMaskBackdrop(A.data,m,y,v),_(A.data,S.data,l),r.putImageData(S,u,a+d)}}(r.context,i,l,u,r.subtype,r.backdrop,r.transferMap,a,c,r.offsetX,r.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}function getImageSmoothingEnabled(t,r){const i=o.Util.singularValueDecompose2dScale(t);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==r?r:i[0]<=a||i[1]<=a}const p=["butt","round","square"],g=["miter","round","bevel"],m={},y={};class CanvasGraphics{constructor(t,r,i,o,a,c,l,u){this.ctx=t,this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=i,this.canvasFactory=o,this.imageLayer=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=c,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=u?.background||null,this.foregroundColor=u?.foreground||null,t&&addContextCurrentTransform(t),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,r=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):r}beginDrawing({transform:t,viewport:r,transparency:i=!1,background:o=null}){const a=this.ctx.canvas.width,c=this.ctx.canvas.height,l=o||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const t=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const r=this.backgroundColor=this.ctx.fillStyle;let i=!0,o=l;if(this.ctx.fillStyle=l,o=this.ctx.fillStyle,i="string"==typeof o&&/^#[0-9A-Fa-f]{6}$/.test(o),"#000000"===t&&"#ffffff"===r||t===r||!i)this.foregroundColor=this.backgroundColor=null;else{const i=parseInt(o.slice(1),16),a=(i&&16711680)>>16,c=(i&&65280)>>8,l=i&&255,newComp=t=>(t/=255)<=.03928?t/12.92:((t+.055)/1.055)**2.4,u=Math.round(.2126*newComp(a)+.7152*newComp(c)+.0722*newComp(l));this.selectColor=(i,o,a)=>{const c=.2126*newComp(i)+.7152*newComp(o)+.0722*newComp(a);return Math.round(c)===u?r:t}}}if(this.ctx.fillStyle=this.backgroundColor||l,this.ctx.fillRect(0,0,a,c),this.ctx.restore(),i){const t=this.cachedCanvases.getCanvas("transparent",a,c,!0);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),resetCtxToDefault(this.ctx,this.foregroundColor),t&&(this.ctx.transform.apply(this.ctx,t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform.apply(this.ctx,r.transform),this.viewportScale=r.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(t,r,i,a){const c=t.argsArray,l=t.fnArray;let u=r||0;const d=c.length;if(d===u)return u;const h=d-u>10&&"function"==typeof i,p=h?Date.now()+15:0;let g=0;const m=this.commonObjs,y=this.objs;let v;for(;;){if(void 0!==a&&u===a.nextBreakPoint)return a.breakIt(u,i),u;if(v=l[u],v!==o.OPS.dependency)this[v].apply(this,c[u]);else for(const t of c[u]){const r=t.startsWith("g_")?m:y;if(!r.has(t))return r.get(t,i),u}if(u++,u===d)return u;if(h&&++g>10){if(Date.now()>p)return i(),u;g=0}}}endDrawing(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const r of t.values())"undefined"!=typeof HTMLCanvasElement&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(t,r){const i=t.width,o=t.height;let a,c,l=Math.max(Math.hypot(r[0],r[1]),1),u=Math.max(Math.hypot(r[2],r[3]),1),d=i,h=o,p="prescale1";for(;l>2&&d>1||u>2&&h>1;){let r=d,i=h;l>2&&d>1&&(r=Math.ceil(d/2),l/=d/r),u>2&&h>1&&(i=Math.ceil(h/2),u/=h/i),a=this.cachedCanvases.getCanvas(p,r,i,!1),c=a.context,c.clearRect(0,0,r,i),c.drawImage(t,0,0,d,h,0,0,r,i),t=a.canvas,d=r,h=i,p="prescale1"===p?"prescale2":"prescale1"}return{img:t,paintWidth:d,paintHeight:h}}_createMaskCanvas(t){const r=this.ctx,{width:i,height:c}=t,l=this.current.fillColor,u=this.current.patternFill,d=r.mozCurrentTransform;let h,p,g,m;if((t.bitmap||t.data)&&t.count>1){const r=t.bitmap||t.data.buffer,i=d.slice(0,4);p=JSON.stringify(u?i:[i,l]),h=this._cachedBitmapsMap.get(r),h||(h=new Map,this._cachedBitmapsMap.set(r,h));const o=h.get(p);if(o&&!u){return{canvas:o,offsetX:Math.round(Math.min(d[0],d[2])+d[4]),offsetY:Math.round(Math.min(d[1],d[3])+d[5])}}g=o}g||(m=this.cachedCanvases.getCanvas("maskCanvas",i,c,!1),putBinaryImageMask(m.context,t));let y=o.Util.transform(d,[1/i,0,0,-1/c,0,0]);y=o.Util.transform(y,[1,0,0,1,0,-c]);const v=o.Util.applyTransform([0,0],y),_=o.Util.applyTransform([i,c],y),b=o.Util.normalizeRect([v[0],v[1],_[0],_[1]]),A=Math.round(b[2]-b[0])||1,S=Math.round(b[3]-b[1])||1,C=this.cachedCanvases.getCanvas("fillCanvas",A,S,!0),P=C.context,w=Math.min(v[0],_[0]),x=Math.min(v[1],_[1]);P.translate(-w,-x),P.transform.apply(P,y),g||(g=this._scaleImage(m.canvas,P.mozCurrentTransformInverse),g=g.img,h&&u&&h.set(p,g)),P.imageSmoothingEnabled=getImageSmoothingEnabled(P.mozCurrentTransform,t.interpolate),drawImageAtIntegerCoords(P,g,0,0,g.width,g.height,0,0,i,c),P.globalCompositeOperation="source-in";const k=o.Util.transform(P.mozCurrentTransformInverse,[1,0,0,1,-w,-x]);return P.fillStyle=u?l.getPattern(r,this,k,a.PathType.FILL):l,P.fillRect(0,0,i,c),h&&!u&&(this.cachedCanvases.delete("fillCanvas"),h.set(p,C.canvas)),{canvas:C.canvas,offsetX:Math.round(w),offsetY:Math.round(x)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=p[t]}setLineJoin(t){this.ctx.lineJoin=g[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,r){const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(let r=0,i=t.length;r<i;r++){const i=t[r],o=i[0],a=i[1];switch(o){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=a}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(i,t,r,!0);this.suspendedCtx=this.ctx,this.ctx=o.context;const a=this.ctx;a.setTransform.apply(a,this.suspendedCtx.mozCurrentTransform),copyCtxState(this.suspendedCtx,a),function mirrorContextOperations(t,r){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function ctxSave(){r.save(),this.__originalSave()},t.restore=function ctxRestore(){r.restore(),this.__originalRestore()},t.translate=function ctxTranslate(t,i){r.translate(t,i),this.__originalTranslate(t,i)},t.scale=function ctxScale(t,i){r.scale(t,i),this.__originalScale(t,i)},t.transform=function ctxTransform(t,i,o,a,c,l){r.transform(t,i,o,a,c,l),this.__originalTransform(t,i,o,a,c,l)},t.setTransform=function ctxSetTransform(t,i,o,a,c,l){r.setTransform(t,i,o,a,c,l),this.__originalSetTransform(t,i,o,a,c,l)},t.resetTransform=function ctxResetTransform(){r.resetTransform(),this.__originalResetTransform()},t.rotate=function ctxRotate(t){r.rotate(t),this.__originalRotate(t)},t.clip=function ctxRotate(t){r.clip(t),this.__originalClip(t)},t.moveTo=function(t,i){r.moveTo(t,i),this.__originalMoveTo(t,i)},t.lineTo=function(t,i){r.lineTo(t,i),this.__originalLineTo(t,i)},t.bezierCurveTo=function(t,i,o,a,c,l){r.bezierCurveTo(t,i,o,a,c,l),this.__originalBezierCurveTo(t,i,o,a,c,l)},t.rect=function(t,i,o,a){r.rect(t,i,o,a),this.__originalRect(t,i,o,a)},t.closePath=function(){r.closePath(),this.__originalClosePath()},t.beginPath=function(){r.beginPath(),this.__originalBeginPath()}}(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),copyCtxState(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask;composeSMask(this.suspendedCtx,r,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(copyCtxState(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),copyCtxState(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(t,r,i,o,a,c){this.ctx.transform(t,r,i,o,a,c),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(t,r,i){const a=this.ctx,c=this.current;let l,u,d=c.x,h=c.y;const p=a.mozCurrentTransform,g=0===p[0]&&0===p[3]||0===p[1]&&0===p[2],m=g?i.slice(0):null;for(let i=0,y=0,v=t.length;i<v;i++)switch(0|t[i]){case o.OPS.rectangle:d=r[y++],h=r[y++];const t=r[y++],i=r[y++],v=d+t,_=h+i;a.moveTo(d,h),0===t||0===i?a.lineTo(v,_):(a.lineTo(v,h),a.lineTo(v,_),a.lineTo(d,_)),g||c.updateRectMinMax(p,[d,h,v,_]),a.closePath();break;case o.OPS.moveTo:d=r[y++],h=r[y++],a.moveTo(d,h),g||c.updatePathMinMax(p,d,h);break;case o.OPS.lineTo:d=r[y++],h=r[y++],a.lineTo(d,h),g||c.updatePathMinMax(p,d,h);break;case o.OPS.curveTo:l=d,u=h,d=r[y+4],h=r[y+5],a.bezierCurveTo(r[y],r[y+1],r[y+2],r[y+3],d,h),c.updateCurvePathMinMax(p,l,u,r[y],r[y+1],r[y+2],r[y+3],d,h,m),y+=6;break;case o.OPS.curveTo2:l=d,u=h,a.bezierCurveTo(d,h,r[y],r[y+1],r[y+2],r[y+3]),c.updateCurvePathMinMax(p,l,u,d,h,r[y],r[y+1],r[y+2],r[y+3],m),d=r[y+2],h=r[y+3],y+=4;break;case o.OPS.curveTo3:l=d,u=h,d=r[y+2],h=r[y+3],a.bezierCurveTo(r[y],r[y+1],d,h,d,h),c.updateCurvePathMinMax(p,l,u,r[y],r[y+1],d,h,d,h,m),y+=4;break;case o.OPS.closePath:a.closePath()}g&&c.updateScalingPathMinMax(p,m),c.setCurrentPoint(d,h)}closePath(){this.ctx.closePath()}stroke(t){t=void 0===t||t;const r=this.ctx,i=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof i&&i?.getPattern?(r.save(),r.strokeStyle=i.getPattern(r,this,r.mozCurrentTransformInverse,a.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t){t=void 0===t||t;const r=this.ctx,i=this.current.fillColor;let o=!1;this.current.patternFill&&(r.save(),r.fillStyle=i.getPattern(r,this,r.mozCurrentTransformInverse,a.PathType.FILL),o=!0);const c=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==c&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),o&&r.restore(),t&&this.consumePath(c)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=m}eoClip(){this.pendingClip=y}beginText(){this.current.textMatrix=o.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,r=this.ctx;if(void 0!==t){r.save(),r.beginPath();for(let i=0;i<t.length;i++){const o=t[i];r.setTransform.apply(r,o.transform),r.translate(o.x,o.y),o.addToPath(r,o.fontSize)}r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}else r.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,r){const i=this.commonObjs.get(t),a=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=i.fontMatrix||o.FONT_IDENTITY_MATRIX,0!==a.fontMatrix[0]&&0!==a.fontMatrix[3]||(0,o.warn)("Invalid font matrix for font "+t),r<0?(r=-r,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const c=i.loadedName||"sans-serif";let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal",d=`"${c}", ${i.fallbackName}`;let h=r;r<16?h=16:r>100&&(h=100),this.current.fontSizeScale=r/h,this.ctx.font=`${u} ${l} ${h}px ${d}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,r){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(t,r){this.setLeading(-r),this.moveText(t,r)}setTextMatrix(t,r,i,o,a,c){this.current.textMatrix=[t,r,i,o,a,c],this.current.textMatrixScale=Math.hypot(t,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,r,i,a){const c=this.ctx,l=this.current,u=l.font,d=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,p=d&o.TextRenderingMode.FILL_STROKE_MASK,g=!!(d&o.TextRenderingMode.ADD_TO_PATH_FLAG),m=l.patternFill&&!u.missingFile;let y;if((u.disableFontFace||g||m)&&(y=u.getPathGenerator(this.commonObjs,t)),u.disableFontFace||m?(c.save(),c.translate(r,i),c.beginPath(),y(c,h),a&&c.setTransform.apply(c,a),p!==o.TextRenderingMode.FILL&&p!==o.TextRenderingMode.FILL_STROKE||c.fill(),p!==o.TextRenderingMode.STROKE&&p!==o.TextRenderingMode.FILL_STROKE||c.stroke(),c.restore()):(p!==o.TextRenderingMode.FILL&&p!==o.TextRenderingMode.FILL_STROKE||c.fillText(t,r,i),p!==o.TextRenderingMode.STROKE&&p!==o.TextRenderingMode.FILL_STROKE||c.strokeText(t,r,i)),g){(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:c.mozCurrentTransform,x:r,y:i,fontSize:h,addToPath:y})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);t.scale(1.5,1),t.fillText("I",0,10);const r=t.getImageData(0,0,10,10).data;let i=!1;for(let t=3;t<r.length;t+=4)if(r[t]>0&&r[t]<255){i=!0;break}return(0,o.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(t){const r=this.current,i=r.font;if(i.isType3Font)return this.showType3Text(t);const c=r.fontSize;if(0===c)return;const l=this.ctx,u=r.fontSizeScale,d=r.charSpacing,h=r.wordSpacing,p=r.fontDirection,g=r.textHScale*p,m=t.length,y=i.vertical,v=y?1:-1,_=i.defaultVMetrics,b=c*r.fontMatrix[0],A=r.textRenderingMode===o.TextRenderingMode.FILL&&!i.disableFontFace&&!r.patternFill;let S;if(l.save(),l.transform.apply(l,r.textMatrix),l.translate(r.x,r.y+r.textRise),p>0?l.scale(g,-1):l.scale(g,1),r.patternFill){l.save();const t=r.fillColor.getPattern(l,this,l.mozCurrentTransformInverse,a.PathType.FILL);S=l.mozCurrentTransform,l.restore(),l.fillStyle=t}let C=r.lineWidth;const P=r.textMatrixScale;if(0===P||0===C){const t=r.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;t!==o.TextRenderingMode.STROKE&&t!==o.TextRenderingMode.FILL_STROKE||(C=this.getSinglePixelWidth())}else C/=P;1!==u&&(l.scale(u,u),C/=u),l.lineWidth=C;let w,x=0;for(w=0;w<m;++w){const r=t[w];if("number"==typeof r){x+=v*r*c/1e3;continue}let o=!1;const a=(r.isSpace?h:0)+d,g=r.fontChar,m=r.accent;let C,P,k,T=r.width;if(y){const t=r.vmetric||_,i=-(r.vmetric?t[1]:.5*T)*b,o=t[2]*b;T=t?-t[0]:T,C=i/u,P=(x+o)/u}else C=x/u,P=0;if(i.remeasure&&T>0){const t=1e3*l.measureText(g).width/c*u;if(T<t&&this.isFontSubpixelAAEnabled){const r=T/t;o=!0,l.save(),l.scale(r,1),C/=r}else T!==t&&(C+=(T-t)/2e3*c/u)}if(this.contentVisible&&(r.isInFont||i.missingFile))if(A&&!m)l.fillText(g,C,P);else if(this.paintChar(g,C,P,S),m){const t=C+c*m.offset.x/u,r=P-c*m.offset.y/u;this.paintChar(m.fontChar,t,r,S)}k=y?T*b-a*p:T*b+a*p,x+=k,o&&l.restore()}y?r.y-=x:r.x+=x*g,l.restore(),this.compose()}showType3Text(t){const r=this.ctx,i=this.current,a=i.font,c=i.fontSize,l=i.fontDirection,u=a.vertical?1:-1,d=i.charSpacing,h=i.wordSpacing,p=i.textHScale*l,g=i.fontMatrix||o.FONT_IDENTITY_MATRIX,m=t.length;let y,v,_,b;if(!(i.textRenderingMode===o.TextRenderingMode.INVISIBLE)&&0!==c){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,r.save(),r.transform.apply(r,i.textMatrix),r.translate(i.x,i.y),r.scale(p,l),y=0;y<m;++y){if(v=t[y],"number"==typeof v){b=u*v*c/1e3,this.ctx.translate(b,0),i.x+=b*p;continue}const l=(v.isSpace?h:0)+d,m=a.charProcOperatorList[v.operatorListId];if(!m){(0,o.warn)(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),r.scale(c,c),r.transform.apply(r,g),this.executeOperatorList(m),this.restore());_=o.Util.applyTransform([v.width,0],g)[0]*c+l,r.translate(_,0),i.x+=_*p}r.restore(),this.processingType3=null}}setCharWidth(t,r){}setCharWidthAndBounds(t,r,i,o,a,c){this.ctx.rect(i,o,a-i,c-o),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let r;if("TilingPattern"===t[0]){const i=t[1],o=this.baseTransform||this.ctx.mozCurrentTransform.slice(),c={createCanvasGraphics:t=>new CanvasGraphics(t,this.commonObjs,this.objs,this.canvasFactory)};r=new a.TilingPattern(t,i,this.ctx,c,o)}else r=this._getPattern(t[1],t[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,r,i){const a=this.selectColor?.(t,r,i)||o.Util.makeHexColor(t,r,i);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(t,r,i){const a=this.selectColor?.(t,r,i)||o.Util.makeHexColor(t,r,i);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(t,r=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=(0,a.getShadingPattern)(this.objs.get(t)),this.cachedPatterns.set(t,i)),r&&(i.matrix=r),i}shadingFill(t){if(!this.contentVisible)return;const r=this.ctx;this.save();const i=this._getPattern(t);r.fillStyle=i.getPattern(r,this,r.mozCurrentTransformInverse,a.PathType.SHADING);const c=r.mozCurrentTransformInverse;if(c){const t=r.canvas,i=t.width,a=t.height,l=o.Util.applyTransform([0,0],c),u=o.Util.applyTransform([0,a],c),d=o.Util.applyTransform([i,0],c),h=o.Util.applyTransform([i,a],c),p=Math.min(l[0],u[0],d[0],h[0]),g=Math.min(l[1],u[1],d[1],h[1]),m=Math.max(l[0],u[0],d[0],h[0]),y=Math.max(l[1],u[1],d[1],h[1]);this.ctx.fillRect(p,g,m-p,y-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,o.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,o.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(t,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(t)&&6===t.length&&this.transform.apply(this,t),this.baseTransform=this.ctx.mozCurrentTransform,r)){const t=r[2]-r[0],i=r[3]-r[1];this.ctx.rect(r[0],r[1],t,i),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||(0,o.info)("TODO: Support non-isolated groups."),t.knockout&&(0,o.warn)("Knockout groups not supported.");const i=r.mozCurrentTransform;if(t.matrix&&r.transform.apply(r,t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=o.Util.getAxialAlignedBoundingBox(t.bbox,r.mozCurrentTransform);const c=[0,0,r.canvas.width,r.canvas.height];a=o.Util.intersect(a,c)||[0,0,0,0];const l=Math.floor(a[0]),u=Math.floor(a[1]);let h=Math.max(Math.ceil(a[2])-l,1),p=Math.max(Math.ceil(a[3])-u,1),g=1,m=1;h>d&&(g=h/d,h=d),p>d&&(m=p/d,p=d),this.current.startNewPathAndClipBox([0,0,h,p]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,h,p,!0),_=v.context;_.scale(1/g,1/m),_.translate(-l,-u),_.transform.apply(_,i),t.smask?this.smaskStack.push({canvas:v.canvas,context:_,offsetX:l,offsetY:u,scaleX:g,scaleY:m,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(l,u),r.scale(g,m),r.save()),copyCtxState(r,_),this.ctx=_,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,t);const i=o.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],t);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(t,r,i,a,c){if(this.save(),Array.isArray(r)&&4===r.length){const a=r[2]-r[0],l=r[3]-r[1];if(c&&this.annotationCanvasMap){(i=i.slice())[4]-=r[0],i[5]-=r[1],(r=r.slice())[0]=r[1]=0,r[2]=a,r[3]=l;const[c,d]=o.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:h}=this,p=Math.ceil(a*this.outputScaleX*h),g=Math.ceil(l*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:m,context:y}=this.annotationCanvas,v=`var(--zoom-factor) * ${u.PixelsPerInch.PDF_TO_CSS_UNITS}`;m.style.width=`calc(${a}px * ${v})`,m.style.height=`calc(${l}px * ${v})`,this.annotationCanvasMap.set(t,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.setTransform(c,0,0,-d,0,l*d),addContextCurrentTransform(this.ctx),resetCtxToDefault(this.ctx,this.foregroundColor)}else resetCtxToDefault(this.ctx,this.foregroundColor),this.ctx.rect(r[0],r[1],a,l),this.ctx.clip(),this.endPath()}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,i),this.transform.apply(this,a)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas),this.restore()}paintImageMaskXObject(t){if(!this.contentVisible)return;const r=t.count;(t=this.getObject(t.data,t)).count=r;const i=this.ctx,o=this.processingType3;if(o&&(void 0===o.compiled&&(o.compiled=function compileType3Glyph(t){const{width:r,height:i}=t;if(r>1e3||i>1e3)return null;const o=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=r+1;let c,u,d,h=new Uint8Array(a*(i+1));const p=r+7&-8;let g=new Uint8Array(p*i),m=0;for(const r of t.data){let t=128;for(;t>0;)g[m++]=r&t?0:255,t>>=1}let y=0;for(m=0,0!==g[m]&&(h[0]=1,++y),u=1;u<r;u++)g[m]!==g[m+1]&&(h[u]=g[m]?2:1,++y),m++;for(0!==g[m]&&(h[u]=2,++y),c=1;c<i;c++){m=c*p,d=c*a,g[m-p]!==g[m]&&(h[d]=g[m]?1:8,++y);let t=(g[m]?4:0)+(g[m-p]?8:0);for(u=1;u<r;u++)t=(t>>2)+(g[m+1]?4:0)+(g[m-p+1]?8:0),o[t]&&(h[d+u]=o[t],++y),m++;if(g[m-p]!==g[m]&&(h[d+u]=g[m]?2:4,++y),y>1e3)return null}for(m=p*(i-1),d=c*a,0!==g[m]&&(h[d]=8,++y),u=1;u<r;u++)g[m]!==g[m+1]&&(h[d+u]=g[m]?4:8,++y),m++;if(0!==g[m]&&(h[d+u]=4,++y),y>1e3)return null;const v=new Int32Array([0,a,-1,0,-a,0,0,0,1]);let _,b,A;for(l.isNodeJS?b=[]:_=new Path2D,c=0;y&&c<=i;c++){let t=c*a;const i=t+r;for(;t<i&&!h[t];)t++;if(t===i)continue;_?_.moveTo(t%a,c):A=[t%a,c];const o=t;let l=h[t];do{const r=v[l];do{t+=r}while(!h[t]);const i=h[t];5!==i&&10!==i?(l=i,h[t]=0):(l=i&51*l>>4,h[t]&=l>>2|l<<2),_?_.lineTo(t%a,t/a|0):A.push(t%a,t/a|0),h[t]||--y}while(o!==t);_||b.push(A),--c}return g=null,h=null,function(t){if(t.save(),t.scale(1/r,-1/i),t.translate(0,-i),_)t.fill(_);else{t.beginPath();for(const r of b){t.moveTo(r[0],r[1]);for(let i=2,o=r.length;i<o;i+=2)t.lineTo(r[i],r[i+1])}t.fill()}t.beginPath(),t.restore()}}(t)),o.compiled))return void o.compiled(i);const a=this._createMaskCanvas(t),c=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(c,a.offsetX,a.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,r,i=0,a=0,c,l){if(!this.contentVisible)return;t=this.getObject(t.data,t);const u=this.ctx;u.save();const d=u.mozCurrentTransform;u.transform(r,i,a,c,0,0);const h=this._createMaskCanvas(t);u.setTransform(1,0,0,1,0,0);for(let t=0,p=l.length;t<p;t+=2){const p=o.Util.transform(d,[r,i,a,c,l[t],l[t+1]]),[g,m]=o.Util.applyTransform([0,0],p);u.drawImage(h.canvas,g,m)}u.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;for(let c=0,l=t.length;c<l;c++){const l=t[c],u=l.width,d=l.height,h=this.cachedCanvases.getCanvas("maskCanvas",u,d,!1),p=h.context;p.save(),putBinaryImageMask(p,l),p.globalCompositeOperation="source-in",p.fillStyle=o?i.getPattern(p,this,r.mozCurrentTransformInverse,a.PathType.FILL):i,p.fillRect(0,0,u,d),p.restore(),r.save(),r.transform.apply(r,l.transform),r.scale(1,-1),drawImageAtIntegerCoords(r,h.canvas,0,0,u,d,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const r=this.getObject(t);r?this.paintInlineImageXObject(r):(0,o.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,r,i,a){if(!this.contentVisible)return;const c=this.getObject(t);if(!c)return void(0,o.warn)("Dependent image isn't ready yet");const l=c.width,u=c.height,d=[];for(let t=0,o=a.length;t<o;t+=2)d.push({transform:[r,0,0,i,a[t],a[t+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(c,d)}paintInlineImageXObject(t){if(!this.contentVisible)return;const r=t.width,i=t.height,o=this.ctx;let a;if(this.save(),o.scale(1/r,-1/i),"function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const o=this.cachedCanvases.getCanvas("inlineImage",r,i,!1);putBinaryImageData(o.context,t,this.current.transferMaps),a=o.canvas}const c=this._scaleImage(a,o.mozCurrentTransformInverse);o.imageSmoothingEnabled=getImageSmoothingEnabled(o.mozCurrentTransform,t.interpolate);const[l,u]=drawImageAtIntegerCoords(o,c.img,0,0,c.paintWidth,c.paintHeight,0,-i,r,i);if(this.imageLayer){const r=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:t,left:r[0],top:r[1],width:l,height:u})}this.compose(),this.restore()}paintInlineImageXObjectGroup(t,r){if(!this.contentVisible)return;const i=this.ctx,o=t.width,a=t.height,c=this.cachedCanvases.getCanvas("inlineImage",o,a,!1);putBinaryImageData(c.context,t,this.current.transferMaps);for(let l=0,u=r.length;l<u;l++){const u=r[l];if(i.save(),i.transform.apply(i,u.transform),i.scale(1,-1),drawImageAtIntegerCoords(i,c.canvas,u.x,u.y,u.w,u.h,0,-1,1,1),this.imageLayer){const r=this.getCanvasPosition(u.x,u.y);this.imageLayer.appendImage({imgData:t,left:r[0],top:r[1],width:o,height:a})}i.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,r){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,r){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(r||(this.pendingClip===y?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=this.ctx.mozCurrentTransform;if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const r=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),o=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,o)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:t}=this.current,r=this.ctx.mozCurrentTransform;let i,o;if(0===r[1]&&0===r[2]){const a=Math.abs(r[0]),c=Math.abs(r[3]);if(0===t)i=1/a,o=1/c;else{const r=a*t,l=c*t;i=r<1?1/r:1,o=l<1?1/l:1}}else{const a=Math.abs(r[0]*r[3]-r[2]*r[1]),c=Math.hypot(r[0],r[1]),l=Math.hypot(r[2],r[3]);if(0===t)i=l/a,o=c/a;else{const r=t*a;i=l>r?l/r:1,o=c>r?c/r:1}}this._cachedScaleForStroking=[i,o]}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:r}=this,{lineWidth:i}=this.current,[o,a]=this.getScaleForStroking();if(r.lineWidth=i||1,1===o&&1===a)return void r.stroke();let c,l,u;t&&(c=r.mozCurrentTransform.slice(),l=r.getLineDash().slice(),u=r.lineDashOffset),r.scale(o,a);const d=Math.max(o,a);r.setLineDash(r.getLineDash().map((t=>t/d))),r.lineDashOffset/=d,r.stroke(),t&&(r.setTransform(...c),r.setLineDash(l),r.lineDashOffset=u)}getCanvasPosition(t,r){const i=this.ctx.mozCurrentTransform;return[i[0]*t+i[2]*r+i[4],i[1]*t+i[3]*r+i[5]]}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}r.CanvasGraphics=CanvasGraphics;for(const t in o.OPS)void 0!==CanvasGraphics.prototype[t]&&(CanvasGraphics.prototype[o.OPS[t]]=CanvasGraphics.prototype[t])},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=function getShadingPattern(t){switch(t[0]){case"RadialAxial":return new RadialAxialShadingPattern(t);case"Mesh":return new MeshShadingPattern(t);case"Dummy":return new DummyShadingPattern}throw new Error(`Unknown IR type: ${t[0]}`)};var o=i(1),a=i(3);const c={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function applyBoundingBox(t,r){if(!r||a.isNodeJS)return;const i=r[2]-r[0],o=r[3]-r[1],c=new Path2D;c.rect(r[0],r[1],i,o),t.clip(c)}r.PathType=c;class BaseShadingPattern{constructor(){this.constructor===BaseShadingPattern&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class RadialAxialShadingPattern extends BaseShadingPattern{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let r;"axial"===this._type?r=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(r=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)r.addColorStop(t[0],t[1]);return r}getPattern(t,r,i,a){let l;if(a===c.STROKE||a===c.FILL){const c=r.current.getClippedPathBoundingBox(a,t.mozCurrentTransform)||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,h=r.cachedCanvases.getCanvas("pattern",u,d,!0),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),i=o.Util.transform(i,[1,0,0,1,c[0],c[1]]),p.transform.apply(p,r.baseTransform),this.matrix&&p.transform.apply(p,this.matrix),applyBoundingBox(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(h.canvas,"no-repeat");const g=new DOMMatrix(i);try{l.setTransform(g)}catch(t){(0,o.warn)(`RadialAxialShadingPattern.getPattern: "${t?.message}".`)}}else applyBoundingBox(t,this._bbox),l=this._createGradient(t);return l}}function drawTriangle(t,r,i,o,a,c,l,u){const d=r.coords,h=r.colors,p=t.data,g=4*t.width;let m;d[i+1]>d[o+1]&&(m=i,i=o,o=m,m=c,c=l,l=m),d[o+1]>d[a+1]&&(m=o,o=a,a=m,m=l,l=u,u=m),d[i+1]>d[o+1]&&(m=i,i=o,o=m,m=c,c=l,l=m);const y=(d[i]+r.offsetX)*r.scaleX,v=(d[i+1]+r.offsetY)*r.scaleY,_=(d[o]+r.offsetX)*r.scaleX,b=(d[o+1]+r.offsetY)*r.scaleY,A=(d[a]+r.offsetX)*r.scaleX,S=(d[a+1]+r.offsetY)*r.scaleY;if(v>=S)return;const C=h[c],P=h[c+1],w=h[c+2],x=h[l],k=h[l+1],T=h[l+2],R=h[u],E=h[u+1],I=h[u+2],M=Math.round(v),D=Math.round(S);let O,L,N,B,j,V,U,z;for(let t=M;t<=D;t++){if(t<b){let r;r=t<v?0:(v-t)/(v-b),O=y-(y-_)*r,L=C-(C-x)*r,N=P-(P-k)*r,B=w-(w-T)*r}else{let r;r=t>S?1:b===S?0:(b-t)/(b-S),O=_-(_-A)*r,L=x-(x-R)*r,N=k-(k-E)*r,B=T-(T-I)*r}let r;r=t<v?0:t>S?1:(v-t)/(v-S),j=y-(y-A)*r,V=C-(C-R)*r,U=P-(P-E)*r,z=w-(w-I)*r;const i=Math.round(Math.min(O,j)),o=Math.round(Math.max(O,j));let a=g*t+4*i;for(let t=i;t<=o;t++)r=(O-t)/(O-j),r<0?r=0:r>1&&(r=1),p[a++]=L-(L-V)*r|0,p[a++]=N-(N-U)*r|0,p[a++]=B-(B-z)*r|0,p[a++]=255}}function drawFigure(t,r,i){const o=r.coords,a=r.colors;let c,l;switch(r.type){case"lattice":const u=r.verticesPerRow,d=Math.floor(o.length/u)-1,h=u-1;for(c=0;c<d;c++){let r=c*u;for(let c=0;c<h;c++,r++)drawTriangle(t,i,o[r],o[r+1],o[r+u],a[r],a[r+1],a[r+u]),drawTriangle(t,i,o[r+u+1],o[r+1],o[r+u],a[r+u+1],a[r+1],a[r+u])}break;case"triangles":for(c=0,l=o.length;c<l;c+=3)drawTriangle(t,i,o[c],o[c+1],o[c+2],a[c],a[c+1],a[c+2]);break;default:throw new Error("illegal figure")}}class MeshShadingPattern extends BaseShadingPattern{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,r,i){const o=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,l=Math.ceil(this._bounds[3])-a,u=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(l*t[1]*1.1)),3e3),h=c/u,p=l/d,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-a,scaleX:1/h,scaleY:1/p},m=u+4,y=d+4,v=i.getCanvas("mesh",m,y,!1),_=v.context,b=_.createImageData(u,d);if(r){const t=b.data;for(let i=0,o=t.length;i<o;i+=4)t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2],t[i+3]=255}for(const t of this._figures)drawFigure(b,t,g);_.putImageData(b,2,2);return{canvas:v.canvas,offsetX:o-2*h,offsetY:a-2*p,scaleX:h,scaleY:p}}getPattern(t,r,i,a){let l;if(applyBoundingBox(t,this._bbox),a===c.SHADING)l=o.Util.singularValueDecompose2dScale(t.mozCurrentTransform);else if(l=o.Util.singularValueDecompose2dScale(r.baseTransform),this.matrix){const t=o.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*t[0],l[1]*t[1]]}const u=this._createMeshCanvas(l,a===c.SHADING?null:this._background,r.cachedCanvases);return a!==c.SHADING&&(t.setTransform.apply(t,r.baseTransform),this.matrix&&t.transform.apply(t,this.matrix)),t.translate(u.offsetX,u.offsetY),t.scale(u.scaleX,u.scaleY),t.createPattern(u.canvas,"no-repeat")}}class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}}const l=1,u=2;class TilingPattern{static get MAX_PATTERN_SIZE(){return(0,o.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(t,r,i,o,a){this.operatorList=t[2],this.matrix=t[3]||[1,0,0,1,0,0],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=r,this.ctx=i,this.canvasGraphicsFactory=o,this.baseTransform=a}createPatternCanvas(t){const r=this.operatorList,i=this.bbox,a=this.xstep,c=this.ystep,l=this.paintType,u=this.tilingType,d=this.color,h=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+u);const p=i[0],g=i[1],m=i[2],y=i[3],v=o.Util.singularValueDecompose2dScale(this.matrix),_=o.Util.singularValueDecompose2dScale(this.baseTransform),b=[v[0]*_[0],v[1]*_[1]],A=this.getSizeAndScale(a,this.ctx.canvas.width,b[0]),S=this.getSizeAndScale(c,this.ctx.canvas.height,b[1]),C=t.cachedCanvases.getCanvas("pattern",A.size,S.size,!0),P=C.context,w=h.createCanvasGraphics(P);w.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(w,l,d);let x=p,k=g,T=m,R=y;return p<0&&(x=0,T+=Math.abs(p)),g<0&&(k=0,R+=Math.abs(g)),P.translate(-A.scale*x,-S.scale*k),w.transform(A.scale,0,0,S.scale,0,0),P.save(),this.clipBbox(w,x,k,T,R),w.baseTransform=w.ctx.mozCurrentTransform.slice(),w.executeOperatorList(r),w.endDrawing(),{canvas:C.canvas,scaleX:A.scale,scaleY:S.scale,offsetX:x,offsetY:k}}getSizeAndScale(t,r,i){t=Math.abs(t);const o=Math.max(TilingPattern.MAX_PATTERN_SIZE,r);let a=Math.ceil(t*i);return a>=o?a=o:i=a/t,{scale:i,size:a}}clipBbox(t,r,i,o,a){const c=o-r,l=a-i;t.ctx.rect(r,i,c,l),t.current.updateRectMinMax(t.ctx.mozCurrentTransform,[r,i,o,a]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,r,i){const a=t.ctx,c=t.current;switch(r){case l:const t=this.ctx;a.fillStyle=t.fillStyle,a.strokeStyle=t.strokeStyle,c.fillColor=t.fillStyle,c.strokeColor=t.strokeStyle;break;case u:const d=o.Util.makeHexColor(i[0],i[1],i[2]);a.fillStyle=d,a.strokeStyle=d,c.fillColor=d,c.strokeColor=d;break;default:throw new o.FormatError(`Unsupported paint type: ${r}`)}}getPattern(t,r,i,a){let l=i;a!==c.SHADING&&(l=o.Util.transform(l,r.baseTransform),this.matrix&&(l=o.Util.transform(l,this.matrix)));const u=this.createPatternCanvas(r);let d=new DOMMatrix(l);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const h=t.createPattern(u.canvas,"repeat");try{h.setTransform(d)}catch(t){(0,o.warn)(`TilingPattern.getPattern: "${t?.message}".`)}return h}}r.TilingPattern=TilingPattern},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyMaskImageData=function applyMaskImageData({src:t,srcPos:r=0,dest:i,destPos:a=0,width:c,height:l,inverseDecode:u=!1}){const d=o.FeatureTest.isLittleEndian?4278190080:255,[h,p]=u?[0,d]:[d,0],g=c>>3,m=7&c,y=t.length;i=new Uint32Array(i.buffer);for(let o=0;o<l;o++){for(const o=r+g;r<o;r++){const o=r<y?t[r]:255;i[a++]=128&o?p:h,i[a++]=64&o?p:h,i[a++]=32&o?p:h,i[a++]=16&o?p:h,i[a++]=8&o?p:h,i[a++]=4&o?p:h,i[a++]=2&o?p:h,i[a++]=1&o?p:h}if(0===m)continue;const o=r<y?t[r++]:255;for(let t=0;t<m;t++)i[a++]=o&1<<7-t?p:h}return{srcPos:r,destPos:a}};var o=i(1)},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const i=Object.create(null);r.GlobalWorkerOptions=i,i.workerPort=void 0===i.workerPort?null:i.workerPort,i.workerSrc=void 0===i.workerSrc?"":i.workerSrc},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var o=i(1);const a=1,c=2,l=1,u=2,d=3,h=4,p=5,g=6,m=7,y=8;function wrapReason(t){switch(t instanceof Error||"object"==typeof t&&null!==t||(0,o.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new o.AbortException(t.message);case"MissingPDFException":return new o.MissingPDFException(t.message);case"PasswordException":return new o.PasswordException(t.message,t.code);case"UnexpectedResponseException":return new o.UnexpectedResponseException(t.message,t.status);case"UnknownErrorException":return new o.UnknownErrorException(t.message,t.details);default:return new o.UnknownErrorException(t.message,t.toString())}}r.MessageHandler=class MessageHandler{constructor(t,r,i){this.sourceName=t,this.targetName=r,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=t=>{const r=t.data;if(r.targetName!==this.sourceName)return;if(r.stream)return void this._processStreamMessage(r);if(r.callback){const t=r.callbackId,i=this.callbackCapabilities[t];if(!i)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],r.callback===a)i.resolve(r.data);else{if(r.callback!==c)throw new Error("Unexpected callback case");i.reject(wrapReason(r.reason))}return}const o=this.actionHandler[r.action];if(!o)throw new Error(`Unknown action from worker: ${r.action}`);if(r.callbackId){const t=this.sourceName,l=r.sourceName;new Promise((function(t){t(o(r.data))})).then((function(o){i.postMessage({sourceName:t,targetName:l,callback:a,callbackId:r.callbackId,data:o})}),(function(o){i.postMessage({sourceName:t,targetName:l,callback:c,callbackId:r.callbackId,reason:wrapReason(o)})}))}else r.streamId?this._createStreamSink(r):o(r.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,r){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=r}send(t,r,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:r},i)}sendWithPromise(t,r,i){const a=this.callbackId++,c=(0,o.createPromiseCapability)();this.callbackCapabilities[a]=c;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:r},i)}catch(t){c.reject(t)}return c.promise}sendWithStream(t,r,i,a){const c=this.streamId++,u=this.sourceName,d=this.targetName,h=this.comObj;return new ReadableStream({start:i=>{const l=(0,o.createPromiseCapability)();return this.streamControllers[c]={controller:i,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:u,targetName:d,action:t,streamId:c,data:r,desiredSize:i.desiredSize},a),l.promise},pull:t=>{const r=(0,o.createPromiseCapability)();return this.streamControllers[c].pullCall=r,h.postMessage({sourceName:u,targetName:d,stream:g,streamId:c,desiredSize:t.desiredSize}),r.promise},cancel:t=>{(0,o.assert)(t instanceof Error,"cancel must have a valid reason");const r=(0,o.createPromiseCapability)();return this.streamControllers[c].cancelCall=r,this.streamControllers[c].isClosed=!0,h.postMessage({sourceName:u,targetName:d,stream:l,streamId:c,reason:wrapReason(t)}),r.promise}},i)}_createStreamSink(t){const r=t.streamId,i=this.sourceName,a=t.sourceName,c=this.comObj,l=this,u=this.actionHandler[t.action],g={enqueue(t,l=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=l,d>0&&this.desiredSize<=0&&(this.sinkCapability=(0,o.createPromiseCapability)(),this.ready=this.sinkCapability.promise),c.postMessage({sourceName:i,targetName:a,stream:h,streamId:r,chunk:t},u)},close(){this.isCancelled||(this.isCancelled=!0,c.postMessage({sourceName:i,targetName:a,stream:d,streamId:r}),delete l.streamSinks[r])},error(t){(0,o.assert)(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,c.postMessage({sourceName:i,targetName:a,stream:p,streamId:r,reason:wrapReason(t)}))},sinkCapability:(0,o.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[r]=g,new Promise((function(r){r(u(t.data,g))})).then((function(){c.postMessage({sourceName:i,targetName:a,stream:y,streamId:r,success:!0})}),(function(t){c.postMessage({sourceName:i,targetName:a,stream:y,streamId:r,reason:wrapReason(t)})}))}_processStreamMessage(t){const r=t.streamId,i=this.sourceName,a=t.sourceName,c=this.comObj,v=this.streamControllers[r],_=this.streamSinks[r];switch(t.stream){case y:t.success?v.startCall.resolve():v.startCall.reject(wrapReason(t.reason));break;case m:t.success?v.pullCall.resolve():v.pullCall.reject(wrapReason(t.reason));break;case g:if(!_){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,success:!0});break}_.desiredSize<=0&&t.desiredSize>0&&_.sinkCapability.resolve(),_.desiredSize=t.desiredSize,new Promise((function(t){t(_.onPull&&_.onPull())})).then((function(){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,success:!0})}),(function(t){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,reason:wrapReason(t)})}));break;case h:if((0,o.assert)(v,"enqueue should have stream controller"),v.isClosed)break;v.controller.enqueue(t.chunk);break;case d:if((0,o.assert)(v,"close should have stream controller"),v.isClosed)break;v.isClosed=!0,v.controller.close(),this._deleteStreamController(v,r);break;case p:(0,o.assert)(v,"error should have stream controller"),v.controller.error(wrapReason(t.reason)),this._deleteStreamController(v,r);break;case u:t.success?v.cancelCall.resolve():v.cancelCall.reject(wrapReason(t.reason)),this._deleteStreamController(v,r);break;case l:if(!_)break;new Promise((function(r){r(_.onCancel&&_.onCancel(wrapReason(t.reason)))})).then((function(){c.postMessage({sourceName:i,targetName:a,stream:u,streamId:r,success:!0})}),(function(t){c.postMessage({sourceName:i,targetName:a,stream:u,streamId:r,reason:wrapReason(t)})})),_.sinkCapability.reject(wrapReason(t.reason)),_.isCancelled=!0,delete this.streamSinks[r];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(t,r){await Promise.allSettled([t.startCall&&t.startCall.promise,t.pullCall&&t.pullCall.promise,t.cancelCall&&t.cancelCall.promise]),delete this.streamControllers[r]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var o=i(1);r.Metadata=class Metadata{#l;#u;constructor({parsedData:t,rawData:r}){this.#l=t,this.#u=r}getRaw(){return this.#u}get(t){return this.#l.get(t)??null}getAll(){return(0,o.objectFromMap)(this.#l)}has(t){return this.#l.has(t)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var o=i(1);class OptionalContentGroup{constructor(t,r){this.visible=!0,this.name=t,this.intent=r}}r.OptionalContentConfig=class OptionalContentConfig{constructor(t){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,null!==t){this.name=t.name,this.creator=t.creator,this._order=t.order;for(const r of t.groups)this._groups.set(r.id,new OptionalContentGroup(r.name,r.intent));if("OFF"===t.baseState)for(const t of this._groups)t.visible=!1;for(const r of t.on)this._groups.get(r).visible=!0;for(const r of t.off)this._groups.get(r).visible=!1}}_evaluateVisibilityExpression(t){const r=t.length;if(r<2)return!0;const i=t[0];for(let a=1;a<r;a++){const r=t[a];let c;if(Array.isArray(r))c=this._evaluateVisibilityExpression(r);else{if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;c=this._groups.get(r).visible}switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return"And"===i}isVisible(t){if(0===this._groups.size)return!0;if(!t)return(0,o.warn)("Optional content group not defined."),!0;if("OCG"===t.type)return this._groups.has(t.id)?this._groups.get(t.id).visible:((0,o.warn)(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this._evaluateVisibilityExpression(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(this._groups.get(r).visible)return!0}return!1}if("AllOn"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(!this._groups.get(r).visible)return!1}return!0}if("AnyOff"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(!this._groups.get(r).visible)return!0}return!1}if("AllOff"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(this._groups.get(r).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,o.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,r=!0){this._groups.has(t)?this._groups.get(t).visible=!!r:(0,o.warn)(`Optional content group not found: ${t}`)}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,o.objectFromMap)(this._groups):null}getGroup(t){return this._groups.get(t)||null}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var o=i(1),a=i(5);r.PDFDataTransportStream=class PDFDataTransportStream{constructor(t,r){(0,o.assert)(r,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=t.progressiveDone||!1,this._contentDispositionFilename=t.contentDispositionFilename||null;const i=t.initialData;if(i?.length>0){const t=new Uint8Array(i).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=r,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._contentLength=t.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(((t,r)=>{this._onReceiveData({begin:t,chunk:r})})),this._pdfDataRangeTransport.addProgressListener(((t,r)=>{this._onProgress({loaded:t,total:r})})),this._pdfDataRangeTransport.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),this._pdfDataRangeTransport.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}_onReceiveData(t){const r=new Uint8Array(t.chunk).buffer;if(void 0===t.begin)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some((function(i){return i._begin===t.begin&&(i._enqueue(r),!0)}));(0,o.assert)(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){if(void 0===t.total){const r=this._rangeReaders[0];r?.onProgress&&r.onProgress({loaded:t.loaded})}else{const r=this._fullRequestReader;r?.onProgress&&r.onProgress({loaded:t.loaded,total:t.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const r=this._rangeReaders.indexOf(t);r>=0&&this._rangeReaders.splice(r,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=new PDFDataTransportStreamRangeReader(this,t,r);return this._pdfDataRangeTransport.requestDataRange(t,r),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeReaders.slice(0))r.cancel(t);this._pdfDataRangeTransport.abort()}};class PDFDataTransportStreamReader{constructor(t,r,i=!1,o=null){this._stream=t,this._done=i||!1,this._filename=(0,a.isPdfFile)(o)?o:null,this._queuedChunks=r||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PDFDataTransportStreamRangeReader{constructor(t,r,i){this._stream=t,this._begin=r,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class XfaText{static textContent(t){const r=[],i={items:r,styles:Object.create(null)};return function walk(t){if(!t)return;let i=null;const o=t.name;if("#text"===o)i=t.value;else{if(!XfaText.shouldBuildText(o))return;t?.attributes?.textContent?i=t.attributes.textContent:t.value&&(i=t.value)}if(null!==i&&r.push({str:i}),t.children)for(const r of t.children)walk(r)}(t),i}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}r.XfaText=XfaText},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var o=i(6);const fetchData=function(t){return new Promise(((r,i)=>{__webpack_require__(172).readFile(t,((t,o)=>{!t&&o?r(new Uint8Array(o)):i(new Error(t))}))}))};class NodeCanvasFactory extends o.BaseCanvasFactory{_createCanvas(t,r){return __webpack_require__(414).createCanvas(t,r)}}r.NodeCanvasFactory=NodeCanvasFactory;class NodeCMapReaderFactory extends o.BaseCMapReaderFactory{_fetchData(t,r){return fetchData(t).then((t=>({cMapData:t,compressionType:r})))}}r.NodeCMapReaderFactory=NodeCMapReaderFactory;class NodeStandardFontDataFactory extends o.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t)}}r.NodeStandardFontDataFactory=NodeStandardFontDataFactory},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var o=i(1),a=i(5),c=i(8),l=i(21),u=i(22);const d=1e3,h=new WeakSet;function getRectDims(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class AnnotationElementFactory{static create(t){switch(t.data.annotationType){case o.AnnotationType.LINK:return new LinkAnnotationElement(t);case o.AnnotationType.TEXT:return new TextAnnotationElement(t);case o.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(t);case"Btn":return t.data.radioButton?new RadioButtonWidgetAnnotationElement(t):t.data.checkBox?new CheckboxWidgetAnnotationElement(t):new PushButtonWidgetAnnotationElement(t);case"Ch":return new ChoiceWidgetAnnotationElement(t)}return new WidgetAnnotationElement(t);case o.AnnotationType.POPUP:return new PopupAnnotationElement(t);case o.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(t);case o.AnnotationType.LINE:return new LineAnnotationElement(t);case o.AnnotationType.SQUARE:return new SquareAnnotationElement(t);case o.AnnotationType.CIRCLE:return new CircleAnnotationElement(t);case o.AnnotationType.POLYLINE:return new PolylineAnnotationElement(t);case o.AnnotationType.CARET:return new CaretAnnotationElement(t);case o.AnnotationType.INK:return new InkAnnotationElement(t);case o.AnnotationType.POLYGON:return new PolygonAnnotationElement(t);case o.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(t);case o.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(t);case o.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(t);case o.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(t);case o.AnnotationType.STAMP:return new StampAnnotationElement(t);case o.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(t);default:return new AnnotationElement(t)}}}class AnnotationElement{constructor(t,{isRenderable:r=!1,ignoreBorder:i=!1,createQuadrilaterals:o=!1}={}){this.isRenderable=r,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,r&&(this.container=this._createContainer(i)),o&&(this.quadrilaterals=this._createQuadrilaterals(i))}_createContainer(t=!1){const r=this.data,i=this.page,a=this.viewport,c=document.createElement("section");let{width:l,height:u}=getRectDims(r.rect);c.setAttribute("data-annotation-id",r.id);const d=o.Util.normalizeRect([r.rect[0],i.view[3]-r.rect[1]+i.view[1],r.rect[2],i.view[3]-r.rect[3]+i.view[1]]);if(r.hasOwnCanvas){const t=a.transform.slice(),[r,i]=o.Util.singularValueDecompose2dScale(t);l=Math.ceil(l*r),u=Math.ceil(u*i),d[0]*=r,d[1]*=i;for(let r=0;r<4;r++)t[r]=Math.sign(t[r]);c.style.transform=`matrix(${t.join(",")})`}else c.style.transform=`matrix(${a.transform.join(",")})`;if(c.style.transformOrigin=`${-d[0]}px ${-d[1]}px`,!t&&r.borderStyle.width>0){c.style.borderWidth=`${r.borderStyle.width}px`,r.borderStyle.style!==o.AnnotationBorderStyleType.UNDERLINE&&(l-=2*r.borderStyle.width,u-=2*r.borderStyle.width);const t=r.borderStyle.horizontalCornerRadius,i=r.borderStyle.verticalCornerRadius;if(t>0||i>0){const r=`${t}px / ${i}px`;c.style.borderRadius=r}switch(r.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:c.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:c.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:c.style.borderBottomStyle="solid"}r.borderColor||r.color||null?c.style.borderColor=o.Util.makeHexColor(0|r.color[0],0|r.color[1],0|r.color[2]):c.style.borderWidth=0}return c.style.left=`${d[0]}px`,c.style.top=`${d[1]}px`,r.hasOwnCanvas?c.style.width=c.style.height="auto":(c.style.width=`${l}px`,c.style.height=`${u}px`),c}get _commonActions(){const setColor=(t,r,i)=>{const o=i.detail[t];i.target.style[r]=l.ColorConverters[`${o[0]}_HTML`](o.slice(1))};return(0,o.shadow)(this,"_commonActions",{display:t=>{const r=t.detail.display%2==1;t.target.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r,print:0===t.detail.display||3===t.detail.display})},print:t=>{this.annotationStorage.setValue(this.data.id,{print:t.detail.print})},hidden:t=>{t.target.style.visibility=t.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:t.detail.hidden})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.detail.readonly?t.target.setAttribute("readonly",""):t.target.removeAttribute("readonly")},required:t=>{t.detail.required?t.target.setAttribute("required",""):t.target.removeAttribute("required")},bgColor:t=>{setColor("bgColor","backgroundColor",t)},fillColor:t=>{setColor("fillColor","backgroundColor",t)},fgColor:t=>{setColor("fgColor","color",t)},textColor:t=>{setColor("textColor","color",t)},borderColor:t=>{setColor("borderColor","borderColor",t)},strokeColor:t=>{setColor("strokeColor","borderColor",t)}})}_dispatchEventFromSandbox(t,r){const i=this._commonActions;for(const o of Object.keys(r.detail)){const a=t[o]||i[o];a&&a(r)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const r=this.annotationStorage.getRawValue(this.data.id);if(!r)return;const i=this._commonActions;for(const[o,a]of Object.entries(r)){const c=i[o];c&&(c({detail:a,target:t}),delete r[o])}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const r=[],i=this.data.rect;for(const i of this.data.quadPoints)this.data.rect=[i[2].x,i[2].y,i[1].x,i[1].y],r.push(this._createContainer(t));return this.data.rect=i,r}_createPopup(t,r){let i=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,i=this.quadrilaterals[0]),t||((t=document.createElement("div")).style.height=i.style.height,t.style.width=i.style.width,i.appendChild(t));const o=new PopupElement({container:i,trigger:t,color:r.color,titleObj:r.titleObj,modificationDate:r.modificationDate,contentsObj:r.contentsObj,richText:r.richText,hideWrapper:!0}).render();o.style.left=i.style.width,i.appendChild(o)}_renderQuadrilaterals(t){for(const r of this.quadrilaterals)r.className=t;return this.quadrilaterals}render(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,r=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:t,id:c,exportValues:l}of a){if(-1===t)continue;if(c===r)continue;const a="string"==typeof l?l:null,u=document.getElementById(c);!u||h.has(u)?i.push({id:c,exportValue:a,domElement:u}):(0,o.warn)(`_getElementsByName - element not allowed: ${c}`)}return i}for(const o of document.getElementsByName(t)){const{id:t,exportValue:a}=o;t!==r&&(h.has(o)&&i.push({id:t,exportValue:a,domElement:o}))}return i}static get platform(){const t="undefined"!=typeof navigator?navigator.platform:"";return(0,o.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class LinkAnnotationElement extends AnnotationElement{constructor(t,r=null){super(t,{isRenderable:!!(t.data.url||t.data.dest||t.data.action||t.data.isTooltipOnly||t.data.resetForm||t.data.actions&&(t.data.actions.Action||t.data.actions["Mouse Up"]||t.data.actions["Mouse Down"])),ignoreBorder:!!r?.ignoreBorder,createQuadrilaterals:!0})}render(){const{data:t,linkService:r}=this,i=document.createElement("a");if(t.url)r.addLinkAttributes(i,t.url,t.newWindow);else if(t.action)this._bindNamedAction(i,t.action);else if(t.dest)this._bindLink(i,t.dest);else{let r=!1;t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(r=!0,this._bindJSAction(i,t)),t.resetForm?this._bindResetFormAction(i,t.resetForm):r||this._bindLink(i,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map(((t,r)=>{const o=0===r?i:i.cloneNode();return t.appendChild(o),t})):(this.container.className="linkAnnotation",this.container.appendChild(i),this.container)}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||""===r)&&(t.className="internalLink")}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),t.className="internalLink"}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(r.actions)){const a=i.get(o);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:o}}),!1))}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects)return(0,o.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(i||(t.onclick=()=>!1));t.onclick=()=>{i&&i();const{fields:t,refs:o,include:a}=r,c=[];if(0!==t.length||0!==o.length){const r=new Set(o);for(const i of t){const t=this._fieldObjects[i]||[];for(const{id:i}of t)r.add(i)}for(const t of Object.values(this._fieldObjects))for(const i of t)r.has(i.id)===a&&c.push(i)}else for(const t of Object.values(this._fieldObjects))c.push(...t);const l=this.annotationStorage,u=[];for(const t of c){const{id:r}=t;switch(u.push(r),t.type){case"text":{const i=t.defaultValue||"";l.setValue(r,{value:i});break}case"checkbox":case"radiobutton":{const i=t.defaultValue===t.exportValues;l.setValue(r,{value:i});break}case"combobox":case"listbox":{const i=t.defaultValue||"";l.setValue(r,{value:i});break}default:continue}const i=document.getElementById(r);i&&h.has(i)&&i.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}}class TextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.appendChild(t),this.container}}class WidgetAnnotationElement extends AnnotationElement{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:r,isMac:i}=AnnotationElement.platform;return r&&t.ctrlKey||i&&t.metaKey}_setEventListener(t,r,i,o){r.includes("mouse")?t.addEventListener(r,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(r,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(t)}})}))}_setEventListeners(t,r,i){for(const[o,a]of r)("Action"===a||this.data.actions?.[a])&&this._setEventListener(t,o,a,i)}_setBackgroundColor(t){const r=this.data.backgroundColor||null;t.style.backgroundColor=null===r?"transparent":o.Util.makeHexColor(r[0],r[1],r[2])}}class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,r,i,o){const a=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[r]=i),a.setValue(c.id,{[o]:i})}render(){const t=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let i=null;if(this.renderForms){const o=t.getValue(r,{value:this.data.fieldValue}),a=o.formattedValue||o.value||"",c={userValue:null,formattedValue:null,valueOnFocus:""};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a):(i=document.createElement("input"),i.type="text",i.setAttribute("value",a)),h.add(i),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=d,c.userValue=a,i.setAttribute("id",r),i.addEventListener("input",(o=>{t.setValue(r,{value:o.target.value}),this.setPropertyOnSiblings(i,"value",o.target.value,"value")})),i.addEventListener("resetform",(t=>{const r=this.data.defaultFieldValue??"";i.value=c.userValue=r,c.formattedValue=null}));let blurListener=t=>{const{formattedValue:r}=c;null!=r&&(t.target.value=r),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",(t=>{c.userValue&&(t.target.value=c.userValue),c.valueOnFocus=t.target.value})),i.addEventListener("updatefromsandbox",(i=>{const o={value(i){c.userValue=i.detail.value??"",t.setValue(r,{value:c.userValue.toString()}),i.target.value=c.userValue},formattedValue(i){const{formattedValue:o}=i.detail;c.formattedValue=o,null!=o&&i.target!==document.activeElement&&(i.target.value=o),t.setValue(r,{formattedValue:o})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)}};this._dispatchEventFromSandbox(o,i)})),i.addEventListener("keydown",(t=>{let i=-1;if("Escape"===t.key?i=0:"Enter"===t.key?i=2:"Tab"===t.key&&(i=3),-1===i)return;const{value:o}=t.target;c.valueOnFocus!==o&&(c.userValue=o,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:o,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const o=blurListener;blurListener=null,i.addEventListener("blur",(t=>{const{value:i}=t.target;c.userValue=i,this._mouseState.isDown&&c.valueOnFocus!==i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:i,willCommit:!0,commitKey:1,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),o(t)})),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",(t=>{const{data:i,target:o}=t,{value:a,selectionStart:c,selectionEnd:l}=o;let u=c,d=l;switch(t.inputType){case"deleteWordBackward":{const t=a.substring(0,c).match(/\w*[^\w]*$/);t&&(u-=t[0].length);break}case"deleteWordForward":{const t=a.substring(c).match(/^[^\w]*\w*/);t&&(d+=t[0].length);break}case"deleteContentBackward":c===l&&(u-=1);break;case"deleteContentForward":c===l&&(d+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:a,change:i||"",willCommit:!1,selStart:u,selEnd:d}})})),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(blurListener&&i.addEventListener("blur",blurListener),null!==this.data.maxLen&&(i.maxLength=this.data.maxLen),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;i.classList.add("comb"),i.style.letterSpacing=`calc(${t}px - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.appendChild(i),this.container}_setTextStyle(t){const r=["left","center","right"],{fontSize:i,fontColor:a}=this.data.defaultAppearanceData,c=t.style;i&&(c.fontSize=`${i}px`),c.color=o.Util.makeHexColor(a[0],a[1],a[2]),null!==this.data.textAlignment&&(c.textAlign=r[this.data.textAlignment])}}class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,r=this.data,i=r.id;let o=t.getValue(i,{value:r.exportValue===r.fieldValue}).value;"string"==typeof o&&(o="Off"!==o,t.setValue(i,{value:o})),this.container.className="buttonWidgetAnnotation checkBox";const a=document.createElement("input");return h.add(a),a.disabled=r.readOnly,a.type="checkbox",a.name=r.fieldName,o&&a.setAttribute("checked",!0),a.setAttribute("id",i),a.setAttribute("exportValue",r.exportValue),a.tabIndex=d,a.addEventListener("change",(o=>{const{name:a,checked:c}=o.target;for(const o of this._getElementsByName(a,i)){const i=c&&o.exportValue===r.exportValue;o.domElement&&(o.domElement.checked=i),t.setValue(o.id,{value:i})}t.setValue(i,{value:c})})),a.addEventListener("resetform",(t=>{const i=r.defaultFieldValue||"Off";t.target.checked=i===r.exportValue})),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",(r=>{const o={value(r){r.target.checked="Off"!==r.detail.value,t.setValue(i,{value:r.target.checked})}};this._dispatchEventFromSandbox(o,r)})),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.appendChild(a),this.container}}class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,r=this.data,i=r.id;let o=t.getValue(i,{value:r.fieldValue===r.buttonValue}).value;"string"==typeof o&&(o=o!==r.buttonValue,t.setValue(i,{value:o}));const a=document.createElement("input");if(h.add(a),a.disabled=r.readOnly,a.type="radio",a.name=r.fieldName,o&&a.setAttribute("checked",!0),a.setAttribute("id",i),a.tabIndex=d,a.addEventListener("change",(r=>{const{name:o,checked:a}=r.target;for(const r of this._getElementsByName(o,i))t.setValue(r.id,{value:!1});t.setValue(i,{value:a})})),a.addEventListener("resetform",(t=>{const i=r.defaultFieldValue;t.target.checked=null!=i&&i===r.buttonValue})),this.enableScripting&&this.hasJSActions){const o=r.buttonValue;a.addEventListener("updatefromsandbox",(r=>{const a={value:r=>{const a=o===r.detail.value;for(const o of this._getElementsByName(r.target.name)){const r=a&&o.id===i;o.domElement&&(o.domElement.checked=r),t.setValue(o.id,{value:r})}}};this._dispatchEventFromSandbox(a,r)})),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.appendChild(a),this.container}}class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();return t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText),this._setDefaultPropertiesFromJS(t),t}}class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,r=this.data.id,i=t.getValue(r,{value:this.data.fieldValue});let{fontSize:o}=this.data.defaultAppearanceData;o||(o=9);const a=`calc(${o}px * var(--zoom-factor))`,c=document.createElement("select");h.add(c),c.disabled=this.data.readOnly,c.name=this.data.fieldName,c.setAttribute("id",r),c.tabIndex=d,c.style.fontSize=`${o}px`,this.data.combo||(c.size=this.data.options.length,this.data.multiSelect&&(c.multiple=!0)),c.addEventListener("resetform",(t=>{const r=this.data.defaultFieldValue;for(const t of c.options)t.selected=t.value===r}));for(const t of this.data.options){const r=document.createElement("option");r.textContent=t.displayValue,r.value=t.exportValue,this.data.combo&&(r.style.fontSize=a),i.value.includes(t.exportValue)&&r.setAttribute("selected",!0),c.appendChild(r)}const getValue=(t,r)=>{const i=r?"value":"textContent",o=t.target.options;return t.target.multiple?Array.prototype.filter.call(o,(t=>t.selected)).map((t=>t[i])):-1===o.selectedIndex?null:o[o.selectedIndex][i]},getItems=t=>{const r=t.target.options;return Array.prototype.map.call(r,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(c.addEventListener("updatefromsandbox",(i=>{const o={value(i){const o=i.detail.value,a=new Set(Array.isArray(o)?o:[o]);for(const t of c.options)t.selected=a.has(t.value);t.setValue(r,{value:getValue(i,!0)})},multipleSelection(t){c.multiple=!0},remove(i){const o=c.options,a=i.detail.remove;if(o[a].selected=!1,c.remove(a),o.length>0){-1===Array.prototype.findIndex.call(o,(t=>t.selected))&&(o[0].selected=!0)}t.setValue(r,{value:getValue(i,!0),items:getItems(i)})},clear(i){for(;0!==c.length;)c.remove(0);t.setValue(r,{value:null,items:[]})},insert(i){const{index:o,displayValue:a,exportValue:l}=i.detail.insert,u=document.createElement("option");u.textContent=a,u.value=l,c.insertBefore(u,c.children[o]),t.setValue(r,{value:getValue(i,!0),items:getItems(i)})},items(i){const{items:o}=i.detail;for(;0!==c.length;)c.remove(0);for(const t of o){const{displayValue:r,exportValue:i}=t,o=document.createElement("option");o.textContent=r,o.value=i,c.appendChild(o)}c.options.length>0&&(c.options[0].selected=!0),t.setValue(r,{value:getValue(i,!0),items:getItems(i)})},indices(i){const o=new Set(i.detail.indices);for(const t of i.target.options)t.selected=o.has(t.index);t.setValue(r,{value:getValue(i,!0)})},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(o,i)})),c.addEventListener("input",(i=>{const o=getValue(i,!0),a=getValue(i,!1);t.setValue(r,{value:o}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:a,changeEx:o,willCommit:!0,commitKey:1,keyDown:!1}})})),this._setEventListeners(c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],(t=>t.target.checked))):c.addEventListener("input",(function(i){t.setValue(r,{value:getValue(i,!0)})})),this._setBackgroundColor(c),this._setDefaultPropertiesFromJS(c),this.container.appendChild(c),this.container}}class PopupAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const t=`[data-annotation-id="${this.data.parentId}"]`,r=this.layer.querySelectorAll(t);if(0===r.length)return this.container;const i=new PopupElement({container:this.container,trigger:Array.from(r),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),a=this.page,c=o.Util.normalizeRect([this.data.parentRect[0],a.view[3]-this.data.parentRect[1]+a.view[1],this.data.parentRect[2],a.view[3]-this.data.parentRect[3]+a.view[1]]),l=c[0]+this.data.parentRect[2]-this.data.parentRect[0],u=c[1];return this.container.style.transformOrigin=`${-l}px ${-u}px`,this.container.style.left=`${l}px`,this.container.style.top=`${u}px`,this.container.appendChild(i.render()),this.container}}class PopupElement{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const t=document.createElement("div");t.className="popupWrapper",this.hideElement=this.hideWrapper?t:this.container,this.hideElement.hidden=!0;const r=document.createElement("div");r.className="popup";const i=this.color;if(i){const t=.7*(255-i[0])+i[0],a=.7*(255-i[1])+i[1],c=.7*(255-i[2])+i[2];r.style.backgroundColor=o.Util.makeHexColor(0|t,0|a,0|c)}const c=document.createElement("h1");c.dir=this.titleObj.dir,c.textContent=this.titleObj.str,r.appendChild(c);const l=a.PDFDateString.toDateObject(this.modificationDate);if(l){const t=document.createElement("span");t.className="popupDate",t.textContent="{{date}}, {{time}}",t.dataset.l10nId="annotation_date_string",t.dataset.l10nArgs=JSON.stringify({date:l.toLocaleDateString(),time:l.toLocaleTimeString()}),r.appendChild(t)}if(!this.richText?.str||this.contentsObj?.str&&this.contentsObj.str!==this.richText.str){const t=this._formatContents(this.contentsObj);r.appendChild(t)}else u.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:r}),r.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const t of this.trigger)t.addEventListener("click",this._toggle.bind(this)),t.addEventListener("mouseover",this._show.bind(this,!1)),t.addEventListener("mouseout",this._hide.bind(this,!1));return r.addEventListener("click",this._hide.bind(this,!0)),t.appendChild(r),t}_formatContents({str:t,dir:r}){const i=document.createElement("p");i.className="popupContent",i.dir=r;const o=t.split(/(?:\r\n?|\n)/);for(let t=0,r=o.length;t<r;++t){const a=o[t];i.appendChild(document.createTextNode(a)),t<r-1&&i.appendChild(document.createElement("br"))}return i}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(t=!0){t&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class FreeTextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class LineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:r,height:i}=getRectDims(t.rect),o=this.svgFactory.create(r,i),a=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),o.appendChild(a),this.container.append(o),this._createPopup(a,t),this.container}}class SquareAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:r,height:i}=getRectDims(t.rect),o=this.svgFactory.create(r,i),a=t.borderStyle.width,c=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",a/2),c.setAttribute("y",a/2),c.setAttribute("width",r-a),c.setAttribute("height",i-a),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class CircleAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:r,height:i}=getRectDims(t.rect),o=this.svgFactory.create(r,i),a=t.borderStyle.width,c=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",r/2),c.setAttribute("cy",i/2),c.setAttribute("rx",r/2-a/2),c.setAttribute("ry",i/2-a/2),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class PolylineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:r,height:i}=getRectDims(t.rect),o=this.svgFactory.create(r,i);let a=[];for(const r of t.vertices){const i=r.x-t.rect[0],o=t.rect[3]-r.y;a.push(i+","+o)}a=a.join(" ");const c=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",a),c.setAttribute("stroke-width",t.borderStyle.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class CaretAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class InkAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:r,height:i}=getRectDims(t.rect),o=this.svgFactory.create(r,i);for(const r of t.inkLists){let i=[];for(const o of r){const r=o.x-t.rect[0],a=t.rect[3]-o.y;i.push(`${r},${a}`)}i=i.join(" ");const a=this.svgFactory.createElement(this.svgElementName);a.setAttribute("points",i),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),this._createPopup(a,t),o.appendChild(a)}return this.container.append(o),this.container}}class HighlightAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class UnderlineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class SquigglyAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class StrikeOutAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class StampAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class FileAttachmentAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!0});const{filename:r,content:i}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(r),this.content=i,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:r,content:i})}render(){this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.appendChild(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}r.AnnotationLayer=class AnnotationLayer{static render(t){const r=[],i=[];for(const a of t.annotations){if(!a)continue;const{width:t,height:c}=getRectDims(a.rect);t<=0||c<=0||(a.annotationType!==o.AnnotationType.POPUP?r.push(a):i.push(a))}i.length&&r.push(...i);const l=t.div;for(const i of r){const r=AnnotationElementFactory.create({data:i,layer:l,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new a.DOMSVGFactory,annotationStorage:t.annotationStorage||new c.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(r.isRenderable){const t=r.render();if(i.hidden&&(t.style.visibility="hidden"),Array.isArray(t))for(const r of t)l.appendChild(r);else r instanceof PopupAnnotationElement?l.prepend(t):l.appendChild(t)}}this.#d(l,t.annotationCanvasMap)}static update(t){const{page:r,viewport:i,annotations:a,annotationCanvasMap:c,div:l}=t,u=i.transform,d=`matrix(${u.join(",")})`;let h,p;for(const t of a){const i=l.querySelectorAll(`[data-annotation-id="${t.id}"]`);if(i)for(const a of i)if(t.hasOwnCanvas){const i=o.Util.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]);if(!p){h=Math.abs(u[0]||u[1]);const t=u.slice();for(let r=0;r<4;r++)t[r]=Math.sign(t[r]);p=`matrix(${t.join(",")})`}const c=i[0]*h,l=i[1]*h;a.style.left=`${c}px`,a.style.top=`${l}px`,a.style.transformOrigin=`${-c}px ${-l}px`,a.style.transform=p}else a.style.transform=d}this.#d(l,c),l.hidden=!1}static#d(t,r){if(r){for(const[i,o]of r){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;const{firstChild:a}=r;"CANVAS"===a.nodeName?r.replaceChild(o,a):r.insertBefore(o,a)}r.clear()}}}},(t,r)=>{function makeColorComp(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;r.ColorConverters=class ColorConverters{static CMYK_G([t,r,i,o]){return["G",1-Math.min(1,.3*t+.59*i+.11*r+o)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_HTML([t]){const r=makeColorComp(t);return`#${r}${r}${r}`}static RGB_G([t,r,i]){return["G",.3*t+.59*r+.11*i]}static RGB_HTML([t,r,i]){return`#${makeColorComp(t)}${makeColorComp(r)}${makeColorComp(i)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([t,r,i,o]){return["RGB",1-Math.min(1,t+o),1-Math.min(1,i+o),1-Math.min(1,r+o)]}static CMYK_HTML(t){return this.RGB_HTML(this.CMYK_RGB(t))}static RGB_CMYK([t,r,i]){const o=1-t,a=1-r,c=1-i;return["CMYK",o,a,c,Math.min(o,a,c)]}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var o=i(18);r.XfaLayer=class XfaLayer{static setupStorage(t,r,i,o,a){const c=o.getValue(r,{value:null});switch(i.name){case"textarea":if(null!==c.value&&(t.textContent=c.value),"print"===a)break;t.addEventListener("input",(t=>{o.setValue(r,{value:t.target.value})}));break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),"print"===a)break;t.addEventListener("change",(t=>{o.setValue(r,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==c.value&&t.setAttribute("value",c.value),"print"===a)break;t.addEventListener("input",(t=>{o.setValue(r,{value:t.target.value})}))}break;case"select":if(null!==c.value)for(const t of i.children)t.attributes.value===c.value&&(t.attributes.selected=!0);t.addEventListener("input",(t=>{const i=t.target.options,a=-1===i.selectedIndex?"":i[i.selectedIndex].value;o.setValue(r,{value:a})}))}}static setAttributes({html:t,element:r,storage:i=null,intent:o,linkService:a}){const{attributes:c}=r,l=t instanceof HTMLAnchorElement;"radio"===c.type&&(c.name=`${c.name}-${o}`);for(const[r,i]of Object.entries(c))if(null!=i&&"dataId"!==r)if("style"!==r)if("textContent"===r)t.textContent=i;else if("class"===r)i.length&&t.setAttribute(r,i.join(" "));else{if(l&&("href"===r||"newWindow"===r))continue;t.setAttribute(r,i)}else Object.assign(t.style,i);l&&a.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,r,i)}static render(t){const r=t.annotationStorage,i=t.linkService,a=t.xfaHtml,c=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:c,linkService:i});const u=[[a,-1,l]],d=t.div;if(d.appendChild(l),t.viewport){const r=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=r}"richText"!==c&&d.setAttribute("class","xfaLayer xfaFont");const h=[];for(;u.length>0;){const[t,a,l]=u[u.length-1];if(a+1===t.children.length){u.pop();continue}const d=t.children[++u[u.length-1][1]];if(null===d)continue;const{name:p}=d;if("#text"===p){const t=document.createTextNode(d.value);h.push(t),l.appendChild(t);continue}let g;if(g=d?.attributes?.xmlns?document.createElementNS(d.attributes.xmlns,p):document.createElement(p),l.appendChild(g),d.attributes&&this.setAttributes({html:g,element:d,storage:r,intent:c,linkService:i}),d.children&&d.children.length>0)u.push([d,-1,g]);else if(d.value){const t=document.createTextNode(d.value);o.XfaText.shouldBuildText(p)&&h.push(t),g.appendChild(t)}}for(const t of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const r=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=r,t.div.hidden=!1}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.renderTextLayer=function renderTextLayer(t){const r=new TextLayerRenderTask({textContent:t.textContent,textContentStream:t.textContentStream,container:t.container,viewport:t.viewport,textDivs:t.textDivs,textContentItemsStr:t.textContentItemsStr,enhanceTextSelection:t.enhanceTextSelection});return r._render(t.timeout),r};var o=i(1);const a=30,c=new Map,l=/^\s+$/g;function appendText(t,r,i,u){const d=document.createElement("span"),h=t._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==r.str,hasEOL:r.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:""!==r.str,hasEOL:r.hasEOL};t._textDivs.push(d);const p=o.Util.transform(t._viewport.transform,r.transform);let g=Math.atan2(p[1],p[0]);const m=i[r.fontName];m.vertical&&(g+=Math.PI/2);const y=Math.hypot(p[2],p[3]),v=y*function getAscent(t,r){const i=c.get(t);if(i)return i;r.save(),r.font=`30px ${t}`;const o=r.measureText("");let l=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);if(l){r.restore();const i=l/(l+u);return c.set(t,i),i}r.strokeStyle="red",r.clearRect(0,0,a,a),r.strokeText("g",0,0);let d=r.getImageData(0,0,a,a).data;u=0;for(let t=d.length-1-3;t>=0;t-=4)if(d[t]>0){u=Math.ceil(t/4/a);break}r.clearRect(0,0,a,a),r.strokeText("A",0,a),d=r.getImageData(0,0,a,a).data,l=0;for(let t=0,r=d.length;t<r;t+=4)if(d[t]>0){l=a-Math.floor(t/4/a);break}if(r.restore(),l){const r=l/(l+u);return c.set(t,r),r}return c.set(t,.8),.8}(m.fontFamily,u);let _,b;0===g?(_=p[4],b=p[5]-v):(_=p[4]+v*Math.sin(g),b=p[5]-v*Math.cos(g)),d.style.left=`${_}px`,d.style.top=`${b}px`,d.style.fontSize=`${y}px`,d.style.fontFamily=m.fontFamily,d.setAttribute("role","presentation"),d.textContent=r.str,d.dir=r.dir,t._fontInspectorEnabled&&(d.dataset.fontName=r.fontName),0!==g&&(h.angle=g*(180/Math.PI));let A=!1;if(r.str.length>1||t._enhanceTextSelection&&l.test(r.str))A=!0;else if(" "!==r.str&&r.transform[0]!==r.transform[3]){const t=Math.abs(r.transform[0]),i=Math.abs(r.transform[3]);t!==i&&Math.max(t,i)/Math.min(t,i)>1.5&&(A=!0)}if(A&&(m.vertical?h.canvasWidth=r.height*t._viewport.scale:h.canvasWidth=r.width*t._viewport.scale),t._textDivProperties.set(d,h),t._textContentStream&&t._layoutText(d),t._enhanceTextSelection&&h.hasText){let i=1,a=0;0!==g&&(i=Math.cos(g),a=Math.sin(g));const c=(m.vertical?r.height:r.width)*t._viewport.scale,l=y;let u,h;0!==g?(u=[i,a,-a,i,_,b],h=o.Util.getAxialAlignedBoundingBox([0,0,c,l],u)):h=[_,b,_+c,b+l],t._bounds.push({left:h[0],top:h[1],right:h[2],bottom:h[3],div:d,size:[c,l],m:u})}}function render(t){if(t._canceled)return;const r=t._textDivs,i=t._capability,o=r.length;if(o>1e5)return t._renderingDone=!0,void i.resolve();if(!t._textContentStream)for(let i=0;i<o;i++)t._layoutText(r[i]);t._renderingDone=!0,i.resolve()}function findPositiveMin(t,r,i){let o=0;for(let a=0;a<i;a++){const i=t[r++];i>0&&(o=o?Math.min(i,o):i)}return o}function expand(t){const r=t._bounds,i=t._viewport,a=function expandBounds(t,r,i){const o=i.map((function(t,r){return{x1:t.left,y1:t.top,x2:t.right,y2:t.bottom,index:r,x1New:void 0,x2New:void 0}}));expandBoundsLTR(t,o);const a=new Array(i.length);for(const t of o){const r=t.index;a[r]={left:t.x1New,top:0,right:t.x2New,bottom:0}}i.map((function(r,i){const c=a[i],l=o[i];l.x1=r.top,l.y1=t-c.right,l.x2=r.bottom,l.y2=t-c.left,l.index=i,l.x1New=void 0,l.x2New=void 0})),expandBoundsLTR(r,o);for(const t of o){const r=t.index;a[r].top=t.x1New,a[r].bottom=t.x2New}return a}(i.width,i.height,r);for(let i=0;i<a.length;i++){const c=r[i].div,l=t._textDivProperties.get(c);if(0===l.angle){l.paddingLeft=r[i].left-a[i].left,l.paddingTop=r[i].top-a[i].top,l.paddingRight=a[i].right-r[i].right,l.paddingBottom=a[i].bottom-r[i].bottom,t._textDivProperties.set(c,l);continue}const u=a[i],d=r[i],h=d.m,p=h[0],g=h[1],m=[[0,0],[0,d.size[1]],[d.size[0],0],d.size],y=new Float64Array(64);for(let t=0,r=m.length;t<r;t++){const r=o.Util.applyTransform(m[t],h);y[t+0]=p&&(u.left-r[0])/p,y[t+4]=g&&(u.top-r[1])/g,y[t+8]=p&&(u.right-r[0])/p,y[t+12]=g&&(u.bottom-r[1])/g,y[t+16]=g&&(u.left-r[0])/-g,y[t+20]=p&&(u.top-r[1])/p,y[t+24]=g&&(u.right-r[0])/-g,y[t+28]=p&&(u.bottom-r[1])/p,y[t+32]=p&&(u.left-r[0])/-p,y[t+36]=g&&(u.top-r[1])/-g,y[t+40]=p&&(u.right-r[0])/-p,y[t+44]=g&&(u.bottom-r[1])/-g,y[t+48]=g&&(u.left-r[0])/g,y[t+52]=p&&(u.top-r[1])/-p,y[t+56]=g&&(u.right-r[0])/g,y[t+60]=p&&(u.bottom-r[1])/-p}const v=1+Math.min(Math.abs(p),Math.abs(g));l.paddingLeft=findPositiveMin(y,32,16)/v,l.paddingTop=findPositiveMin(y,48,16)/v,l.paddingRight=findPositiveMin(y,0,16)/v,l.paddingBottom=findPositiveMin(y,16,16)/v,t._textDivProperties.set(c,l)}}function expandBoundsLTR(t,r){r.sort((function(t,r){return t.x1-r.x1||t.index-r.index}));const i=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const t of r){let r=0;for(;r<i.length&&i[r].end<=t.y1;)r++;let o,a,c=i.length-1;for(;c>=0&&i[c].start>=t.y2;)c--;let l,u,d=-1/0;for(l=r;l<=c;l++){let r;o=i[l],a=o.boundary,r=a.x2>t.x1?a.index>t.index?a.x1New:t.x1:void 0===a.x2New?(a.x2+t.x1)/2:a.x2New,r>d&&(d=r)}for(t.x1New=d,l=r;l<=c;l++)o=i[l],a=o.boundary,void 0===a.x2New?a.x2>t.x1?a.index>t.index&&(a.x2New=a.x2):a.x2New=d:a.x2New>d&&(a.x2New=Math.max(d,a.x2));const h=[];let p=null;for(l=r;l<=c;l++){o=i[l],a=o.boundary;const r=a.x2>t.x2?a:t;p===r?h[h.length-1].end=o.end:(h.push({start:o.start,end:o.end,boundary:r}),p=r)}for(i[r].start<t.y1&&(h[0].start=t.y1,h.unshift({start:i[r].start,end:t.y1,boundary:i[r].boundary})),t.y2<i[c].end&&(h[h.length-1].end=t.y2,h.push({start:t.y2,end:i[c].end,boundary:i[c].boundary})),l=r;l<=c;l++){if(o=i[l],a=o.boundary,void 0!==a.x2New)continue;let t=!1;for(u=r-1;!t&&u>=0&&i[u].start>=a.y1;u--)t=i[u].boundary===a;for(u=c+1;!t&&u<i.length&&i[u].end<=a.y2;u++)t=i[u].boundary===a;for(u=0;!t&&u<h.length;u++)t=h[u].boundary===a;t||(a.x2New=d)}Array.prototype.splice.apply(i,[r,c-r+1].concat(h))}for(const r of i){const i=r.boundary;void 0===i.x2New&&(i.x2New=Math.max(t,i.x2))}}class TextLayerRenderTask{constructor({textContent:t,textContentStream:r,container:i,viewport:a,textDivs:c,textContentItemsStr:l,enhanceTextSelection:u}){this._textContent=t,this._textContentStream=r,this._container=i,this._document=i.ownerDocument,this._viewport=a,this._textDivs=c||[],this._textContentItemsStr=l||[],this._enhanceTextSelection=!!u,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,o.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally((()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)})).catch((()=>{}))}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")).catch((()=>{})),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(t,r){for(let i=0,o=t.length;i<o;i++)if(void 0!==t[i].str)this._textContentItemsStr.push(t[i].str),appendText(this,t[i],r,this._layoutTextCtx);else if("beginMarkedContentProps"===t[i].type||"beginMarkedContent"===t[i].type){const r=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==t[i].id&&this._container.setAttribute("id",`${t[i].id}`),r.appendChild(this._container)}else"endMarkedContent"===t[i].type&&(this._container=this._container.parentNode)}_layoutText(t){const r=this._textDivProperties.get(t);let i="";if(0!==r.canvasWidth&&r.hasText){const{fontSize:o,fontFamily:a}=t.style;o===this._layoutTextLastFontSize&&a===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=`${o} ${a}`,this._layoutTextLastFontSize=o,this._layoutTextLastFontFamily=a);const{width:c}=this._layoutTextCtx.measureText(t.textContent);if(c>0){const t=r.canvasWidth/c;this._enhanceTextSelection&&(r.scale=t),i=`scaleX(${t})`}}if(0!==r.angle&&(i=`rotate(${r.angle}deg) ${i}`),i.length>0&&(this._enhanceTextSelection&&(r.originalTransform=i),t.style.transform=i),r.hasText&&this._container.appendChild(t),r.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this._container.appendChild(t)}}_render(t=0){const r=(0,o.createPromiseCapability)();let i=Object.create(null);const c=this._document.createElement("canvas");if(c.height=c.width=a,this._layoutTextCtx=c.getContext("2d",{alpha:!1}),this._textContent){const t=this._textContent.items,i=this._textContent.styles;this._processItems(t,i),r.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const pump=()=>{this._reader.read().then((({value:t,done:o})=>{o?r.resolve():(Object.assign(i,t.styles),this._processItems(t.items,i),pump())}),r.reject)};this._reader=this._textContentStream.getReader(),pump()}}r.promise.then((()=>{i=null,t?this._renderTimer=setTimeout((()=>{render(this),this._renderTimer=null}),t):render(this)}),this._capability.reject)}expandTextDivs(t=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(expand(this),this._bounds=null);const r=[],i=[];for(let o=0,a=this._textDivs.length;o<a;o++){const a=this._textDivs[o],c=this._textDivProperties.get(a);c.hasText&&(t?(r.length=0,i.length=0,c.originalTransform&&r.push(c.originalTransform),c.paddingTop>0?(i.push(`${c.paddingTop}px`),r.push(`translateY(${-c.paddingTop}px)`)):i.push(0),c.paddingRight>0?i.push(c.paddingRight/c.scale+"px"):i.push(0),c.paddingBottom>0?i.push(`${c.paddingBottom}px`):i.push(0),c.paddingLeft>0?(i.push(c.paddingLeft/c.scale+"px"),r.push(`translateX(${-c.paddingLeft/c.scale}px)`)):i.push(0),a.style.padding=i.join(" "),r.length&&(a.style.transform=r.join(" "))):(a.style.padding=null,a.style.transform=c.originalTransform))}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var o=i(1),a=i(5),c=i(3);let l=class{constructor(){(0,o.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=l;{const u={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",p=["butt","round","square"],g=["miter","round","bevel"],createObjectURL=function(t,r="",i=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!i)return URL.createObjectURL(new Blob([t],{type:r}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a=`data:${r};base64,`;for(let r=0,i=t.length;r<i;r+=3){const c=255&t[r],l=255&t[r+1],u=255&t[r+2];a+=o[c>>2]+o[(3&c)<<4|l>>4]+o[r+1<i?(15&l)<<2|u>>6:64]+o[r+2<i?63&u:64]}return a},m=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),r=new Int32Array(256);for(let t=0;t<256;t++){let i=t;for(let t=0;t<8;t++)i=1&i?3988292384^i>>1&2147483647:i>>1&2147483647;r[t]=i}function writePngChunk(t,i,o,a){let c=a;const l=i.length;o[c]=l>>24&255,o[c+1]=l>>16&255,o[c+2]=l>>8&255,o[c+3]=255&l,c+=4,o[c]=255&t.charCodeAt(0),o[c+1]=255&t.charCodeAt(1),o[c+2]=255&t.charCodeAt(2),o[c+3]=255&t.charCodeAt(3),c+=4,o.set(i,c),c+=i.length;const u=function crc32(t,i,o){let a=-1;for(let c=i;c<o;c++){const i=255&(a^t[c]);a=a>>>8^r[i]}return-1^a}(o,a+4,c);o[c]=u>>24&255,o[c+1]=u>>16&255,o[c+2]=u>>8&255,o[c+3]=255&u}function deflateSyncUncompressed(t){let r=t.length;const i=65535,o=Math.ceil(r/i),a=new Uint8Array(2+r+5*o+4);let c=0;a[c++]=120,a[c++]=156;let l=0;for(;r>i;)a[c++]=0,a[c++]=255,a[c++]=255,a[c++]=0,a[c++]=0,a.set(t.subarray(l,l+i),c),c+=i,l+=i,r-=i;a[c++]=1,a[c++]=255&r,a[c++]=r>>8&255,a[c++]=255&~r,a[c++]=(65535&~r)>>8&255,a.set(t.subarray(l),c),c+=t.length-l;const u=function adler32(t,r,i){let o=1,a=0;for(let c=r;c<i;++c)o=(o+(255&t[c]))%65521,a=(a+o)%65521;return a<<16|o}(t,0,t.length);return a[c++]=u>>24&255,a[c++]=u>>16&255,a[c++]=u>>8&255,a[c++]=255&u,a}function encode(r,i,a,l){const u=r.width,d=r.height;let h,p,g;const m=r.data;switch(i){case o.ImageKind.GRAYSCALE_1BPP:p=0,h=1,g=u+7>>3;break;case o.ImageKind.RGB_24BPP:p=2,h=8,g=3*u;break;case o.ImageKind.RGBA_32BPP:p=6,h=8,g=4*u;break;default:throw new Error("invalid format")}const y=new Uint8Array((1+g)*d);let v=0,_=0;for(let t=0;t<d;++t)y[v++]=0,y.set(m.subarray(_,_+g),v),_+=g,v+=g;if(i===o.ImageKind.GRAYSCALE_1BPP&&l){v=0;for(let t=0;t<d;t++){v++;for(let t=0;t<g;t++)y[v++]^=255}}const b=new Uint8Array([u>>24&255,u>>16&255,u>>8&255,255&u,d>>24&255,d>>16&255,d>>8&255,255&d,h,p,0,0,0]),A=function deflateSync(t){if(!c.isNodeJS)return deflateSyncUncompressed(t);try{let r;r=parseInt(process.versions.node)>=8?t:Buffer.from(t);const i=__webpack_require__(258).deflateSync(r,{level:9});return i instanceof Uint8Array?i:new Uint8Array(i)}catch(t){(0,o.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return deflateSyncUncompressed(t)}(y),S=t.length+36+b.length+A.length,C=new Uint8Array(S);let P=0;return C.set(t,P),P+=t.length,writePngChunk("IHDR",b,C,P),P+=12+b.length,writePngChunk("IDATA",A,C,P),P+=12+A.length,writePngChunk("IEND",new Uint8Array(0),C,P),createObjectURL(C,"image/png",a)}return function convertImgDataToPng(t,r,i){return encode(t,void 0===t.kind?o.ImageKind.GRAYSCALE_1BPP:t.kind,r,i)}}();class SVGExtraState{constructor(){this.fontSizeScale=1,this.fontWeight=u.fontWeight,this.fontSize=0,this.textMatrix=o.IDENTITY_MATRIX,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=o.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=u.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(t,r){this.x=t,this.y=r}}function opListToTree(t){let r=[];const i=[];for(const o of t)"save"!==o.fn?"restore"===o.fn?r=i.pop():r.push(o):(r.push({fnId:92,fn:"group",items:[]}),i.push(r),r=r[r.length-1].items);return r}function pf(t){if(Number.isInteger(t))return t.toString();const r=t.toFixed(10);let i=r.length-1;if("0"!==r[i])return r;do{i--}while("0"===r[i]);return r.substring(0,"."===r[i]?i:i+1)}function pm(t){if(0===t[4]&&0===t[5]){if(0===t[1]&&0===t[2])return 1===t[0]&&1===t[3]?"":`scale(${pf(t[0])} ${pf(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){return`rotate(${pf(180*Math.acos(t[0])/Math.PI)})`}}else if(1===t[0]&&0===t[1]&&0===t[2]&&1===t[3])return`translate(${pf(t[4])} ${pf(t[5])})`;return`matrix(${pf(t[0])} ${pf(t[1])} ${pf(t[2])} ${pf(t[3])} ${pf(t[4])} ${pf(t[5])})`}let y=0,v=0,_=0;r.SVGGraphics=l=class{constructor(t,r,i=!1){this.svgFactory=new a.DOMSVGFactory,this.current=new SVGExtraState,this.transformMatrix=o.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=r,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!i,this._operatorIdMapping=[];for(const t in o.OPS)this._operatorIdMapping[o.OPS[t]]=t}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const r=t.fnArray,i=t.argsArray;for(let t=0,a=r.length;t<a;t++)if(r[t]===o.OPS.dependency)for(const r of i[t]){const t=r.startsWith("g_")?this.commonObjs:this.objs,i=new Promise((i=>{t.get(r,i)}));this.current.dependencies.push(i)}return Promise.all(this.current.dependencies)}transform(t,r,i,a,c,l){const u=[t,r,i,a,c,l];this.transformMatrix=o.Util.transform(this.transformMatrix,u),this.tgrp=null}getSVG(t,r){this.viewport=r;const i=this._initialize(r);return this.loadDependencies(t).then((()=>(this.transformMatrix=o.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),i)))}convertOpList(t){const r=this._operatorIdMapping,i=t.argsArray,o=t.fnArray,a=[];for(let t=0,c=o.length;t<c;t++){const c=o[t];a.push({fnId:c,fn:r[c],args:i[t]})}return opListToTree(a)}executeOpTree(t){for(const r of t){const t=r.fn,i=r.fnId,a=r.args;switch(0|i){case o.OPS.beginText:this.beginText();break;case o.OPS.dependency:break;case o.OPS.setLeading:this.setLeading(a);break;case o.OPS.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case o.OPS.setFont:this.setFont(a);break;case o.OPS.showText:case o.OPS.showSpacedText:this.showText(a[0]);break;case o.OPS.endText:this.endText();break;case o.OPS.moveText:this.moveText(a[0],a[1]);break;case o.OPS.setCharSpacing:this.setCharSpacing(a[0]);break;case o.OPS.setWordSpacing:this.setWordSpacing(a[0]);break;case o.OPS.setHScale:this.setHScale(a[0]);break;case o.OPS.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.OPS.setTextRise:this.setTextRise(a[0]);break;case o.OPS.setTextRenderingMode:this.setTextRenderingMode(a[0]);break;case o.OPS.setLineWidth:this.setLineWidth(a[0]);break;case o.OPS.setLineJoin:this.setLineJoin(a[0]);break;case o.OPS.setLineCap:this.setLineCap(a[0]);break;case o.OPS.setMiterLimit:this.setMiterLimit(a[0]);break;case o.OPS.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case o.OPS.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case o.OPS.setStrokeColorN:this.setStrokeColorN(a);break;case o.OPS.setFillColorN:this.setFillColorN(a);break;case o.OPS.shadingFill:this.shadingFill(a[0]);break;case o.OPS.setDash:this.setDash(a[0],a[1]);break;case o.OPS.setRenderingIntent:this.setRenderingIntent(a[0]);break;case o.OPS.setFlatness:this.setFlatness(a[0]);break;case o.OPS.setGState:this.setGState(a[0]);break;case o.OPS.fill:this.fill();break;case o.OPS.eoFill:this.eoFill();break;case o.OPS.stroke:this.stroke();break;case o.OPS.fillStroke:this.fillStroke();break;case o.OPS.eoFillStroke:this.eoFillStroke();break;case o.OPS.clip:this.clip("nonzero");break;case o.OPS.eoClip:this.clip("evenodd");break;case o.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.OPS.paintImageXObject:this.paintImageXObject(a[0]);break;case o.OPS.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case o.OPS.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case o.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case o.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.OPS.closePath:this.closePath();break;case o.OPS.closeStroke:this.closeStroke();break;case o.OPS.closeFillStroke:this.closeFillStroke();break;case o.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case o.OPS.nextLine:this.nextLine();break;case o.OPS.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.OPS.constructPath:this.constructPath(a[0],a[1]);break;case o.OPS.endPath:this.endPath();break;case 92:this.group(r.items);break;default:(0,o.warn)(`Unimplemented operator ${t}`)}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,r,i,o,a,c){const l=this.current;l.textMatrix=l.lineMatrix=[t,r,i,o,a,c],l.textMatrixScale=Math.hypot(t,r),l.x=l.lineX=0,l.y=l.lineY=0,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${pf(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",pf(-l.y)),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtElement.appendChild(l.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=o.IDENTITY_MATRIX,t.lineMatrix=o.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,r){const i=this.current;i.x=i.lineX+=t,i.y=i.lineY+=r,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${pf(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",pf(-i.y))}showText(t){const r=this.current,i=r.font,a=r.fontSize;if(0===a)return;const c=r.fontSizeScale,l=r.charSpacing,h=r.wordSpacing,p=r.fontDirection,g=r.textHScale*p,m=i.vertical,y=m?1:-1,v=i.defaultVMetrics,_=a*r.fontMatrix[0];let b=0;for(const o of t){if(null===o){b+=p*h;continue}if("number"==typeof o){b+=y*o*a/1e3;continue}const t=(o.isSpace?h:0)+l,u=o.fontChar;let d,g,A,S=o.width;if(m){let t;const r=o.vmetric||v;t=o.vmetric?r[1]:.5*S,t=-t*_;const i=r[2]*_;S=r?-r[0]:S,d=t/c,g=(b+i)/c}else d=b/c,g=0;(o.isInFont||i.missingFile)&&(r.xcoords.push(r.x+d),m&&r.ycoords.push(-r.y+g),r.tspan.textContent+=u),A=m?S*_-t*p:S*_+t*p,b+=A}r.tspan.setAttributeNS(null,"x",r.xcoords.map(pf).join(" ")),m?r.tspan.setAttributeNS(null,"y",r.ycoords.map(pf).join(" ")):r.tspan.setAttributeNS(null,"y",pf(-r.y)),m?r.y-=b:r.x+=b*g,r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${pf(r.fontSize)}px`),r.fontStyle!==u.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==u.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);const A=r.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;if(A===o.TextRenderingMode.FILL||A===o.TextRenderingMode.FILL_STROKE?(r.fillColor!==u.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===o.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),A===o.TextRenderingMode.STROKE||A===o.TextRenderingMode.FILL_STROKE){const t=1/(r.textMatrixScale||1);this._setStrokeAttributes(r.tspan,t)}let S=r.textMatrix;0!==r.textRise&&(S=S.slice(),S[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",`${pm(S)} scale(${pf(g)}, -1)`),r.txtElement.setAttributeNS(d,"xml:space","preserve"),r.txtElement.appendChild(r.tspan),r.txtgrp.appendChild(r.txtElement),this._ensureTransformGroup().appendChild(r.txtElement)}setLeadingMoveText(t,r){this.setLeading(-r),this.moveText(t,r)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const r=createObjectURL(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${r}); }\n`}setFont(t){const r=this.current,i=this.commonObjs.get(t[0]);let a=t[1];r.font=i,!this.embedFonts||i.missingFile||this.embeddedFonts[i.loadedName]||(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),r.fontMatrix=i.fontMatrix||o.FONT_IDENTITY_MATRIX;let c="normal";i.black?c="900":i.bold&&(c="bold");const l=i.italic?"italic":"normal";a<0?(a=-a,r.fontDirection=-1):r.fontDirection=1,r.fontSize=a,r.fontFamily=i.loadedName,r.fontWeight=c,r.fontStyle=l,r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"y",pf(-r.y)),r.xcoords=[],r.ycoords=[]}endText(){const t=this.current;t.textRenderingMode&o.TextRenderingMode.ADD_TO_PATH_FLAG&&t.txtElement?.hasChildNodes()&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=p[t]}setLineJoin(t){this.current.lineJoin=g[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,r,i){this.current.strokeColor=o.Util.makeHexColor(t,r,i)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,r,i){this.current.fillColor=o.Util.makeHexColor(t,r,i),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const r=this.viewport.width,i=this.viewport.height,a=o.Util.inverseTransform(this.transformMatrix),c=o.Util.applyTransform([0,0],a),l=o.Util.applyTransform([0,i],a),u=o.Util.applyTransform([r,0],a),d=o.Util.applyTransform([r,i],a),h=Math.min(c[0],l[0],u[0],d[0]),p=Math.min(c[1],l[1],u[1],d[1]),g=Math.max(c[0],l[0],u[0],d[0]),m=Math.max(c[1],l[1],u[1],d[1]),y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",h),y.setAttributeNS(null,"y",p),y.setAttributeNS(null,"width",g-h),y.setAttributeNS(null,"height",m-p),y.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(y)}_makeColorN_Pattern(t){return"TilingPattern"===t[0]?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const r=t[1],i=t[2],a=t[3]||o.IDENTITY_MATRIX,[c,l,u,d]=t[4],h=t[5],p=t[6],g=t[7],m="shading"+_++,[y,v,b,A]=o.Util.normalizeRect([...o.Util.applyTransform([c,l],a),...o.Util.applyTransform([u,d],a)]),[S,C]=o.Util.singularValueDecompose2dScale(a),P=h*S,w=p*C,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",m),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",P),x.setAttributeNS(null,"height",w),x.setAttributeNS(null,"x",`${y}`),x.setAttributeNS(null,"y",`${v}`);const k=this.svg,T=this.transformMatrix,R=this.current.fillColor,E=this.current.strokeColor,I=this.svgFactory.create(b-y,A-v);if(this.svg=I,this.transformMatrix=a,2===g){const t=o.Util.makeHexColor(...r);this.current.fillColor=t,this.current.strokeColor=t}return this.executeOpTree(this.convertOpList(i)),this.svg=k,this.transformMatrix=T,this.current.fillColor=R,this.current.strokeColor=E,x.appendChild(I.childNodes[0]),this.defs.appendChild(x),`url(#${m})`}_makeShadingPattern(t){switch("string"==typeof t&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const r="shading"+_++,i=t[3];let a;switch(t[1]){case"axial":const i=t[4],o=t[5];a=this.svgFactory.createElement("svg:linearGradient"),a.setAttributeNS(null,"id",r),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"x1",i[0]),a.setAttributeNS(null,"y1",i[1]),a.setAttributeNS(null,"x2",o[0]),a.setAttributeNS(null,"y2",o[1]);break;case"radial":const c=t[4],l=t[5],u=t[6],d=t[7];a=this.svgFactory.createElement("svg:radialGradient"),a.setAttributeNS(null,"id",r),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"cx",l[0]),a.setAttributeNS(null,"cy",l[1]),a.setAttributeNS(null,"r",d),a.setAttributeNS(null,"fx",c[0]),a.setAttributeNS(null,"fy",c[1]),a.setAttributeNS(null,"fr",u);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const t of i){const r=this.svgFactory.createElement("svg:stop");r.setAttributeNS(null,"offset",t[0]),r.setAttributeNS(null,"stop-color",t[1]),a.appendChild(r)}return this.defs.appendChild(a),`url(#${r})`;case"Mesh":return(0,o.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,r){this.current.dashArray=t,this.current.dashPhase=r}constructPath(t,r){const i=this.current;let a=i.x,c=i.y,l=[],u=0;for(const i of t)switch(0|i){case o.OPS.rectangle:a=r[u++],c=r[u++];const t=a+r[u++],i=c+r[u++];l.push("M",pf(a),pf(c),"L",pf(t),pf(c),"L",pf(t),pf(i),"L",pf(a),pf(i),"Z");break;case o.OPS.moveTo:a=r[u++],c=r[u++],l.push("M",pf(a),pf(c));break;case o.OPS.lineTo:a=r[u++],c=r[u++],l.push("L",pf(a),pf(c));break;case o.OPS.curveTo:a=r[u+4],c=r[u+5],l.push("C",pf(r[u]),pf(r[u+1]),pf(r[u+2]),pf(r[u+3]),pf(a),pf(c)),u+=6;break;case o.OPS.curveTo2:l.push("C",pf(a),pf(c),pf(r[u]),pf(r[u+1]),pf(r[u+2]),pf(r[u+3])),a=r[u+2],c=r[u+3],u+=4;break;case o.OPS.curveTo3:a=r[u+2],c=r[u+3],l.push("C",pf(r[u]),pf(r[u+1]),pf(a),pf(c),pf(a),pf(c)),u+=4;break;case o.OPS.closePath:l.push("Z")}l=l.join(" "),i.path&&t.length>0&&t[0]!==o.OPS.rectangle&&t[0]!==o.OPS.moveTo?l=i.path.getAttributeNS(null,"d")+l:(i.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(i.path)),i.path.setAttributeNS(null,"d",l),i.path.setAttributeNS(null,"fill","none"),i.element=i.path,i.setCurrentPoint(a,c)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element)return void(this.pendingClip=null);const r="clippath"+y++,i=this.svgFactory.createElement("svg:clipPath");i.setAttributeNS(null,"id",r),i.setAttributeNS(null,"transform",pm(this.transformMatrix));const o=t.element.cloneNode(!0);if("evenodd"===this.pendingClip?o.setAttributeNS(null,"clip-rule","evenodd"):o.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,i.appendChild(o),this.defs.appendChild(i),t.activeClipUrl){t.clipGroup=null;for(const t of this.extraStack)t.clipGroup=null;i.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${r})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const r=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",r)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[r,i]of t)switch(r){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i);break;case"CA":this.setStrokeAlpha(i);break;case"ca":this.setFillAlpha(i);break;default:(0,o.warn)(`Unimplemented graphic state operator ${r}`)}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,r=1){const i=this.current;let o=i.dashArray;1!==r&&o.length>0&&(o=o.map((function(t){return r*t}))),t.setAttributeNS(null,"stroke",i.strokeColor),t.setAttributeNS(null,"stroke-opacity",i.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",pf(i.miterLimit)),t.setAttributeNS(null,"stroke-linecap",i.lineCap),t.setAttributeNS(null,"stroke-linejoin",i.lineJoin),t.setAttributeNS(null,"stroke-width",pf(r*i.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",o.map(pf).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",pf(r*i.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(t)}paintImageXObject(t){const r=t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t);r?this.paintInlineImageXObject(r):(0,o.warn)(`Dependent image with object ID ${t} is not ready yet`)}paintInlineImageXObject(t,r){const i=t.width,o=t.height,a=m(t,this.forceDataSchema,!!r),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width",pf(i)),c.setAttributeNS(null,"height",pf(o)),this.current.element=c,this.clip("nonzero");const l=this.svgFactory.createElement("svg:image");l.setAttributeNS(h,"xlink:href",a),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",pf(-o)),l.setAttributeNS(null,"width",pf(i)+"px"),l.setAttributeNS(null,"height",pf(o)+"px"),l.setAttributeNS(null,"transform",`scale(${pf(1/i)} ${pf(-1/o)})`),r?r.appendChild(l):this._ensureTransformGroup().appendChild(l)}paintImageMaskXObject(t){const r=this.current,i=t.width,o=t.height,a=r.fillColor;r.maskId="mask"+v++;const c=this.svgFactory.createElement("svg:mask");c.setAttributeNS(null,"id",r.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",pf(i)),l.setAttributeNS(null,"height",pf(o)),l.setAttributeNS(null,"fill",a),l.setAttributeNS(null,"mask",`url(#${r.maskId})`),this.defs.appendChild(c),this._ensureTransformGroup().appendChild(l),this.paintInlineImageXObject(t,c)}paintFormXObjectBegin(t,r){if(Array.isArray(t)&&6===t.length&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),r){const t=r[2]-r[0],i=r[3]-r[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",r[0]),o.setAttributeNS(null,"y",r[1]),o.setAttributeNS(null,"width",pf(t)),o.setAttributeNS(null,"height",pf(i)),this.current.element=o,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const r=this.svgFactory.create(t.width,t.height),i=this.svgFactory.createElement("svg:defs");r.appendChild(i),this.defs=i;const o=this.svgFactory.createElement("svg:g");return o.setAttributeNS(null,"transform",pm(t.transform)),r.appendChild(o),this.svg=o,r}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var o=i(1),a=i(26);const c=__webpack_require__(172),l=__webpack_require__(1),u=__webpack_require__(779),d=__webpack_require__(558),h=/^file:\/\/\/[a-zA-Z]:\//;r.PDFNodeStream=class PDFNodeStream{constructor(t){this.source=t,this.url=function parseUrl(t){const r=d.parse(t);return"file:"===r.protocol||r.host?r:/^[a-z]:[/\\]/i.test(t)?d.parse(`file:///${t}`):(r.host||(r.protocol="file:"),r)}(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this),this._fullRequestReader}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,t,r):new PDFNodeStreamRangeReader(this,t,r);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class BaseFullReader{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=t.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)(),this._headersCapability=(0,o.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=(0,o.createPromiseCapability)(),this.read();this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class BaseRangeReader{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)();const r=t.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=(0,o.createPromiseCapability)(),this.read();this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}function createRequestOptions(t,r){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:r}}class PDFNodeStreamFullReader extends BaseFullReader{constructor(t){super(t);const handleResponse=r=>{if(404===r.statusCode){const t=new o.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(r);const getResponseHeader=t=>this._readableStream.headers[t.toLowerCase()],{allowRangeRequests:i,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader)};this._request=null,"http:"===this._url.protocol?this._request=l.request(createRequestOptions(this._url,t.httpHeaders),handleResponse):this._request=u.request(createRequestOptions(this._url,t.httpHeaders),handleResponse),this._request.on("error",(t=>{this._storedError=t,this._headersCapability.reject(t)})),this._request.end()}}class PDFNodeStreamRangeReader extends BaseRangeReader{constructor(t,r,i){super(t),this._httpHeaders={};for(const r in t.httpHeaders){const i=t.httpHeaders[r];void 0!==i&&(this._httpHeaders[r]=i)}this._httpHeaders.Range=`bytes=${r}-${i-1}`;const handleResponse=t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=t}};this._request=null,"http:"===this._url.protocol?this._request=l.request(createRequestOptions(this._url,this._httpHeaders),handleResponse):this._request=u.request(createRequestOptions(this._url,this._httpHeaders),handleResponse),this._request.on("error",(t=>{this._storedError=t})),this._request.end()}}class PDFNodeStreamFsFullReader extends BaseFullReader{constructor(t){super(t);let r=decodeURIComponent(this._url.path);h.test(this._url.href)&&(r=r.replace(/^\//,"")),c.lstat(r,((t,i)=>{if(t)return"ENOENT"===t.code&&(t=new o.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=t,void this._headersCapability.reject(t);this._contentLength=i.size,this._setReadableStream(c.createReadStream(r)),this._headersCapability.resolve()}))}}class PDFNodeStreamFsRangeReader extends BaseRangeReader{constructor(t,r,i){super(t);let o=decodeURIComponent(this._url.path);h.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(c.createReadStream(o,{start:r,end:i-1}))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=function createResponseStatusError(t,r){if(404===t||0===t&&r.startsWith("file:"))return new o.MissingPDFException('Missing PDF "'+r+'".');return new o.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${r}".`,t)},r.extractFilenameFromHeader=function extractFilenameFromHeader(t){const r=t("Content-Disposition");if(r){let t=(0,a.getFilenameFromContentDispositionHeader)(r);if(t.includes("%"))try{t=decodeURIComponent(t)}catch(t){}if((0,c.isPdfFile)(t))return t}return null},r.validateRangeRequestCapabilities=function validateRangeRequestCapabilities({getResponseHeader:t,isHttp:r,rangeChunkSize:i,disableRange:o}){const a={allowRangeRequests:!1,suggestedLength:void 0},c=parseInt(t("Content-Length"),10);if(!Number.isInteger(c))return a;if(a.suggestedLength=c,c<=2*i)return a;if(o||!r)return a;if("bytes"!==t("Accept-Ranges"))return a;if("identity"!==(t("Content-Encoding")||"identity"))return a;return a.allowRangeRequests=!0,a},r.validateResponseStatus=function validateResponseStatus(t){return 200===t||206===t};var o=i(1),a=i(27),c=i(5)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=function getFilenameFromContentDispositionHeader(t){let r=!0,i=toParamRegExp("filename\\*","i").exec(t);if(i){i=i[1];let t=rfc2616unquote(i);return t=unescape(t),t=rfc5987decode(t),t=rfc2047decode(t),fixupEncoding(t)}if(i=function rfc2231getparam(t){const r=[];let i;const o=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(i=o.exec(t));){let[,t,o,a]=i;if(t=parseInt(t,10),t in r){if(0===t)break}else r[t]=[o,a]}const a=[];for(let t=0;t<r.length&&t in r;++t){let[i,o]=r[t];o=rfc2616unquote(o),i&&(o=unescape(o),0===t&&(o=rfc5987decode(o))),a.push(o)}return a.join("")}(t),i){return fixupEncoding(rfc2047decode(i))}if(i=toParamRegExp("filename","i").exec(t),i){i=i[1];let t=rfc2616unquote(i);return t=rfc2047decode(t),fixupEncoding(t)}function toParamRegExp(t,r){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function textdecode(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const a=new TextDecoder(t,{fatal:!0}),c=(0,o.stringToBytes)(i);i=a.decode(c),r=!1}catch(t){}}return i}function fixupEncoding(t){return r&&/[\x80-\xff]/.test(t)&&(t=textdecode("utf-8",t),r&&(t=textdecode("iso-8859-1",t))),t}function rfc2616unquote(t){if(t.startsWith('"')){const r=t.slice(1).split('\\"');for(let t=0;t<r.length;++t){const i=r[t].indexOf('"');-1!==i&&(r[t]=r[t].slice(0,i),r.length=t+1),r[t]=r[t].replace(/\\(.)/g,"$1")}t=r.join('"')}return t}function rfc5987decode(t){const r=t.indexOf("'");if(-1===r)return t;return textdecode(t.slice(0,r),t.slice(r+1).replace(/^[^']*'/,""))}function rfc2047decode(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,r,i,o){if("q"===i||"Q"===i)return textdecode(r,o=(o=o.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(t,r){return String.fromCharCode(parseInt(r,16))})));try{o=atob(o)}catch(t){}return textdecode(r,o)}))}return""};var o=i(1)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var o=i(1),a=i(26);class NetworkManager{constructor(t,r={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&r.httpHeaders||Object.create(null),this.withCredentials=r.withCredentials||!1,this.getXhr=r.getXhr||function NetworkManager_getXhr(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,r,i){const o={begin:t,end:r};for(const t in i)o[t]=i[t];return this.request(o)}requestFull(t){return this.request(t)}request(t){const r=this.getXhr(),i=this.currXhrId++,o=this.pendingRequests[i]={xhr:r};r.open("GET",this.url),r.withCredentials=this.withCredentials;for(const t in this.httpHeaders){const i=this.httpHeaders[t];void 0!==i&&r.setRequestHeader(t,i)}return this.isHttp&&"begin"in t&&"end"in t?(r.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),o.expectedStatus=206):o.expectedStatus=200,r.responseType="arraybuffer",t.onError&&(r.onerror=function(i){t.onError(r.status)}),r.onreadystatechange=this.onStateChange.bind(this,i),r.onprogress=this.onProgress.bind(this,i),o.onHeadersReceived=t.onHeadersReceived,o.onDone=t.onDone,o.onError=t.onError,o.onProgress=t.onProgress,r.send(null),i}onProgress(t,r){const i=this.pendingRequests[t];i&&i.onProgress?.(r)}onStateChange(t,r){const i=this.pendingRequests[t];if(!i)return;const a=i.xhr;if(a.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==a.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===a.status&&this.isHttp)return void i.onError?.(a.status);const c=a.status||200;if(!(200===c&&206===i.expectedStatus)&&c!==i.expectedStatus)return void i.onError?.(a.status);const l=function getArrayBuffer(t){const r=t.response;return"string"!=typeof r?r:(0,o.stringToBytes)(r).buffer}(a);if(206===c){const t=a.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);i.onDone({begin:parseInt(r[1],10),chunk:l})}else l?i.onDone({begin:0,chunk:l}):i.onError?.(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const r=this.pendingRequests[t].xhr;delete this.pendingRequests[t],r.abort()}}r.PDFNetworkStream=class PDFNetworkStream{constructor(t){this._source=t,this._manager=new NetworkManager(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const r=this._rangeRequestReaders.indexOf(t);r>=0&&this._rangeRequestReaders.splice(r,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}getRangeReader(t,r){const i=new PDFNetworkStreamRangeRequestReader(this._manager,t,r);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class PDFNetworkStreamFullRequestReader{constructor(t,r){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=r.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._contentLength=r.length,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,r=this._manager.getRequestXhr(t),getResponseHeader=t=>r.getResponseHeader(t),{allowRangeRequests:i,suggestedLength:o}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){this._requests.shift().resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=(0,a.createResponseStatusError)(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class PDFNetworkStreamRangeRequestReader{constructor(t,r,i){this._manager=t;const o={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(r,i,o),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const r=t.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:r,done:!1})}else this._queuedChunk=r;this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=(0,a.createResponseStatusError)(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var o=i(1),a=i(26);function createFetchOptions(t,r,i){return{method:"GET",headers:t,signal:i?.signal,mode:"cors",credentials:r?"include":"same-origin",redirect:"follow"}}function createHeaders(t){const r=new Headers;for(const i in t){const o=t[i];void 0!==o&&r.append(i,o)}return r}r.PDFFetchStream=class PDFFetchStream{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=new PDFFetchStreamRangeReader(this,t,r);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class PDFFetchStreamReader{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const r=t.source;this._withCredentials=r.withCredentials||!1,this._contentLength=r.length,this._headersCapability=(0,o.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._headers=createHeaders(this._stream.httpHeaders);const i=r.url;fetch(i,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const getResponseHeader=r=>t.headers.get(r),{allowRangeRequests:r,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:r}=await this._reader.read();if(r)return{value:t,done:r};this._loaded+=t.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}}class PDFFetchStreamRangeReader{constructor(t,r,i){this._stream=t,this._reader=null,this._loaded=0;const c=t.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,o.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=createHeaders(this._stream.httpHeaders),this._headers.append("Range",`bytes=${r}-${i-1}`);const l=c.url;fetch(l,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,l);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:r}=await this._reader.read();if(r)return{value:t,done:r};this._loaded+=t.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(t){var r=__webpack_module_cache__[t];if(void 0!==r)return r.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](i,i.exports,__w_pdfjs_require__),i.exports}var __webpack_exports__={};return(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(t,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(t,"LoopbackPort",{enumerable:!0,get:function(){return i.LoopbackPort}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return o.PDFDateString}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(t,"PixelsPerInch",{enumerable:!0,get:function(){return o.PixelsPerInch}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return o.RenderingCancelledException}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return d.SVGGraphics}}),Object.defineProperty(t,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return r.UNSUPPORTED_FEATURES}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return h.XfaLayer}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(t,"createPromiseCapability",{enumerable:!0,get:function(){return r.createPromiseCapability}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return o.getFilenameFromUrl}}),Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return o.getPdfFilenameFromUrl}}),Object.defineProperty(t,"getXfaPageViewport",{enumerable:!0,get:function(){return o.getXfaPageViewport}}),Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return o.isPdfFile}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return o.loadScript}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return i.version}});var r=__w_pdfjs_require__(1),i=__w_pdfjs_require__(4),o=__w_pdfjs_require__(5),a=__w_pdfjs_require__(20),c=__w_pdfjs_require__(13),l=__w_pdfjs_require__(3),u=__w_pdfjs_require__(23),d=__w_pdfjs_require__(24),h=__w_pdfjs_require__(22);if(l.isNodeJS){const{PDFNodeStream:t}=__w_pdfjs_require__(25);(0,i.setPDFNetworkStreamFactory)((r=>new t(r)))}else{const{PDFNetworkStream:t}=__w_pdfjs_require__(28),{PDFFetchStream:r}=__w_pdfjs_require__(29);(0,i.setPDFNetworkStreamFactory)((i=>(0,o.isValidFetchUrl)(i.url)?new r(i):new t(i)))}})(),__webpack_exports__})()))},963:function(t,r,i){!function webpackUniversalModuleDefinition(r,i){t.exports=i()}(0,(()=>(()=>{"use strict";var t=[,(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultXfaLayerFactory=r.DefaultTextLayerFactory=r.DefaultStructTreeLayerFactory=r.DefaultAnnotationLayerFactory=void 0;var o=i(2),a=i(4),c=i(5),l=i(7),u=i(8),d=i(9);r.DefaultAnnotationLayerFactory=class DefaultAnnotationLayerFactory{createAnnotationLayerBuilder(t,r,i=null,l="",u=!0,d=a.NullL10n,h=!1,p=null,g=null,m=null,y=null){return new o.AnnotationLayerBuilder({pageDiv:t,pdfPage:r,imageResourcesPath:l,renderForms:u,linkService:new c.SimpleLinkService,l10n:d,annotationStorage:i,enableScripting:h,hasJSActionsPromise:p,fieldObjectsPromise:m,mouseState:g,annotationCanvasMap:y})}};r.DefaultStructTreeLayerFactory=class DefaultStructTreeLayerFactory{createStructTreeLayerBuilder(t){return new l.StructTreeLayerBuilder({pdfPage:t})}};r.DefaultTextLayerFactory=class DefaultTextLayerFactory{createTextLayerBuilder(t,r,i,o=!1,a,c){return new u.TextLayerBuilder({textLayerDiv:t,pageIndex:r,viewport:i,enhanceTextSelection:o,eventBus:a,highlighter:c})}};r.DefaultXfaLayerFactory=class DefaultXfaLayerFactory{createXfaLayerBuilder(t,r,i=null,o=null){return new d.XfaLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i,linkService:new c.SimpleLinkService,xfaHtml:o})}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayerBuilder=void 0;var o=i(3),a=i(4);r.AnnotationLayerBuilder=class AnnotationLayerBuilder{constructor({pageDiv:t,pdfPage:r,linkService:i,downloadManager:o,annotationStorage:c=null,imageResourcesPath:l="",renderForms:u=!0,l10n:d=a.NullL10n,enableScripting:h=!1,hasJSActionsPromise:p=null,fieldObjectsPromise:g=null,mouseState:m=null,annotationCanvasMap:y=null}){this.pageDiv=t,this.pdfPage=r,this.linkService=i,this.downloadManager=o,this.imageResourcesPath=l,this.renderForms=u,this.l10n=d,this.annotationStorage=c,this.enableScripting=h,this._hasJSActionsPromise=p,this._fieldObjectsPromise=g,this._mouseState=m,this._annotationCanvasMap=y,this.div=null,this._cancelled=!1}async render(t,r="display"){const[i,a=!1,c=null]=await Promise.all([this.pdfPage.getAnnotations({intent:r}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled||0===i.length)return;const l={viewport:t.clone({dontFlip:!0}),div:this.div,annotations:i,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:a,fieldObjects:c,mouseState:this._mouseState,annotationCanvasMap:this._annotationCanvasMap};this.div?o.AnnotationLayer.update(l):(this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.appendChild(this.div),l.div=this.div,o.AnnotationLayer.render(l),this.l10n.translate(this.div))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},t=>{let r;r="undefined"!=typeof window&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:i(299),t.exports=r},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NullL10n=void 0,r.fixupLangCode=function fixupLangCode(t){return o[t?.toLowerCase()]||t},r.getL10nFallback=getL10nFallback;const i={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading…",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts."};function getL10nFallback(t,r){switch(t){case"find_match_count":t=`find_match_count[${1===r.total?"one":"other"}]`;break;case"find_match_count_limit":t=`find_match_count_limit[${1===r.limit?"one":"other"}]`}return i[t]||""}const o={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};const a={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(t,r=null,i=getL10nFallback(t,r))=>function formatL10nValue(t,r){return r?t.replace(/\{\{\s*(\w+)\s*\}\}/g,((t,i)=>i in r?r[i]:"{{"+i+"}}")):t}(i,r),async translate(t){}};r.NullL10n=a},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SimpleLinkService=r.PDFLinkService=r.LinkTarget=void 0;var o=i(6);const a={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function addLinkAttributes(t,{url:r,target:i,rel:c,enabled:l=!0}={}){if(!r||"string"!=typeof r)throw new Error('A valid "url" parameter must provided.');const u=(0,o.removeNullCharacters)(r);l?t.href=t.title=u:(t.href="",t.title=`Disabled: ${u}`,t.onclick=()=>!1);let d="";switch(i){case a.NONE:break;case a.SELF:d="_self";break;case a.BLANK:d="_blank";break;case a.PARENT:d="_parent";break;case a.TOP:d="_top"}t.target=d,t.rel="string"==typeof c?c:"noopener noreferrer nofollow"}r.LinkTarget=a;class PDFLinkService{#h=new Map;constructor({eventBus:t,externalLinkTarget:r=null,externalLinkRel:i=null,ignoreDestinationZoom:o=!1}={}){this.eventBus=t,this.externalLinkTarget=r,this.externalLinkRel=i,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=o,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,r=null){this.baseUrl=r,this.pdfDocument=t,this.#h.clear()}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(t){this.pdfViewer.currentPageNumber=t}get rotation(){return this.pdfViewer.pagesRotation}set rotation(t){this.pdfViewer.pagesRotation=t}#p(t,r=null,i){const o=i[0];let a;if("object"==typeof o&&null!==o){if(a=this._cachedPageNumber(o),!a)return void this.pdfDocument.getPageIndex(o).then((a=>{this.cachePageRef(a+1,o),this.#p(t,r,i)})).catch((()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${o}" is not a valid page reference, for dest="${t}".`)}))}else{if(!Number.isInteger(o))return void console.error(`PDFLinkService.#goToDestinationHelper: "${o}" is not a valid destination reference, for dest="${t}".`);a=o+1}!a||a<1||a>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${a}" is not a valid page number, for dest="${t}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:r,explicitDest:i,pageNumber:a})),this.pdfViewer.scrollPageIntoView({pageNumber:a,destArray:i,ignoreDestinationZoom:this._ignoreDestinationZoom}))}async goToDestination(t){if(!this.pdfDocument)return;let r,i;"string"==typeof t?(r=t,i=await this.pdfDocument.getDestination(t)):(r=null,i=await t),Array.isArray(i)?this.#p(t,r,i):console.error(`PDFLinkService.goToDestination: "${i}" is not a valid destination array, for dest="${t}".`)}goToPage(t){if(!this.pdfDocument)return;const r="string"==typeof t&&this.pdfViewer.pageLabelToPageNumber(t)||0|t;Number.isInteger(r)&&r>0&&r<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(r)),this.pdfViewer.scrollPageIntoView({pageNumber:r})):console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`)}addLinkAttributes(t,r,i=!1){addLinkAttributes(t,{url:r,target:i?a.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(t){if("string"==typeof t){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const r=JSON.stringify(t);if(r.length>0)return this.getAnchorUrl("#"+escape(r))}return this.getAnchorUrl("")}getAnchorUrl(t){return(this.baseUrl||"")+t}setHash(t){if(!this.pdfDocument)return;let r,i;if(t.includes("=")){const a=(0,o.parseQueryString)(t);if(a.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:a.get("search").replace(/"/g,""),phraseSearch:"true"===a.get("phrase")}),a.has("page")&&(r=0|a.get("page")||1),a.has("zoom")){const t=a.get("zoom").split(","),r=t[0],o=parseFloat(r);r.includes("Fit")?"Fit"===r||"FitB"===r?i=[null,{name:r}]:"FitH"===r||"FitBH"===r||"FitV"===r||"FitBV"===r?i=[null,{name:r},t.length>1?0|t[1]:null]:"FitR"===r?5!==t.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):i=[null,{name:r},0|t[1],0|t[2],0|t[3],0|t[4]]:console.error(`PDFLinkService.setHash: "${r}" is not a valid zoom value.`):i=[null,{name:"XYZ"},t.length>1?0|t[1]:null,t.length>2?0|t[2]:null,o?o/100:r]}i?this.pdfViewer.scrollPageIntoView({pageNumber:r||this.page,destArray:i,allowNegativeOffset:!0}):r&&(this.page=r),a.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:a.get("pagemode")}),a.has("nameddest")&&this.goToDestination(a.get("nameddest"))}else{i=unescape(t);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch(t){}if("string"==typeof i||PDFLinkService.#f(i))return void this.goToDestination(i);console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}}executeNamedAction(t){switch(t){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:t})}cachePageRef(t,r){if(!r)return;const i=0===r.gen?`${r.num}R`:`${r.num}R${r.gen}`;this.#h.set(i,t)}_cachedPageNumber(t){if(!t)return null;const r=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this.#h.get(r)||null}isPageVisible(t){return this.pdfViewer.isPageVisible(t)}isPageCached(t){return this.pdfViewer.isPageCached(t)}static#f(t){if(!Array.isArray(t))return!1;const r=t.length;if(r<2)return!1;const i=t[0];if(!("object"==typeof i&&Number.isInteger(i.num)&&Number.isInteger(i.gen)||Number.isInteger(i)&&i>=0))return!1;const o=t[1];if("object"!=typeof o||"string"!=typeof o.name)return!1;let a=!0;switch(o.name){case"XYZ":if(5!==r)return!1;break;case"Fit":case"FitB":return 2===r;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==r)return!1;break;case"FitR":if(6!==r)return!1;a=!1;break;default:return!1}for(let i=2;i<r;i++){const r=t[i];if(!("number"==typeof r||a&&null===r))return!1}return!0}}r.PDFLinkService=PDFLinkService;r.SimpleLinkService=class SimpleLinkService{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(t){}get rotation(){return 0}set rotation(t){}async goToDestination(t){}goToPage(t){}addLinkAttributes(t,r,i=!1){addLinkAttributes(t,{url:r,enabled:this.externalLinkEnabled})}getDestinationHash(t){return"#"}getAnchorUrl(t){return"#"}setHash(t){}executeNamedAction(t){}cachePageRef(t,r){}isPageVisible(t){return!0}isPageCached(t){return!0}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.animationStarted=r.VERTICAL_PADDING=r.UNKNOWN_SCALE=r.TextLayerMode=r.SpreadMode=r.SidebarView=r.ScrollMode=r.SCROLLBAR_PADDING=r.RenderingStates=r.RendererType=r.ProgressBar=r.PresentationModeState=r.OutputScale=r.MIN_SCALE=r.MAX_SCALE=r.MAX_AUTO_SCALE=r.DEFAULT_SCALE_VALUE=r.DEFAULT_SCALE_DELTA=r.DEFAULT_SCALE=r.AutoPrintRegExp=void 0,r.apiPageLayoutToViewerModes=function apiPageLayoutToViewerModes(t){let r=o.VERTICAL,i=a.NONE;switch(t){case"SinglePage":r=o.PAGE;break;case"OneColumn":break;case"TwoPageLeft":r=o.PAGE;case"TwoColumnLeft":i=a.ODD;break;case"TwoPageRight":r=o.PAGE;case"TwoColumnRight":i=a.EVEN}return{scrollMode:r,spreadMode:i}},r.apiPageModeToSidebarView=function apiPageModeToSidebarView(t){switch(t){case"UseNone":return i.NONE;case"UseThumbs":return i.THUMBS;case"UseOutlines":return i.OUTLINE;case"UseAttachments":return i.ATTACHMENTS;case"UseOC":return i.LAYERS}return i.NONE},r.approximateFraction=function approximateFraction(t){if(Math.floor(t)===t)return[t,1];const r=1/t;if(r>8)return[1,8];if(Math.floor(r)===r)return[1,r];const i=t>1?r:t;let o,a=0,c=1,l=1,u=1;for(;;){const t=a+l,r=c+u;if(r>8)break;i<=t/r?(l=t,u=r):(a=t,c=r)}o=i-a/c<l/u-i?i===t?[a,c]:[c,a]:i===t?[l,u]:[u,l];return o},r.backtrackBeforeAllVisibleElements=backtrackBeforeAllVisibleElements,r.binarySearchFirstItem=binarySearchFirstItem,r.getActiveOrFocusedElement=function getActiveOrFocusedElement(){let t=document,r=t.activeElement||t.querySelector(":focus");for(;r?.shadowRoot;)t=r.shadowRoot,r=t.activeElement||t.querySelector(":focus");return r},r.getPageSizeInches=function getPageSizeInches({view:t,userUnit:r,rotate:i}){const[o,a,c,l]=t,u=i%180!=0,d=(c-o)/72*r,h=(l-a)/72*r;return{width:u?h:d,height:u?d:h}},r.getVisibleElements=function getVisibleElements({scrollEl:t,views:r,sortByVisibility:i=!1,horizontal:o=!1,rtl:a=!1}){const c=t.scrollTop,l=c+t.clientHeight,u=t.scrollLeft,d=u+t.clientWidth;const h=[],p=new Set,g=r.length;let m=binarySearchFirstItem(r,o?function isElementNextAfterViewHorizontally(t){const r=t.div,i=r.offsetLeft+r.clientLeft,o=i+r.clientWidth;return a?i<d:o>u}:function isElementBottomAfterViewTop(t){const r=t.div;return r.offsetTop+r.clientTop+r.clientHeight>c});m>0&&m<g&&!o&&(m=backtrackBeforeAllVisibleElements(m,r,c));let y=o?d:-1;for(let t=m;t<g;t++){const i=r[t],a=i.div,g=a.offsetLeft+a.clientLeft,m=a.offsetTop+a.clientTop,v=a.clientWidth,_=a.clientHeight,b=g+v,A=m+_;if(-1===y)A>=l&&(y=A);else if((o?g:m)>y)break;if(A<=c||m>=l||b<=u||g>=d)continue;const S=Math.max(0,c-m)+Math.max(0,A-l),C=Math.max(0,u-g)+Math.max(0,b-d),P=(v-C)/v,w=(_-S)/_*P*100|0;h.push({id:i.id,x:g,y:m,view:i,percent:w,widthPercent:100*P|0}),p.add(i.id)}const v=h[0],_=h[h.length-1];i&&h.sort((function(t,r){const i=t.percent-r.percent;return Math.abs(i)>.001?-i:t.id-r.id}));return{first:v,last:_,views:h,ids:p}},r.isPortraitOrientation=function isPortraitOrientation(t){return t.width<=t.height},r.isValidRotation=function isValidRotation(t){return Number.isInteger(t)&&t%90==0},r.isValidScrollMode=function isValidScrollMode(t){return Number.isInteger(t)&&Object.values(o).includes(t)&&t!==o.UNKNOWN},r.isValidSpreadMode=function isValidSpreadMode(t){return Number.isInteger(t)&&Object.values(a).includes(t)&&t!==a.UNKNOWN},r.noContextMenuHandler=function noContextMenuHandler(t){t.preventDefault()},r.normalizeWheelEventDelta=function normalizeWheelEventDelta(t){let r=normalizeWheelEventDirection(t);0===t.deltaMode?r/=900:1===t.deltaMode&&(r/=30);return r},r.normalizeWheelEventDirection=normalizeWheelEventDirection,r.parseQueryString=function parseQueryString(t){const r=new Map;for(const[i,o]of new URLSearchParams(t))r.set(i.toLowerCase(),o);return r},r.removeNullCharacters=function removeNullCharacters(t,r=!1){if("string"!=typeof t)return console.error("The argument must be a string."),t;r&&(t=t.replace(l," "));return t.replace(c,"")},r.roundToDivide=function roundToDivide(t,r){const i=t%r;return 0===i?t:Math.round(t-i+r)},r.scrollIntoView=function scrollIntoView(t,r,i=!1){let o=t.offsetParent;if(!o)return void console.error("offsetParent is not set -- cannot scroll");let a=t.offsetTop+t.clientTop,c=t.offsetLeft+t.clientLeft;for(;o.clientHeight===o.scrollHeight&&o.clientWidth===o.scrollWidth||i&&(o.classList.contains("markedContent")||"hidden"===getComputedStyle(o).overflow);)if(a+=o.offsetTop,c+=o.offsetLeft,o=o.offsetParent,!o)return;r&&(void 0!==r.top&&(a+=r.top),void 0!==r.left&&(c+=r.left,o.scrollLeft=c));o.scrollTop=a},r.watchScroll=function watchScroll(t,r){const debounceScroll=function(a){o||(o=window.requestAnimationFrame((function viewAreaElementScrolled(){o=null;const a=t.scrollLeft,c=i.lastX;a!==c&&(i.right=a>c),i.lastX=a;const l=t.scrollTop,u=i.lastY;l!==u&&(i.down=l>u),i.lastY=l,r(i)})))},i={right:!0,down:!0,lastX:t.scrollLeft,lastY:t.scrollTop,_eventHandler:debounceScroll};let o=null;return t.addEventListener("scroll",debounceScroll,!0),i};r.DEFAULT_SCALE_VALUE="auto";r.DEFAULT_SCALE=1;r.DEFAULT_SCALE_DELTA=1.1;r.MIN_SCALE=.1;r.MAX_SCALE=10;r.UNKNOWN_SCALE=0;r.MAX_AUTO_SCALE=1.25;r.SCROLLBAR_PADDING=40;r.VERTICAL_PADDING=5;r.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};r.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const i={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};r.SidebarView=i;r.RendererType={CANVAS:"canvas",SVG:"svg"};r.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};const o={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};r.ScrollMode=o;const a={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};r.SpreadMode=a;r.AutoPrintRegExp=/\bprint\s*\(/;r.OutputScale=class OutputScale{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}};const c=/\x00/g,l=/[\x01-\x1F]/g;function binarySearchFirstItem(t,r,i=0){let o=i,a=t.length-1;if(a<0||!r(t[a]))return t.length;if(r(t[o]))return o;for(;o<a;){const i=o+a>>1;r(t[i])?a=i:o=i+1}return o}function backtrackBeforeAllVisibleElements(t,r,i){if(t<2)return t;let o=r[t].div,a=o.offsetTop+o.clientTop;a>=i&&(o=r[t-1].div,a=o.offsetTop+o.clientTop);for(let i=t-2;i>=0&&(o=r[i].div,!(o.offsetTop+o.clientTop+o.clientHeight<=a));--i)t=i;return t}function normalizeWheelEventDirection(t){let r=Math.hypot(t.deltaX,t.deltaY);const i=Math.atan2(t.deltaY,t.deltaX);return-.25*Math.PI<i&&i<.75*Math.PI&&(r=-r),r}const u=new Promise((function(t){window.requestAnimationFrame(t)}));r.animationStarted=u;r.ProgressBar=class ProgressBar{constructor(t){if(arguments.length>1)throw new Error("ProgressBar no longer accepts any additional options, please use CSS rules to modify its appearance instead.");this.visible=!0,this.div=document.querySelector(t+" .progress"),this.bar=this.div.parentNode,this.percent=0}#g(){if(this._indeterminate)return void this.div.classList.add("indeterminate");this.div.classList.remove("indeterminate");document.documentElement.style.setProperty("--progressBar-percent",`${this._percent}%`)}get percent(){return this._percent}set percent(t){this._indeterminate=isNaN(t),this._percent=function clamp(t,r,i){return Math.min(Math.max(t,r),i)}(t,0,100),this.#g()}setWidth(t){if(!t)return;const r=t.parentNode.offsetWidth-t.offsetWidth;if(r>0){document.documentElement.style.setProperty("--progressBar-end-offset",`${r}px`)}}hide(){this.visible&&(this.visible=!1,this.bar.classList.add("hidden"))}show(){this.visible||(this.visible=!0,this.bar.classList.remove("hidden"))}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StructTreeLayerBuilder=void 0;const i={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},o=/^H(\d+)$/;r.StructTreeLayerBuilder=class StructTreeLayerBuilder{constructor({pdfPage:t}){this.pdfPage=t}render(t){return this._walk(t)}_setAttributes(t,r){void 0!==t.alt&&r.setAttribute("aria-label",t.alt),void 0!==t.id&&r.setAttribute("aria-owns",t.id),void 0!==t.lang&&r.setAttribute("lang",t.lang)}_walk(t){if(!t)return null;const r=document.createElement("span");if("role"in t){const{role:a}=t,c=a.match(o);c?(r.setAttribute("role","heading"),r.setAttribute("aria-level",c[1])):i[a]&&r.setAttribute("role",i[a])}if(this._setAttributes(t,r),t.children)if(1===t.children.length&&"id"in t.children[0])this._setAttributes(t.children[0],r);else for(const i of t.children)r.appendChild(this._walk(i));return r}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerBuilder=void 0;var o=i(3);r.TextLayerBuilder=class TextLayerBuilder{constructor({textLayerDiv:t,eventBus:r,pageIndex:i,viewport:o,highlighter:a=null,enhanceTextSelection:c=!1}){this.textLayerDiv=t,this.eventBus=r,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=i+1,this.viewport=o,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=a,this.enhanceTextSelection=c,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const t=document.createElement("div");t.className="endOfContent",this.textLayerDiv.appendChild(t)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(t=0){if(!this.textContent&&!this.textContentStream||this.renderingDone)return;this.cancel(),this.textDivs.length=0,this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr);const r=document.createDocumentFragment();this.textLayerRenderTask=(0,o.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:r,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:t,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then((()=>{this.textLayerDiv.appendChild(r),this._finishRendering(),this.highlighter?.enable()}),(function(t){}))}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable()}setTextContentStream(t){this.cancel(),this.textContentStream=t}setTextContent(t){this.cancel(),this.textContent=t}_bindMouse(){const t=this.textLayerDiv;let r=null;t.addEventListener("mousedown",(i=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return this.textLayerRenderTask.expandTextDivs(!0),void(r&&(clearTimeout(r),r=null));const o=t.querySelector(".endOfContent");if(!o)return;let a=i.target!==t;if(a=a&&"none"!==window.getComputedStyle(o).getPropertyValue("-moz-user-select"),a){const r=t.getBoundingClientRect(),a=Math.max(0,(i.pageY-r.top)/r.height);o.style.top=(100*a).toFixed(2)+"%"}o.classList.add("active")})),t.addEventListener("mouseup",(()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return void(r=setTimeout((()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),r=null}),300));const i=t.querySelector(".endOfContent");i&&(i.style.top="",i.classList.remove("active"))}))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayerBuilder=void 0;var o=i(3);r.XfaLayerBuilder=class XfaLayerBuilder{constructor({pageDiv:t,pdfPage:r,annotationStorage:i=null,linkService:o,xfaHtml:a=null}){this.pageDiv=t,this.pdfPage=r,this.annotationStorage=i,this.linkService=o,this.xfaHtml=a,this.div=null,this._cancelled=!1}render(t,r="display"){if("print"===r){const i={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:r},a=document.createElement("div");this.pageDiv.appendChild(a),i.div=a;const c=o.XfaLayer.render(i);return Promise.resolve(c)}return this.pdfPage.getXfa().then((i=>{if(this._cancelled||!i)return{textDivs:[]};const a={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:r};return this.div?o.XfaLayer.update(a):(this.div=document.createElement("div"),this.pageDiv.appendChild(this.div),a.div=this.div,o.XfaLayer.render(a))})).catch((t=>{console.error(t)}))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFViewer=r.PDFSinglePageViewer=void 0;var o=i(6),a=i(11);class PDFViewer extends a.BaseViewer{}r.PDFViewer=PDFViewer;class PDFSinglePageViewer extends a.BaseViewer{_resetView(){super._resetView(),this._scrollMode=o.ScrollMode.PAGE,this._spreadMode=o.SpreadMode.NONE}set scrollMode(t){}_updateScrollMode(){}set spreadMode(t){}_updateSpreadMode(){}}r.PDFSinglePageViewer=PDFSinglePageViewer},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PagesCountLimit=r.PDFPageViewBuffer=r.BaseViewer=void 0;var o=i(3),a=i(6),c=i(2),l=i(4),u=i(12),d=i(14),h=i(5),p=i(7),g=i(15),m=i(8),y=i(9);const v="enablePermissions",_={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};r.PagesCountLimit=_;class PDFPageViewBuffer{#m=new Set;#y=0;constructor(t){this.#y=t}push(t){const r=this.#m;r.has(t)&&r.delete(t),r.add(t),r.size>this.#y&&this.#v()}resize(t,r=null){this.#y=t;const i=this.#m;if(r){const t=i.size;let o=1;for(const a of i)if(r.has(a.id)&&(i.delete(a),i.add(a)),++o>t)break}for(;i.size>this.#y;)this.#v()}has(t){return this.#m.has(t)}[Symbol.iterator](){return this.#m.keys()}#v(){const t=this.#m.keys().next().value;t?.destroy(),this.#m.delete(t)}}r.PDFPageViewBuffer=PDFPageViewBuffer;class BaseViewer{#_=null;#b=o.AnnotationMode.ENABLE_FORMS;#A=null;#S=!1;#C=0;#P=null;#w=null;constructor(t){if(this.constructor===BaseViewer)throw new Error("Cannot initialize BaseViewer.");const r="2.14.305";if(o.version!==r)throw new Error(`The API version "${o.version}" does not match the Viewer version "2.14.305".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,"DIV"!==this.container?.tagName.toUpperCase()||"DIV"!==this.viewer?.tagName.toUpperCase())throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.eventBus=t.eventBus,this.linkService=t.linkService||new h.SimpleLinkService,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,this._scriptingManager=t.scriptingManager||null,this.removePageBorders=t.removePageBorders||!1,this.textLayerMode=t.textLayerMode??a.TextLayerMode.ENABLE,this.#b=t.annotationMode??o.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.renderer=t.renderer||a.RendererType.CANVAS,this.useOnlyCssZoom=t.useOnlyCssZoom||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.l10n=t.l10n||l.NullL10n,this.#S=t.enablePermissions||!1,this.pageColors=t.pageColors||null,!t.pageColors||CSS.supports("color",t.pageColors.background)&&CSS.supports("color",t.pageColors.foreground)||((t.pageColors.background||t.pageColors.foreground)&&console.warn("Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new d.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue,this._doc=document.documentElement,this.scroll=(0,a.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=a.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.updateContainerHeightCss(),Promise.resolve().then((()=>{this.eventBus.dispatch("baseviewerinit",{source:this})}))}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}get pageViewsReady(){return!!this._pagesCapability.settled&&this._pages.every((function(t){return t?.pdfPage}))}get renderForms(){return this.#b===o.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(t,!0)||console.error(`currentPageNumber: "${t}" is not a valid page.`))}_setCurrentPageNumber(t,r=!1){if(this._currentPageNumber===t)return r&&this.#x(),!0;if(!(0<t&&t<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:i}),r&&this.#x(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let r=0|t;if(this._pageLabels){const i=this._pageLabels.indexOf(t);i>=0&&(r=i+1)}this._setCurrentPageNumber(r,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return this._currentScale!==a.UNKNOWN_SCALE?this._currentScale:a.DEFAULT_SCALE}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(t,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&this._setScale(t,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!(0,a.isValidRotation)(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument)return;if((t%=360)<0&&(t+=360),this._pagesRotation===t)return;this._pagesRotation=t;const r=this._currentPageNumber,i={rotation:t};for(const t of this._pages)t.update(i);this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:r}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#k(t){t&&(t.includes(o.PermissionFlag.COPY)||this.viewer.classList.add(v),t.includes(o.PermissionFlag.MODIFY_ANNOTATIONS)||t.includes(o.PermissionFlag.FILL_INTERACTIVE_FORMS)||this.#b===o.AnnotationMode.ENABLE_FORMS&&(this.#A=this.#b,this.#b=o.AnnotationMode.ENABLE))}#T(){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return Promise.resolve();const t=new Promise((t=>{this.#w=()=>{"hidden"===document.visibilityState&&(t(),document.removeEventListener("visibilitychange",this.#w),this.#w=null)},document.addEventListener("visibilitychange",this.#w)}));return Promise.race([this._onePageRenderedCapability.promise,t])}setDocument(t){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null)),this.pdfDocument=t,!t)return;const r=t.isPureXfa,i=t.numPages,c=t.getPage(1),l=t.getOptionalContentConfig(),d=this.#S?t.getPermissions():Promise.resolve();if(i>_.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const t=this._scrollMode=a.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t})}this._pagesCapability.promise.then((()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:i})}),(()=>{})),this._onBeforeDraw=t=>{const r=this._pages[t.pageNumber-1];r&&this.#_.push(r)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=t=>{t.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:t.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#w&&(document.removeEventListener("visibilitychange",this.#w),this.#w=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([c,d]).then((([c,d])=>{if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(c),this._optionalContentConfigPromise=l,this.#k(d);const h=this._scrollMode===a.ScrollMode.PAGE?null:this.viewer,p=this.currentScale,g=c.getViewport({scale:p*o.PixelsPerInch.PDF_TO_CSS_UNITS}),m=this.textLayerMode===a.TextLayerMode.DISABLE||r?null:this,y=this.#b!==o.AnnotationMode.DISABLE?this:null,v=r?this:null;for(let t=1;t<=i;++t){const r=new u.PDFPageView({container:h,eventBus:this.eventBus,id:t,scale:p,defaultViewport:g.clone(),optionalContentConfigPromise:l,renderingQueue:this.renderingQueue,textLayerFactory:m,textLayerMode:this.textLayerMode,annotationLayerFactory:y,annotationMode:this.#b,xfaLayerFactory:v,textHighlighterFactory:this,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n});this._pages.push(r)}const b=this._pages[0];b&&(b.setPdfPage(c),this.linkService.cachePageRef(1,c.ref)),this._scrollMode===a.ScrollMode.PAGE?this.#R():this._spreadMode!==a.SpreadMode.NONE&&this._updateSpreadMode(),this.#T().then((async()=>{if(this.findController&&this.findController.setDocument(t),this._scriptingManager&&this._scriptingManager.setDocument(t),t.loadingParams.disableAutoFetch||i>_.FORCE_LAZY_PAGE_INIT)return void this._pagesCapability.resolve();let r=i-1;if(r<=0)this._pagesCapability.resolve();else for(let o=2;o<=i;++o){const i=t.getPage(o).then((t=>{const i=this._pages[o-1];i.pdfPage||i.setPdfPage(t),this.linkService.cachePageRef(o,t.ref),0==--r&&this._pagesCapability.resolve()}),(t=>{console.error(`Unable to get page ${o} to initialize viewer`,t),0==--r&&this._pagesCapability.resolve()}));o%_.PAUSE_EAGER_PAGE_INIT==0&&await i}})),this.eventBus.dispatch("pagesinit",{source:this}),t.getMetadata().then((({info:r})=>{t===this.pdfDocument&&r.Language&&(this.viewer.lang=r.Language)})),this.defaultRenderingQueue&&this.update()})).catch((t=>{console.error("Unable to initialize viewer",t),this._pagesCapability.reject(t)}))}setPageLabels(t){if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,r=this._pages.length;t<r;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=a.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#_=new PDFPageViewBuffer(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,o.createPromiseCapability)(),this._onePageRenderedCapability=(0,o.createPromiseCapability)(),this._pagesCapability=(0,o.createPromiseCapability)(),this._scrollMode=a.ScrollMode.VERTICAL,this._previousScrollMode=a.ScrollMode.UNKNOWN,this._spreadMode=a.SpreadMode.NONE,this.#P={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#w&&(document.removeEventListener("visibilitychange",this.#w),this.#w=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(v),null!==this.#A&&(this.#b=this.#A,this.#A=null)}#R(){if(this._scrollMode!==a.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,r=this.#P,i=this.viewer;if(i.textContent="",r.pages.length=0,this._spreadMode!==a.SpreadMode.NONE||this.isInPresentationMode){const o=new Set,a=this._spreadMode-1;-1===a?o.add(t-1):t%2!==a?(o.add(t-1),o.add(t)):(o.add(t-2),o.add(t-1));const c=document.createElement("div");if(c.className="spread",this.isInPresentationMode){const t=document.createElement("div");t.className="dummyPage",c.appendChild(t)}for(const t of o){const i=this._pages[t];i&&(c.appendChild(i.div),r.pages.push(i))}i.appendChild(c)}else{const o=this._pages[t-1];i.appendChild(o.div),r.pages.push(o)}r.scrollDown=t>=r.previousPageNumber,r.previousPageNumber=t}_scrollUpdate(){0!==this.pagesCount&&this.update()}#E(t,r=null){const{div:i,id:o}=t;if(this._scrollMode===a.ScrollMode.PAGE&&(this._setCurrentPageNumber(o),this.#R(),this.update()),!r&&!this.isInPresentationMode){const t=i.offsetLeft+i.clientLeft,o=t+i.clientWidth,{scrollLeft:c,clientWidth:l}=this.container;(this._scrollMode===a.ScrollMode.HORIZONTAL||t<c||o>c+l)&&(r={left:0,top:0})}(0,a.scrollIntoView)(i,r)}#I(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15}_setScaleUpdatePages(t,r,i=!1,o=!1){if(this._currentScaleValue=r.toString(),this.#I(t))return void(o&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:r}));this._doc.style.setProperty("--zoom-factor",t);const a={scale:t};for(const t of this._pages)t.update(a);if(this._currentScale=t,!i){let t,r=this._currentPageNumber;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(r=this._location.pageNumber,t=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:r,destArray:t,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:o?r:void 0}),this.defaultRenderingQueue&&this.update(),this.updateContainerHeightCss()}get _pageWidthScaleFactor(){return this._spreadMode!==a.SpreadMode.NONE&&this._scrollMode!==a.ScrollMode.HORIZONTAL?2:1}_setScale(t,r=!1){let i=parseFloat(t);if(i>0)this._setScaleUpdatePages(i,t,r,!1);else{const o=this._pages[this._currentPageNumber-1];if(!o)return;let c=a.SCROLLBAR_PADDING,l=a.VERTICAL_PADDING;this.isInPresentationMode?c=l=4:this.removePageBorders?c=l=0:this._scrollMode===a.ScrollMode.HORIZONTAL&&([c,l]=[l,c]);const u=(this.container.clientWidth-c)/o.width*o.scale/this._pageWidthScaleFactor,d=(this.container.clientHeight-l)/o.height*o.scale;switch(t){case"page-actual":i=1;break;case"page-width":i=u;break;case"page-height":i=d;break;case"page-fit":i=Math.min(u,d);break;case"auto":const r=(0,a.isPortraitOrientation)(o)?u:Math.min(d,u);i=Math.min(a.MAX_AUTO_SCALE,r);break;default:return void console.error(`_setScale: "${t}" is an unknown zoom value.`)}this._setScaleUpdatePages(i,t,r,!0)}}#x(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0),this.#E(t)}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const r=this._pageLabels.indexOf(t);return r<0?null:r+1}scrollPageIntoView({pageNumber:t,destArray:r=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:c=!1}){if(!this.pdfDocument)return;const l=Number.isInteger(t)&&this._pages[t-1];if(!l)return void console.error(`scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!r)return void this._setCurrentPageNumber(t,!0);let u,d,h=0,p=0,g=0,m=0;const y=l.rotation%180!=0,v=(y?l.height:l.width)/l.scale/o.PixelsPerInch.PDF_TO_CSS_UNITS,_=(y?l.width:l.height)/l.scale/o.PixelsPerInch.PDF_TO_CSS_UNITS;let b=0;switch(r[1].name){case"XYZ":h=r[2],p=r[3],b=r[4],h=null!==h?h:0,p=null!==p?p:_;break;case"Fit":case"FitB":b="page-fit";break;case"FitH":case"FitBH":p=r[2],b="page-width",null===p&&this._location?(h=this._location.left,p=this._location.top):("number"!=typeof p||p<0)&&(p=_);break;case"FitV":case"FitBV":h=r[2],g=v,m=_,b="page-height";break;case"FitR":h=r[2],p=r[3],g=r[4]-h,m=r[5]-p;const t=this.removePageBorders?0:a.SCROLLBAR_PADDING,i=this.removePageBorders?0:a.VERTICAL_PADDING;u=(this.container.clientWidth-t)/g/o.PixelsPerInch.PDF_TO_CSS_UNITS,d=(this.container.clientHeight-i)/m/o.PixelsPerInch.PDF_TO_CSS_UNITS,b=Math.min(Math.abs(u),Math.abs(d));break;default:return void console.error(`scrollPageIntoView: "${r[1].name}" is not a valid destination type.`)}if(c||(b&&b!==this._currentScale?this.currentScaleValue=b:this._currentScale===a.UNKNOWN_SCALE&&(this.currentScaleValue=a.DEFAULT_SCALE_VALUE)),"page-fit"===b&&!r[4])return void this.#E(l);const A=[l.viewport.convertToViewportPoint(h,p),l.viewport.convertToViewportPoint(h+g,p+m)];let S=Math.min(A[0][0],A[1][0]),C=Math.min(A[0][1],A[1][1]);i||(S=Math.max(S,0),C=Math.max(C,0)),this.#E(l,{left:S,top:C})}_updateLocation(t){const r=this._currentScale,i=this._currentScaleValue,o=parseFloat(i)===r?Math.round(1e4*r)/100:i,a=t.id,c=this._pages[a-1],l=this.container,u=c.getPagePoint(l.scrollLeft-t.x,l.scrollTop-t.y),d=Math.round(u[0]),h=Math.round(u[1]);let p=`#page=${a}`;this.isInPresentationMode||(p+=`&zoom=${o},${d},${h}`),this._location={pageNumber:a,scale:o,top:h,left:d,rotation:this._pagesRotation,pdfOpenParams:p}}update(){const t=this._getVisiblePages(),r=t.views,i=r.length;if(0===i)return;const o=Math.max(10,2*i+1);this.#_.resize(o,t.ids),this.renderingQueue.renderHighestPriority(t);const c=this._spreadMode===a.SpreadMode.NONE&&(this._scrollMode===a.ScrollMode.PAGE||this._scrollMode===a.ScrollMode.VERTICAL),l=this._currentPageNumber;let u=!1;for(const t of r){if(t.percent<100)break;if(t.id===l&&c){u=!0;break}}this._setCurrentPageNumber(u?l:r[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===a.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===a.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===a.ScrollMode.PAGE?this.#P.pages:this._pages,r=this._scrollMode===a.ScrollMode.HORIZONTAL,i=r&&this._isContainerRtl;return(0,a.getVisibleElements)({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:r,rtl:i})}isPageVisible(t){return!!this.pdfDocument&&(Number.isInteger(t)&&t>0&&t<=this.pagesCount?this._getVisiblePages().ids.has(t):(console.error(`isPageVisible: "${t}" is not a valid page.`),!1))}isPageCached(t){if(!this.pdfDocument)return!1;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount))return console.error(`isPageCached: "${t}" is not a valid page.`),!1;const r=this._pages[t-1];return this.#_.has(r)}cleanup(){for(const t of this._pages)t.renderingState!==a.RenderingStates.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}async#M(t){if(t.pdfPage)return t.pdfPage;try{const r=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(r),this.linkService._cachedPageNumber?.(r.ref)||this.linkService.cachePageRef(t.id,r.ref),r}catch(t){return console.error("Unable to get page for page view",t),null}}#D(t){if(1===t.first?.id)return!0;if(t.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case a.ScrollMode.PAGE:return this.#P.scrollDown;case a.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}#O(t){for(const r of t){this._pages[r-1]?.toggleLoadingIconSpinner(!0)}for(const r of this.#_)t.has(r.id)||r.toggleLoadingIconSpinner(!1)}forceRendering(t){const r=t||this._getVisiblePages(),i=this.#D(r),o=this._spreadMode!==a.SpreadMode.NONE&&this._scrollMode!==a.ScrollMode.HORIZONTAL,c=this.renderingQueue.getHighestPriority(r,this._pages,i,o);return this.#O(r.ids),!!c&&(this.#M(c).then((()=>{this.renderingQueue.renderView(c)})),!0)}createTextLayerBuilder(t,r,i,o=!1,a,c){return new m.TextLayerBuilder({textLayerDiv:t,eventBus:a,pageIndex:r,viewport:i,enhanceTextSelection:!this.isInPresentationMode&&o,highlighter:c})}createTextHighlighter(t,r){return new g.TextHighlighter({eventBus:r,pageIndex:t,findController:this.isInPresentationMode?null:this.findController})}createAnnotationLayerBuilder(t,r,i=null,o="",a=!0,u=l.NullL10n,d=null,h=null,p=null,g=null,m=null){return new c.AnnotationLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i||this.pdfDocument?.annotationStorage,imageResourcesPath:o,renderForms:a,linkService:this.linkService,downloadManager:this.downloadManager,l10n:u,enableScripting:d??this.enableScripting,hasJSActionsPromise:h||this.pdfDocument?.hasJSActions(),fieldObjectsPromise:g||this.pdfDocument?.getFieldObjects(),mouseState:p||this._scriptingManager?.mouseState,annotationCanvasMap:m})}createXfaLayerBuilder(t,r,i=null){return new y.XfaLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i||this.pdfDocument?.annotationStorage,linkService:this.linkService})}createStructTreeLayerBuilder(t){return new p.StructTreeLayerBuilder({pdfPage:t})}get hasEqualPageSizes(){const t=this._pages[0];for(let r=1,i=this._pages.length;r<i;++r){const i=this._pages[r];if(i.width!==t.width||i.height!==t.height)return!1}return!0}getPagesOverview(){return this._pages.map((t=>{const r=t.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,a.isPortraitOrientation)(r)?{width:r.width,height:r.height,rotation:r.rotation}:{width:r.height,height:r.width,rotation:(r.rotation-90)%360}}))}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig():Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);if(!this.pdfDocument)return;if(!this._optionalContentConfigPromise)return;this._optionalContentConfigPromise=t;const r={optionalContentConfigPromise:t};for(const t of this._pages)t.update(r);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t})}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!(0,a.isValidScrollMode)(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>_.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const r=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",r===a.ScrollMode.HORIZONTAL),i.classList.toggle("scrollWrapped",r===a.ScrollMode.WRAPPED),this.pdfDocument&&t&&(r===a.ScrollMode.PAGE?this.#R():this._previousScrollMode===a.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!(0,a.isValidSpreadMode)(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const r=this.viewer,i=this._pages;if(this._scrollMode===a.ScrollMode.PAGE)this.#R();else if(r.textContent="",this._spreadMode===a.SpreadMode.NONE)for(const t of this._pages)r.appendChild(t.div);else{const t=this._spreadMode-1;let o=null;for(let a=0,c=i.length;a<c;++a)null===o?(o=document.createElement("div"),o.className="spread",r.appendChild(o)):a%2===t&&(o=o.cloneNode(!1),r.appendChild(o)),o.appendChild(i[a].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,r=!1){switch(this._scrollMode){case a.ScrollMode.WRAPPED:{const{views:i}=this._getVisiblePages(),o=new Map;for(const{id:t,y:r,percent:a,widthPercent:c}of i){if(0===a||c<100)continue;let i=o.get(r);i||o.set(r,i||=[]),i.push(t)}for(const i of o.values()){const o=i.indexOf(t);if(-1===o)continue;const a=i.length;if(1===a)break;if(r)for(let r=o-1,a=0;r>=a;r--){const o=i[r],a=i[r+1]-1;if(o<a)return t-a}else for(let r=o+1,c=a;r<c;r++){const o=i[r],a=i[r-1]+1;if(o>a)return a-t}if(r){const r=i[0];if(r<t)return t-r+1}else{const r=i[a-1];if(r>t)return r-t+1}break}break}case a.ScrollMode.HORIZONTAL:break;case a.ScrollMode.PAGE:case a.ScrollMode.VERTICAL:{if(this._spreadMode===a.SpreadMode.NONE)break;const i=this._spreadMode-1;if(r&&t%2!==i)break;if(!r&&t%2===i)break;const{views:o}=this._getVisiblePages(),c=r?t-1:t+1;for(const{id:t,percent:r,widthPercent:i}of o)if(t===c){if(r>0&&100===i)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,r=this.pagesCount;if(t>=r)return!1;const i=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+i,r),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const r=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-r,1),!0}increaseScale(t=1){let r=this._currentScale;do{r=(r*a.DEFAULT_SCALE_DELTA).toFixed(2),r=Math.ceil(10*r)/10,r=Math.min(a.MAX_SCALE,r)}while(--t>0&&r<a.MAX_SCALE);this.currentScaleValue=r}decreaseScale(t=1){let r=this._currentScale;do{r=(r/a.DEFAULT_SCALE_DELTA).toFixed(2),r=Math.floor(10*r)/10,r=Math.max(a.MIN_SCALE,r)}while(--t>0&&r>a.MIN_SCALE);this.currentScaleValue=r}updateContainerHeightCss(){const t=this.container.clientHeight;t!==this.#C&&(this.#C=t,this._doc.style.setProperty("--viewer-container-height",`${t}px`))}}r.BaseViewer=BaseViewer},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFPageView=void 0;var o=i(3),a=i(6),c=i(13),l=i(4);const u=c.compatibilityParams.maxCanvasPixels||16777216;r.PDFPageView=class PDFPageView{#b=o.AnnotationMode.ENABLE_FORMS;constructor(t){const r=t.container,i=t.defaultViewport;this.id=t.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||a.DEFAULT_SCALE,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=t.textLayerMode??a.TextLayerMode.ENABLE,this.#b=t.annotationMode??o.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=t.imageResourcesPath||"",this.useOnlyCssZoom=t.useOnlyCssZoom||!1,this.maxCanvasPixels=t.maxCanvasPixels||u,this.pageColors=t.pageColors||null,this.eventBus=t.eventBus,this.renderingQueue=t.renderingQueue,this.textLayerFactory=t.textLayerFactory,this.annotationLayerFactory=t.annotationLayerFactory,this.xfaLayerFactory=t.xfaLayerFactory,this.textHighlighter=t.textHighlighterFactory?.createTextHighlighter(this.id-1,this.eventBus),this.structTreeLayerFactory=t.structTreeLayerFactory,this.renderer=t.renderer||a.RendererType.CANVAS,this.l10n=t.l10n||l.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=a.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._annotationCanvasMap=null,this.annotationLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const c=document.createElement("div");c.className="page",c.style.width=Math.floor(this.viewport.width)+"px",c.style.height=Math.floor(this.viewport.height)+"px",c.setAttribute("data-page-number",this.id),c.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then((t=>{c.setAttribute("aria-label",t)})),this.div=c,r?.appendChild(c)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const r=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:this.scale*o.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:r}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}async _renderAnnotationLayer(){let t=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(r){t=r}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:t})}}async _renderXfaLayer(){let t=null;try{const r=await this.xfaLayer.render(this.viewport,"display");this.textHighlighter&&this._buildXfaTextContentItems(r.textDivs)}catch(r){t=r}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:t})}}async _buildXfaTextContentItems(t){const r=await this.pdfPage.getTextContent(),i=[];for(const t of r.items)i.push(t.str);this.textHighlighter.setTextMapping(t,i),this.textHighlighter.enable()}_resetZoomLayer(t=!1){if(!this.zoomLayer)return;const r=this.zoomLayer.firstChild;this.paintedViewportMap.delete(r),r.width=0,r.height=0,t&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:t=!1,keepAnnotationLayer:r=!1,keepXfaLayer:i=!1}={}){this.cancelRendering({keepAnnotationLayer:r,keepXfaLayer:i}),this.renderingState=a.RenderingStates.INITIAL;const o=this.div;o.style.width=Math.floor(this.viewport.width)+"px",o.style.height=Math.floor(this.viewport.height)+"px";const c=o.childNodes,l=t&&this.zoomLayer||null,u=r&&this.annotationLayer?.div||null,d=i&&this.xfaLayer?.div||null;for(let t=c.length-1;t>=0;t--){const r=c[t];switch(r){case l:case u:case d:continue}r.remove()}o.removeAttribute("data-loaded"),u&&this.annotationLayer.hide(),d&&this.xfaLayer.hide(),l||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this._isStandalone&&this.toggleLoadingIconSpinner(!0),this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then((t=>{this.loadingIconDiv?.setAttribute("aria-label",t)})),o.appendChild(this.loadingIconDiv)}update({scale:t=0,rotation:r=null,optionalContentConfigPromise:i=null}){this.scale=t||this.scale,"number"==typeof r&&(this.rotation=r),i instanceof Promise&&(this._optionalContentConfigPromise=i);const a=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*o.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:a}),this._isStandalone){const{style:t}=document.documentElement;t.setProperty("--zoom-factor",this.scale)}if(this.svg)return this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});let c=!1;if(this.canvas&&this.maxCanvasPixels>0){const t=this.outputScale;(Math.floor(this.viewport.width)*t.sx|0)*(Math.floor(this.viewport.height)*t.sy|0)>this.maxCanvasPixels&&(c=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&c)return this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer:t=!1,keepXfaLayer:r=!1}={}){this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),!this.annotationLayer||t&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),!this.xfaLayer||r&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null,this.textHighlighter?.disable()),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target:t,redrawAnnotationLayer:r=!1,redrawXfaLayer:i=!1}){const o=this.viewport.width,a=this.viewport.height,c=this.div;t.style.width=t.parentNode.style.width=c.style.width=Math.floor(o)+"px",t.style.height=t.parentNode.style.height=c.style.height=Math.floor(a)+"px";const l=this.viewport.rotation-this.paintedViewportMap.get(t).rotation,u=Math.abs(l);let d=1,h=1;if(90!==u&&270!==u||(d=a/o,h=o/a),t.style.transform=`rotate(${l}deg) scale(${d}, ${h})`,this.textLayer){const t=this.textLayer.viewport,r=this.viewport.rotation-t.rotation,i=Math.abs(r);let a=o/t.width;90!==i&&270!==i||(a=o/t.height);const c=this.textLayer.textLayerDiv;let l,u;switch(i){case 0:l=u=0;break;case 90:l=0,u="-"+c.style.height;break;case 180:l="-"+c.style.width,u="-"+c.style.height;break;case 270:l="-"+c.style.width,u=0;break;default:console.error("Bad rotation value.")}c.style.transform=`rotate(${i}deg) scale(${a}) translate(${l}, ${u})`,c.style.transformOrigin="0% 0%"}r&&this.annotationLayer&&this._renderAnnotationLayer(),i&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,r){return this.viewport.convertToPdfPoint(t,r)}toggleLoadingIconSpinner(t=!1){this.loadingIconDiv?.classList.toggle("notVisible",!t)}draw(){this.renderingState!==a.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,pdfPage:r}=this;if(!r)return this.renderingState=a.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=a.RenderingStates.RUNNING;const i=document.createElement("div");i.style.width=t.style.width,i.style.height=t.style.height,i.classList.add("canvasWrapper"),this.annotationLayer?.div?t.insertBefore(i,this.annotationLayer.div):t.appendChild(i);let c=null;if(this.textLayerMode!==a.TextLayerMode.DISABLE&&this.textLayerFactory){const r=document.createElement("div");r.className="textLayer",r.style.width=i.style.width,r.style.height=i.style.height,this.annotationLayer?.div?t.insertBefore(r,this.annotationLayer.div):t.appendChild(r),c=this.textLayerFactory.createTextLayerBuilder(r,this.id-1,this.viewport,this.textLayerMode===a.TextLayerMode.ENABLE_ENHANCE,this.eventBus,this.textHighlighter)}this.textLayer=c,this.#b!==o.AnnotationMode.DISABLE&&this.annotationLayerFactory&&(this._annotationCanvasMap||=new Map,this.annotationLayer||=this.annotationLayerFactory.createAnnotationLayerBuilder(t,r,null,this.imageResourcesPath,this.#b===o.AnnotationMode.ENABLE_FORMS,this.l10n,null,null,null,null,this._annotationCanvasMap)),this.xfaLayer?.div&&t.appendChild(this.xfaLayer.div);let l=null;this.renderingQueue&&(l=t=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=a.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=a.RenderingStates.RUNNING,t()});t()});const finishPaintTask=async(t=null)=>{if(u===this.paintTask&&(this.paintTask=null),t instanceof o.RenderingCancelledException)this._renderError=null;else if(this._renderError=t,this.renderingState=a.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),this._resetZoomLayer(!0),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),t)throw t},u=this.renderer===a.RendererType.SVG?this.paintOnSvg(i):this.paintOnCanvas(i);u.onRenderContinue=l,this.paintTask=u;const d=u.promise.then((()=>finishPaintTask(null).then((()=>{if(c){const t=r.streamTextContent({includeMarkedContent:!0});c.setTextContentStream(t),c.render()}this.annotationLayer&&this._renderAnnotationLayer()}))),(function(t){return finishPaintTask(t)}));return this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder(t,r,null)),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=t=>{t.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then((t=>{if(!t)return;if(!this.canvas)return;const r=this.structTreeLayer.render(t);r.classList.add("structTree"),this.canvas.appendChild(r)})))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder(r)),t.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),d}paintOnCanvas(t){const r=(0,o.createPromiseCapability)(),i={promise:r.promise,onRenderContinue(t){t()},cancel(){y.cancel()}},c=this.viewport,l=document.createElement("canvas");l.hidden=!0;let u=!0;const showCanvas=function(){u&&(l.hidden=!1,u=!1)};t.appendChild(l),this.canvas=l;const d=l.getContext("2d",{alpha:!1}),h=this.outputScale=new a.OutputScale;if(this.useOnlyCssZoom){const t=c.clone({scale:o.PixelsPerInch.PDF_TO_CSS_UNITS});h.sx*=t.width/c.width,h.sy*=t.height/c.height}if(this.maxCanvasPixels>0){const t=c.width*c.height,r=Math.sqrt(this.maxCanvasPixels/t);h.sx>r||h.sy>r?(h.sx=r,h.sy=r,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const p=(0,a.approximateFraction)(h.sx),g=(0,a.approximateFraction)(h.sy);l.width=(0,a.roundToDivide)(c.width*h.sx,p[0]),l.height=(0,a.roundToDivide)(c.height*h.sy,g[0]),l.style.width=(0,a.roundToDivide)(c.width,p[1])+"px",l.style.height=(0,a.roundToDivide)(c.height,g[1])+"px",this.paintedViewportMap.set(l,c);const m={canvasContext:d,transform:h.scaled?[h.sx,0,0,h.sy,0,0]:null,viewport:this.viewport,annotationMode:this.#b,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},y=this.pdfPage.render(m);return y.onContinue=function(t){showCanvas(),i.onRenderContinue?i.onRenderContinue(t):t()},y.promise.then((function(){showCanvas(),r.resolve()}),(function(t){showCanvas(),r.reject(t)})),i}paintOnSvg(t){let r=!1;const ensureNotCancelled=()=>{if(r)throw new o.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},i=this.pdfPage,c=this.viewport.clone({scale:o.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:i.getOperatorList({annotationMode:this.#b}).then((r=>{ensureNotCancelled();return new o.SVGGraphics(i.commonObjs,i.objs).getSVG(r,c).then((r=>{ensureNotCancelled(),this.svg=r,this.paintedViewportMap.set(r,c),r.style.width=t.style.width,r.style.height=t.style.height,this.renderingState=a.RenderingStates.FINISHED,t.appendChild(r)}))})),onRenderContinue(t){t()},cancel(){r=!0}}}setPageLabel(t){this.pageLabel="string"==typeof t?t:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.compatibilityParams=r.OptionKind=r.AppOptions=void 0;const i=Object.create(null);r.compatibilityParams=i;{const t=navigator.userAgent||"",r=navigator.platform||"",o=navigator.maxTouchPoints||1,a=/Android/.test(t),c=/\b(iPad|iPhone|iPod)(?=;)/.test(t)||"MacIntel"===r&&o>1;!function checkCanvasSizeLimitation(){(c||a)&&(i.maxCanvasPixels=5242880)}()}const o={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};r.OptionKind=o;const a={annotationMode:{value:2,kind:o.VIEWER+o.PREFERENCE},cursorToolOnLoad:{value:0,kind:o.VIEWER+o.PREFERENCE},defaultUrl:{value:"compressed.tracemonkey-pldi-09.pdf",kind:o.VIEWER},defaultZoomValue:{value:"",kind:o.VIEWER+o.PREFERENCE},disableHistory:{value:!1,kind:o.VIEWER},disablePageLabels:{value:!1,kind:o.VIEWER+o.PREFERENCE},enablePermissions:{value:!1,kind:o.VIEWER+o.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:o.VIEWER+o.PREFERENCE},enableScripting:{value:!0,kind:o.VIEWER+o.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:o.VIEWER},externalLinkTarget:{value:0,kind:o.VIEWER+o.PREFERENCE},historyUpdateUrl:{value:!1,kind:o.VIEWER+o.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:o.VIEWER+o.PREFERENCE},imageResourcesPath:{value:"./images/",kind:o.VIEWER},maxCanvasPixels:{value:16777216,compatibility:i.maxCanvasPixels,kind:o.VIEWER},pageColorsBackground:{value:"Canvas",kind:o.VIEWER+o.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:o.VIEWER+o.PREFERENCE},pdfBugEnabled:{value:!1,kind:o.VIEWER+o.PREFERENCE},printResolution:{value:150,kind:o.VIEWER},renderer:{value:"canvas",kind:o.VIEWER},sidebarViewOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},scrollModeOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},spreadModeOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},textLayerMode:{value:1,kind:o.VIEWER+o.PREFERENCE},useOnlyCssZoom:{value:!1,kind:o.VIEWER+o.PREFERENCE},viewerCssTheme:{value:0,kind:o.VIEWER+o.PREFERENCE},viewOnLoad:{value:0,kind:o.VIEWER+o.PREFERENCE},cMapPacked:{value:!0,kind:o.API},cMapUrl:{value:"../web/cmaps/",kind:o.API},disableAutoFetch:{value:!1,kind:o.API+o.PREFERENCE},disableFontFace:{value:!1,kind:o.API+o.PREFERENCE},disableRange:{value:!1,kind:o.API+o.PREFERENCE},disableStream:{value:!1,kind:o.API+o.PREFERENCE},docBaseUrl:{value:"",kind:o.API},enableXfa:{value:!0,kind:o.API+o.PREFERENCE},fontExtraProperties:{value:!1,kind:o.API},isEvalSupported:{value:!0,kind:o.API},maxImageSize:{value:-1,kind:o.API},pdfBug:{value:!1,kind:o.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:o.API},verbosity:{value:1,kind:o.API},workerPort:{value:null,kind:o.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:o.WORKER}};a.disablePreferences={value:!1,kind:o.VIEWER},a.locale={value:navigator.language||"en-US",kind:o.VIEWER},a.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:o.VIEWER},a.renderer.kind+=o.PREFERENCE;const c=Object.create(null);r.AppOptions=class AppOptions{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(t){const r=c[t];if(void 0!==r)return r;const i=a[t];return void 0!==i?i.compatibility??i.value:void 0}static getAll(t=null){const r=Object.create(null);for(const i in a){const l=a[i];if(t){if(0==(t&l.kind))continue;if(t===o.PREFERENCE){const t=l.value,o=typeof t;if("boolean"===o||"string"===o||"number"===o&&Number.isInteger(t)){r[i]=t;continue}throw new Error(`Invalid type for preference: ${i}`)}}const u=c[i];r[i]=void 0!==u?u:l.compatibility??l.value}return r}static set(t,r){c[t]=r}static setAll(t){for(const r in t)c[r]=t[r]}static remove(t){delete c[t]}static _hasUserOptions(){return Object.keys(c).length>0}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFRenderingQueue=void 0;var o=i(3),a=i(6);r.PDFRenderingQueue=class PDFRenderingQueue{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(t)||this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(t,r,i,o=!1){const a=t.views,c=a.length;if(0===c)return null;for(let t=0;t<c;t++){const r=a[t].view;if(!this.isViewFinished(r))return r}const l=t.first.id,u=t.last.id;if(u-l+1>c){const o=t.ids;for(let t=1,a=u-l;t<a;t++){const a=i?l+t:u-t;if(o.has(a))continue;const c=r[a-1];if(!this.isViewFinished(c))return c}}let d=i?u:l-2,h=r[d];return h&&!this.isViewFinished(h)||o&&(d+=i?1:-1,h=r[d],h&&!this.isViewFinished(h))?h:null}isViewFinished(t){return t.renderingState===a.RenderingStates.FINISHED}renderView(t){switch(t.renderingState){case a.RenderingStates.FINISHED:return!1;case a.RenderingStates.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case a.RenderingStates.RUNNING:this.highestPriorityPage=t.renderingId;break;case a.RenderingStates.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally((()=>{this.renderHighestPriority()})).catch((t=>{t instanceof o.RenderingCancelledException||console.error(`renderView: "${t}"`)}))}return!0}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextHighlighter=void 0;r.TextHighlighter=class TextHighlighter{constructor({findController:t,eventBus:r,pageIndex:i}){this.findController=t,this.matches=[],this.eventBus=r,this.pageIdx=i,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,r){this.textDivs=t,this.textContentItemsStr=r}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=t=>{t.pageIndex!==this.pageIdx&&-1!==t.pageIndex||this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null))}_convertMatches(t,r){if(!t)return[];const{textContentItemsStr:i}=this;let o=0,a=0;const c=i.length-1,l=[];for(let u=0,d=t.length;u<d;u++){let d=t[u];for(;o!==c&&d>=a+i[o].length;)a+=i[o].length,o++;o===i.length&&console.error("Could not find a matching mapping");const h={begin:{divIdx:o,offset:d-a}};for(d+=r[u];o!==c&&d>a+i[o].length;)a+=i[o].length,o++;h.end={divIdx:o,offset:d-a},l.push(h)}return l}_renderMatches(t){if(0===t.length)return;const{findController:r,pageIdx:i}=this,{textContentItemsStr:o,textDivs:a}=this,c=i===r.selected.pageIdx,l=r.selected.matchIdx;let u=null;const d={divIdx:-1,offset:void 0};function beginText(t,r){const i=t.divIdx;return a[i].textContent="",appendTextToDiv(i,0,t.offset,r)}function appendTextToDiv(t,r,i,c){let l=a[t];if(l.nodeType===Node.TEXT_NODE){const r=document.createElement("span");l.parentNode.insertBefore(r,l),r.appendChild(l),a[t]=r,l=r}const u=o[t].substring(r,i),d=document.createTextNode(u);if(c){const t=document.createElement("span");return t.className=`${c} appended`,t.appendChild(d),l.appendChild(t),c.includes("selected")?t.offsetLeft:0}return l.appendChild(d),0}let h=l,p=h+1;if(r.state.highlightAll)h=0,p=t.length;else if(!c)return;for(let o=h;o<p;o++){const h=t[o],p=h.begin,g=h.end,m=c&&o===l,y=m?" selected":"";let v=0;if(u&&p.divIdx===u.divIdx?appendTextToDiv(u.divIdx,u.offset,p.offset):(null!==u&&appendTextToDiv(u.divIdx,u.offset,d.offset),beginText(p)),p.divIdx===g.divIdx)v=appendTextToDiv(p.divIdx,p.offset,g.offset,"highlight"+y);else{v=appendTextToDiv(p.divIdx,p.offset,d.offset,"highlight begin"+y);for(let t=p.divIdx+1,r=g.divIdx;t<r;t++)a[t].className="highlight middle"+y;beginText(g,"highlight end"+y)}u=g,m&&r.scrollMatchIntoView({element:a[p.divIdx],selectedLeft:v,pageIndex:i,matchIndex:l})}u&&appendTextToDiv(u.divIdx,u.offset,d.offset)}_updateMatches(){if(!this.enabled)return;const{findController:t,matches:r,pageIdx:i}=this,{textContentItemsStr:o,textDivs:a}=this;let c=-1;for(let t=0,i=r.length;t<i;t++){const i=r[t];for(let t=Math.max(c,i.begin.divIdx),r=i.end.divIdx;t<=r;t++){const r=a[t];r.textContent=o[t],r.className=""}c=i.end.divIdx+1}if(!t?.highlightMatches)return;const l=t.pageMatches[i]||null,u=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(l,u),this._renderMatches(this.matches)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DownloadManager=void 0;var o=i(3);function download(t,r){const i=document.createElement("a");if(!i.click)throw new Error('DownloadManager: "a.click()" is not supported.');i.href=t,i.target="_parent","download"in i&&(i.download=r),(document.body||document.documentElement).appendChild(i),i.click(),i.remove()}r.DownloadManager=class DownloadManager{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(t,r){(0,o.createValidAbsoluteUrl)(t,"http://example.com")?download(t+"#pdfjs.action=download",r):console.error(`downloadUrl - not a valid URL: ${t}`)}downloadData(t,r,i){download(URL.createObjectURL(new Blob([t],{type:i})),r)}openOrDownloadData(t,r,i){const a=(0,o.isPdfFile)(i),c=a?"application/pdf":"";if(a){let o,a=this._openBlobUrls.get(t);a||(a=URL.createObjectURL(new Blob([r],{type:c})),this._openBlobUrls.set(t,a)),o="?file="+encodeURIComponent(a+"#"+i);try{return window.open(o),!0}catch(r){console.error(`openOrDownloadData: ${r}`),URL.revokeObjectURL(a),this._openBlobUrls.delete(t)}}return this.downloadData(r,i,c),!1}download(t,r,i,o="download"){download(URL.createObjectURL(t),i)}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WaitOnType=r.EventBus=r.AutomationEventBus=void 0,r.waitOnEventOrTimeout=function waitOnEventOrTimeout({target:t,name:r,delay:o=0}){return new Promise((function(a,c){if("object"!=typeof t||!r||"string"!=typeof r||!(Number.isInteger(o)&&o>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function handler(i){t instanceof EventBus?t._off(r,l):t.removeEventListener(r,l),d&&clearTimeout(d),a(i)}const l=handler.bind(null,i.EVENT);t instanceof EventBus?t._on(r,l):t.addEventListener(r,l);const u=handler.bind(null,i.TIMEOUT),d=setTimeout(u,o)}))};const i={EVENT:"event",TIMEOUT:"timeout"};r.WaitOnType=i;class EventBus{constructor(){this._listeners=Object.create(null)}on(t,r,i=null){this._on(t,r,{external:!0,once:i?.once})}off(t,r,i=null){this._off(t,r,{external:!0,once:i?.once})}dispatch(t,r){const i=this._listeners[t];if(!i||0===i.length)return;let o;for(const{listener:a,external:c,once:l}of i.slice(0))l&&this._off(t,a),c?(o||=[]).push(a):a(r);if(o){for(const t of o)t(r);o=null}}_on(t,r,i=null){(this._listeners[t]||=[]).push({listener:r,external:!0===i?.external,once:!0===i?.once})}_off(t,r,i=null){const o=this._listeners[t];if(o)for(let t=0,i=o.length;t<i;t++)if(o[t].listener===r)return void o.splice(t,1)}}r.EventBus=EventBus;r.AutomationEventBus=class AutomationEventBus extends EventBus{dispatch(t,r){throw new Error("Not implemented: AutomationEventBus.dispatch")}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GenericL10n=void 0,i(19);var o=i(4);const a=document.webL10n;r.GenericL10n=class GenericL10n{constructor(t){this._lang=t,this._ready=new Promise(((r,i)=>{a.setLanguage((0,o.fixupLangCode)(t),(()=>{r(a)}))}))}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(t,r=null,i=(0,o.getL10nFallback)(t,r)){return(await this._ready).get(t,r,i)}async translate(t){return(await this._ready).translate(t)}}},()=>{document.webL10n=function(t,r,i){var o={},a="",c="textContent",l="",u={},d="loading";function xhrLoadText(t,r,i){r=r||function _onSuccess(t){},i=i||function _onFailure(){};var o=new XMLHttpRequest;o.open("GET",t,true),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=utf-8"),o.onreadystatechange=function(){4==o.readyState&&(200==o.status||0===o.status?r(o.responseText):i())},o.onerror=i,o.ontimeout=i;try{o.send(null)}catch(t){i()}}function parseResource(t,r,i,l){var u=t.replace(/[^\/]*$/,"")||"./";function evalString(t){return t.lastIndexOf("\\")<0?t:t.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}xhrLoadText(t,(function(t){a+=t,function parseProperties(t,i){var o={},a=/^\s*|\s*$/,c=/^\s*#|^\s*$/,l=/^\s*\[(.*)\]\s*$/,d=/^\s*@import\s+url\((.*)\)\s*$/i,h=/^([^=\s]*)\s*=\s*(.+)$/;function parseRawLines(t,i,p){var g=t.replace(a,"").split(/[\r\n]+/),m="*",y=r.split("-",1)[0],v=!1,_="";!function nextEntry(){for(;;){if(!g.length)return void p();var t=g.shift();if(!c.test(t)){if(i){if(_=l.exec(t)){m=_[1].toLowerCase(),v="*"!==m&&m!==r&&m!==y;continue}if(v)continue;if(_=d.exec(t))return void loadImport(u+_[1],nextEntry)}var a=t.match(h);a&&3==a.length&&(o[a[1]]=evalString(a[2]))}}}()}function loadImport(t,r){xhrLoadText(t,(function(t){parseRawLines(t,!1,r)}),(function(){console.warn(t+" not found."),r()}))}parseRawLines(t,!0,(function(){i(o)}))}(t,(function(t){for(var r in t){var a,l,u=r.lastIndexOf(".");u>0?(a=r.substring(0,u),l=r.substring(u+1)):(a=r,l=c),o[a]||(o[a]={}),o[a][l]=t[r]}i&&i()}))}),l)}function loadLocale(t,i){t&&(t=t.toLowerCase()),i=i||function _callback(){},function clear(){o={},a="",l=""}(),l=t;var c=function getL10nResourceLinks(){return r.querySelectorAll('link[type="application/l10n"]')}(),u=c.length;if(0!==u){var h,p=0;h=function(){++p>=u&&(i(),d="complete")};for(var g=0;g<u;g++){new L10nResourceLink(c[g]).load(t,h)}}else{var m=function getL10nDictionary(){var t=r.querySelector('script[type="application/l10n"]');return t?JSON.parse(t.innerHTML):null}();if(m&&m.locales&&m.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(o=m.locales[t])){var y=m.default_locale.toLowerCase();for(var v in m.locales){if((v=v.toLowerCase())===t){o=m.locales[t];break}v===y&&(o=m.locales[y])}}i()}else console.log("no resource to load, early way out");d="complete"}function L10nResourceLink(t){var r=t.href;this.load=function(t,i){parseResource(r,t,i,(function(){console.warn(r+" not found."),console.warn('"'+t+'" resource not found'),l="",i()}))}}}function getL10nData(t,r,i){var a=o[t];if(!a){if(console.warn("#"+t+" is undefined."),!i)return null;a=i}var c={};for(var l in a){var u=a[l];u=substArguments(u=substIndexes(u,r,t,l),r,t),c[l]=u}return c}function substIndexes(t,r,i,a){var c=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(t);if(!c||!c.length)return t;var l,d=c[1],h=c[2];(r&&h in r?l=r[h]:h in o&&(l=o[h]),d in u)&&(t=(0,u[d])(t,l,i,a));return t}function substArguments(t,r,i){return t.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(t,a){return r&&a in r?r[a]:a in o?o[a]:(console.log("argument {{"+a+"}} for #"+i+" is undefined."),t)}))}function translateElement(t){var i=function getL10nAttributes(t){if(!t)return{};var r=t.getAttribute("data-l10n-id"),i=t.getAttribute("data-l10n-args"),o={};if(i)try{o=JSON.parse(i)}catch(t){console.warn("could not parse arguments for #"+r)}return{id:r,args:o}}(t);if(i.id){var o=getL10nData(i.id,i.args);if(o){if(o[c]){if(0===function getChildElementCount(t){if(t.children)return t.children.length;if(void 0!==t.childElementCount)return t.childElementCount;for(var r=0,i=0;i<t.childNodes.length;i++)r+=1===t.nodeType?1:0;return r}(t))t[c]=o[c];else{for(var a=t.childNodes,l=!1,u=0,d=a.length;u<d;u++)3===a[u].nodeType&&/\S/.test(a[u].nodeValue)&&(l?a[u].nodeValue="":(a[u].nodeValue=o[c],l=!0));if(!l){var h=r.createTextNode(o[c]);t.insertBefore(h,t.firstChild)}}delete o[c]}for(var p in o)t[p]=o[p]}else console.warn("#"+i.id+" is undefined.")}}return u.plural=function(t,r,i,a){var d=parseFloat(r);if(isNaN(d))return t;if(a!=c)return t;u._pluralRules||(u._pluralRules=function getPluralRules(t){function isIn(t,r){return-1!==r.indexOf(t)}function isBetween(t,r,i){return r<=t&&t<=i}var r={0:function(t){return"other"},1:function(t){return isBetween(t%100,3,10)?"few":0===t?"zero":isBetween(t%100,11,99)?"many":2==t?"two":1==t?"one":"other"},2:function(t){return 0!==t&&t%10==0?"many":2==t?"two":1==t?"one":"other"},3:function(t){return 1==t?"one":"other"},4:function(t){return isBetween(t,0,1)?"one":"other"},5:function(t){return isBetween(t,0,2)&&2!=t?"one":"other"},6:function(t){return 0===t?"zero":t%10==1&&t%100!=11?"one":"other"},7:function(t){return 2==t?"two":1==t?"one":"other"},8:function(t){return isBetween(t,3,6)?"few":isBetween(t,7,10)?"many":2==t?"two":1==t?"one":"other"},9:function(t){return 0===t||1!=t&&isBetween(t%100,1,19)?"few":1==t?"one":"other"},10:function(t){return isBetween(t%10,2,9)&&!isBetween(t%100,11,19)?"few":t%10!=1||isBetween(t%100,11,19)?"other":"one"},11:function(t){return isBetween(t%10,2,4)&&!isBetween(t%100,12,14)?"few":t%10==0||isBetween(t%10,5,9)||isBetween(t%100,11,14)?"many":t%10==1&&t%100!=11?"one":"other"},12:function(t){return isBetween(t,2,4)?"few":1==t?"one":"other"},13:function(t){return isBetween(t%10,2,4)&&!isBetween(t%100,12,14)?"few":1!=t&&isBetween(t%10,0,1)||isBetween(t%10,5,9)||isBetween(t%100,12,14)?"many":1==t?"one":"other"},14:function(t){return isBetween(t%100,3,4)?"few":t%100==2?"two":t%100==1?"one":"other"},15:function(t){return 0===t||isBetween(t%100,2,10)?"few":isBetween(t%100,11,19)?"many":1==t?"one":"other"},16:function(t){return t%10==1&&11!=t?"one":"other"},17:function(t){return 3==t?"few":0===t?"zero":6==t?"many":2==t?"two":1==t?"one":"other"},18:function(t){return 0===t?"zero":isBetween(t,0,2)&&0!==t&&2!=t?"one":"other"},19:function(t){return isBetween(t,2,10)?"few":isBetween(t,0,1)?"one":"other"},20:function(t){return!isBetween(t%10,3,4)&&t%10!=9||isBetween(t%100,10,19)||isBetween(t%100,70,79)||isBetween(t%100,90,99)?t%1e6==0&&0!==t?"many":t%10!=2||isIn(t%100,[12,72,92])?t%10!=1||isIn(t%100,[11,71,91])?"other":"one":"two":"few"},21:function(t){return 0===t?"zero":1==t?"one":"other"},22:function(t){return isBetween(t,0,1)||isBetween(t,11,99)?"one":"other"},23:function(t){return isBetween(t%10,1,2)||t%20==0?"one":"other"},24:function(t){return isBetween(t,3,10)||isBetween(t,13,19)?"few":isIn(t,[2,12])?"two":isIn(t,[1,11])?"one":"other"}},i={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[t.replace(/-.*$/,"")];return i in r?r[i]:(console.warn("plural form unknown for ["+t+"]"),function(){return"other"})}(l));var h="["+u._pluralRules(d)+"]";return 0===d&&i+"[zero]"in o?t=o[i+"[zero]"][a]:1==d&&i+"[one]"in o?t=o[i+"[one]"][a]:2==d&&i+"[two]"in o?t=o[i+"[two]"][a]:i+h in o?t=o[i+h][a]:i+"[other]"in o&&(t=o[i+"[other]"][a]),t},{get:function(t,r,i){var o,a=t.lastIndexOf("."),l=c;a>0&&(l=t.substring(a+1),t=t.substring(0,a)),i&&((o={})[l]=i);var u=getL10nData(t,r,o);return u&&l in u?u[l]:"{{"+t+"}}"},getData:function(){return o},getText:function(){return a},getLanguage:function(){return l},setLanguage:function(t,r){loadLocale(t,(function(){r&&r()}))},getDirection:function(){var t=l.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(t)>=0?"rtl":"ltr"},translate:function translateFragment(t){for(var i=function getTranslatableChildren(t){return t?t.querySelectorAll("*[data-l10n-id]"):[]}(t=t||r.documentElement),o=i.length,a=0;a<o;a++)translateElement(i[a]);translateElement(t)},getReadyState:function(){return d},ready:function(i){i&&("complete"==d||"interactive"==d?t.setTimeout((function(){i()})):r.addEventListener&&r.addEventListener("localized",(function once(){r.removeEventListener("localized",once),i()})))}}}(window,document)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFindController=r.FindState=void 0;var o=i(6),a=i(3),c=i(21);const l={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};r.FindState=l;const u={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},d=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),h=[...d.values()].map((t=>String.fromCharCode(t))).join(""),p=/\p{M}+/gu,g=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,m=/([^\p{M}])\p{M}*$/u,y=/^\p{M}*([^\p{M}])/u;let v=null;function normalize(t){if(!v){const t=Object.keys(u).join("");v=new RegExp(`([${t}])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(\\n)`,"gum")}const r=[];let i;for(;null!==(i=p.exec(t));)r.push([i[0].length,i.index]);let o=t.normalize("NFD");const a=[[0,0]];let c=0,l=0,d=0,h=0,g=!1;return o=o.replace(v,((t,i,o,p,m,y)=>{if(y-=d,i){const r=u[t],i=r.length;for(let t=1;t<i;t++)a.push([y-l+t,l-t]);return l-=i-1,r}if(o){const t=o.endsWith("\n"),i=t?o.length-2:o.length;g=!0;let u=i;y+h===r[c]?.[1]&&(u-=r[c][0],++c);for(let t=1;t<u+1;t++)a.push([y-1-l+t,l-t]);return l-=u,d+=u,t?(y+=i-1,a.push([y-l+1,1+l]),l+=1,d+=1,h+=1,o.slice(0,i)):o}return p?(a.push([y-l+1,1+l]),l+=1,d+=1,h+=1,p.charAt(0)):(a.push([y-l+1,l-1]),l-=1,d+=1,h+=1," ")})),a.push([o.length,l]),[o,a,g]}function getOriginalIndex(t,r,i){if(!t)return[r,i];const a=r,c=r+i;let l=(0,o.binarySearchFirstItem)(t,(t=>t[0]>=a));t[l][0]>a&&--l;let u=(0,o.binarySearchFirstItem)(t,(t=>t[0]>=c),l);return t[u][0]>c&&--u,[a+t[l][1],i+t[u][1]-t[l][1]]}r.PDFFindController=class PDFFindController{constructor({linkService:t,eventBus:r}){this._linkService=t,this._eventBus=r,this.#L(),r._on("find",this.#F.bind(this)),r._on("findbarclose",this.#N.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(t){this._pdfDocument&&this.#L(),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}#F(t){if(!t)return;const r=this._pdfDocument,{type:i}=t;(null===this._state||this.#B(t))&&(this._dirtyMatch=!0),this._state=t,"highlightallchange"!==i&&this.#j(l.PENDING),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||r&&this._pdfDocument!==r)return;this.#V();const t=!this._highlightMatches,o=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),i?this._dirtyMatch?this.#U():"again"===i?(this.#U(),t&&this._state.highlightAll&&this.#z()):"highlightallchange"===i?(o?this.#U():this._highlightMatches=!0,this.#z()):this.#U():this._findTimeout=setTimeout((()=>{this.#U(),this._findTimeout=null}),250)}))}scrollMatchIntoView({element:t=null,selectedLeft:r=0,pageIndex:i=-1,matchIndex:a=-1}){if(!this._scrollMatches||!t)return;if(-1===a||a!==this._selected.matchIdx)return;if(-1===i||i!==this._selected.pageIdx)return;this._scrollMatches=!1;const c={top:-50,left:r+-400};(0,o.scrollIntoView)(t,c,!0)}#L(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,a.createPromiseCapability)()}get#J(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=normalize(this._state.query)),this._normalizedQuery}#B(t){if(t.query!==this._state.query)return!0;switch(t.type){case"again":const t=this._selected.pageIdx+1,r=this._linkService;return t>=1&&t<=r.pagesCount&&t!==r.page&&!r.isPageVisible(t);case"highlightallchange":return!1}return!0}#H(t,r,i){let o=t.slice(0,r).match(m);if(o){const i=t.charCodeAt(r),a=o[1].charCodeAt(0);if((0,c.getCharacterType)(i)===(0,c.getCharacterType)(a))return!1}if(o=t.slice(r+i).match(y),o){const a=t.charCodeAt(r+i-1),l=o[1].charCodeAt(0);if((0,c.getCharacterType)(a)===(0,c.getCharacterType)(l))return!1}return!0}#G(t,r,i,o){const a=[],c=[],l=this._pageDiffs[i];let u;for(;null!==(u=t.exec(o));){if(r&&!this.#H(o,u.index,u[0].length))continue;const[t,i]=getOriginalIndex(l,u.index,u[0].length);i&&(a.push(t),c.push(i))}this._pageMatches[i]=a,this._pageMatchesLength[i]=c}#q(t,r){const{matchDiacritics:i}=this._state;let o=!1;const a="[ ]*";return(t=t.replace(g,((t,a,c,l,u,h)=>a?`[ ]*\\${a}[ ]*`:c?`[ ]*${c}[ ]*`:l?"[ ]+":i?u||h:u?d.has(u.charCodeAt(0))?u:"":r?(o=!0,`${h}\\p{M}*`):h))).endsWith(a)&&(t=t.slice(0,t.length-a.length)),i&&r&&(o=!0,t=`${t}(?=[${h}]|[^\\p{M}]|$)`),[o,t]}#W(t){let r=this.#J;if(0===r.length)return;const{caseSensitive:i,entireWord:o,phraseSearch:a}=this._state,c=this._pageContents[t],l=this._hasDiacritics[t];let u=!1;if(a)[u,r]=this.#q(r,l);else{const t=r.match(/\S+/g);t&&(r=t.sort().reverse().map((t=>{const[r,i]=this.#q(t,l);return u||=r,`(${i})`})).join("|"))}r=new RegExp(r,`g${u?"u":""}${i?"":"i"}`),this.#G(r,o,t,c),this._state.highlightAll&&this.#Y(t),this._resumePageIdx===t&&(this._resumePageIdx=null,this.#Q());const d=this._pageMatches[t].length;d>0&&(this._matchesCountTotal+=d,this.#X())}#V(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();for(let r=0,i=this._linkService.pagesCount;r<i;r++){const i=(0,a.createPromiseCapability)();this._extractTextPromises[r]=i.promise,t=t.then((()=>this._pdfDocument.getPage(r+1).then((t=>t.getTextContent())).then((t=>{const o=[];for(const r of t.items)o.push(r.str),r.hasEOL&&o.push("\n");[this._pageContents[r],this._pageDiffs[r],this._hasDiacritics[r]]=normalize(o.join("")),i.resolve()}),(t=>{console.error(`Unable to get text content for page ${r+1}`,t),this._pageContents[r]="",this._pageDiffs[r]=null,this._hasDiacritics[r]=!1,i.resolve()}))))}}#Y(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})}#z(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#U(){const t=this._state.findPrevious,r=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=r,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,this.#z();for(let t=0;t<i;t++)this._pendingFindMatches.has(t)||(this._pendingFindMatches.add(t),this._extractTextPromises[t].then((()=>{this._pendingFindMatches.delete(t),this.#W(t)})))}if(""===this.#J)return void this.#j(l.FOUND);if(this._resumePageIdx)return;const o=this._offset;if(this._pagesToSearch=i,null!==o.matchIdx){const r=this._pageMatches[o.pageIdx].length;if(!t&&o.matchIdx+1<r||t&&o.matchIdx>0)return o.matchIdx=t?o.matchIdx-1:o.matchIdx+1,void this.#$(!0);this.#K(t)}this.#Q()}#Z(t){const r=this._offset,i=t.length,o=this._state.findPrevious;return i?(r.matchIdx=o?i-1:0,this.#$(!0),!0):(this.#K(o),!!(r.wrapped&&(r.matchIdx=null,this._pagesToSearch<0))&&(this.#$(!1),!0))}#Q(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let t=null;do{const r=this._offset.pageIdx;if(t=this._pageMatches[r],!t){this._resumePageIdx=r;break}}while(!this.#Z(t))}#K(t){const r=this._offset,i=this._linkService.pagesCount;r.pageIdx=t?r.pageIdx-1:r.pageIdx+1,r.matchIdx=null,this._pagesToSearch--,(r.pageIdx>=i||r.pageIdx<0)&&(r.pageIdx=t?i-1:0,r.wrapped=!0)}#$(t=!1){let r=l.NOT_FOUND;const i=this._offset.wrapped;if(this._offset.wrapped=!1,t){const t=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,r=i?l.WRAPPED:l.FOUND,-1!==t&&t!==this._selected.pageIdx&&this.#Y(t)}this.#j(r,this._state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this.#Y(this._selected.pageIdx))}#N(t){const r=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||r&&this._pdfDocument!==r||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#j(l.FOUND),this._highlightMatches=!1,this.#z())}))}#ee(){const{pageIdx:t,matchIdx:r}=this._selected;let i=0,o=this._matchesCountTotal;if(-1!==r){for(let r=0;r<t;r++)i+=this._pageMatches[r]?.length||0;i+=r+1}return(i<1||i>o)&&(i=o=0),{current:i,total:o}}#X(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#ee()})}#j(t,r=!1){this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:r,matchesCount:this.#ee(),rawQuery:this._state?.query??null})}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CharacterType=void 0,r.getCharacterType=function getCharacterType(t){if(function isAlphabeticalScript(t){return t<11904}(t))return function isAscii(t){return 0==(65408&t)}(t)?function isAsciiSpace(t){return 32===t||9===t||13===t||10===t}(t)?i.SPACE:function isAsciiAlpha(t){return t>=97&&t<=122||t>=65&&t<=90}(t)||function isAsciiDigit(t){return t>=48&&t<=57}(t)||95===t?i.ALPHA_LETTER:i.PUNCT:function isThai(t){return 3584==(65408&t)}(t)?i.THAI_LETTER:160===t?i.SPACE:i.ALPHA_LETTER;if(function isHan(t){return t>=13312&&t<=40959||t>=63744&&t<=64255}(t))return i.HAN_LETTER;if(function isKatakana(t){return t>=12448&&t<=12543}(t))return i.KATAKANA_LETTER;if(function isHiragana(t){return t>=12352&&t<=12447}(t))return i.HIRAGANA_LETTER;if(function isHalfwidthKatakana(t){return t>=65376&&t<=65439}(t))return i.HALFWIDTH_KATAKANA_LETTER;return i.ALPHA_LETTER};const i={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};r.CharacterType=i},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFHistory=void 0,r.isDestArraysEqual=isDestArraysEqual,r.isDestHashesEqual=isDestHashesEqual;var o=i(6),a=i(17);function getCurrentHash(){return document.location.hash}function isDestHashesEqual(t,r){if("string"!=typeof t||"string"!=typeof r)return!1;if(t===r)return!0;return(0,o.parseQueryString)(t).get("nameddest")===r}function isDestArraysEqual(t,r){function isEntryEqual(t,r){if(typeof t!=typeof r)return!1;if(Array.isArray(t)||Array.isArray(r))return!1;if(null!==t&&"object"==typeof t&&null!==r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const i in t)if(!isEntryEqual(t[i],r[i]))return!1;return!0}return t===r||Number.isNaN(t)&&Number.isNaN(r)}if(!Array.isArray(t)||!Array.isArray(r))return!1;if(t.length!==r.length)return!1;for(let i=0,o=t.length;i<o;i++)if(!isEntryEqual(t[i],r[i]))return!1;return!0}r.PDFHistory=class PDFHistory{constructor({linkService:t,eventBus:r}){this.linkService=t,this.eventBus=r,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",(()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",(t=>{this._isPagesLoaded=!!t.pagesCount}),{once:!0})}))}initialize({fingerprint:t,resetHistory:r=!1,updateUrl:i=!1}){if(!t||"string"!=typeof t)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const o=""!==this._fingerprint&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=!0===i,this._initialized=!0,this._bindEvents();const a=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=getCurrentHash(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(a,!0)||r){const{hash:t,page:i,rotation:a}=this._parseCurrentHash(!0);return!t||o||r?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:t,page:i,rotation:a},!0)}const c=a.destination;this._updateInternalState(c,a.uid,!0),void 0!==c.rotation&&(this._initialRotation=c.rotation),c.dest?(this._initialBookmark=JSON.stringify(c.dest),this._destination.page=null):c.hash?this._initialBookmark=c.hash:c.page&&(this._initialBookmark=`page=${c.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:r,pageNumber:i}){if(!this._initialized)return;if(t&&"string"!=typeof t)return void console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);if(!Array.isArray(r))return void console.error(`PDFHistory.push: "${r}" is not a valid explicitDest parameter.`);if(!this._isValidPage(i)&&(null!==i||this._destination))return void console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);const o=t||JSON.stringify(r);if(!o)return;let a=!1;if(this._destination&&(isDestHashesEqual(this._destination.hash,o)||isDestArraysEqual(this._destination.dest,r))){if(this._destination.page)return;a=!0}this._popStateInProgress&&!a||(this._pushOrReplaceState({dest:r,hash:o,page:i,rotation:this.linkService.rotation},a),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))}pushPage(t){this._initialized&&(this._isValidPage(t)?this._destination?.page!==t&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))):console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this._isValidState(t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this._isValidState(t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(t,r=!1){const i=r||!this._destination,o={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:t};let a;if(this._updateInternalState(t,o.uid),this._updateUrl&&t?.hash){const r=document.location.href.split("#")[0];r.startsWith("file://")||(a=`${r}#${t.hash}`)}i?window.history.replaceState(o,"",a):window.history.pushState(o,"",a)}_tryPushCurrentPosition(t=!1){if(!this._position)return;let r=this._position;if(t&&(r=Object.assign(Object.create(null),this._position),r.temporary=!0),!this._destination)return void this._pushOrReplaceState(r);if(this._destination.temporary)return void this._pushOrReplaceState(r,!0);if(this._destination.hash===r.hash)return;if(!this._destination.page&&this._numPositionUpdates<=50)return;let i=!1;if(this._destination.page>=r.first&&this._destination.page<=r.page){if(void 0!==this._destination.dest||!this._destination.first)return;i=!0}this._pushOrReplaceState(r,i)}_isValidPage(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount}_isValidState(t,r=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint){if(!r)return!1;{if("string"!=typeof t.fingerprint||t.fingerprint.length!==this._fingerprint.length)return!1;const[r]=performance.getEntriesByType("navigation");if("reload"!==r?.type)return!1}}return!(!Number.isInteger(t.uid)||t.uid<0)&&(null!==t.destination&&"object"==typeof t.destination)}_updateInternalState(t,r,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=r,this._maxUid=Math.max(this._maxUid,r),this._numPositionUpdates=0}_parseCurrentHash(t=!1){const r=unescape(getCurrentHash()).substring(1),i=(0,o.parseQueryString)(r),a=i.get("nameddest")||"";let c=0|i.get("page");return(!this._isValidPage(c)||t&&a.length>0)&&(c=null),{hash:r,page:c,rotation:this.linkService.rotation}}_updateViewarea({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout((()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null}),1e3))}_popState({state:t}){const r=getCurrentHash(),i=this._currentHash!==r;if(this._currentHash=r,!t){this._uid++;const{hash:t,page:r,rotation:i}=this._parseCurrentHash();return void this._pushOrReplaceState({hash:t,page:r,rotation:i},!0)}if(!this._isValidState(t))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,(0,a.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then((()=>{this._blockHashChange--})));const c=t.destination;this._updateInternalState(c,t.uid,!0),(0,o.isValidRotation)(c.rotation)&&(this.linkService.rotation=c.rotation),c.dest?this.linkService.goToDestination(c.dest):c.hash?this.linkService.setHash(c.hash):c.page&&(this.linkService.page=c.page),Promise.resolve().then((()=>{this._popStateInProgress=!1}))}_pageHide(){this._destination&&!this._destination.temporary||this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFScriptingManager=void 0;var o=i(6),a=i(3);r.PDFScriptingManager=class PDFScriptingManager{constructor({eventBus:t,sandboxBundleSrc:r=null,scriptingFactory:i=null,docPropertiesLookup:o=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=t,this._sandboxBundleSrc=r,this._scriptingFactory=i,this._docPropertiesLookup=o,this._scriptingFactory||window.addEventListener("updatefromsandbox",(t=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}))}setViewer(t){this._pdfViewer=t}async setDocument(t){if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=t,!t)return;const[r,i,o]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(r||o){if(t===this._pdfDocument){try{this._scripting=this._createScripting()}catch(t){return console.error(`PDFScriptingManager.setDocument: "${t?.message}".`),void await this._destroyScripting()}this._internalEvents.set("updatefromsandbox",(t=>{t?.source===window&&this._updateFromSandbox(t.detail)})),this._internalEvents.set("dispatcheventinsandbox",(t=>{this._scripting?.dispatchEventInSandbox(t.detail)})),this._internalEvents.set("pagechanging",(({pageNumber:t,previous:r})=>{t!==r&&(this._dispatchPageClose(r),this._dispatchPageOpen(t))})),this._internalEvents.set("pagerendered",(({pageNumber:t})=>{this._pageOpenPending.has(t)&&t===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(t)})),this._internalEvents.set("pagesdestroy",(async t=>{await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"})),this._closeCapability?.resolve()})),this._domEvents.set("mousedown",(t=>{this._mouseState.isDown=!0})),this._domEvents.set("mouseup",(t=>{this._mouseState.isDown=!1}));for(const[t,r]of this._internalEvents)this._eventBus._on(t,r);for(const[t,r]of this._domEvents)window.addEventListener(t,r,!0);try{const a=await this._getDocProperties();if(t!==this._pdfDocument)return;await this._scripting.createSandbox({objects:r,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...a,actions:o}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(t){return console.error(`PDFScriptingManager.setDocument: "${t?.message}".`),void await this._destroyScripting()}await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then((()=>{t===this._pdfDocument&&(this._ready=!0)}))}}else await this._destroyScripting()}async dispatchWillSave(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get mouseState(){return this._mouseState}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,a.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,a.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,a.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,a.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(t){const r=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:i,siblings:a,command:c,value:l}=t;if(!i){switch(c){case"clear":console.clear();break;case"error":console.error(l);break;case"layout":if(r)return;const t=(0,o.apiPageLayoutToViewerModes)(l);this._pdfViewer.spreadMode=t.spreadMode;break;case"page-num":this._pdfViewer.currentPageNumber=l+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(l);break;case"zoom":if(r)return;this._pdfViewer.currentScaleValue=l;break;case"SaveAs":this._eventBus.dispatch("save",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(r)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(r)return;this._pdfViewer.decreaseScale()}return}if(r&&t.focus)return;delete t.id,delete t.siblings;const u=a?[i,...a]:[i];for(const r of u){const i=document.getElementById(r);i?i.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):this._pdfDocument?.annotationStorage.setValue(r,t)}}async _dispatchPageOpen(t,r=!1){const i=this._pdfDocument,c=this._visitedPages;if(r&&(this._closeCapability=(0,a.createPromiseCapability)()),!this._closeCapability)return;const l=this._pdfViewer.getPageView(t-1);if(l?.renderingState!==o.RenderingStates.FINISHED)return void this._pageOpenPending.add(t);this._pageOpenPending.delete(t);const u=(async()=>{const r=await(c.has(t)?null:l.pdfPage?.getJSActions());i===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:r}))})();c.set(t,u)}async _dispatchPageClose(t){const r=this._pdfDocument,i=this._visitedPages;if(!this._closeCapability)return;if(this._pageOpenPending.has(t))return;const o=i.get(t);o&&(i.set(t,null),await o,r===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:t}=i(24);return t(this._pdfDocument)}_createScripting(){if(this._destroyCapability=(0,a.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:t}=i(24);return new t(this._sandboxBundleSrc)}async _destroyScripting(){if(!this._scripting)return this._pdfDocument=null,void this._destroyCapability?.resolve();this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise((t=>{setTimeout(t,1e3)}))]).catch((t=>{})),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch(t){}for(const[t,r]of this._internalEvents)this._eventBus._off(t,r);this._internalEvents.clear();for(const[t,r]of this._domEvents)window.removeEventListener(t,r,!0);this._domEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,delete this._mouseState.isDown,this._ready=!1,this._destroyCapability?.resolve()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GenericScripting=void 0,r.docPropertiesLookup=async function docPropertiesLookup(t){const r="".split("#")[0];let{info:i,metadata:a,contentDispositionFilename:c,contentLength:l}=await t.getMetadata();if(!l){const{length:r}=await t.getDownloadInfo();l=r}return{...i,baseURL:r,filesize:l,filename:c||(0,o.getPdfFilenameFromUrl)(""),metadata:a?.getRaw(),authors:a?.get("dc:creator"),numPages:t.numPages,URL:""}};var o=i(3);r.GenericScripting=class GenericScripting{constructor(t){this._ready=(0,o.loadScript)(t,!0).then((()=>window.pdfjsSandbox.QuickJSSandbox()))}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){const r=await this._ready;setTimeout((()=>r.dispatchEvent(t)),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}}],r={};function __w_pdfjs_require__(i){var o=r[i];if(void 0!==o)return o.exports;var a=r[i]={exports:{}};return t[i](a,a.exports,__w_pdfjs_require__),a.exports}var o={};return(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return l.AnnotationLayerBuilder}}),Object.defineProperty(t,"DefaultAnnotationLayerFactory",{enumerable:!0,get:function(){return r.DefaultAnnotationLayerFactory}}),Object.defineProperty(t,"DefaultStructTreeLayerFactory",{enumerable:!0,get:function(){return r.DefaultStructTreeLayerFactory}}),Object.defineProperty(t,"DefaultTextLayerFactory",{enumerable:!0,get:function(){return r.DefaultTextLayerFactory}}),Object.defineProperty(t,"DefaultXfaLayerFactory",{enumerable:!0,get:function(){return r.DefaultXfaLayerFactory}}),Object.defineProperty(t,"DownloadManager",{enumerable:!0,get:function(){return u.DownloadManager}}),Object.defineProperty(t,"EventBus",{enumerable:!0,get:function(){return d.EventBus}}),Object.defineProperty(t,"GenericL10n",{enumerable:!0,get:function(){return h.GenericL10n}}),Object.defineProperty(t,"LinkTarget",{enumerable:!0,get:function(){return i.LinkTarget}}),Object.defineProperty(t,"NullL10n",{enumerable:!0,get:function(){return p.NullL10n}}),Object.defineProperty(t,"PDFFindController",{enumerable:!0,get:function(){return g.PDFFindController}}),Object.defineProperty(t,"PDFHistory",{enumerable:!0,get:function(){return m.PDFHistory}}),Object.defineProperty(t,"PDFLinkService",{enumerable:!0,get:function(){return i.PDFLinkService}}),Object.defineProperty(t,"PDFPageView",{enumerable:!0,get:function(){return y.PDFPageView}}),Object.defineProperty(t,"PDFScriptingManager",{enumerable:!0,get:function(){return v.PDFScriptingManager}}),Object.defineProperty(t,"PDFSinglePageViewer",{enumerable:!0,get:function(){return c.PDFSinglePageViewer}}),Object.defineProperty(t,"PDFViewer",{enumerable:!0,get:function(){return c.PDFViewer}}),Object.defineProperty(t,"ProgressBar",{enumerable:!0,get:function(){return a.ProgressBar}}),Object.defineProperty(t,"SimpleLinkService",{enumerable:!0,get:function(){return i.SimpleLinkService}}),Object.defineProperty(t,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return _.StructTreeLayerBuilder}}),Object.defineProperty(t,"TextLayerBuilder",{enumerable:!0,get:function(){return b.TextLayerBuilder}}),Object.defineProperty(t,"XfaLayerBuilder",{enumerable:!0,get:function(){return A.XfaLayerBuilder}}),Object.defineProperty(t,"parseQueryString",{enumerable:!0,get:function(){return a.parseQueryString}});var r=__w_pdfjs_require__(1),i=__w_pdfjs_require__(5),a=__w_pdfjs_require__(6),c=__w_pdfjs_require__(10),l=__w_pdfjs_require__(2),u=__w_pdfjs_require__(16),d=__w_pdfjs_require__(17),h=__w_pdfjs_require__(18),p=__w_pdfjs_require__(4),g=__w_pdfjs_require__(20),m=__w_pdfjs_require__(22),y=__w_pdfjs_require__(12),v=__w_pdfjs_require__(23),_=__w_pdfjs_require__(7),b=__w_pdfjs_require__(8),A=__w_pdfjs_require__(9)})(),o})()))},539:t=>{"use strict";const r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(t){return t.trim().split("\n").map((t=>t.trim()))},r.splitSections=function(t){return t.split("\nm=").map(((t,r)=>(r>0?"m="+t:t).trim()+"\r\n"))},r.getDescription=function(t){const i=r.splitSections(t);return i&&i[0]},r.getMediaSections=function(t){const i=r.splitSections(t);return i.shift(),i},r.matchPrefix=function(t,i){return r.splitLines(t).filter((t=>0===t.indexOf(i)))},r.parseCandidate=function(t){let r;r=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let t=8;t<r.length;t+=2)switch(r[t]){case"raddr":i.relatedAddress=r[t+1];break;case"rport":i.relatedPort=parseInt(r[t+1],10);break;case"tcptype":i.tcpType=r[t+1];break;case"ufrag":i.ufrag=r[t+1],i.usernameFragment=r[t+1];break;default:void 0===i[r[t]]&&(i[r[t]]=r[t+1])}return i},r.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;"rtp"===i?r.push(1):"rtcp"===i?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),"host"!==o&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},r.parseIceOptions=function(t){return t.substr(14).split(" ")},r.parseRtpMap=function(t){let r=t.substr(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=3===r.length?parseInt(r[2],10):1,i.numChannels=i.channels,i},r.writeRtpMap=function(t){let r=t.payloadType;void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(1!==i?"/"+i:"")+"\r\n"},r.parseExtmap=function(t){const r=t.substr(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1]}},r.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},r.parseFmtp=function(t){const r={};let i;const o=t.substr(t.indexOf(" ")+1).split(";");for(let t=0;t<o.length;t++)i=o[t].trim().split("="),r[i[0].trim()]=i[1];return r},r.writeFmtp=function(t){let r="",i=t.payloadType;if(void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach((r=>{void 0!==t.parameters[r]?o.push(r+"="+t.parameters[r]):o.push(r)})),r+="a=fmtp:"+i+" "+o.join(";")+"\r\n"}return r},r.parseRtcpFb=function(t){const r=t.substr(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},r.writeRtcpFb=function(t){let r="",i=t.payloadType;return void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach((t=>{r+="a=rtcp-fb:"+i+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"})),r},r.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substr(7,r-7),10)},o=t.indexOf(":",r);return o>-1?(i.attribute=t.substr(r+1,o-r-1),i.value=t.substr(o+1)):i.attribute=t.substr(r+1),i},r.parseSsrcGroup=function(t){const r=t.substr(13).split(" ");return{semantics:r.shift(),ssrcs:r.map((t=>parseInt(t,10)))}},r.getMid=function(t){const i=r.matchPrefix(t,"a=mid:")[0];if(i)return i.substr(6)},r.parseFingerprint=function(t){const r=t.substr(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},r.getDtlsParameters=function(t,i){return{role:"auto",fingerprints:r.matchPrefix(t+i,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(t,r){let i="a=setup:"+r+"\r\n";return t.fingerprints.forEach((t=>{i+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"})),i},r.parseCryptoLine=function(t){const r=t.substr(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},r.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+("object"==typeof t.keyParams?r.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(t){if(0!==t.indexOf("inline:"))return null;const r=t.substr(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},r.getCryptoParameters=function(t,i){return r.matchPrefix(t+i,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(t,i){const o=r.matchPrefix(t+i,"a=ice-ufrag:")[0],a=r.matchPrefix(t+i,"a=ice-pwd:")[0];return o&&a?{usernameFragment:o.substr(12),password:a.substr(10)}:null},r.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n";return t.iceLite&&(r+="a=ice-lite\r\n"),r},r.parseRtpParameters=function(t){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=r.splitLines(t)[0].split(" ");for(let a=3;a<o.length;a++){const c=o[a],l=r.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(l){const o=r.parseRtpMap(l),a=r.matchPrefix(t,"a=fmtp:"+c+" ");switch(o.parameters=a.length?r.parseFmtp(a[0]):{},o.rtcpFeedback=r.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(r.parseRtcpFb),i.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(t,"a=extmap:").forEach((t=>{i.headerExtensions.push(r.parseExtmap(t))})),i},r.writeRtpDescription=function(t,i){let o="";o+="m="+t+" ",o+=i.codecs.length>0?"9":"0",o+=" UDP/TLS/RTP/SAVPF ",o+=i.codecs.map((t=>void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType)).join(" ")+"\r\n",o+="c=IN IP4 0.0.0.0\r\n",o+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((t=>{o+=r.writeRtpMap(t),o+=r.writeFmtp(t),o+=r.writeRtcpFb(t)}));let a=0;return i.codecs.forEach((t=>{t.maxptime>a&&(a=t.maxptime)})),a>0&&(o+="a=maxptime:"+a+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach((t=>{o+=r.writeExtmap(t)})),o},r.parseRtpEncodingParameters=function(t){const i=[],o=r.parseRtpParameters(t),a=-1!==o.fecMechanisms.indexOf("RED"),c=-1!==o.fecMechanisms.indexOf("ULPFEC"),l=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"cname"===t.attribute)),u=l.length>0&&l[0].ssrc;let d;const h=r.matchPrefix(t,"a=ssrc-group:FID").map((t=>t.substr(17).split(" ").map((t=>parseInt(t,10)))));h.length>0&&h[0].length>1&&h[0][0]===u&&(d=h[0][1]),o.codecs.forEach((t=>{if("RTX"===t.name.toUpperCase()&&t.parameters.apt){let r={ssrc:u,codecPayloadType:parseInt(t.parameters.apt,10)};u&&d&&(r.rtx={ssrc:d}),i.push(r),a&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:u,mechanism:c?"red+ulpfec":"red"},i.push(r))}})),0===i.length&&u&&i.push({ssrc:u});let p=r.matchPrefix(t,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,i.forEach((t=>{t.maxBitrate=p}))),i},r.parseRtcpParameters=function(t){const i={},o=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"cname"===t.attribute))[0];o&&(i.cname=o.value,i.ssrc=o.ssrc);const a=r.matchPrefix(t,"a=rtcp-rsize");i.reducedSize=a.length>0,i.compound=0===a.length;const c=r.matchPrefix(t,"a=rtcp-mux");return i.mux=c.length>0,i},r.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+="a=rtcp-rsize\r\n"),t.mux&&(r+="a=rtcp-mux\r\n"),void 0!==t.ssrc&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+"\r\n"),r},r.parseMsid=function(t){let i;const o=r.matchPrefix(t,"a=msid:");if(1===o.length)return i=o[0].substr(7).split(" "),{stream:i[0],track:i[1]};const a=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"msid"===t.attribute));return a.length>0?(i=a[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},r.parseSctpDescription=function(t){const i=r.parseMLine(t),o=r.matchPrefix(t,"a=max-message-size:");let a;o.length>0&&(a=parseInt(o[0].substr(19),10)),isNaN(a)&&(a=65536);const c=r.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substr(12),10),protocol:i.fmt,maxMessageSize:a};const l=r.matchPrefix(t,"a=sctpmap:");if(l.length>0){const t=l[0].substr(10).split(" ");return{port:parseInt(t[0],10),protocol:t[1],maxMessageSize:a}}},r.writeSctpDescription=function(t,r){let i=[];return i="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+r.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+r.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+r.port+" "+r.protocol+" 65535\r\n"],void 0!==r.maxMessageSize&&i.push("a=max-message-size:"+r.maxMessageSize+"\r\n"),i.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(t,i,o){let a;const c=void 0!==i?i:2;a=t||r.generateSessionId();return"v=0\r\no="+(o||"thisisadapterortc")+" "+a+" "+c+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.getDirection=function(t,i){const o=r.splitLines(t);for(let t=0;t<o.length;t++)switch(o[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[t].substr(2)}return i?r.getDirection(i):"sendrecv"},r.getKind=function(t){return r.splitLines(t)[0].split(" ")[0].substr(2)},r.isRejected=function(t){return"0"===t.split(" ",2)[1]},r.parseMLine=function(t){const i=r.splitLines(t)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},r.parseOLine=function(t){const i=r.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},r.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;const i=r.splitLines(t);for(let t=0;t<i.length;t++)if(i[t].length<2||"="!==i[t].charAt(1))return!1;return!0},t.exports=r},379:(t,r,i)=>{"use strict";var o=function isOldIE(){var t;return function memorize(){return void 0===t&&(t=Boolean(window&&document&&document.all&&!window.atob)),t}}(),a=function getTarget(){var t={};return function memorize(r){if(void 0===t[r]){var i=document.querySelector(r);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[r]=i}return t[r]}}(),c=[];function getIndexByIdentifier(t){for(var r=-1,i=0;i<c.length;i++)if(c[i].identifier===t){r=i;break}return r}function modulesToDom(t,r){for(var i={},o=[],a=0;a<t.length;a++){var l=t[a],u=r.base?l[0]+r.base:l[0],d=i[u]||0,h="".concat(u," ").concat(d);i[u]=d+1;var p=getIndexByIdentifier(h),g={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(c[p].references++,c[p].updater(g)):c.push({identifier:h,updater:addStyle(g,r),references:1}),o.push(h)}return o}function insertStyleElement(t){var r=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var c=i.nc;c&&(o.nonce=c)}if(Object.keys(o).forEach((function(t){r.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(r);else{var l=a(t.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(r)}return r}var l=function replaceText(){var t=[];return function replace(r,i){return t[r]=i,t.filter(Boolean).join("\n")}}();function applyToSingletonTag(t,r,i,o){var a=i?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=l(r,a);else{var c=document.createTextNode(a),u=t.childNodes;u[r]&&t.removeChild(u[r]),u.length?t.insertBefore(c,u[r]):t.appendChild(c)}}function applyToTag(t,r,i){var o=i.css,a=i.media,c=i.sourceMap;if(a?t.setAttribute("media",a):t.removeAttribute("media"),c&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(c))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var u=null,d=0;function addStyle(t,r){var i,o,a;if(r.singleton){var c=d++;i=u||(u=insertStyleElement(r)),o=applyToSingletonTag.bind(null,i,c,!1),a=applyToSingletonTag.bind(null,i,c,!0)}else i=insertStyleElement(r),o=applyToTag.bind(null,i,r),a=function remove(){!function removeStyleElement(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return o(t),function updateStyle(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;o(t=r)}else a()}}t.exports=function(t,r){(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=o());var i=modulesToDom(t=t||[],r);return function update(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<i.length;o++){var a=getIndexByIdentifier(i[o]);c[a].references--}for(var l=modulesToDom(t,r),u=0;u<i.length;u++){var d=getIndexByIdentifier(i[u]);0===c[d].references&&(c[d].updater(),c.splice(d,1))}i=l}}}},835:(t,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>y});var o={};i.r(o),i.d(o,{fixNegotiationNeeded:()=>fixNegotiationNeeded,shimAddTrackRemoveTrack:()=>shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative:()=>shimAddTrackRemoveTrackWithNative,shimGetDisplayMedia:()=>shimGetDisplayMedia,shimGetSendersWithDtmf:()=>shimGetSendersWithDtmf,shimGetStats:()=>shimGetStats,shimGetUserMedia:()=>shimGetUserMedia,shimMediaStream:()=>shimMediaStream,shimOnTrack:()=>shimOnTrack,shimPeerConnection:()=>shimPeerConnection,shimSenderReceiverGetStats:()=>shimSenderReceiverGetStats});var a={};i.r(a),i.d(a,{shimAddTransceiver:()=>shimAddTransceiver,shimCreateAnswer:()=>shimCreateAnswer,shimCreateOffer:()=>shimCreateOffer,shimGetDisplayMedia:()=>getdisplaymedia_shimGetDisplayMedia,shimGetParameters:()=>shimGetParameters,shimGetUserMedia:()=>getusermedia_shimGetUserMedia,shimOnTrack:()=>firefox_shim_shimOnTrack,shimPeerConnection:()=>firefox_shim_shimPeerConnection,shimRTCDataChannel:()=>shimRTCDataChannel,shimReceiverGetStats:()=>shimReceiverGetStats,shimRemoveStream:()=>shimRemoveStream,shimSenderGetStats:()=>shimSenderGetStats});var c={};i.r(c),i.d(c,{shimAudioContext:()=>shimAudioContext,shimCallbacksAPI:()=>shimCallbacksAPI,shimConstraints:()=>shimConstraints,shimCreateOfferLegacy:()=>shimCreateOfferLegacy,shimGetUserMedia:()=>safari_shim_shimGetUserMedia,shimLocalStreamsAPI:()=>shimLocalStreamsAPI,shimRTCIceServerUrls:()=>shimRTCIceServerUrls,shimRemoteStreamsAPI:()=>shimRemoteStreamsAPI,shimTrackEventTransceiver:()=>shimTrackEventTransceiver});var l={};i.r(l),i.d(l,{removeExtmapAllowMixed:()=>removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty:()=>shimAddIceCandidateNullOrEmpty,shimConnectionState:()=>shimConnectionState,shimMaxMessageSize:()=>shimMaxMessageSize,shimParameterlessSetLocalDescription:()=>shimParameterlessSetLocalDescription,shimRTCIceCandidate:()=>shimRTCIceCandidate,shimSendThrowTypeError:()=>shimSendThrowTypeError});let u=!0,d=!0;function extractVersion(t,r,i){const o=t.match(r);return o&&o.length>=i&&parseInt(o[i],10)}function wrapPeerConnectionEvent(t,r,i){if(!t.RTCPeerConnection)return;const o=t.RTCPeerConnection.prototype,a=o.addEventListener;o.addEventListener=function(t,o){if(t!==r)return a.apply(this,arguments);const wrappedCallback=t=>{const r=i(t);r&&(o.handleEvent?o.handleEvent(r):o(r))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(o,wrappedCallback),a.apply(this,[t,wrappedCallback])};const c=o.removeEventListener;o.removeEventListener=function(t,i){if(t!==r||!this._eventMap||!this._eventMap[r])return c.apply(this,arguments);if(!this._eventMap[r].has(i))return c.apply(this,arguments);const o=this._eventMap[r].get(i);return this._eventMap[r].delete(i),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,c.apply(this,[t,o])},Object.defineProperty(o,"on"+r,{get(){return this["_on"+r]},set(t){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),t&&this.addEventListener(r,this["_on"+r]=t)},enumerable:!0,configurable:!0})}function disableLog(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(u=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(d=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function log(){if("object"==typeof window){if(u)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function deprecated(t,r){d&&console.warn(t+" is deprecated, please use "+r+" instead.")}function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function compactObject(t){return isObject(t)?Object.keys(t).reduce((function(r,i){const o=isObject(t[i]),a=o?compactObject(t[i]):t[i],c=o&&!Object.keys(a).length;return void 0===a||c?r:Object.assign(r,{[i]:a})}),{}):t}function walkStats(t,r,i){r&&!i.has(r.id)&&(i.set(r.id,r),Object.keys(r).forEach((o=>{o.endsWith("Id")?walkStats(t,t.get(r[o]),i):o.endsWith("Ids")&&r[o].forEach((r=>{walkStats(t,t.get(r),i)}))})))}function filterStats(t,r,i){const o=i?"outbound-rtp":"inbound-rtp",a=new Map;if(null===r)return a;const c=[];return t.forEach((t=>{"track"===t.type&&t.trackIdentifier===r.id&&c.push(t)})),c.forEach((r=>{t.forEach((i=>{i.type===o&&i.trackId===r.id&&walkStats(t,i,a)}))})),a}const h=log;function shimGetUserMedia(t,r){const i=t&&t.navigator;if(!i.mediaDevices)return;const constraintsToChrome_=function(t){if("object"!=typeof t||t.mandatory||t.optional)return t;const r={};return Object.keys(t).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const o="object"==typeof t[i]?t[i]:{ideal:t[i]};void 0!==o.exact&&"number"==typeof o.exact&&(o.min=o.max=o.exact);const oldname_=function(t,r){return t?t+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==o.ideal){r.optional=r.optional||[];let t={};"number"==typeof o.ideal?(t[oldname_("min",i)]=o.ideal,r.optional.push(t),t={},t[oldname_("max",i)]=o.ideal,r.optional.push(t)):(t[oldname_("",i)]=o.ideal,r.optional.push(t))}void 0!==o.exact&&"number"!=typeof o.exact?(r.mandatory=r.mandatory||{},r.mandatory[oldname_("",i)]=o.exact):["min","max"].forEach((t=>{void 0!==o[t]&&(r.mandatory=r.mandatory||{},r.mandatory[oldname_(t,i)]=o[t])}))})),t.advanced&&(r.optional=(r.optional||[]).concat(t.advanced)),r},shimConstraints_=function(t,o){if(r.version>=61)return o(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"==typeof t.audio){const remap=function(t,r,i){r in t&&!(i in t)&&(t[i]=t[r],delete t[r])};remap((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),remap(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=constraintsToChrome_(t.audio)}if(t&&"object"==typeof t.video){let a=t.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const c=r.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||c)){let r;if(delete t.video.facingMode,"environment"===a.exact||"environment"===a.ideal?r=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(r=["front"]),r)return i.mediaDevices.enumerateDevices().then((i=>{let c=(i=i.filter((t=>"videoinput"===t.kind))).find((t=>r.some((r=>t.label.toLowerCase().includes(r)))));return!c&&i.length&&r.includes("back")&&(c=i[i.length-1]),c&&(t.video.deviceId=a.exact?{exact:c.deviceId}:{ideal:c.deviceId}),t.video=constraintsToChrome_(t.video),h("chrome: "+JSON.stringify(t)),o(t)}))}t.video=constraintsToChrome_(t.video)}return h("chrome: "+JSON.stringify(t)),o(t)},shimError_=function(t){return r.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(t,r,o){shimConstraints_(t,(t=>{i.webkitGetUserMedia(t,r,(t=>{o&&o(shimError_(t))}))}))}.bind(i),i.mediaDevices.getUserMedia){const t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(r){return shimConstraints_(r,(r=>t(r).then((t=>{if(r.audio&&!t.getAudioTracks().length||r.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((t=>{t.stop()})),new DOMException("","NotFoundError");return t}),(t=>Promise.reject(shimError_(t))))))}}}function shimGetDisplayMedia(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof r?t.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){return r(i).then((r=>{const o=i.video&&i.video.width,a=i.video&&i.video.height,c=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:c||3}},o&&(i.video.mandatory.maxWidth=o),a&&(i.video.mandatory.maxHeight=a),t.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function shimMediaStream(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function shimOnTrack(t){if("object"==typeof t&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",(i=>{let o;o=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((t=>t.track&&t.track.id===i.track.id)):{track:i.track};const a=new Event("track");a.track=i.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)})),r.stream.getTracks().forEach((i=>{let o;o=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((t=>t.track&&t.track.id===i.id)):{track:i};const a=new Event("track");a.track=i,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else wrapPeerConnectionEvent(t,"track",(t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t)))}function shimGetSendersWithDtmf(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const shimSenderWithDtmf=function(t,r){return{track:r,get dtmf(){return void 0===this._dtmf&&("audio"===r.kind?this._dtmf=t.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function getSenders(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function addTrack(t,i){let o=r.apply(this,arguments);return o||(o=shimSenderWithDtmf(this,t),this._senders.push(o)),o};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){i.apply(this,arguments);const r=this._senders.indexOf(t);-1!==r&&this._senders.splice(r,1)}}const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._senders=this._senders||[],r.apply(this,[t]),t.getTracks().forEach((t=>{this._senders.push(shimSenderWithDtmf(this,t))}))};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._senders=this._senders||[],i.apply(this,[t]),t.getTracks().forEach((t=>{const r=this._senders.find((r=>r.track===t));r&&this._senders.splice(this._senders.indexOf(r),1)}))}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){const[t,i,o]=arguments;if(arguments.length>0&&"function"==typeof t)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof t))return r.apply(this,[]);const fixChromeStats_=function(t){const r={};return t.result().forEach((t=>{const i={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach((r=>{i[r]=t.stat(r)})),r[i.id]=i})),r},makeMapStats=function(t){return new Map(Object.keys(t).map((r=>[r,t[r]])))};if(arguments.length>=2){const successCallbackWrapper_=function(t){i(makeMapStats(fixChromeStats_(t)))};return r.apply(this,[successCallbackWrapper_,t])}return new Promise(((t,i)=>{r.apply(this,[function(r){t(makeMapStats(fixChromeStats_(r)))},i])})).then(i,o)}}function shimSenderReceiverGetStats(t){if(!("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function addTrack(){const t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function getStats(){const t=this;return this._pc.getStats().then((r=>filterStats(r,t.track,!0)))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t}),wrapPeerConnectionEvent(t,"track",(t=>(t.receiver._pc=t.srcElement,t))),t.RTCRtpReceiver.prototype.getStats=function getStats(){const t=this;return this._pc.getStats().then((r=>filterStats(r,t.track,!1)))}}if(!("getStats"in t.RTCRtpSender.prototype)||!("getStats"in t.RTCRtpReceiver.prototype))return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const t=arguments[0];let r,i,o;return this.getSenders().forEach((i=>{i.track===t&&(r?o=!0:r=i)})),this.getReceivers().forEach((r=>(r.track===t&&(i?o=!0:i=r),r.track===t))),o||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(t){t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((t=>this._shimmedLocalStreams[t][0]))};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function addTrack(t,i){if(!i)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=r.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(o)&&this._shimmedLocalStreams[i.id].push(o):this._shimmedLocalStreams[i.id]=[i,o],o};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach((t=>{if(this.getSenders().find((r=>r.track===t)))throw new DOMException("Track already exists.","InvalidAccessError")}));const r=this.getSenders();i.apply(this,arguments);const o=this.getSenders().filter((t=>-1===r.indexOf(t)));this._shimmedLocalStreams[t.id]=[t].concat(o)};const o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function removeStream(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],o.apply(this,arguments)};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach((r=>{const i=this._shimmedLocalStreams[r].indexOf(t);-1!==i&&this._shimmedLocalStreams[r].splice(i,1),1===this._shimmedLocalStreams[r].length&&delete this._shimmedLocalStreams[r]})),a.apply(this,arguments)}}function shimAddTrackRemoveTrack(t,r){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return shimAddTrackRemoveTrackWithNative(t);const i=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){const t=i.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((t=>this._reverseStreams[t.id]))};const o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(r){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.getTracks().forEach((t=>{if(this.getSenders().find((r=>r.track===t)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[r.id]){const i=new t.MediaStream(r.getTracks());this._streams[r.id]=i,this._reverseStreams[i.id]=r,r=i}o.apply(this,[r])};const a=t.RTCPeerConnection.prototype.removeStream;function replaceInternalStreamId(t,r){let i=r.sdp;return Object.keys(t._reverseStreams||[]).forEach((r=>{const o=t._reverseStreams[r],a=t._streams[o.id];i=i.replace(new RegExp(a.id,"g"),o.id)})),new RTCSessionDescription({type:r.type,sdp:i})}function replaceExternalStreamId(t,r){let i=r.sdp;return Object.keys(t._reverseStreams||[]).forEach((r=>{const o=t._reverseStreams[r],a=t._streams[o.id];i=i.replace(new RegExp(o.id,"g"),a.id)})),new RTCSessionDescription({type:r.type,sdp:i})}t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function addTrack(r,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((t=>t===r)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const a=this.getSenders().find((t=>t.track===r));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const c=this._streams[i.id];if(c)c.addTrack(r),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const o=new t.MediaStream([r]);this._streams[i.id]=o,this._reverseStreams[o.id]=i,this.addStream(o)}return this.getSenders().find((t=>t.track===r))},["createOffer","createAnswer"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){const t=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[r=>{const i=replaceInternalStreamId(this,r);t[0].apply(null,[i])},r=>{t[1]&&t[1].apply(null,r)},arguments[2]]):i.apply(this,arguments).then((t=>replaceInternalStreamId(this,t)))}};t.RTCPeerConnection.prototype[r]=o[r]}));const c=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){return arguments.length&&arguments[0].type?(arguments[0]=replaceExternalStreamId(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const t=l.get.apply(this);return""===t.type?t:replaceInternalStreamId(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let r;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((r=>t.track===r))&&(r=this._streams[i])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]}))}function fixNegotiationNeeded(t,r){wrapPeerConnectionEvent(t,"negotiationneeded",(t=>{const i=t.target;if(!(r.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return t}))}function getusermedia_shimGetUserMedia(t,r){const i=t&&t.navigator,o=t&&t.MediaStreamTrack;if(i.getUserMedia=function(t,r,o){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(t).then(r,o)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const remap=function(t,r,i){r in t&&!(i in t)&&(t[i]=t[r],delete t[r])},t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),remap(r.audio,"autoGainControl","mozAutoGainControl"),remap(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},o&&o.prototype.getSettings){const t=o.prototype.getSettings;o.prototype.getSettings=function(){const r=t.apply(this,arguments);return remap(r,"mozAutoGainControl","autoGainControl"),remap(r,"mozNoiseSuppression","noiseSuppression"),r}}if(o&&o.prototype.applyConstraints){const t=o.prototype.applyConstraints;o.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(JSON.stringify(r)),remap(r,"autoGainControl","mozAutoGainControl"),remap(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function getdisplaymedia_shimGetDisplayMedia(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){if(!i||!i.video){const t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}return!0===i.video?i.video={mediaSource:r}:i.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(i)})}function firefox_shim_shimOnTrack(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function firefox_shim_shimPeerConnection(t,r){if("object"!=typeof t||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]}));const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){const[t,a,c]=arguments;return o.apply(this,[t||null]).then((t=>{if(r.version<53&&!a)try{t.forEach((t=>{t.type=i[t.type]||t.type}))}catch(r){if("TypeError"!==r.name)throw r;t.forEach(((r,o)=>{t.set(o,Object.assign({},r,{type:i[r.type]||r.type}))}))}return t})).then(a,c)}}function shimSenderGetStats(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function addTrack(){const t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function getStats(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t}),wrapPeerConnectionEvent(t,"track",(t=>(t.receiver._pc=t.srcElement,t))),t.RTCRtpReceiver.prototype.getStats=function getStats(){return this._pc.getStats(this.track)}}function shimRemoveStream(t){t.RTCPeerConnection&&!("removeStream"in t.RTCPeerConnection.prototype)&&(t.RTCPeerConnection.prototype.removeStream=function removeStream(t){deprecated("removeStream","removeTrack"),this.getSenders().forEach((r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)}))})}function shimRTCDataChannel(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function shimAddTransceiver(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function addTransceiver(){this.setParametersPromises=[];const t=arguments[1],i=t&&"sendEncodings"in t;i&&t.sendEncodings.forEach((t=>{if("rid"in t){if(!/^[a-z0-9]{0,16}$/i.test(t.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const o=r.apply(this,arguments);if(i){const{sender:r}=o,i=r.getParameters();(!("encodings"in i)||1===i.encodings.length&&0===Object.keys(i.encodings[0]).length)&&(i.encodings=t.sendEncodings,r.sendEncodings=t.sendEncodings,this.setParametersPromises.push(r.setParameters(i).then((()=>{delete r.sendEncodings})).catch((()=>{delete r.sendEncodings}))))}return o})}function shimGetParameters(t){if("object"!=typeof t||!t.RTCRtpSender)return;const r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function getParameters(){const t=r.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function shimCreateOffer(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function createOffer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>r.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):r.apply(this,arguments)}}function shimCreateAnswer(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function createAnswer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>r.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):r.apply(this,arguments)}}function shimLocalStreamsAPI(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach((i=>r.call(this,i,t))),t.getVideoTracks().forEach((i=>r.call(this,i,t)))},t.RTCPeerConnection.prototype.addTrack=function addTrack(t,...i){return i&&i.forEach((t=>{this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]})),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(-1===r)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach((t=>{i.includes(t.track)&&this.removeTrack(t)}))})}}function shimRemoteStreamsAPI(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function getRemoteStreams(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=t=>{t.streams.forEach((t=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(t))return;this._remoteStreams.push(t);const r=new Event("addstream");r.stream=t,this.dispatchEvent(r)}))})}});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach((r=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(r)>=0)return;t._remoteStreams.push(r);const i=new Event("addstream");i.stream=r,t.dispatchEvent(i)}))}),r.apply(t,arguments)}}}function shimCallbacksAPI(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.createOffer,o=r.createAnswer,a=r.setLocalDescription,c=r.setRemoteDescription,l=r.addIceCandidate;r.createOffer=function createOffer(t,r){const o=arguments.length>=2?arguments[2]:arguments[0],a=i.apply(this,[o]);return r?(a.then(t,r),Promise.resolve()):a},r.createAnswer=function createAnswer(t,r){const i=arguments.length>=2?arguments[2]:arguments[0],a=o.apply(this,[i]);return r?(a.then(t,r),Promise.resolve()):a};let withCallback=function(t,r,i){const o=a.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o};r.setLocalDescription=withCallback,withCallback=function(t,r,i){const o=c.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o},r.setRemoteDescription=withCallback,withCallback=function(t,r,i){const o=l.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o},r.addIceCandidate=withCallback}function safari_shim_shimGetUserMedia(t){const r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const t=r.mediaDevices,i=t.getUserMedia.bind(t);r.mediaDevices.getUserMedia=t=>i(shimConstraints(t))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function getUserMedia(t,i,o){r.mediaDevices.getUserMedia(t).then(i,o)}.bind(r))}function shimConstraints(t){return t&&void 0!==t.video?Object.assign({},t,{video:compactObject(t.video)}):t}function shimRTCIceServerUrls(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection;t.RTCPeerConnection=function RTCPeerConnection(t,i){if(t&&t.iceServers){const r=[];for(let i=0;i<t.iceServers.length;i++){let o=t.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,r.push(o)):r.push(t.iceServers[i])}t.iceServers=r}return new r(t,i)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>r.generateCertificate})}function shimTrackEventTransceiver(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(t){const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function createOffer(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const r=this.getTransceivers().find((t=>"audio"===t.receiver.track.kind));!1===t.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==t.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const i=this.getTransceivers().find((t=>"video"===t.receiver.track.kind));!1===t.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==t.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function shimAudioContext(t){"object"!=typeof t||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var p=i(539),g=i.n(p);function shimRTCIceCandidate(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const r=t.RTCIceCandidate;t.RTCIceCandidate=function RTCIceCandidate(t){if("object"==typeof t&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){const i=new r(t),o=g().parseCandidate(t.candidate),a=Object.assign(i,o);return a.toJSON=function toJSON(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new r(t)},t.RTCIceCandidate.prototype=r.prototype,wrapPeerConnectionEvent(t,"icecandidate",(r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"}),r)))}function shimMaxMessageSize(t,r){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const sctpInDescription=function(t){if(!t||!t.sdp)return!1;const r=g().splitSections(t.sdp);return r.shift(),r.some((t=>{const r=g().parseMLine(t);return r&&"application"===r.kind&&-1!==r.protocol.indexOf("SCTP")}))},getRemoteFirefoxVersion=function(t){const r=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===r||r.length<2)return-1;const i=parseInt(r[1],10);return i!=i?-1:i},getCanSendMaxMessageSize=function(t){let i=65536;return"firefox"===r.browser&&(i=r.version<57?-1===t?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),i},getMaxMessageSize=function(t,i){let o=65536;"firefox"===r.browser&&57===r.version&&(o=65535);const a=g().matchPrefix(t.sdp,"a=max-message-size:");return a.length>0?o=parseInt(a[0].substr(19),10):"firefox"===r.browser&&-1!==i&&(o=2147483637),o},i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){if(this._sctp=null,"chrome"===r.browser&&r.version>=76){const{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(sctpInDescription(arguments[0])){const t=getRemoteFirefoxVersion(arguments[0]),r=getCanSendMaxMessageSize(t),i=getMaxMessageSize(arguments[0],t);let o;o=0===r&&0===i?Number.POSITIVE_INFINITY:0===r||0===i?Math.max(r,i):Math.min(r,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this._sctp=a}return i.apply(this,arguments)}}function shimSendThrowTypeError(t){if(!t.RTCPeerConnection||!("createDataChannel"in t.RTCPeerConnection.prototype))return;function wrapDcSend(t,r){const i=t.send;t.send=function send(){const o=arguments[0],a=o.length||o.size||o.byteLength;if("open"===t.readyState&&r.sctp&&a>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return i.apply(t,arguments)}}const r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function createDataChannel(){const t=r.apply(this,arguments);return wrapDcSend(t,this),t},wrapPeerConnectionEvent(t,"datachannel",(t=>(wrapDcSend(t.channel,t.target),t)))}function shimConnectionState(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((t=>{const i=r[t];r[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=t=>{const r=t.target;if(r._lastConnectionState!==r.connectionState){r._lastConnectionState=r.connectionState;const i=new Event("connectionstatechange",t);r.dispatchEvent(i)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function removeExtmapAllowMixed(t,r){if(!t.RTCPeerConnection)return;if("chrome"===r.browser&&r.version>=71)return;if("safari"===r.browser&&r.version>=605)return;const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(r){if(r&&r.sdp&&-1!==r.sdp.indexOf("\na=extmap-allow-mixed")){const i=r.sdp.split("\n").filter((t=>"a=extmap-allow-mixed"!==t.trim())).join("\n");t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:i}):r.sdp=i}return i.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(t,r){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype.addIceCandidate;i&&0!==i.length&&(t.RTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(){return arguments[0]?("chrome"===r.browser&&r.version<78||"firefox"===r.browser&&r.version<68||"safari"===r.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(t,r){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype.setLocalDescription;i&&0!==i.length&&(t.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){let t=arguments[0]||{};if("object"!=typeof t||t.type&&t.sdp)return i.apply(this,arguments);if(t={type:t.type,sdp:t.sdp},!t.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}if(t.sdp||"offer"!==t.type&&"answer"!==t.type)return i.apply(this,[t]);const r="offer"===t.type?this.createOffer:this.createAnswer;return r.apply(this).then((t=>i.apply(this,[t])))})}const m=function adapterFactory({window:t}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=log,u=function detectBrowser(t){const r={browser:null,version:null};if(void 0===t||!t.navigator)return r.browser="Not a browser.",r;const{navigator:i}=t;if(i.mozGetUserMedia)r.browser="firefox",r.version=extractVersion(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)r.browser="chrome",r.version=extractVersion(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!t.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=extractVersion(i.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return r}(t),d={browserDetails:u,commonShim:l,extractVersion,disableLog,disableWarnings,sdp:p};switch(u.browser){case"chrome":if(!o||!shimPeerConnection||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),d;if(null===u.version)return i("Chrome shim can not determine version, not shimming."),d;i("adapter.js shimming chrome."),d.browserShim=o,shimAddIceCandidateNullOrEmpty(t,u),shimParameterlessSetLocalDescription(t),shimGetUserMedia(t,u),shimMediaStream(t),shimPeerConnection(t,u),shimOnTrack(t),shimAddTrackRemoveTrack(t,u),shimGetSendersWithDtmf(t),shimGetStats(t),shimSenderReceiverGetStats(t),fixNegotiationNeeded(t,u),shimRTCIceCandidate(t),shimConnectionState(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,u);break;case"firefox":if(!a||!firefox_shim_shimPeerConnection||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),d;i("adapter.js shimming firefox."),d.browserShim=a,shimAddIceCandidateNullOrEmpty(t,u),shimParameterlessSetLocalDescription(t),getusermedia_shimGetUserMedia(t,u),firefox_shim_shimPeerConnection(t,u),firefox_shim_shimOnTrack(t),shimRemoveStream(t),shimSenderGetStats(t),shimReceiverGetStats(t),shimRTCDataChannel(t),shimAddTransceiver(t),shimGetParameters(t),shimCreateOffer(t),shimCreateAnswer(t),shimRTCIceCandidate(t),shimConnectionState(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t);break;case"safari":if(!c||!r.shimSafari)return i("Safari shim is not included in this adapter release."),d;i("adapter.js shimming safari."),d.browserShim=c,shimAddIceCandidateNullOrEmpty(t,u),shimParameterlessSetLocalDescription(t),shimRTCIceServerUrls(t),shimCreateOfferLegacy(t),shimCallbacksAPI(t),shimLocalStreamsAPI(t),shimRemoteStreamsAPI(t),shimTrackEventTransceiver(t),safari_shim_shimGetUserMedia(t),shimAudioContext(t),shimRTCIceCandidate(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,u);break;default:i("Unsupported browser!")}return d}({window:"undefined"==typeof window?void 0:window}),y=m},941:(t,r,i)=>{t.exports=function Worker_fn(){return new Worker(i.p+"pdf.worker.js")}},67:t=>{"use strict";t.exports="data:font/ttf;base64,AAEAAAALAIAAAwAwT1MvMg8SDCIAAAC8AAAAYGNtYXCkzqBtAAABHAAAAJxnYXNwAAAAEAAAAbgAAAAIZ2x5ZidmXZ0AAAHAAAAPbGhlYWQb4iunAAARLAAAADZoaGVhB8ID2gAAEWQAAAAkaG10eFoAB1AAABGIAAAAZGxvY2ErdjCEAAAR7AAAADRtYXhwADoAywAAEiAAAAAgbmFtZUEbxNgAABJAAAABwnBvc3QAAwAAAAAUBAAAACAAAwPpAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADvDwPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAgAAAABwAEAADAAwAAQAg6Qjs+e0W7UPtT+1s7XLtf+477w///f//AAAAAAAg6QDs+e0W7UPtT+1s7XLtf+477wz//f//AAH/4xcEExQS+BLMEsESpRKgEpQR2REJAAMAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAAbAAD/qwQAA6sAAwAHAAsADwATABcAGwAfACMAJwArAC8AMwA3ADsAPwBDAEcASwBPAFMAVwBbAF8AYwBnAGsAABMhESEhMzUjBTM1IwczNSMHMzUjFzM1IwUzNSMRMzUjETM1IxEzNSM1MzUjETM1IxUzNSMVMzUjERUzNQczNSMHMzUjBzM1IwczNSMHMzUjETM1IzUzNSMRMzUjETM1IxEzNSM1MzUjETM1IwABLf7TAaY8PAGzNTVrNTXXNjZsNTUBQTw8PDw8PDw8PDw8PDw8PDw8pzU1azU1azU1bDY2cTw8PDw8PDw8PDw8PDw8PDwDq/wAPDw8PDw8PDw8PDwDDzz88TwBpjw8Pf7TPLU8tDwC0z09PT09PT09PT09Pfx4PD08AS08/tM8AS09PDz+WzwAAAAgAAD/qwQAA6sAAwAHAAsADwAUABgAHQAiACYAKgAuADIANgA6AD4AQgBGAEsAUABUAFgAXABgAGUAaQBtAHEAdQB5AH0AgQCFAAAXMxUjITM1IwczNSMHMzUjBzM1IxUjMzUjBzM1IxU7ATUjFSEzNSMRMzUjFTM1IxEzNSMRMzUjNTM1IzUzNSMRMzUjERUzNQUzNSMVIzM1IxUhMzUjBzM1IwczNSMFMzUjBTM1IxUhMzUjETM1IxUzNSM1MzUjETM1IxEzNSMRMzUjETM1IwA8PANLPT14PDx5PT14PDx5PT3xPT15PDwC0zw8PDw8PDw8PDw8PDw8PDw8/PE8PHk9PQJbPDx5PT3xPT0B4j09/pc8PP4ePDw8PDw8PDw8PDw8PDw8PBk8PDw8PDw8PDw8PDw8PDw8AS08tDwBpT3+0zw8PLU8/PE8A0w9PT09PT09PT09PT09PT09PT388Ty1PLU8AS09/tM8AS08/tM8AAAbAAD/qwQAA6sAAwAHAAsAEAAUABgAHAAgACQAKAAsADAANAA4ADwAQABEAEkATgBSAFYAWgBeAGIAZgBqAG4AAAERIREDMzUjBzM1IwUzNSMVOwE1IxczNSMFMzUjETM1IxEzNSMRMzUjNTM1IxEzNSMVMzUjETM1IzUzNSMhIxUzJyMVMycjFTM1MyMVMzUFMzUjETM1IzUzNSM1MzUjFTM1IxEzNSMVMzUjNTM1IwQA/tO1PDxrNjb+vzU1azU1azY2/rg8PDw8PDw8PDw8PDw8PDw8PDwB6TY2bDU11jU1azU1AQw8PDw8PDw8PDw8PDw8PDw8A6v8AAQA/AA8PDw8PDw8PDw8PAGmPAEtPP3iPLU8/ls8tTwCHj20PT09PT09PT09PT38eDw9PLU8tTwBLT21PLU8AAAAAQDiAQ0DHgJJABMAABMBFjI3ATY0JyYiDwEnJiIHBhQX4gEADCQMAQANDQwkDOLiDCQMDQ0CDf8ADQ0BAAwjDQwM4uIMDA0jDAAAAAEA4gENAx4CSQATAAAJASYiBwEGFBcWMj8BFxYyNzY0JwMe/wAMJAz/AA0NDCQM4uIMJAwNDQFJAQAMDP8ADSMMDQ3h4Q0NDCMNAAAEAFUAAAOrA1UAHAA4AFQAcQAAASMiBgcOAR0BFBYzMjY9ATQ2Nz4BOwEyNjU0JiMBNTQmJy4BKwEiBhUUFjsBMhYXHgEdARQWMzI2ATMyNjc+AT0BNCYjIgYdARQGBw4BKwEiBhUUFgEVFBYXHgE7ATI2NTQmKwEiJicuAT0BNCYjIgYVAVWAGi8RERUZEhIZBgYGEAiAEhkZEgJWFBIRLxqAEhkZEoAIEAYGBhkSEhn/AIAaLxERFRkSEhkGBgYQCIASGRn9vBQSES8agBIZGRKACBAGBgYZEhIZA1UUERIuG4ARGRkRgAkQBQYHGRIRGf8AgBsvEREUGRESGQcGBRAJgBEZGf28FBIRLxqAEhkZEoAJDwYGBxkREhkBAIAaLxESFBkSERkHBgYPCYASGRkSAAQAVQAAA6sDVQAcADkAVQBxAAABFRQGBw4BKwEiBhUUFjsBMjY3PgE9ATQmIyIGFQUjIiYnLgE9ATQmIyIGHQEUFhceATsBMjY1NCYjAzU0Njc+ATsBMjY1NCYrASIGBw4BHQEUFjMyNiUzMhYXHgEdARQWMzI2PQE0JicuASsBIgYVFBYBKwcGBg8JgBIZGRKAGi8REhQZEhEZAlWACQ8GBgcZERIZFBIRLxqAEhkZEqsHBgYPCYASGRkSgBovERIUGRIRGf2rgAkPBgYHGRESGRQSES8agBIZGQMrgAkQBQYHGRIRGRQREi4bgBEZGRGrBwYFEAmAERkZEYAbLxERFBkREhn9q4AIEAYGBhkSEhkUEhEvGoASGRm8BgYGEAiAEhkZEoAaLxERFRkSEhkAAAAAAQDiAI0DHgLJACAAABMXBwYUFxYyPwEXFjI3NjQvATc2NCcmIg8BJyYiBwYUF+Li4g0NDCQM4uIMJAwNDeLiDQ0MJAzi4gwkDA0NAo3i4g0jDA0N4eENDQwjDeLiDCMNDAzi4gwMDSMMAAAAAgCAACsDdwMrACYAPwAAJSc+ATU0Jy4BJyYjIgcOAQcGFRQXHgEXFjMyNjcXHgEzMjY3NjQnJSImJy4BNTQ2Nz4BMzIWFx4BFRQGBw4BIwN31iAjGBhTODdAPzg4UxgYGBhTODg/N2Mn1AUNBgYMBQoJ/jswWCIiJCQiIlgwMFgiIiUlIiJYMGLYJ2I2Pzg4UxgYGBhTODg/QDc4UxgYJCDWBQUEBQkbCqYlIiJYMDBYISMkJCMiVzAwWCIiJQAAAwAAACsDdwMrAAcADQAZAAABMxEjJyMRMzcHIxEzFwEXBycHJzcnNxc3FwFSLi3Ak5Kukm5tkwGtiSyKiS2IiCyKiS0DK/0AwAGAUpL/AJMBE4otiYktioktiYktAAAAAwCAACsDgAMrAAMABgAJAAABMxEjIREBAREBA0BAQP1AAiD+IAFxAyv9AAMA/oABBP33AQUAAAACAED/qwOAA6sAAgAIAAABIzUBESERIREDbe0BAPzAAgACq+3+0/1ABAD+wAAAAAACAUAAKwLAAysAAwAHAAABMxEjAREjEQFAQEABgEADK/0AAwD9AAMAAAAAAAIBAP/rA4ADawACAAUAAAkBERMJAQOA/YBAAdD+MAGr/kADgPz7AUUBRQAAAwAA/6sEAAOrAFoAXQBgAAABFAcGBwYHBgczFSERMxU2NzY3Njc2NTQnJicmJyYnJicmIyIHBgcGBwYHBgcGFRQXFhcWFxYXByYnJicmJyYnJicmNTQ3Njc2NzY3Njc2MzIXFhcWFxYXFhcWDQEREzcnBAASEyIjMTE9if8AQDowLyEhExIQEB0dKSkyMjk5Pj06OTIxKSkeHRAQGBgrLDw9SBA3MjEqKSIhGBcMDRISIiEvLzk4QkFHRkJBOTkvLiIhExL/AP6AQMDAAatGQkI6OjEwIUABAJMbKis0NTw9QT05OjEyKSkdHhAQEBAeHSkpMjE6OT1LRkU5OSoqFD0PGxokIywsMjE3NjpGQkE5OS4vIiESExMSISIvLjk5QUJG3gG7/rRvbwAAAwCAACsDgAMrAAMABgAJAAA3ETMREwERJxEBgECgAiBA/o8rAwD9AAGAAYD9AHsCCf78AAYAAP/rA8ADqwAvAF8AgACQAKAAyAAAATIXFhcWFxYXFhcWFRQHBgcGBwYHBgcGIyInJicmJyYnJicmNTQ3Njc2NzY3Njc2EzI3Njc2NzY3Njc2NTQnJicmJyYnJicmIyIHBgcGBwYHBgcGFRQXFhcWFxYXFhcWExYVFAcGBwYHBiMiJyYnJicmNTQ3Njc2NzYzMhcxNxcHBzI3NjU0JyYjIgcGFRQXFiUWFxYVFAcGByc2NzY1NCcnJiMiBwYHBgcGBwYHBhUUFxYXByYnJjU0NzY3Njc2NzY3NjMyFxYXAeBCPT02NSwsHx8SERERIB8sKzY1Pj1CQj09NjUsLB8fEhERESAfLCs2NT49Qjk1NS8uJiYbGw8PDw8bGyYmLi41NTo5NTUvLiYmGxsPDw8PGxsmJi4uNTWQCgcIDQ0REhQUERINDQcIBwgNDRESFBYUty23Vw0JCgkKDQ0JCgkKAU0PCAgaGjItKBYWGpA5PigkJSAgGhoTEgsKFhYoLTIaGwwNFxcgICcnLS0xJSUkIgOrEhEfHywsNTY9PUJCPj01NiwrIB8RERERHyArLDY1PT5CQj09NjUsLB8fERL8gA8PGxsmJi4uNTU6OTU1Li8mJhsbDw8PDxsbJiYvLjU1OTo1NS4uJiYbGw8PAcoUFhQSEQ0NCAcHCA0NERIUFBESDQ0HCAq4LbhJCQoNDQkKCgkNDQoJsCIlJCVGQUExLSk0NDk+OpAaCwoTExoaICAlJSc6NTQpLTJAQEcwLS0nJyAgFxcMDQgIDwAAAAACAAAAKwGAAysABwANAAABMxEjJyMRMxMRByMRMwFSLi3Ak5Kukm5tAyv9AMABgP4tAiWS/wAAAAMAAAArAoADKwARABkAHwAAARYXFhUUBwYHJzY3NjU0JyYnJzMRIycjETM3ByMRMxcCNSQUExMTJS0bDg8ODxu1LS3Ak5Kukm5tkwJgJS4vMzQuLyQtGyMjJyYjJBv4/QDAAYBSkv8AkwAAAAQAAAArA0ADKwARACMAKwAxAAABFhcWFRQHBgcnNjc2NTQnJicHFhcWFRQHBgcnNjc2NTQnJicnMxEjJyMRMzcHIxEzFwK9PyIiIiI/LTYdHR0dNlskFBMTEyUtGw4PDg8btS0twJOSrpJubZMC6EBSUVpaUlFALTdGRk1NRkY2WiUuLzM0Li8kLRsjIycmIyQb+P0AwAGAUpL/AJMAAAAFAAD/5gQAA28AIQAzAEUATQBTAAABFhcWFxYXFhUUBwYHBgcGByc2NzY3Njc2NTQnJicmJyYnExQHBgcnNjc2NTQnJic3FhcWJRYXFhUUBwYHJzY3NjU0JyYnJzMRIycjETM3ByMRMxcDRC0jIxgYDA0MDRgXIyMtLiggHxYVCwsKCxYVIB8pKSIiPy02HR0dHTYtPyIi/vUkFBMTEyUtGw4PDg8btS0twJOSrpJubZMDby00NTk6Pj4/QD4+OTo0NS0uKC8wMzQ4Nzo5ODc0NC8vKf5pWlJRQC03RkZNTUZGNi5AUlFbJS4vMzQuLyQtGyMjJyYjJBv4/QDAAYBSkv8AkwAAAAABAAAAAQAAssE0J18PPPUACwQAAAAAANxhc6oAAAAA3GFzqgAA/6sEAAOrAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAQAAAEAAAAAAAAAAAAAAAAAAAAZBAAAAAAAAAAAAAAAAgAAAAQAAAAEAAAABAAAAAQAAOIEAADiBAAAVQQAAFUEAADiBAAAgAQAAAAEAACABAAAQAQAAUAEAAEABAAAAAQAAIAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAACgAUAB4AugF0AhICOAJeAvgDkgPIBCgEWAR0BIwEogS4BU4FaAaQBqwG4gcyB7YAAQAAABkAyQAgAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAwAAAABAAAAAAACAAcAjQABAAAAAAADAAwARQABAAAAAAAEAAwAogABAAAAAAAFAAsAJAABAAAAAAAGAAwAaQABAAAAAAAKABoAxgADAAEECQABABgADAADAAEECQACAA4AlAADAAEECQADABgAUQADAAEECQAEABgArgADAAEECQAFABYALwADAAEECQAGABgAdQADAAEECQAKADQA4HBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMHBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac3BsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcnBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},424:t=>{"use strict";t.exports='player-controls {\r\n\twidth: 100%;\r\n}\r\n\r\n#controlContainer {\r\n\t--seek-before-width: 0%;\r\n\t--volume-before-width: 100%;\r\n\t--buffered-width: 0%;\r\n\twidth: 100%;\r\n\tposition: relative;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\r\n\tbackground-color: rgba(233, 236, 239, 0.8);\r\n\tborder-radius: 0.333em;\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n}\r\n#controlContainer::before {\r\n\tposition: absolute;\r\n\tcontent: \'\';\r\n\tz-index: -1;\r\n}\r\n#controlContainer path {\r\n    stroke: #007db5;\r\n}\r\n\r\n#controlContainer button {\r\n\tpadding: 0;\r\n\tborder: 0;\r\n\tbackground: transparent;\r\n\tborder-radius: 0.333em;\r\n\tcursor: pointer;\r\n\toutline: none;\r\n\tmin-width: 40px;\r\n\twidth: 40px;\r\n\tmin-height: 40px;\r\n\theight: 40px;\r\n\tfont-size: 1.25em;\r\n}\r\n#controlContainer button:hover {\r\n\tcolor: rgba(0, 125, 181, 1);\r\n\tbackground-color: rgba(222, 226, 230, 0.9);\r\n}\r\n#controlContainer button.selected {\r\n\tbackground-color: rgba(0, 125, 181, 1);\r\n}\r\n#controlContainer button.selected:hover {\r\n\tbackground-color: rgba(0, 125, 181, 0.8);\r\n}\r\n#controlContainer button.active {\r\n\tcolor: rgba(0, 125, 181, 1);\r\n}\r\n#controlContainer button.active:hover {\r\n\tcolor: rgba(0, 125, 181, 0.8);\r\n}\r\n#controlContainer button.selected path {\r\n\tcolor: #F9FAFB;\r\n\tstroke: #F9FAFB;\r\n}\r\n#controlContainer #raiseHandButton button.active {\r\n\tbackground-color: rgba(25, 135, 84, 1);\r\n}\r\n#controlContainer #raiseHandButton button.active:hover {\r\n\tbackground-color: rgba(255, 193, 7, 1);\r\n}\r\n#controlContainer #raiseHandButton button.active path {\r\n\tstroke: #F9FAFB;\r\n}\r\n#controlContainer button svg {\r\n\twidth: 23px;\r\n\theight: 23px;\r\n\tvertical-align: text-bottom;\r\n}\r\n#controlContainer #settingsButton path {\r\n\tstroke: #212529;\r\n}\r\n#controlContainer #playMediaButton {\r\n\tbackground-color: #FECACA;\r\n}\r\n#controlContainer #playMediaButton:hover {\r\n\tbackground-color: #FEE2E2;\r\n}\r\n#controlContainer #showQuizButton {\r\n\tcolor: #15803D;\r\n}\r\n#controlContainer .pulse {\r\n\t--animation-color: #15803D;\r\n\tanimation: button-pulse 2s 5;\r\n\tz-index: 10;\r\n}\r\n#controlContainer .pulse-infinite {\r\n\t--animation-color: #007db5;\r\n\tanimation: button-pulse 2s infinite;\r\n\tz-index: 10;\r\n}\r\n\r\n\r\n\r\n#controlContainer .control-bar {\r\n\twidth: 100%;\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\talign-items: center;\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n}\r\n#controlContainer .control-bar .col {\r\n\tflex: 1;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n#controlContainer .control-bar .nav-left {\r\n\tflex: 1;\r\n\tjustify-content: flex-start;\r\n}\r\n#controlContainer .control-bar .nav-center {\r\n\tflex: 1;\r\n\tjustify-content: center;\r\n}\r\n#controlContainer .control-bar .nav-right {\r\n\tflex: 1;\r\n\tjustify-content: flex-end;\r\n}\r\n\r\n#controlContainer #volumeSlider {\r\n    margin: 10px 2.5%;\r\n    width: 150px;\r\n}\r\n#controlContainer #volumeSlider::-webkit-slider-runnable-track {\r\n    background: rgba(0, 125, 181, 0.6);\r\n}\r\n#controlContainer #volumeSlider::-moz-range-track {\r\n    background: rgba(0, 125, 181, 0.6);\r\n}\r\n#controlContainer #volumeSlider::-ms-fill-upper {\r\n    background: rgba(0, 125, 181, 0.6);\r\n}\r\n#controlContainer #volumeSlider::before {\r\n    width: var(--volume-before-width);\r\n}\r\n#controlContainer #volumeIndicator {\r\n    margin: 0 0;\r\n}\r\n#controlContainer input[type="range"] {\r\n    position: relative;\r\n    -webkit-appearance: none;\r\n    width: 48%;\r\n    margin: 0;\r\n    padding: 0;\r\n    height: 19px;\r\n    margin: 30px 2.5% 20px 2.5%;\r\n    float: left;\r\n    outline: none;\r\n\tbackground: transparent;\r\n}\r\n#controlContainer input[type="range"]::-webkit-slider-runnable-track {\r\n    width: 100%;\r\n    height: 3px;\r\n    cursor: pointer;\r\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\r\n}\r\n#controlContainer input[type="range"]::before {\r\n    position: absolute;\r\n    content: "";\r\n    top: 8px;\r\n    left: 0;\r\n    width: var(--seek-before-width);\r\n    height: 3px;\r\n    background-color: #007db5;\r\n    cursor: pointer;\r\n}\r\n#controlContainer input[type="range"]::-webkit-slider-thumb {\r\n    position: relative;\r\n    -webkit-appearance: none;\r\n    box-sizing: content-box;\r\n    border: 1px solid #007db5;\r\n    height: 15px;\r\n    width: 15px;\r\n    border-radius: 50%;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n    margin: -7px 0 0 0;\r\n}\r\n#controlContainer input[type="range"]:active::-webkit-slider-thumb {\r\n    transform: scale(1.2);\r\n    background: #007db5;\r\n}\r\n#controlContainer input[type="range"]::-moz-range-track {\r\n    width: 100%;\r\n    height: 3px;\r\n    cursor: pointer;\r\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\r\n}\r\n#controlContainer input[type="range"]::-moz-range-progress {\r\n    background-color: #007db5;\r\n}\r\n#controlContainer input[type="range"]::-moz-focus-outer {\r\n    border: 0;\r\n}\r\n#controlContainer input[type="range"]::-moz-range-thumb {\r\n    box-sizing: content-box;\r\n    border: 1px solid #007db5;\r\n    height: 15px;\r\n    width: 15px;\r\n    border-radius: 50%;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n}\r\n#controlContainer input[type="range"]:active::-moz-range-thumb {\r\n    transform: scale(1.2);\r\n    background: #007db5;\r\n}\r\n#controlContainer input[type="range"]::-ms-track {\r\n    width: 100%;\r\n    height: 3px;\r\n    cursor: pointer;\r\n    background: transparent;\r\n    border: solid transparent;\r\n    color: transparent;\r\n}\r\n#controlContainer input[type="range"]::-ms-fill-lower {\r\n    background-color: #007db5;\r\n}\r\n#controlContainer input[type="range"]::-ms-fill-upper {\r\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\r\n}\r\n#controlContainer input[type="range"]::-ms-thumb {\r\n    box-sizing: content-box;\r\n    border: 1px solid #007db5;\r\n    height: 15px;\r\n    width: 15px;\r\n    border-radius: 50%;\r\n    background-color: #fff;\r\n    cursor: pointer;\r\n}\r\n#controlContainer input[type="range"]:active::-ms-thumb {\r\n    transform: scale(1.2);\r\n    background: #007db5;\r\n}\r\n\r\n\r\n@-webkit-keyframes button-pulse {\r\n\t0% {\r\n\t\t-webkit-box-shadow: 0 0 0 0 var(--animation-color);\r\n\t}\r\n\t70% {\r\n\t\t-webkit-box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);\r\n\t}\r\n\t100% {\r\n\t\t-webkit-box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\r\n\t}\r\n}\r\n@keyframes button-pulse {\r\n\t0% {\r\n\t\t-moz-box-shadow: 0 0 0 0 var(--animation-color);\r\n\t\tbox-shadow: 0 0 0 0 var(--animation-color);\r\n\t}\r\n\t70% {\r\n\t\t-moz-box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);\r\n\t\tbox-shadow: 0 0 0 10px rgba(0, 0, 0, 0);\r\n\t}\r\n\t100% {\r\n\t\t-moz-box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\r\n\t\tbox-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\r\n\t}\r\n}'},151:t=>{"use strict";t.exports='<div id="controlContainer">\r\n\t<div class="control-bar">\r\n\t\t<div class="col nav-left">\r\n\t\t\t<button id="volumeIndicator"></button>\r\n\t\t\t<input type="range" id="volumeSlider" class="d-sm-block d-none" max="100" value="100">\r\n\t\t\t<span id="duration" class="ps-1"></span>\r\n\t\t</div>\r\n\t\t<div class="col nav-center">\r\n\t\t\t<button id="raiseHandButton">\r\n\t\t\t\t<svg viewBox="0 0 512 512">\r\n\t\t\t\t\t<path d="M80 320V144a32 32 0 0132-32h0a32 32 0 0132 32v112M144 256V80a32 32 0 0132-32h0a32 32 0 0132 32v160M272 241V96a32 32 0 0132-32h0a32 32 0 0132 32v224M208 240V48a32 32 0 0132-32h0a32 32 0 0132 32v192" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>\r\n\t\t\t\t\t<path d="M80 320c0 117.4 64 176 152 176s123.71-39.6 144-88l52.71-144c6.66-18.05 3.64-34.79-11.87-43.6h0c-15.52-8.82-35.91-4.28-44.31 11.68L336 320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t\t<button class="invisible" id="showQuizButton">\r\n\t\t\t\t<svg stroke-width="0.1" fill="currentColor" stroke="currentColor" viewBox="0 0 16 16">\r\n\t\t\t\t\t<path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" fill="currentColor" stroke="currentColor"/>\r\n\t\t\t\t\t<path d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0zM7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z" fill="currentColor" stroke="currentColor"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\r\n\t\t\t<button class="invisible" id="playMediaButton">\r\n\t\t\t\t<svg viewBox="0 0 512 512">\r\n\t\t\t\t\t<path d="M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class="col nav-right">\r\n\t\t\t<button id="chatButton" class="bi bi-chat-text invisible" data-bs-toggle="button"></button>\r\n\t\t\t<button id="settingsButton" class="bi bi-gear"></button>\r\n\t\t\t<button id="fullscreenButton" class="bi bi-fullscreen"></button>\r\n\t\t</div>\r\n\t</div>\r\n</div>'},77:t=>{"use strict";t.exports="player-view {\r\n\tbackground-color: #f8f9fa;\r\n\tdisplay: flex;\r\n\tflex-grow: 1;\r\n\tflex-direction: column;\r\n}\r\nplayer-view > .player-container {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n}\r\nplayer-view .slide-container {\r\n\tdisplay: flex;\r\n\tflex-grow: 1;\r\n\tflex-direction: column;\r\n}\r\nplayer-view .feed-container {\r\n\tdisplay: flex;\r\n\tflex-grow: 0;\r\n\tflex-direction: column;\r\n}\r\nplayer-view .right-container {\r\n\tbackground-color: rgba(233, 236, 239, 0.8);\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tpadding: 0.5em 0.5em;\r\n\tmargin-left: 0.5em;\r\n}\r\nplayer-view slide-view {\r\n\tflex-grow: 1;\r\n}\r\nplayer-view .feed-container video {\r\n\tborder: 2px solid #94A3B8;\r\n\tmax-width: 15em;\r\n\tmax-height: 9em;\r\n}\r\nplayer-view .chat-container > * {\r\n\tmin-width: 15em;\r\n}\r\nplayer-view .invisible {\r\n\tdisplay: none;\r\n}\r\n\r\ntextarea[id=messageTextarea] {\r\n\tresize: none;\r\n\tborder-radius: 0;\r\n}\r\ntextarea[id=messageTextarea]:focus {   \r\n\tborder-color: #86b7fe;\r\n\toutline: 0;\r\n\tbox-shadow: 0 0 0 -0.25rem rgba(13, 110, 253, 0.25);\r\n}\r\n\r\n#chatModal .modal-body {\r\n\tpadding: 0;\r\n}\r\n#chatModal .modal-footer {\r\n\tborder-top: 0;\r\n}\r\n\r\n\r\n@media (max-width: 576px) {\r\n\tplayer-view .feed-container video {\r\n\t\tborder: 2px solid #94A3B8;\r\n\t\tmax-width: 10em;\r\n\t\tmax-height: 5em;\r\n\t}\r\n}"},628:t=>{"use strict";t.exports='<div class="d-flex flex-column flex-sm-row h-100 bg-light p-2" id="playerContainer">\r\n\t<div class="order-sm-0 order-2 d-flex flex-column h-100 w-100">\r\n\t\t<div class="d-flex flex-row h-100 w-100">\r\n\t\t\t<div class="d-flex h-100 w-100 pb-1 px-1">\r\n\t\t\t\t<div class="d-flex h-100 w-100" id="slideContainer">\r\n\t\t\t\t\t<slide-view class="d-flex h-100 w-100" id="slideView"></slide-view>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="w-100 d-flex align-items-end">\r\n\t\t\t<player-controls id="playerControls"></player-controls>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="d-flex flex-column bg-white" id="rightContainer">\r\n\t\t<div class="order-sm-2 order-1 d-flex flex-row flex-sm-column" id="videoFeedContainer">\r\n\t\t\t<div class="feed-container invisible" id="localVideoFeedContainer">\r\n\t\t\t\t<video id="localVideoFeed" autoplay playsinline muted></video>\r\n\t\t\t</div>\r\n\t\t\t<div class="feed-container invisible" id="mainVideoFeedContainer">\r\n\t\t\t\t<video id="videoFeed" autoplay playsinline></video>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="order-sm-last order-last mt-auto d-flex flex-row d-none d-sm-block chat-container" id="chatContainer">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class="modal fade" id="chatModal" tabindex="-1" aria-labelledby="chatModalLabel" aria-hidden="true">\r\n\t<div class="modal-dialog">\r\n\t\t<div class="modal-content">\r\n\t\t\t<div class="modal-header">\r\n\t\t\t\t<div class="modal-title" id="chatModalLabel">Chat</div>\r\n\t\t\t\t<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-body">\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<button type="button" class="btn btn-outline-secondary btn-sm" data-bs-dismiss="modal">Schließen</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class="modal fade" id="entry-modal" aria-hidden="true" aria-labelledby="entryModalLabel" tabindex="-1">\r\n\t<div class="modal-dialog">\r\n\t\t<div class="modal-content">\r\n\t\t\t<div class="modal-header">\r\n\t\t\t\t<div class="modal-title" id="chatModalLabel">Medienwiedergabe Starten</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-body">\r\n\t\t\t\t<label class="form-label" id="entry-modal-label">Um Audio und Video wiederzugeben, klicken Sie auf &#171;Starten&#187;.</label>\r\n\t\t\t</div>\r\n\t\t\t<div class="modal-footer">\r\n\t\t\t\t<button type="button" class="btn btn-outline-primary btn-sm" data-bs-dismiss="modal">Starten</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'},486:t=>{"use strict";t.exports=".slide-view {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tmin-height: 1px;\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\toverflow: hidden;\r\n\tposition: relative;\r\n\ttext-align: center;\r\n\tbox-sizing: border-box;\r\n\tdisplay: flex !important;\r\n\talign-items: center !important;\r\n\tjustify-content: center !important;\r\n}\r\n.slide-view > canvas {\r\n\tposition: absolute;\r\n\ttransform: translate(-50%, 0);\r\n\tleft: 50%;\r\n\tborder: 1px solid #94A3B8;\r\n\tborder-radius: 0.2em;\r\n}\r\n.slide-view .slide-canvas {\r\n\tvisibility: hidden;\r\n\tz-index: 0;\r\n}\r\n.slide-view .action-canvas {\r\n\tz-index: 1;\r\n}\r\n.slide-view .volatile-canvas {\r\n\tz-index: 2;\r\n}\r\n\r\n.text-layer {\r\n\tposition: absolute;\r\n\ttransform: translate(0, -50%);\r\n\ttop: 50%;\r\n\toverflow: hidden;\r\n\topacity: 0.2;\r\n\tline-height: 1;\r\n\tmargin: 0 auto;\r\n\tz-index: 3;\r\n}\r\n.text-layer > span {\r\n\tcolor: transparent;\r\n\tposition: absolute;\r\n\twhite-space: pre;\r\n\tcursor: text;\r\n\ttransform-origin: 0% 0%;\r\n}\r\n.text-layer .highlight {\r\n\tmargin: -1px;\r\n\tpadding: 1px;\r\n\tbackground-color: rgba(180, 0, 170, 1);\r\n\tborder-radius: 4px;\r\n}\r\n.text-layer .highlight.begin {\r\n\tborder-radius: 4px 0 0 4px;\r\n}\r\n.text-layer .highlight.end {\r\n\tborder-radius: 0 4px 4px 0;\r\n}\r\n.text-layer .highlight.middle {\r\n\tborder-radius: 0;\r\n}\r\n.text-layer .highlight.selected {\r\n\tbackground-color: rgba(0, 100, 0, 1);\r\n}\r\n.text-layer ::-moz-selection {\r\n\tbackground: rgba(0, 0, 255, 1);\r\n}\r\n.text-layer ::selection {\r\n\tbackground: rgba(0, 0, 255, 1);\r\n}\r\n.text-layer .endOfContent {\r\n\tdisplay: block;\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 100%;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tz-index: -1;\r\n\tcursor: default;\r\n\t-webkit-user-select: none;\r\n\t   -moz-user-select: none;\r\n\t\t-ms-user-select: none;\r\n\t\t\tuser-select: none;\r\n}\r\n.text-layer .endOfContent.active {\r\n\ttop: 0;\r\n}\r\n\r\n.annotationLayer section {\r\n\tposition: absolute;\r\n\tz-index: 4;\r\n}\r\n.annotationLayer .linkAnnotation > a {\r\n\tposition: absolute;\r\n\tfont-size: 1em;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tcursor: pointer;\r\n}\r\n.annotationLayer .linkAnnotation > a:hover {\r\n\tbackground: #ff0;\r\n}"},225:t=>{"use strict";t.exports='<div class="slide-view">\r\n\t<canvas class="slide-canvas"></canvas>\r\n\t<canvas class="action-canvas" scale="full"></canvas>\r\n\t<canvas class="volatile-canvas" scale="full"></canvas>\r\n\t<div class="text-layer"></div>\r\n</div>'},414:()=>{},172:()=>{},1:()=>{},779:()=>{},558:()=>{},258:()=>{}},__webpack_module_cache__={};function __webpack_require__(t){var r=__webpack_module_cache__[t];if(void 0!==r)return r.exports;var i=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(t,r)=>{for(var i in r)__webpack_require__.o(r,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;__webpack_require__.g.importScripts&&(t=__webpack_require__.g.location+"");var r=__webpack_require__.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var i=r.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=t})(),__webpack_require__.nc=void 0;var __webpack_exports__={};return(()=>{"use strict";function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,r,i){return r&&_defineProperties(t.prototype,r),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,r,i){return r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LecturePlayer:()=>Hn,PlayerView:()=>q,WebPlayerControls:()=>M,WebSlideView:()=>H});var t=__webpack_require__(379),r=__webpack_require__.n(t),i=__webpack_require__(576),o={insert:"head",singleton:!1};r()(i.Z,o);i.Z.locals;Array.prototype.equals&&console.warn("Overriding existing Array.prototype.equals."),Array.prototype.equals=function(t){if(!t)return!1;if(this===t)return!0;if(this.length!=t.length)return!1;for(var r=0,i=this.length;r<i;r++)if(this[r]instanceof Array&&t[r]instanceof Array){if(!this[r].equals(t[r]))return!1}else if(this[r]!=t[r])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1});var a=function(){function Point(t,r){_classCallCheck(this,Point),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),this.x=t,this.y=r}return _createClass(Point,[{key:"set",value:function set(t,r){return this.x=t,this.y=r,this}},{key:"distance",value:function distance(t){var r=t.x-this.x,i=t.y-this.y;return Math.sqrt(r*r+i*i)}},{key:"add",value:function add(t){return this.x+=t.x,this.y+=t.y,this}},{key:"subtract",value:function subtract(t){return this.x-=t.x,this.y-=t.y,this}},{key:"multiply",value:function multiply(t){return this.x*=t,this.y*=t,this}},{key:"normalize",value:function normalize(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return this.x/=t,this.y/=t,this}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y)}}]),Point}(),c=function(){function Transform(t){_classCallCheck(this,Transform),_defineProperty(this,"m",void 0),this.m=t?t.slice(0,6):[1,0,0,1,0,0]}return _createClass(Transform,[{key:"getScaleX",value:function getScaleX(){return this.m[0]}},{key:"getScaleY",value:function getScaleY(){return this.m[3]}},{key:"getShearX",value:function getShearX(){return this.m[1]}},{key:"getShearY",value:function getShearY(){return this.m[2]}},{key:"getTranslateX",value:function getTranslateX(){return this.m[4]}},{key:"getTranslateY",value:function getTranslateY(){return this.m[5]}},{key:"clone",value:function clone(){return new Transform(this.m)}},{key:"reset",value:function reset(){this.setValues(1,0,0,1,0,0)}},{key:"setTransform",value:function setTransform(t){this.m[0]=t.getScaleX(),this.m[1]=t.getShearX(),this.m[2]=t.getShearY(),this.m[3]=t.getScaleY(),this.m[4]=t.getTranslateX(),this.m[5]=t.getTranslateY()}},{key:"setValues",value:function setValues(t,r,i,o,a,c){this.m[0]=t,this.m[1]=r,this.m[2]=i,this.m[3]=o,this.m[4]=a,this.m[5]=c}},{key:"invert",value:function invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);this.m[0]=this.m[3]*t,this.m[1]=-this.m[1]*t,this.m[2]=-this.m[2]*t,this.m[3]=this.m[0]*t,this.m[4]=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),this.m[5]=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5])}},{key:"multiply",value:function multiply(t){this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=this.m[1]*t.m[0]+this.m[3]*t.m[1],this.m[2]=this.m[0]*t.m[2]+this.m[2]*t.m[3],this.m[3]=this.m[1]*t.m[2]+this.m[3]*t.m[3],this.m[4]=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],this.m[5]=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5]}},{key:"rotate",value:function rotate(t){var r=Math.cos(t),i=Math.sin(t);this.m[0]=this.m[0]*r+this.m[1]*i,this.m[1]=this.m[0]*-i+this.m[1]*r,this.m[2]=this.m[2]*r+this.m[3]*i,this.m[3]=this.m[2]*-i+this.m[3]*r}},{key:"scale",value:function scale(t,r){this.m[0]*=t,this.m[1]*=t,this.m[2]*=r,this.m[3]*=r}},{key:"translate",value:function translate(t,r){this.m[4]+=this.m[0]*t+this.m[2]*r,this.m[5]+=this.m[1]*t+this.m[3]*r}},{key:"transformPoint",value:function transformPoint(t,r){var i=t,o=r;return t=i*this.m[0]+o*this.m[2]+this.m[4],r=i*this.m[1]+o*this.m[3]+this.m[5],new a(t,r)}},{key:"equals",value:function equals(t){return!!t&&this.m.equals(t.m)}},{key:"toString",value:function toString(){return"["+this.m.join(", ")+"]"}}]),Transform}(),l=CanvasRenderingContext2D.prototype.getTransform;if(CanvasRenderingContext2D.prototype.getTransformExt=function(){if(l){var t=l.apply(this,Array.from(arguments));this._transform_ext||(this._transform_ext=new c),this._transform_ext.setValues(t.a,t.b,t.c,t.d,t.e,t.f)}return this._transform_ext},!l){var u=CanvasRenderingContext2D.prototype.resetTransform,d=CanvasRenderingContext2D.prototype.rotate,h=CanvasRenderingContext2D.prototype.scale,p=CanvasRenderingContext2D.prototype.setTransform,g=CanvasRenderingContext2D.prototype.transform,m=CanvasRenderingContext2D.prototype.translate,y=CanvasRenderingContext2D.prototype.save,v=CanvasRenderingContext2D.prototype.restore;CanvasRenderingContext2D.prototype.resetTransform=function(){u&&u.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.reset()},CanvasRenderingContext2D.prototype.rotate=function(t){d&&d.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.rotate(t)},CanvasRenderingContext2D.prototype.scale=function(t,r){h&&h.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.scale(t,r)},CanvasRenderingContext2D.prototype.setTransform=function(t,r,i,o,a,l){if(p&&p.apply(this,Array.from(arguments)),r);else{var u=t;t=u.a,r=u.b,i=u.c,o=u.d,a=u.e,l=u.f}this._transform_ext||(this._transform_ext=new c),this._transform_ext.setValues(t,r,i,o,a,l)},CanvasRenderingContext2D.prototype.transform=function(t,r,i,o,a,l){g&&g.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.multiply(new c([t,r,i,o,a,l]))},CanvasRenderingContext2D.prototype.translate=function(t,r){m&&m.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.translate(t,r)},CanvasRenderingContext2D.prototype.save=function(){y&&y.apply(this,Array.from(arguments)),this._transform_ext_stack||(this._transform_ext_stack=[]),this._transform_ext||(this._transform_ext=new c),this._transform_ext_stack.push(this._transform_ext.clone())},CanvasRenderingContext2D.prototype.restore=function(){v&&v.apply(this,Array.from(arguments)),this._transform_ext_stack||(this._transform_ext_stack=[]),this._transform_ext=this._transform_ext_stack.pop(),this._transform_ext||(this._transform_ext=new c)}}for(var _={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},b=Object.keys(_),A=null,S=0,C=[b,["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"]];S<C.length;S++){var P=C[S];if(P[_.fullscreenEnabled]in document){A=P;break}}if(A){var w=Element.prototype;w.requestFullscreen=w[A[_.requestFullscreen]],(w=Document.prototype).exitFullscreen=w[A[_.exitFullscreen]];var x=b[_.fullscreenElement],k=b[_.fullscreenEnabled];if(x in document||(Object.defineProperty(document,x,{get:function get(){return document[A[_.fullscreenElement]]}}),Object.defineProperty(document,k,{get:function get(){return document[A[_.fullscreenEnabled]]}})),b!==A){var T=function proxyListener(t){var r,i=t.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?r=new Event(i,t):(r=document.createEvent("Event")).initEvent(i,t.bubbles,t.cancelable),t.target.dispatchEvent(r)};document.addEventListener(A[_.fullscreenchange],T),document.addEventListener(A[_.fullscreenerror],T)}}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}String.format=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=-1;function callback(t,r,o,c,l,u){if("%%"==t)return"%";if(void 0!==i[++a]){t=c?parseInt(c.substr(1)):void 0;var d,h=l?parseInt(l.substr(1)):void 0;switch(u){case"s":d=i[a];break;case"c":d=i[a][0];break;case"f":d=parseFloat(i[a]).toFixed(t);break;case"p":d=parseFloat(i[a]).toPrecision(t);break;case"e":d=parseFloat(i[a]).toExponential(t);break;case"x":d=parseInt(i[a]).toString(h||16);break;case"d":d=parseFloat(parseInt(i[a],h||10).toPrecision(t)).toFixed(0)}d="object"==_typeof(d)?JSON.stringify(d):d.toString(h);for(var p=parseInt(o),g=o&&"0"==o[0]?"0":" ";d.length<p;)d=void 0!==r?d+g:g+d;return d}}var c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(c,callback)};var R=function ViewElement(t){return function(r){!function validateSelector(t){if(t.indexOf("-")<=0)throw new Error("At least one dash is required in the custom element name!")}(t.selector);var i="";t.styles&&(i+="<style>\n".concat(t.styles,"\n</style>")),t.template&&(i+="\n".concat(t.template));var o=document.createElement("template");o.innerHTML=i;var a=r.prototype.connectedCallback||function(){},c=r.prototype.initialized||function(){return!1};r.prototype.connectedCallback=function(){if(!c.call(this)){this.template=t.template;var r=document.importNode(o.content,!0);t.useShadow?this.attachShadow({mode:"open"}).appendChild(r):this.appendChild(r);var i,l=t.useShadow?this.shadowRoot:this,u=_createForOfIteratorHelper(Reflect.ownKeys(this));try{for(u.s();!(i=u.n()).done;){var d=i.value.toString(),h=l.querySelector("#"+d);h&&(this[d]=h)}}catch(t){u.e(t)}finally{u.f()}a.call(this)}},customElements.define(t.selector,r)}};function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _construct(t,r,i){return _construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(t,r,i){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(t,o));return i&&_setPrototypeOf(a,i.prototype),a},_construct.apply(null,arguments)}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,Wrapper)}function Wrapper(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,t)},_wrapNativeSuper(t)}function _createSuper(t){var r=function web_view_element_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var E,I=function(t){_inherits(WebViewElement,t);var r=_createSuper(WebViewElement);function WebViewElement(){var t;_classCallCheck(this,WebViewElement);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"template",void 0),t}return _createClass(WebViewElement,[{key:"initialized",value:function initialized(){return!1}},{key:"render",value:function render(){}}]),WebViewElement}(_wrapNativeSuper(HTMLElement));function player_controls_createSuper(t){var r=function player_controls_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var M=R({selector:"player-controls",template:__webpack_require__(151),styles:[__webpack_require__(424)]})(E=function(t){_inherits(WebPlayerControls,t);var r=player_controls_createSuper(WebPlayerControls);function WebPlayerControls(){var t;return _classCallCheck(this,WebPlayerControls),_defineProperty(_assertThisInitialized(t=r.call(this)),"controlContainer",void 0),_defineProperty(_assertThisInitialized(t),"fullscreenButton",void 0),_defineProperty(_assertThisInitialized(t),"playMediaButton",void 0),_defineProperty(_assertThisInitialized(t),"chatButton",void 0),_defineProperty(_assertThisInitialized(t),"settingsButton",void 0),_defineProperty(_assertThisInitialized(t),"raiseHandButton",void 0),_defineProperty(_assertThisInitialized(t),"showQuizButton",void 0),_defineProperty(_assertThisInitialized(t),"volumeSlider",void 0),_defineProperty(_assertThisInitialized(t),"volumeIndicator",void 0),_defineProperty(_assertThisInitialized(t),"duration",void 0),_defineProperty(_assertThisInitialized(t),"muteObserver",void 0),t}return _createClass(WebPlayerControls,[{key:"connectedCallback",value:function connectedCallback(){var t=this;this.updateVolumeIndicator(parseFloat(this.volumeSlider.value)/100),this.setFullscreen(!1),document.addEventListener("fullscreenchange",(function(){t.setFullscreen(null!==document.fullscreenElement)})),this.volumeIndicator.addEventListener("click",(function(){t.setMuted(!t.volumeIndicator.classList.contains("icon-mute"))})),this.volumeSlider.addEventListener("input",(function(){var r=t.volumeSlider;t.controlContainer.style.setProperty("--volume-before-width",r.value/r.max*100+"%")})),this.raiseHandButton.addEventListener("click",(function(){t.setSelected(t.raiseHandButton,!t.raiseHandButton.classList.contains("selected"))})),this.showQuizButton.addEventListener("click",(function(){t.setSelected(t.showQuizButton,!t.showQuizButton.classList.contains("selected"))}))}},{key:"visible",get:function get(){return this.hasAttribute("visible")},set:function set(t){t?this.setAttribute("visible",""):this.removeAttribute("visible")}},{key:"show",value:function show(){this.visible=!0}},{key:"hide",value:function hide(){this.visible=!1}},{key:"setDuration",value:function setDuration(t){var r=new Date(t),i=r.getUTCHours(),o="0"+r.getUTCMinutes(),a="0"+r.getUTCSeconds(),c=i+":"+o.substr(-2)+":"+a.substr(-2);this.duration.innerText=c}},{key:"setVolume",value:function setVolume(t){this.volumeSlider.value=(100*t).toString(),this.updateVolumeIndicator(t)}},{key:"setMuted",value:function setMuted(t){t?this.setVolumeIndicator("icon-mute"):this.updateVolumeIndicator(parseFloat(this.volumeSlider.value)/100),this.muteObserver&&this.muteObserver(t)}},{key:"setFullscreen",value:function setFullscreen(t){t?this.setFullscreenIndicator("bi-fullscreen-exit"):this.setFullscreenIndicator("bi-fullscreen")}},{key:"setSelected",value:function setSelected(t,r){var i=t.classList;r?i.add("selected"):i.remove("selected")}},{key:"setActive",value:function setActive(t,r){var i=t.classList;r?i.add("active"):i.remove("active")}},{key:"setVisible",value:function setVisible(t,r){r?t.classList.remove("invisible"):t.classList.add("invisible")}},{key:"setPlayMediaVisible",value:function setPlayMediaVisible(t){this.setVisible(this.playMediaButton,t),this.toggleClass(this.playMediaButton,t,"pulse-infinite")}},{key:"setOnPlayMedia",value:function setOnPlayMedia(t){this.playMediaButton.addEventListener("click",(function(r){r.stopPropagation(),t()}),!1)}},{key:"setOnVolume",value:function setOnVolume(t){var r=this;this.volumeSlider.addEventListener("input",(function(){var i=parseFloat(r.volumeSlider.value)/100;r.updateVolumeIndicator(i),t(i)}))}},{key:"setOnMute",value:function setOnMute(t){this.muteObserver=t}},{key:"setOnSettings",value:function setOnSettings(t){var r=this;this.settingsButton.addEventListener("click",(function(i){i.stopPropagation(),r.settingsButton.disabled=!0,t(!0)}),!1)}},{key:"setOnFullscreen",value:function setOnFullscreen(t){this.fullscreenButton.addEventListener("click",(function(r){r.stopPropagation(),t(!document.fullscreenElement)}),!1)}},{key:"setOnRaiseHand",value:function setOnRaiseHand(t){var r=this;t.subscribe((function(t){r.setSelected(r.raiseHandButton,t)})),this.raiseHandButton.addEventListener("click",(function(i){i.stopPropagation(),t.value=r.raiseHandButton.classList.contains("selected")}),!1)}},{key:"setOnRaiseHandActive",value:function setOnRaiseHandActive(t){var r=this;t.subscribe((function(t){r.setActive(r.raiseHandButton,t)}))}},{key:"setOnShowQuiz",value:function setOnShowQuiz(t){var r=this;t.subscribe((function(t){r.setSelected(r.showQuizButton,t)})),this.showQuizButton.addEventListener("click",(function(i){i.stopPropagation(),t.value=r.showQuizButton.classList.contains("selected")}),!1)}},{key:"setOnShowQuizActive",value:function setOnShowQuizActive(t){var r=this;this.setVisible(this.showQuizButton,t.value),this.toggleClass(this.showQuizButton,t.value,"pulse"),t.subscribe((function(t){r.setVisible(r.showQuizButton,t),r.toggleClass(r.showQuizButton,t,"pulse")}))}},{key:"setChatEnabled",value:function setChatEnabled(t){this.setVisible(this.chatButton,t)}},{key:"setOnChatAction",value:function setOnChatAction(t){var r=this;this.setActive(this.chatButton,t.value),t.subscribe((function(t){r.setActive(r.chatButton,t)})),this.chatButton.addEventListener("click",(function(i){i.stopPropagation(),t.value=r.chatButton.classList.contains("active")}),!1)}},{key:"toggleClass",value:function toggleClass(t,r,i){var o=t.classList;r?o.add(i):o.remove(i)}},{key:"updateVolumeIndicator",value:function updateVolumeIndicator(t){0===t?this.setVolumeIndicator("icon-volume0"):t<.33?this.setVolumeIndicator("icon-volume1"):t>.33&&t<.66?this.setVolumeIndicator("icon-volume2"):t>.66&&this.setVolumeIndicator("icon-volume3")}},{key:"setFullscreenIndicator",value:function setFullscreenIndicator(t){var r=this.fullscreenButton.classList;r.remove("bi-fullscreen","bi-fullscreen-exit"),r.add(t)}},{key:"setVolumeIndicator",value:function setVolumeIndicator(t){var r=this.volumeIndicator.classList;r.remove("icon-mute");for(var i=0;i<4;i++)r.remove("icon-volume"+i);r.add(t)}}]),WebPlayerControls}(I))||E,D=function(){function Dimension(t,r){_classCallCheck(this,Dimension),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),this.width=t,this.height=r}return _createClass(Dimension,[{key:"equals",value:function equals(t){return!!t&&(this.width===t.height&&this.height===t.height)}},{key:"toString",value:function toString(){return"[".concat(this.height,", ").concat(this.width,"]")}}]),Dimension}(),O=function(){function SizeEvent(t){_classCallCheck(this,SizeEvent),_defineProperty(this,"_size",void 0),this._size=t}return _createClass(SizeEvent,[{key:"size",get:function get(){return this._size}}]),SizeEvent}(),L=function(){function TypedEvent(){_classCallCheck(this,TypedEvent),_defineProperty(this,"listeners",[]),_defineProperty(this,"listenersOncer",[])}return _createClass(TypedEvent,[{key:"subscribe",value:function subscribe(t){var r=this;return this.listeners.push(t),{dispose:function dispose(){return r.unsubscribe(t)}}}},{key:"subscribeOnce",value:function subscribeOnce(t){this.listenersOncer.push(t)}},{key:"unsubscribe",value:function unsubscribe(t){var r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}},{key:"publish",value:function publish(t){this.listeners.forEach((function(r){return r(t)})),this.listenersOncer.forEach((function(r){return r(t)})),this.listenersOncer=[]}},{key:"pipe",value:function pipe(t){return this.subscribe((function(r){return t.publish(r)}))}}]),TypedEvent}();function render_surface_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function render_surface_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return render_surface_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return render_surface_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function render_surface_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var N=function(){function RenderSurface(t){_classCallCheck(this,RenderSurface),_defineProperty(this,"canvas",void 0),_defineProperty(this,"canvasContext",void 0),_defineProperty(this,"renderers",void 0),_defineProperty(this,"sizeEvent",new L),_defineProperty(this,"transform",void 0),_defineProperty(this,"size",void 0),this.canvas=t,this.canvasContext=t.getContext("2d"),this.renderers=new Map,this.transform=new c}return _createClass(RenderSurface,[{key:"clear",value:function clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"registerRenderer",value:function registerRenderer(t,r){this.renderers.set(t,r)}},{key:"renderImageSource",value:function renderImageSource(t){this.canvasContext.drawImage(t,0,0)}},{key:"renderSurface",value:function renderSurface(t){0!==t.canvas.width&&0!==t.canvas.height&&this.canvasContext.drawImage(t.canvas,0,0)}},{key:"renderShapes",value:function renderShapes(t){var r,i=render_surface_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.renderShape(o,null)}}catch(t){i.e(t)}finally{i.f()}}},{key:"renderShape",value:function renderShape(t,r){var i=this.renderers.get(t.constructor.name);if(i){var o=this.canvas.width*this.transform.getScaleX(),a=this.transform.getTranslateX(),c=this.transform.getTranslateY();this.canvasContext.save(),this.canvasContext.scale(o,o),this.canvasContext.translate(-a,-c),i.render(this.canvasContext,t,r),this.canvasContext.restore()}}},{key:"getSize",value:function getSize(){return this.size}},{key:"setSize",value:function setSize(t,r){if(!(t<1||r<1)){var i=window.devicePixelRatio||1;this.size=new D(t*i,r*i),this.resizeCanvas(t,r,i),this.fireSizeEvent(new O(this.size))}}},{key:"setTransform",value:function setTransform(t){this.transform.setTransform(t)}},{key:"addSizeListener",value:function addSizeListener(t){return this.sizeEvent.subscribe(t)}},{key:"removeSizeListener",value:function removeSizeListener(t){this.sizeEvent.unsubscribe(t)}},{key:"fireSizeEvent",value:function fireSizeEvent(t){this.sizeEvent.publish(t)}},{key:"resizeCanvas",value:function resizeCanvas(t,r,i){var o=this.canvas.getAttribute("scale");o&&"full"===o&&(this.canvas.width=t*i,this.canvas.height=r*i),this.canvas.style.width=t+"px",this.canvas.style.height=r+"px"}}]),RenderSurface}();function slide_render_surface_createSuper(t){var r=function slide_render_surface_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var B=function(t){_inherits(SlideRenderSurface,t);var r=slide_render_surface_createSuper(SlideRenderSurface);function SlideRenderSurface(){return _classCallCheck(this,SlideRenderSurface),r.apply(this,arguments)}return _createClass(SlideRenderSurface,[{key:"renderSlideShape",value:function renderSlideShape(t,r){if(!this.canvasContext.canvas.style.width||!this.canvasContext.canvas.style.height)return new Promise((function(t,r){r()}));var i=this.renderers.get(t.constructor.name),o=null;if(i){var a=t.bounds,c=this.canvas.width/a.width;this.canvasContext.save(),this.canvasContext.scale(c,c),o=i.render(this.canvasContext,t,r),this.canvasContext.restore()}return o}}]),SlideRenderSurface}(N);function asyncGeneratorStep(t,r,i,o,a,c,l){try{var u=t[c](l),d=u.value}catch(t){return void i(t)}u.done?r(d):Promise.resolve(d).then(o,a)}function _asyncToGenerator(t){return function(){var r=this,i=arguments;return new Promise((function(o,a){var c=t.apply(r,i);function _next(t){asyncGeneratorStep(c,o,a,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(c,o,a,_next,_throw,"throw",t)}_next(void 0)}))}}var j,V=__webpack_require__(757),U=__webpack_require__.n(V),z=function(){function TextLayerSurface(t){_classCallCheck(this,TextLayerSurface),_defineProperty(this,"root",void 0),_defineProperty(this,"size",void 0),this.root=t}var t;return _createClass(TextLayerSurface,[{key:"clear",value:function clear(){for(;this.root.firstChild;)this.root.removeChild(this.root.firstChild)}},{key:"render",value:(t=_asyncToGenerator(U().mark((function _callee(t){return U().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:this.clear(),t.renderText(this.root,this.size);case 2:case"end":return r.stop()}}),_callee,this)}))),function render(r){return t.apply(this,arguments)})},{key:"getSize",value:function getSize(){return this.size}},{key:"setSize",value:function setSize(t,r){this.size=new D(t,r),this.root.style.width=t+"px",this.root.style.height=r+"px"}}]),TextLayerSurface}();function web_slide_view_createSuper(t){var r=function web_slide_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var J,H=R({selector:"slide-view",template:__webpack_require__(225),styles:[__webpack_require__(486)]})(j=function(t){_inherits(WebSlideView,t);var r=web_slide_view_createSuper(WebSlideView);function WebSlideView(){var t;return _classCallCheck(this,WebSlideView),_defineProperty(_assertThisInitialized(t=r.call(this)),"slideRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"actionRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"volatileRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"textLayerSurface",void 0),t}return _createClass(WebSlideView,[{key:"connectedCallback",value:function connectedCallback(){var t=this.querySelector(".slide-canvas"),r=this.querySelector(".action-canvas"),i=this.querySelector(".volatile-canvas"),o=this.querySelector(".text-layer");this.slideRenderSurface=new B(t),this.actionRenderSurface=new N(r),this.volatileRenderSurface=new N(i),this.textLayerSurface=new z(o),new ResizeObserver(this.resize.bind(this)).observe(this),this.resize()}},{key:"getActionRenderSurface",value:function getActionRenderSurface(){return this.actionRenderSurface}},{key:"getSlideRenderSurface",value:function getSlideRenderSurface(){return this.slideRenderSurface}},{key:"getVolatileRenderSurface",value:function getVolatileRenderSurface(){return this.volatileRenderSurface}},{key:"getTextLayerSurface",value:function getTextLayerSurface(){return this.textLayerSurface}},{key:"repaint",value:function repaint(){this.resize()}},{key:"resize",value:function resize(){var t=4/3,r=this.clientWidth,i=this.clientHeight;r/i>t?r=i*t:i=r/t,0!==r&&0!==i&&(this.slideRenderSurface.setSize(r,i),this.actionRenderSurface.setSize(r,i),this.volatileRenderSurface.setSize(r,i),this.textLayerSurface.setSize(r,i))}}]),WebSlideView}(I))||j;function player_view_createSuper(t){var r=function player_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var G,q=R({selector:"player-view",template:__webpack_require__(628),styles:[__webpack_require__(77)]})(J=function(t){_inherits(PlayerView,t);var r=player_view_createSuper(PlayerView);function PlayerView(t){var i;return _classCallCheck(this,PlayerView),_defineProperty(_assertThisInitialized(i=r.call(this)),"playbackModel",void 0),_defineProperty(_assertThisInitialized(i),"playerContainer",void 0),_defineProperty(_assertThisInitialized(i),"slideView",void 0),_defineProperty(_assertThisInitialized(i),"playerControls",void 0),_defineProperty(_assertThisInitialized(i),"videoFeed",void 0),_defineProperty(_assertThisInitialized(i),"videoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"mainVideoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"localVideoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"chatContainer",void 0),_defineProperty(_assertThisInitialized(i),"chatModal",void 0),_defineProperty(_assertThisInitialized(i),"chatModalState",void 0),_defineProperty(_assertThisInitialized(i),"chatCollapse",void 0),_defineProperty(_assertThisInitialized(i),"rightContainer",void 0),i.playbackModel=t,i.chatCollapse=null,i.chatModal=null,i.chatModalState=!1,i}return _createClass(PlayerView,[{key:"connectedCallback",value:function connectedCallback(){var t=this,r=this.playbackModel.elementAProperty.value;r&&this.setChat(r),this.videoFeed.addEventListener("canplay",(function(){t.videoFeed.play().catch((function(r){"NotAllowedError"==r.name&&t.cannotPlay()}))})),this.videoFeed.addEventListener("play",(function(){})),this.playbackModel.elementAProperty.subscribe(this.setChat.bind(this)),this.playbackModel.mainVideoAvailableProperty.subscribe(this.setMainVideoAvailable.bind(this)),this.playbackModel.localVideoAvailableProperty.subscribe(this.setLocalVideoAvailable.bind(this)),this.playbackModel.showChatProperty.subscribe(this.showChat.bind(this)),this.playerControls.setOnRaiseHand(this.playbackModel.raisedHandProperty),this.playerControls.setOnRaiseHandActive(this.playbackModel.webrtcPublisherConnectedProperty),this.playerControls.setOnShowQuiz(this.playbackModel.showQuizProperty),this.playerControls.setOnShowQuizActive(this.playbackModel.showQuizActiveProperty),this.playerControls.setOnChatAction(this.playbackModel.showChatProperty),this.playerControls.setOnFullscreen((function(r){t.setFullscreen(r)})),this.playerControls.setOnPlayMedia((function(){t.videoFeed.play().then((function(){t.playerControls.setPlayMediaVisible(!1),t.querySelectorAll("video").forEach((function(t){t.play()}))})).catch((function(t){console.error(t)}))}));var i=document.getElementById("chatModal");i.addEventListener("hidden.bs.modal",(function(r){t.playbackModel.showChat=!1})),this.chatModal=new bootstrap.Modal(i,{});var o=window.matchMedia("(max-width: 576px)");o.addEventListener("change",(function(r){t.chatModalState=r.matches,t.playbackModel.showChat=!o.matches})),this.chatModalState=o.matches,this.playbackModel.showChat=!o.matches,new ResizeObserver(this.computeViewSize.bind(this)).observe(this.playerContainer),this.style.display="none"}},{key:"initEntryModal",value:function initEntryModal(){var t=this,r=document.getElementById("entry-modal"),i=(document.getElementById("entry-modal-label"),bootstrap.Modal.getOrCreateInstance(r,{backdrop:"static",keyboard:!1}));r.addEventListener("hidden.bs.modal",(function hiddenHandler(){t.videoFeed.play().then((function(){t.querySelectorAll("video").forEach((function(t){t.play()}))})).catch((function(t){console.error(t)}))})),i.show()}},{key:"show",value:function show(){this.style.display="flex"}},{key:"getSlideView",value:function getSlideView(){return this.slideView}},{key:"getMediaElement",value:function getMediaElement(){return this.videoFeed}},{key:"setDuration",value:function setDuration(t){this.playerControls.setDuration(t)}},{key:"setVolume",value:function setVolume(t){this.playerControls.setVolume(t)}},{key:"setMuted",value:function setMuted(t){this.playerControls.setMuted(t)}},{key:"setFullscreen",value:function setFullscreen(t){t?this.requestFullscreen?this.requestFullscreen():this.mozRequestFullScreen?this.mozRequestFullScreen():this.webkitRequestFullScreen?this.webkitRequestFullScreen():this.msRequestFullscreen&&this.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),this.computeViewSize()}},{key:"setOnVolume",value:function setOnVolume(t){this.playerControls.setOnVolume(t)}},{key:"setOnMute",value:function setOnMute(t){this.playerControls.setOnMute(t)}},{key:"setOnFullscreen",value:function setOnFullscreen(t){this.playerControls.setOnFullscreen(t)}},{key:"setOnSettings",value:function setOnSettings(t){this.playerControls.setOnSettings(t)}},{key:"cannotPlay",value:function cannotPlay(){this.initEntryModal()}},{key:"setChat",value:function setChat(t){var r=this;if(t){this.chatContainer.appendChild(t),t.querySelector("#chat-close-button").addEventListener("click",this.toggleChat.bind(this));var i=t.querySelector("#flush-chat");this.chatCollapse=new bootstrap.Collapse(i,{toggle:!1});var o=t.cloneNode(!0).querySelector("#course-message-form"),a=document.getElementById("chatModal"),c=a.querySelector(".modal-body");c.appendChild(o);var l=c.querySelector("#messageSubmit");a.querySelector(".modal-footer").appendChild(l),l.addEventListener("click",(function(t){t.preventDefault();var i=new FormData(o),a=Object.fromEntries(i.entries());fetch(o.getAttribute("action"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((function(t){var i=200===t.status?"toast-success":"toast-warn",a=200===t.status?"course.feature.message.sent":"course.feature.message.send.error";r.showToast(i,a),o.reset(),r.chatModal.hide()})).catch((function(t){return console.error(t)}))})),this.playbackModel.showChat=!window.matchMedia("(max-width: 768px)").matches}else for(;this.chatContainer.firstElementChild;){this.chatContainer.firstElementChild.querySelector("#chat-close-button").removeEventListener("click",this.toggleChat),this.chatCollapse&&(this.chatCollapse.dispose(),this.chatCollapse=null);var u=document.getElementById("chatModal"),d=u.querySelector(".modal-body"),h=u.querySelector(".modal-footer"),p=h.querySelector("#messageSubmit");h.removeChild(p),this.removeAllChildNodes(d),this.chatContainer.removeChild(this.chatContainer.firstElementChild)}this.playerControls.setChatEnabled(null!==t),this.updateRightContainer()}},{key:"showChat",value:function showChat(t){var r=this.chatContainer.firstElementChild;null!==r&&(t&&this.chatModalState&&this.chatModal.show(),this.setElementVisible(r,t),t&&this.chatCollapse.show())}},{key:"toggleChat",value:function toggleChat(){var t=this.playbackModel.showChat;this.playbackModel.showChat=!t}},{key:"showToast",value:function showToast(t,r){var i=document.getElementById(t);i.getElementsByClassName("toast-body")[0].innerHTML=window.dict[r],new bootstrap.Toast(i).show()}},{key:"setElementVisible",value:function setElementVisible(t,r){r?t.classList.remove("invisible"):t.classList.add("invisible")}},{key:"setVideoAvailable",value:function setVideoAvailable(t){this.setElementVisible(this.videoFeedContainer,t),this.updateRightContainer()}},{key:"setMainVideoAvailable",value:function setMainVideoAvailable(t){this.setElementVisible(this.mainVideoFeedContainer,t),this.updateRightContainer()}},{key:"setLocalVideoAvailable",value:function setLocalVideoAvailable(t){this.setElementVisible(this.localVideoFeedContainer,t),this.updateRightContainer()}},{key:"updateRightContainer",value:function updateRightContainer(){this.setElementVisible(this.rightContainer,this.playbackModel.videoAvailable||this.playbackModel.localVideoAvailable||this.chatContainer.hasChildNodes()),this.computeViewSize()}},{key:"computeViewSize",value:function computeViewSize(){var t=4/3,r=this.offsetWidth-this.rightContainer.offsetWidth,i=this.offsetHeight;r/i>t?r=i*t:i=r/t,this.playerContainer.style.height=(i+this.playerControls.offsetHeight)/this.offsetHeight*100+"%"}},{key:"removeAllChildNodes",value:function removeAllChildNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}}]),PlayerView}(I))||J,W=function(){function ProgressiveDataView(t,r,i){_classCallCheck(this,ProgressiveDataView),_defineProperty(this,"dataView",void 0),_defineProperty(this,"offset",void 0),this.dataView=new DataView(t,r,i),this.offset=r||0}return _createClass(ProgressiveDataView,[{key:"byteOffset",get:function get(){return this.offset}},{key:"skip",value:function skip(t){if(this.offset+t>=this.dataView.byteLength)throw new Error("Out of bounds ".concat(this.offset+t," exceeds length ").concat(this.dataView.byteLength));this.offset+=t}},{key:"getString",value:function getString(t){for(var r="",i=-1,o=0;o<t&&0!=(i=this.getUint8());o++)r+=String.fromCharCode(i);return r}},{key:"getFloat32",value:function getFloat32(t){var r=this.dataView.getFloat32(this.offset,t);return this.offset+=4,r}},{key:"getFloat64",value:function getFloat64(t){var r=this.dataView.getFloat64(this.offset,t);return this.offset+=8,r}},{key:"getInt8",value:function getInt8(){var t=this.dataView.getInt8(this.offset);return this.offset+=1,t}},{key:"getInt16",value:function getInt16(t){var r=this.dataView.getInt16(this.offset,t);return this.offset+=2,r}},{key:"getInt32",value:function getInt32(t){var r=this.dataView.getInt32(this.offset,t);return this.offset+=4,r}},{key:"getInt64",value:function getInt64(t){var r=this.dataView.getBigInt64(this.offset,t);return this.offset+=8,r}},{key:"getUint8",value:function getUint8(){var t=this.dataView.getUint8(this.offset);return this.offset+=1,t}},{key:"getUint16",value:function getUint16(t){var r=this.dataView.getUint16(this.offset,t);return this.offset+=2,r}},{key:"getUint32",value:function getUint32(t){var r=this.dataView.getUint32(this.offset,t);return this.offset+=4,r}}]),ProgressiveDataView}();function pen_point_createSuper(t){var r=function pen_point_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}!function(t){t[t.TOOL_BEGIN=0]="TOOL_BEGIN",t[t.TOOL_EXECUTE=1]="TOOL_EXECUTE",t[t.TOOL_END=2]="TOOL_END",t[t.PEN=3]="PEN",t[t.HIGHLIGHTER=4]="HIGHLIGHTER",t[t.POINTER=5]="POINTER",t[t.ARROW=6]="ARROW",t[t.LINE=7]="LINE",t[t.RECTANGLE=8]="RECTANGLE",t[t.ELLIPSE=9]="ELLIPSE",t[t.TEXT=10]="TEXT",t[t.TEXT_CHANGE=11]="TEXT_CHANGE",t[t.TEXT_FONT_CHANGE=12]="TEXT_FONT_CHANGE",t[t.TEXT_LOCATION_CHANGE=13]="TEXT_LOCATION_CHANGE",t[t.TEXT_REMOVE=14]="TEXT_REMOVE",t[t.TEXT_SELECTION=15]="TEXT_SELECTION",t[t.LATEX=16]="LATEX",t[t.LATEX_FONT_CHANGE=17]="LATEX_FONT_CHANGE",t[t.UNDO=18]="UNDO",t[t.REDO=19]="REDO",t[t.CLONE=20]="CLONE",t[t.SELECT=21]="SELECT",t[t.SELECT_GROUP=22]="SELECT_GROUP",t[t.RUBBER=23]="RUBBER",t[t.CLEAR_SHAPES=24]="CLEAR_SHAPES",t[t.PANNING=25]="PANNING",t[t.EXTEND_VIEW=26]="EXTEND_VIEW",t[t.ZOOM=27]="ZOOM",t[t.ZOOM_OUT=28]="ZOOM_OUT",t[t.NEXT_PAGE=29]="NEXT_PAGE",t[t.KEY=30]="KEY",t[t.STATIC=31]="STATIC",t[t.PAGE=32]="PAGE",t[t.RUBBER_EXT=33]="RUBBER_EXT",t[t.TEXT_SELECTION_EXT=34]="TEXT_SELECTION_EXT"}(G||(G={}));var Y=function(t){_inherits(PenPoint,t);var r=pen_point_createSuper(PenPoint);function PenPoint(t,i,o){var a;return _classCallCheck(this,PenPoint),_defineProperty(_assertThisInitialized(a=r.call(this,t,i)),"p",void 0),a.p=o,a}return _createClass(PenPoint,[{key:"clone",value:function clone(){return new PenPoint(this.x,this.y,this.p)}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y&&this.p===t.p)}}],[{key:"createZero",value:function createZero(){return new PenPoint(0,0,0)}}]),PenPoint}(a),Q=_createClass((function Action(){_classCallCheck(this,Action),_defineProperty(this,"keyEvent",void 0),_defineProperty(this,"timestamp",void 0)}));function brush_action_createSuper(t){var r=function brush_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var X=function(t){_inherits(BrushAction,t);var r=brush_action_createSuper(BrushAction);function BrushAction(t,i){var o;return _classCallCheck(this,BrushAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"shapeHandle",void 0),_defineProperty(_assertThisInitialized(o),"brush",void 0),o.shapeHandle=t,o.brush=i,o}return _createClass(BrushAction)}(Q),$=function(){function PaintTool(){_classCallCheck(this,PaintTool),_defineProperty(this,"shapeHandle",void 0),_defineProperty(this,"brush",void 0)}return _createClass(PaintTool,[{key:"begin",value:function begin(t,r){}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),PaintTool}(),K=_createClass((function ShapeAction(t){_classCallCheck(this,ShapeAction),_defineProperty(this,"shapes",void 0),this.shapes=t}));function add_shape_action_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function add_shape_action_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return add_shape_action_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return add_shape_action_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function add_shape_action_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function add_shape_action_createSuper(t){var r=function add_shape_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Z=function(t){_inherits(AddShapeAction,t);var r=add_shape_action_createSuper(AddShapeAction);function AddShapeAction(t){return _classCallCheck(this,AddShapeAction),r.call(this,t)}return _createClass(AddShapeAction,[{key:"execute",value:function execute(t){var r,i=add_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.addShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"undo",value:function undo(t){var r,i=add_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.removeShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"redo",value:function redo(t){this.execute(t)}}]),AddShapeAction}(K);function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,i){var o=_superPropBase(t,r);if(o){var a=Object.getOwnPropertyDescriptor(o,r);return a.get?a.get.call(arguments.length<3?t:i):a.value}},_get.apply(this,arguments)}var ee=function(){function ShapeEvent(t,r){_classCallCheck(this,ShapeEvent),_defineProperty(this,"_shape",void 0),_defineProperty(this,"_dirtyRegion",void 0),this._shape=t,this._dirtyRegion=r}return _createClass(ShapeEvent,[{key:"shape",get:function get(){return this._shape}},{key:"dirtyRegion",get:function get(){return this._dirtyRegion}}]),ShapeEvent}(),te=function(){function Rectangle(t,r,i,o){_classCallCheck(this,Rectangle),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),this.set(t,r,i,o)}return _createClass(Rectangle,[{key:"set",value:function set(t,r,i,o){this.x=t,this.y=r,this.width=i,this.height=o}},{key:"isEmpty",value:function isEmpty(){return this.width<=0||this.height<=0}},{key:"containsPoint",value:function containsPoint(t){var r=t.x,i=t.y;return r>=this.x&&i>=this.y&&r<this.x+this.width&&i<this.y+this.height}},{key:"containsRect",value:function containsRect(t){if(this.isEmpty()||t.isEmpty())return!1;var r=t.x,i=t.y,o=t.width,a=t.height,c=this.x,l=this.y;return r>=c&&i>=l&&r+o<=c+this.width&&i+a<=l+this.height}},{key:"intersectsLine",value:function intersectsLine(t,r,i,o){for(var a=this.x,c=this.x+this.width,l=this.y,u=this.y+this.height,d=this.computeCode(t,r,a,c,l,u),h=this.computeCode(i,o,a,c,l,u);;){if(!(d|h))return!0;if(d&h)return!1;var p=d||h,g=void 0,m=void 0;8&p?(g=t+(i-t)*(u-r)/(o-r),m=u):4&p?(g=t+(i-t)*(l-r)/(o-r),m=l):2&p?(m=r+(o-r)*(c-t)/(i-t),g=c):1&p&&(m=r+(o-r)*(a-t)/(i-t),g=a),p==d?(t=g,r=m,d=this.computeCode(t,r,a,c,l,u)):(i=g,o=m,h=this.computeCode(i,o,a,c,l,u))}}},{key:"intersection",value:function intersection(t){var r=Math.max(this.x,t.x),i=Math.max(this.y,t.y),o=Math.min(this.x+this.width,t.x+t.width)-r,a=Math.min(this.y+this.height,t.y+t.height)-i;return o<=0||a<=0?null:new Rectangle(r,i,o,a)}},{key:"union",value:function union(t){var r=Math.min(this.x,t.x),i=Math.min(this.y,t.y),o=Math.max(this.x+this.width,t.x+t.width),a=Math.max(this.y+this.height,t.y+t.height);this.set(r,i,o-r,a-i)}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height)}},{key:"toString",value:function toString(){return"[".concat(this.x,", ").concat(this.y,", ").concat(this.height,", ").concat(this.width,"]")}},{key:"computeCode",value:function computeCode(t,r,i,o,a,c){var l=0;return t<i?l|=1:t>o&&(l|=2),r<a?l|=4:r>c&&(l|=8),l}}],[{key:"empty",value:function empty(){return new Rectangle(0,0,0,0)}}]),Rectangle}();function shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var ne=function(){function Shape(t){_classCallCheck(this,Shape),_defineProperty(this,"_handle",void 0),_defineProperty(this,"_points",[]),_defineProperty(this,"_bounds",te.empty()),_defineProperty(this,"changeEvent",new L),_defineProperty(this,"selected",void 0),_defineProperty(this,"keyEvent",void 0),this._handle=t}return _createClass(Shape,[{key:"handle",get:function get(){return this._handle}},{key:"addPoint",value:function addPoint(t){var r=this._points.length,i=null;return r>0&&(i=this._points[r-1]),!t.equals(i)&&(this._points.push(t),!0)}},{key:"points",get:function get(){return this._points}},{key:"contains",value:function contains(t){return this._bounds.containsPoint(t)}},{key:"intersects",value:function intersects(t){return null!=this._bounds.intersection(t)}},{key:"bounds",get:function get(){return this._bounds}},{key:"getKeyEvent",value:function getKeyEvent(){return this.keyEvent}},{key:"setKeyEvent",value:function setKeyEvent(t){this.keyEvent=t}},{key:"isSelected",value:function isSelected(){return this.selected}},{key:"setSelected",value:function setSelected(t){this.selected!=t&&(this.selected=t,this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"moveByDelta",value:function moveByDelta(t){var r,i=shape_createForOfIteratorHelper(this._points);try{for(i.s();!(r=i.n()).done;){r.value.subtract(t)}}catch(t){i.e(t)}finally{i.f()}this.updateBoundsByDelta(t),this.fireShapeEvent(new ee(this,this.bounds))}},{key:"clone",value:function clone(){return Object.create(this)}},{key:"addChangeListener",value:function addChangeListener(t){return this.changeEvent.subscribe(t)}},{key:"removeChangeListener",value:function removeChangeListener(t){this.changeEvent.unsubscribe(t)}},{key:"updateBoundsByDelta",value:function updateBoundsByDelta(t){this.bounds.x-=t.x,this.bounds.y-=t.y}},{key:"fireShapeEvent",value:function fireShapeEvent(t){this.changeEvent.publish(t)}}]),Shape}(),re=function(){function Line(t,r,i,o){_classCallCheck(this,Line),_defineProperty(this,"x1",void 0),_defineProperty(this,"y1",void 0),_defineProperty(this,"x2",void 0),_defineProperty(this,"y2",void 0),this.set(t,r,i,o)}return _createClass(Line,[{key:"set",value:function set(t,r,i,o){this.x1=t,this.y1=r,this.x2=i,this.y2=o}},{key:"getStartPoint",value:function getStartPoint(){return new a(this.x1,this.y1)}},{key:"getEndPoint",value:function getEndPoint(){return new a(this.x2,this.y2)}},{key:"distance",value:function distance(t,r){var i=this.x2-this.x1,o=this.y2-this.y1,a=Math.sqrt(i*i+o*o);return Math.abs(((this.y1-this.y2)*t+i*r+(this.x1*this.y2-this.x2*this.y1))/a)}},{key:"intersects",value:function intersects(t){return Line.intersects(this.x1,this.y1,this.x2,this.y2,t.x1,t.y1,t.x2,t.y2)}},{key:"getIntersectionPoint",value:function getIntersectionPoint(t,r,i,o){var c=(o-r)*(this.x2-this.x1)-(i-t)*(this.y2-this.y1);if(Math.abs(c)<.01)return null;var l=((i-t)*(this.y1-r)-(o-r)*(this.x1-t))/c,u=((this.x2-this.x1)*(this.y1-r)-(this.y2-this.y1)*(this.x1-t))/c;if(l>=0&&l<=1&&u>=0&&u<=1){var d=this.y2-this.y1,h=this.x1-this.x2,p=d*this.x1+h*this.y1,g=o-r,m=t-i,y=g*t+m*r;return new a((m*p-h*y)/c,(d*y-g*p)/c)}return null}}],[{key:"intersects",value:function intersects(t,r,i,o,a,c,l,u){var d=(u-c)*(i-t)-(l-a)*(o-r);if(0==d)return!1;var h=((l-a)*(r-c)-(u-c)*(t-a))/d,p=((i-t)*(r-c)-(o-r)*(t-a))/d;return h>=0&&h<=1&&p>=0&&p<=1}}]),Line}();function stroke_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function stroke_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return stroke_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return stroke_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function stroke_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function stroke_shape_createSuper(t){var r=function stroke_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ie=function(t){_inherits(StrokeShape,t);var r=stroke_shape_createSuper(StrokeShape);function StrokeShape(t,i){var o;return _classCallCheck(this,StrokeShape),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"_brush",void 0),_defineProperty(_assertThisInitialized(o),"minPoint",new a(0,0)),_defineProperty(_assertThisInitialized(o),"maxPoint",new a(0,0)),o._brush=i,o}return _createClass(StrokeShape,[{key:"brush",get:function get(){return this._brush}},{key:"addPoint",value:function addPoint(t){var r=_get(_getPrototypeOf(StrokeShape.prototype),"addPoint",this).call(this,t);return r&&(this.minPoint.x=Math.min(this.minPoint.x,t.x),this.minPoint.y=Math.min(this.minPoint.y,t.y),this.maxPoint.x=Math.max(this.maxPoint.x,t.x),this.maxPoint.y=Math.max(this.maxPoint.y,t.y),this.updateBounds(),this.fireShapeEvent(new ee(this,this.bounds))),r}},{key:"contains",value:function contains(t){var r=this.brush.width/2;if(0===this.points.length)return!1;if(1===this.points.length)return this.points[0].distance(t)<=r;for(var i=new re(t.x+r,t.y+r,t.x-r,t.y-r),o=new re(t.x-r,t.y+r,t.x+r,t.y-r),a=0,c=this.points[a++],l=null,u=null;a<this.points.length;){if(l=this.points[a++],(u=new re(c.x,c.y,l.x,l.y)).intersects(i))return!0;if(u.intersects(o))return!0;c=l}return!1}},{key:"intersects",value:function intersects(t){if(0===this.points.length)return!1;if(1===this.points.length)return t.containsPoint(this.points[0]);for(var r=0,i=this.points[r++],o=null;r<this.points.length;){if(o=this.points[r++],t.intersectsLine(i.x,i.y,o.x,o.y))return!0;i=o}return!1}},{key:"updateBounds",value:function updateBounds(){var t=this.minPoint.x,r=this.minPoint.y,i=this.maxPoint.x-this.minPoint.x,o=this.maxPoint.y-this.minPoint.y;this.bounds.set(t,r,i,o)}},{key:"clone",value:function clone(){var t=new StrokeShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=stroke_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),StrokeShape}(ne);function arrayLikeToArray_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function unsupportedIterableToArray_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return arrayLikeToArray_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?arrayLikeToArray_arrayLikeToArray(t,r):void 0}}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return arrayLikeToArray_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||unsupportedIterableToArray_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pen_stroke_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function pen_stroke_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return pen_stroke_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pen_stroke_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function pen_stroke_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var oe=function(){function PenStroke(t){_classCallCheck(this,PenStroke),_defineProperty(this,"vector",new a(0,0)),_defineProperty(this,"normal",new a(0,0)),_defineProperty(this,"miter",new a(0,0)),_defineProperty(this,"offsetA",new a(0,0)),_defineProperty(this,"offsetB",new a(0,0)),_defineProperty(this,"lastLineTop",new re(0,0,0,0)),_defineProperty(this,"lastLineBottom",new re(0,0,0,0)),_defineProperty(this,"A",new Array),_defineProperty(this,"B",new Array),_defineProperty(this,"points",new Array),_defineProperty(this,"strokeWidth",void 0),this.strokeWidth=t}return _createClass(PenStroke,[{key:"getStrokeList",value:function getStrokeList(){if(0===this.points.length)return null;var t=new Array;return 1==this.points.length?(this.capOnePoint(t,this.points[0],this.strokeWidth),t):(t.push.apply(t,_toConsumableArray(this.A)),this.capEndpoint(t,this.points[1],this.points[0],!1),t.push.apply(t,_toConsumableArray(this.B)),t)}},{key:"addPoint",value:function addPoint(t){this.points.push(t.clone());var r=this.points.length;if(r>1){r>2&&this.points.shift();var i=this.points[0];0===this.A.length||0===this.B.length?(this.capEndpoint(this.A,i,t,!1),this.beginPath(i,t)):this.advance(i,t)}}},{key:"intersects",value:function intersects(t){return 0!==this.points.length&&(1===this.points.length?t.containsPoint(this.points[0]):!!this.intersectsRect(this.A,t)||!!this.intersectsRect(this.B,t))}},{key:"moveByDelta",value:function moveByDelta(t){var r,i=pen_stroke_createForOfIteratorHelper(this.A);try{for(i.s();!(r=i.n()).done;){r.value.subtract(t)}}catch(t){i.e(t)}finally{i.f()}var o,a=pen_stroke_createForOfIteratorHelper(this.B);try{for(a.s();!(o=a.n()).done;){o.value.subtract(t)}}catch(t){a.e(t)}finally{a.f()}var c,l=pen_stroke_createForOfIteratorHelper(this.points);try{for(l.s();!(c=l.n()).done;){c.value.subtract(t)}}catch(t){l.e(t)}finally{l.f()}}},{key:"clone",value:function clone(){var t,r=new PenStroke(this.strokeWidth),i=pen_stroke_createForOfIteratorHelper(this.A);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.A.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}var a,c=pen_stroke_createForOfIteratorHelper(this.B);try{for(c.s();!(a=c.n()).done;){var l=a.value;r.B.push(l.clone())}}catch(t){c.e(t)}finally{c.f()}var u,d=pen_stroke_createForOfIteratorHelper(this.points);try{for(d.s();!(u=d.n()).done;){var h=u.value;r.points.push(h.clone())}}catch(t){d.e(t)}finally{d.f()}return r}},{key:"advance",value:function advance(t,r){this.advancePath(this.A,t,r,!1),this.advancePath(this.B,t,r,!0)}},{key:"advancePath",value:function advancePath(t,r,i,o){this.vector.set(i.x,i.y).subtract(r).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetA.set(r.x,r.y),this.offset(this.offsetA,this.miter,o),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(i)/2),this.offsetB.set(i.x,i.y),this.offset(this.offsetB,this.miter,o);var a=new re(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y),c=o?this.lastLineTop:this.lastLineBottom,l=c.getIntersectionPoint(a.x1,a.y1,a.x2,a.y2);if(null!=l)this.intersect(t,l,o);else{var u=c.getEndPoint(),d=a.getStartPoint(),h=this.toDegrees(u,r),p=this.toDegrees(d,r);Math.abs(h-p)>180&&(h%=360,p%=360),this.cap(t,r,h,p,this.strokeWidth*this.toPressure(r)/2,2,o)}c.set(a.x1,a.y1,a.x2,a.y2)}},{key:"beginPath",value:function beginPath(t,r){this.vector.set(r.x,r.y).subtract(t).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(t)/2),this.offsetA.set(t.x,t.y).add(this.miter),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetB.set(r.x,r.y).add(this.miter),this.addPathPoint(this.A,this.offsetB.x,this.offsetB.y,!1),this.lastLineBottom.set(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(t)/2),this.offsetA.set(t.x,t.y).subtract(this.miter),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetB.set(r.x,r.y).subtract(this.miter),this.addPathPoint(this.B,this.offsetA.x,this.offsetA.y,!0),this.addPathPoint(this.B,this.offsetB.x,this.offsetB.y,!0),this.lastLineTop.set(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y)}},{key:"cap",value:function cap(t,r,i,o,a,c,l){if(i>o)for(var u=i;u>=o;u-=c){var d=Math.PI*u/180,h=r.x+a*Math.cos(d),p=r.y+a*Math.sin(d);this.addPathPoint(t,h,p,l)}else for(var g=i;g<=o;g+=c){var m=Math.PI*g/180,y=r.x+a*Math.cos(m),v=r.y+a*Math.sin(m);this.addPathPoint(t,y,v,l)}}},{key:"capOnePoint",value:function capOnePoint(t,r,i){this.addPathPoint(t,r.x+i*this.toPressure(r)/2,r.y,!1),this.cap(t,r,0,360,i*this.toPressure(r)/2,2,!1)}},{key:"capEndpoint",value:function capEndpoint(t,r,i,o){this.vector.set(i.x,i.y).subtract(r).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetA.set(r.x,r.y).add(this.miter),this.offsetB.set(r.x,r.y).subtract(this.miter),this.addPathPoint(t,this.offsetB.x,this.offsetB.y,o);var a=this.toDegrees(this.offsetB,this.offsetA),c=a-180;this.cap(t,r,a,c,this.strokeWidth*this.toPressure(r)/2,2,o)}},{key:"addPathPoint",value:function addPathPoint(t,r,i,o){o?t.unshift(new Y(r,i,1)):t.push(new Y(r,i,1))}},{key:"intersect",value:function intersect(t,r,i){i?t[0].set(r.x,r.y):t[t.length-1].set(r.x,r.y)}},{key:"offset",value:function offset(t,r,i){i?t.subtract(r):t.add(r)}},{key:"toPressure",value:function toPressure(t){return Math.min(1,Math.sqrt(t.p+.1))}},{key:"toDegrees",value:function toDegrees(t,r){var i=Math.atan2(t.y-r.y,t.x-r.x);return 180*(2*Math.PI+i)/Math.PI}},{key:"intersectsRect",value:function intersectsRect(t,r){for(var i=0,o=t[i++],a=null;i<t.length;){if(a=t[i++],r.intersectsLine(o.x,o.y,a.x,a.y))return!0;o=a}return!1}}]),PenStroke}();function pen_shape_createSuper(t){var r=function pen_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ae=function(t){_inherits(PenShape,t);var r=pen_shape_createSuper(PenShape);function PenShape(t,i){var o;return _classCallCheck(this,PenShape),_defineProperty(_assertThisInitialized(o=r.call(this,t,i)),"stroke",void 0),o.stroke=new oe(i.width),o}return _createClass(PenShape,[{key:"addPoint",value:function addPoint(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return this.stroke.addPoint(t),this.updateBounds(),this.fireShapeEvent(new ee(this,this.bounds)),!0}},{key:"contains",value:function contains(t){return this.stroke.intersects(new te(t.x,t.y,t.x,t.y))}},{key:"intersects",value:function intersects(t){return this.stroke.intersects(t)}},{key:"getPenStroke",value:function getPenStroke(){return this.stroke}},{key:"moveByDelta",value:function moveByDelta(t){this.stroke.moveByDelta(t),this.updateBoundsByDelta(t),this.fireShapeEvent(new ee(this,this.bounds))}},{key:"clone",value:function clone(){var t=new PenShape(this.handle,this.brush.clone());return t.stroke=this.stroke.clone(),t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected()),t}}]),PenShape}(ie);function pen_tool_createSuper(t){var r=function pen_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var se=function(t){_inherits(PenTool,t);var r=pen_tool_createSuper(PenTool);function PenTool(){var t;_classCallCheck(this,PenTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),t}return _createClass(PenTool,[{key:"begin",value:function begin(t,r){this.shape=new ae(this.shapeHandle,this.brush),this.shape.addPoint(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}},{key:"end",value:function end(t){}}]),PenTool}($);function pen_action_createSuper(t){var r=function pen_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ce=function(t){_inherits(PenAction,t);var r=pen_action_createSuper(PenAction);function PenAction(){return _classCallCheck(this,PenAction),r.apply(this,arguments)}return _createClass(PenAction,[{key:"execute",value:function execute(t){var r=new se;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setTool(r)}}]),PenAction}(X);function brush_createSuper(t){var r=function brush_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var le=function(t){_inherits(Brush,t);var r=brush_createSuper(Brush);function Brush(t,i){var o;return _classCallCheck(this,Brush),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"width",void 0),o.width=i,o}return _createClass(Brush,[{key:"clone",value:function clone(){return new Brush(this.color,this.width)}}]),Brush}(_createClass((function Paint(t){_classCallCheck(this,Paint),_defineProperty(this,"color",void 0),this.color=t}))),ue=/\((\d+),\s*(\d+),\s*(\d+)(,\s*(\d*.\d*))?\)/,de=function(){function Color(t,r,i,o){_classCallCheck(this,Color),_defineProperty(this,"r",void 0),_defineProperty(this,"g",void 0),_defineProperty(this,"b",void 0),_defineProperty(this,"a",void 0),this.r=t,this.g=r,this.b=i,this.a=o||1}return _createClass(Color,[{key:"toHex",value:function toHex(){return"#"+this.r.toString(16)+this.g.toString(16)+this.b.toString(16)}},{key:"toRgb",value:function toRgb(){return"rgb(".concat(this.r,", ").concat(this.g,", ").concat(this.b,")")}},{key:"toRgba",value:function toRgba(){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(this.a,")")}},{key:"toAlpha",value:function toAlpha(t){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(t,")")}},{key:"equals",value:function equals(t){return this.a===t.a&&this.r===t.r&&this.g===t.g&&this.b===t.b}}],[{key:"fromHex",value:function fromHex(t){var r=t.trim();if(0!==r.indexOf("#"))throw new Error("Not a hex color representation");return r=r.substr(r.indexOf("#")+1),new Color(parseInt(r.substr(0,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(4,2),16))}},{key:"fromRGBString",value:function fromRGBString(t){var r=t.trim();if(0!==r.indexOf("rgb"))throw new Error("Not a rgb color representation");var i=ue.exec(r);return new Color(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),i[5]?parseFloat(i[5]):1)}},{key:"fromRGBNumber",value:function fromRGBNumber(t){return new Color(t>>16&255,t>>8&255,255&t,(t>>24&255)/255)}}]),Color}();function highlighter_tool_createSuper(t){var r=function highlighter_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var he=function(t){_inherits(HighlighterTool,t);var r=highlighter_tool_createSuper(HighlighterTool);function HighlighterTool(){var t;_classCallCheck(this,HighlighterTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),t}return _createClass(HighlighterTool,[{key:"begin",value:function begin(t,r){this.shape=new ie(this.shapeHandle,this.brush),this.shape.addPoint(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}}]),HighlighterTool}($);function highlighter_action_createSuper(t){var r=function highlighter_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pe=function(t){_inherits(HighlighterAction,t);var r=highlighter_action_createSuper(HighlighterAction);function HighlighterAction(){return _classCallCheck(this,HighlighterAction),r.apply(this,arguments)}return _createClass(HighlighterAction,[{key:"execute",value:function execute(t){var r=new he;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setTool(r)}}]),HighlighterAction}(X);function pointer_shape_createSuper(t){var r=function pointer_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var fe=function(t){_inherits(PointerShape,t);var r=pointer_shape_createSuper(PointerShape);function PointerShape(){return _classCallCheck(this,PointerShape),r.apply(this,arguments)}return _createClass(PointerShape,[{key:"addPoint",value:function addPoint(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return this.updateBounds(),this.fireShapeEvent(new ee(this,this.bounds)),!0}},{key:"updateBounds",value:function updateBounds(){var t=this.points[0],r=this.brush.width;this.bounds.set(t.x-r,t.y-r,t.x+2*r,t.y+2*r)}}]),PointerShape}(ie);function pointer_tool_createSuper(t){var r=function pointer_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ge=function(t){_inherits(PointerTool,t);var r=pointer_tool_createSuper(PointerTool);function PointerTool(){var t;_classCallCheck(this,PointerTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"page",void 0),t}return _createClass(PointerTool,[{key:"begin",value:function begin(t,r){this.page=r.page,this.shape=new fe(this.shapeHandle,this.brush),this.shape.addPoint(t),this.page.addShape(this.shape)}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}},{key:"end",value:function end(t){this.page.removeShape(this.shape)}}]),PointerTool}($);function pointer_action_createSuper(t){var r=function pointer_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var me=function(t){_inherits(PointerAction,t);var r=pointer_action_createSuper(PointerAction);function PointerAction(){return _classCallCheck(this,PointerAction),r.apply(this,arguments)}return _createClass(PointerAction,[{key:"execute",value:function execute(t){var r=new ge;r.brush=this.brush,t.setTool(r)}}]),PointerAction}(X);function form_shape_createSuper(t){var r=function form_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ye=function(t){_inherits(FormShape,t);var r=form_shape_createSuper(FormShape);function FormShape(){return _classCallCheck(this,FormShape),r.apply(this,arguments)}return _createClass(FormShape,[{key:"setP0",value:function setP0(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return!0}},{key:"setP1",value:function setP1(t){if(this.points.length>1){var r=this.points[1];if(t.equals(r))return!1;this.points[1]=t}else this.points.push(t);return this.updateBounds(),this.fireShapeEvent(new ee(this,this.bounds)),!0}},{key:"updateBounds",value:function updateBounds(){if(!(this.points.length<2)){var t=this.points[0],r=this.points[1];r.x<t.x?(this.bounds.x=r.x,this.bounds.width=t.x-r.x):(this.bounds.x=t.x,this.bounds.width=r.x-t.x),r.y<t.y?(this.bounds.y=r.y,this.bounds.height=t.y-r.y):(this.bounds.y=t.y,this.bounds.height=r.y-t.y)}}},{key:"fill",value:function fill(){var t=this.getKeyEvent();return null!=t&&t.altKey}}]),FormShape}(ie);function arrow_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function arrow_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return arrow_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return arrow_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function arrow_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function arrow_shape_createSuper(t){var r=function arrow_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ve=function(t){_inherits(ArrowShape,t);var r=arrow_shape_createSuper(ArrowShape);function ArrowShape(){return _classCallCheck(this,ArrowShape),r.apply(this,arguments)}return _createClass(ArrowShape,[{key:"clone",value:function clone(){var t=new ArrowShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=arrow_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),ArrowShape}(ye);function arrow_tool_createSuper(t){var r=function arrow_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var _e=function(t){_inherits(ArrowTool,t);var r=arrow_tool_createSuper(ArrowTool);function ArrowTool(){var t;_classCallCheck(this,ArrowTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(ArrowTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new ve(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),ArrowTool}($);function arrow_action_createSuper(t){var r=function arrow_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var be=function(t){_inherits(ArrowAction,t);var r=arrow_action_createSuper(ArrowAction);function ArrowAction(){return _classCallCheck(this,ArrowAction),r.apply(this,arguments)}return _createClass(ArrowAction,[{key:"execute",value:function execute(t){var r=new _e;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),ArrowAction}(X);function line_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function line_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return line_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return line_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function line_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function line_shape_createSuper(t){var r=function line_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ae=function(t){_inherits(LineShape,t);var r=line_shape_createSuper(LineShape);function LineShape(){return _classCallCheck(this,LineShape),r.apply(this,arguments)}return _createClass(LineShape,[{key:"clone",value:function clone(){var t=new LineShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=line_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),LineShape}(ye);function line_tool_createSuper(t){var r=function line_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Se=function(t){_inherits(LineTool,t);var r=line_tool_createSuper(LineTool);function LineTool(){var t;_classCallCheck(this,LineTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(LineTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Ae(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),LineTool}($);function line_action_createSuper(t){var r=function line_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ce=function(t){_inherits(LineAction,t);var r=line_action_createSuper(LineAction);function LineAction(){return _classCallCheck(this,LineAction),r.apply(this,arguments)}return _createClass(LineAction,[{key:"execute",value:function execute(t){var r=new Se;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),LineAction}(X);function rectangle_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function rectangle_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return rectangle_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rectangle_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function rectangle_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function rectangle_shape_createSuper(t){var r=function rectangle_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Pe=function(t){_inherits(RectangleShape,t);var r=rectangle_shape_createSuper(RectangleShape);function RectangleShape(){return _classCallCheck(this,RectangleShape),r.apply(this,arguments)}return _createClass(RectangleShape,[{key:"contains",value:function contains(t){if(this.points.length<2)return!1;if(this.fill())return this.bounds.containsPoint(t);var r=this.brush.width,i=this.bounds.x,o=this.bounds.y,a=this.bounds.x+this.bounds.width,c=this.bounds.y;return!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x+this.bounds.width,o=this.bounds.y,a=this.bounds.x+this.bounds.width,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x+this.bounds.width,o=this.bounds.y+this.bounds.height,a=this.bounds.x,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x,o=this.bounds.y,a=this.bounds.x,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t))))}},{key:"intersects",value:function intersects(t){return null!=this.bounds.intersection(t)}},{key:"clone",value:function clone(){var t=new RectangleShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=rectangle_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}},{key:"intersectsSegment",value:function intersectsSegment(t,r,i,o,a,c){var l=c.x+t,u=c.y+t,d=c.x-t,h=c.y-t;return!!re.intersects(r,i,o,a,l,u,d,h)||(l=c.x-t,u=c.y+t,d=c.x+t,h=c.y-t,!!re.intersects(r,i,o,a,l,u,d,h))}}]),RectangleShape}(ye);function rectangle_tool_createSuper(t){var r=function rectangle_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var we=function(t){_inherits(RectangleTool,t);var r=rectangle_tool_createSuper(RectangleTool);function RectangleTool(){var t;_classCallCheck(this,RectangleTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(RectangleTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Pe(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),RectangleTool}($);function rectangle_action_createSuper(t){var r=function rectangle_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var xe=function(t){_inherits(RectangleAction,t);var r=rectangle_action_createSuper(RectangleAction);function RectangleAction(){return _classCallCheck(this,RectangleAction),r.apply(this,arguments)}return _createClass(RectangleAction,[{key:"execute",value:function execute(t){var r=new we;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),RectangleAction}(X),ke=function(){function Ellipse(t,r,i,o){_classCallCheck(this,Ellipse),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),_defineProperty(this,"radiusX",void 0),_defineProperty(this,"radiusY",void 0),_defineProperty(this,"centerX",void 0),_defineProperty(this,"centerY",void 0),this.x=t,this.y=r,this.width=i,this.height=o,this.radiusX=.5*i,this.radiusY=.5*o,this.centerX=t+this.radiusX,this.centerY=r+this.radiusY}return _createClass(Ellipse,[{key:"containsPoint",value:function containsPoint(t,r){var i=this.width;if(i<=0)return!1;var o=this.height;if(o<=0)return!1;var a=(t-this.x)/i-.5,c=(r-this.y)/o-.5;return a*a+c*c<.25}},{key:"containsRect",value:function containsRect(t,r,i,o){return this.containsPoint(t,r)&&this.containsPoint(t+i,r)&&this.containsPoint(t,r+o)&&this.containsPoint(t+i,r+o)}},{key:"intersectsRect",value:function intersectsRect(t,r,i,o){return!(i<=0||o<=0)&&(!(this.width<=0||this.height<=0)&&(this.centerX>=t&&this.centerY>=r&&this.centerX<=t+i&&this.centerY<=r+o||(this.intersectsLine(t,r,t+i,r)||this.intersectsLine(t,r+o,t+i,r+o)||this.intersectsLine(t,r,t,r+o)||this.intersectsLine(t+i,r,t+i,r+o))))}},{key:"intersectsLine",value:function intersectsLine(t,r,i,o){if(this.width<=0||this.height<=0)return!1;t-=this.centerX,i-=this.centerX,r-=this.centerY,o-=this.centerY;var a=this.radiusX*this.radiusX,c=this.radiusY*this.radiusY,l=Math.pow(i-t,2)/a+Math.pow(o-r,2)/c,u=2*t*(i-t)/a+2*r*(o-r)/c,d=u*u-4*l*(t*t/a+r*r/c-1);if(0===d){var h=-u/2/l;return h>=0&&h<=1}if(d>0){var p=Math.sqrt(d),g=(-u+p)/2/l,m=(-u-p)/2/l;return g>=0&&g<=1||m>=0&&m<=1}return!1}}]),Ellipse}();function ellipse_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function ellipse_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return ellipse_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ellipse_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function ellipse_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function ellipse_shape_createSuper(t){var r=function ellipse_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Te=function(t){_inherits(EllipseShape,t);var r=ellipse_shape_createSuper(EllipseShape);function EllipseShape(){return _classCallCheck(this,EllipseShape),r.apply(this,arguments)}return _createClass(EllipseShape,[{key:"contains",value:function contains(t){if(this.points.length<2)return!1;var r=new ke(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);return this.fill()?r.containsPoint(t.x,t.y):r.intersectsLine(t.x,t.y,t.x+this.brush.width,t.y+this.brush.width)}},{key:"intersects",value:function intersects(t){return!(this.points.length<2)&&new ke(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height).intersectsRect(t.x,t.y,t.width,t.height)}},{key:"clone",value:function clone(){var t=new EllipseShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=ellipse_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),EllipseShape}(ye);function ellipse_tool_createSuper(t){var r=function ellipse_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Re=function(t){_inherits(EllipseTool,t);var r=ellipse_tool_createSuper(EllipseTool);function EllipseTool(){var t;_classCallCheck(this,EllipseTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(EllipseTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Te(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new Z([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),EllipseTool}($);function ellipse_action_createSuper(t){var r=function ellipse_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ee=function(t){_inherits(EllipseAction,t);var r=ellipse_action_createSuper(EllipseAction);function EllipseAction(){return _classCallCheck(this,EllipseAction),r.apply(this,arguments)}return _createClass(EllipseAction,[{key:"execute",value:function execute(t){var r=new Re;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),EllipseAction}(X);function tool_action_createSuper(t){var r=function tool_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ie=function(t){_inherits(ToolAction,t);var r=tool_action_createSuper(ToolAction);function ToolAction(t){var i;return _classCallCheck(this,ToolAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"point",void 0),i.point=t,i}return _createClass(ToolAction)}(Q);function tool_begin_action_createSuper(t){var r=function tool_begin_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Me=function(t){_inherits(ToolBeginAction,t);var r=tool_begin_action_createSuper(ToolBeginAction);function ToolBeginAction(){return _classCallCheck(this,ToolBeginAction),r.apply(this,arguments)}return _createClass(ToolBeginAction,[{key:"execute",value:function execute(t){t.beginTool(this.point)}}]),ToolBeginAction}(Ie);function tool_execute_action_createSuper(t){var r=function tool_execute_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var De=function(t){_inherits(ToolExecuteAction,t);var r=tool_execute_action_createSuper(ToolExecuteAction);function ToolExecuteAction(){return _classCallCheck(this,ToolExecuteAction),r.apply(this,arguments)}return _createClass(ToolExecuteAction,[{key:"execute",value:function execute(t){t.executeTool(this.point)}}]),ToolExecuteAction}(Ie);function tool_end_action_createSuper(t){var r=function tool_end_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Oe=function(t){_inherits(ToolEndAction,t);var r=tool_end_action_createSuper(ToolEndAction);function ToolEndAction(){return _classCallCheck(this,ToolEndAction),r.apply(this,arguments)}return _createClass(ToolEndAction,[{key:"execute",value:function execute(t){t.endTool(this.point)}}]),ToolEndAction}(Ie),Le=function(){function AtomicTool(){_classCallCheck(this,AtomicTool)}return _createClass(AtomicTool,[{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),AtomicTool}();function undo_tool_createSuper(t){var r=function undo_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Fe=function(t){_inherits(UndoTool,t);var r=undo_tool_createSuper(UndoTool);function UndoTool(){return _classCallCheck(this,UndoTool),r.apply(this,arguments)}return _createClass(UndoTool,[{key:"begin",value:function begin(t,r){r.page.undo()}}]),UndoTool}(Le);function undo_action_createSuper(t){var r=function undo_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ne=function(t){_inherits(UndoAction,t);var r=undo_action_createSuper(UndoAction);function UndoAction(){return _classCallCheck(this,UndoAction),r.apply(this,arguments)}return _createClass(UndoAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Fe)}}]),UndoAction}(Q);function redo_tool_createSuper(t){var r=function redo_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Be=function(t){_inherits(RedoTool,t);var r=redo_tool_createSuper(RedoTool);function RedoTool(){return _classCallCheck(this,RedoTool),r.apply(this,arguments)}return _createClass(RedoTool,[{key:"begin",value:function begin(t,r){r.page.redo()}}]),RedoTool}(Le);function redo_action_createSuper(t){var r=function redo_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var je=function(t){_inherits(RedoAction,t);var r=redo_action_createSuper(RedoAction);function RedoAction(){return _classCallCheck(this,RedoAction),r.apply(this,arguments)}return _createClass(RedoAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Be)}}]),RedoAction}(Q);function remove_shape_action_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function remove_shape_action_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return remove_shape_action_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return remove_shape_action_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function remove_shape_action_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function remove_shape_action_createSuper(t){var r=function remove_shape_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ve=function(t){_inherits(RemoveShapeAction,t);var r=remove_shape_action_createSuper(RemoveShapeAction);function RemoveShapeAction(t){return _classCallCheck(this,RemoveShapeAction),r.call(this,t)}return _createClass(RemoveShapeAction,[{key:"execute",value:function execute(t){var r,i=remove_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.removeShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"undo",value:function undo(t){var r,i=remove_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.addShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"redo",value:function redo(t){this.execute(t)}}]),RemoveShapeAction}(K);function clear_shapes_tool_createSuper(t){var r=function clear_shapes_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ue=function(t){_inherits(ClearShapesTool,t);var r=clear_shapes_tool_createSuper(ClearShapesTool);function ClearShapesTool(){return _classCallCheck(this,ClearShapesTool),r.apply(this,arguments)}return _createClass(ClearShapesTool,[{key:"begin",value:function begin(t,r){var i=Object.assign([],r.page.getShapes());r.page.addAction(new Ve(i))}}]),ClearShapesTool}(Le);function clear_shapes_action_createSuper(t){var r=function clear_shapes_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ze=function(t){_inherits(ClearShapesAction,t);var r=clear_shapes_action_createSuper(ClearShapesAction);function ClearShapesAction(){return _classCallCheck(this,ClearShapesAction),r.apply(this,arguments)}return _createClass(ClearShapesAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Ue)}}]),ClearShapesAction}(Q);function key_action_createSuper(t){var r=function key_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Je=function(t){_inherits(KeyAction,t);var r=key_action_createSuper(KeyAction);function KeyAction(){return _classCallCheck(this,KeyAction),r.apply(this,arguments)}return _createClass(KeyAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent)}}]),KeyAction}(Q);function clone_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function clone_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return clone_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return clone_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function clone_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var He=function(){function CloneTool(){_classCallCheck(this,CloneTool),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"selectedShapes",void 0)}return _createClass(CloneTool,[{key:"begin",value:function begin(t,r){if(this.sourcePoint=t.clone(),this.context=r,this.getSelectedShapes(),this.hasSelectedShapes())if(this.hitSelected(t)){var i,o=new Array,a=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(a.s();!(i=a.n()).done;){var c=i.value.clone();o.push(c)}}catch(t){a.e(t)}finally{a.f()}r.page.addAction(new Z(o))}else this.removeSelection();else{var l=this.getTopLevelShape(t);if(null!=l){var u=l.clone();r.page.addAction(new Z([u])),this.addSelection(u)}}}},{key:"execute",value:function execute(t){this.sourcePoint.subtract(t),this.moveShapes(t,this.sourcePoint),this.sourcePoint=t.clone()}},{key:"end",value:function end(t){}},{key:"getTopLevelShape",value:function getTopLevelShape(t){var r,i=null,o=clone_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(o.s();!(r=o.n()).done;){var a=r.value;a.contains(t)&&(i=a)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"getSelectedShapes",value:function getSelectedShapes(){this.selectedShapes=new Array;var t,r=clone_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&this.selectedShapes.push(i)}}catch(t){r.e(t)}finally{r.f()}}},{key:"moveShapes",value:function moveShapes(t,r){if(this.hasSelectedShapes()){this.context.beginBulkRender();var i,o=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(o.s();!(i=o.n()).done;){i.value.moveByDelta(r)}}catch(t){o.e(t)}finally{o.f()}this.context.endBulkRender()}}},{key:"hasSelectedShapes",value:function hasSelectedShapes(){return 0!=this.selectedShapes.length}},{key:"addSelection",value:function addSelection(t){t.setSelected(!0),this.selectedShapes.push(t)}},{key:"removeSelection",value:function removeSelection(){this.context.beginBulkRender();var t,r=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(r.s();!(t=r.n()).done;){t.value.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.selectedShapes.length=0,this.context.endBulkRender()}},{key:"hitSelected",value:function hitSelected(t){var r,i=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){if(r.value.contains(t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}}]),CloneTool}();function clone_action_createSuper(t){var r=function clone_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ge=function(t){_inherits(CloneAction,t);var r=clone_action_createSuper(CloneAction);function CloneAction(){return _classCallCheck(this,CloneAction),r.apply(this,arguments)}return _createClass(CloneAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new He)}}]),CloneAction}(Q);function select_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function select_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return select_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return select_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function select_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var qe=function(){function SelectTool(){_classCallCheck(this,SelectTool),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"selectedShape",void 0)}return _createClass(SelectTool,[{key:"begin",value:function begin(t,r){this.sourcePoint=t.clone(),this.context=r,this.selectedShape=this.getTopLevelShape(t),this.removeSelection(),null!=this.selectedShape&&this.selectedShape.setSelected(!0)}},{key:"execute",value:function execute(t){null!=this.selectedShape&&(this.sourcePoint.subtract(t),this.context.beginBulkRender(),this.selectedShape.moveByDelta(this.sourcePoint),this.context.endBulkRender(),this.sourcePoint=t.clone())}},{key:"end",value:function end(t){null!=this.selectedShape&&(this.context.beginBulkRender(),this.selectedShape.setSelected(!1),this.context.endBulkRender())}},{key:"getTopLevelShape",value:function getTopLevelShape(t){var r,i=null,o=select_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(o.s();!(r=o.n()).done;){var a=r.value;a.contains(t)&&(i=a)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"removeSelection",value:function removeSelection(){this.context.beginBulkRender();var t,r=select_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&i.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.context.endBulkRender()}}]),SelectTool}();function select_action_createSuper(t){var r=function select_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var We=function(t){_inherits(SelectAction,t);var r=select_action_createSuper(SelectAction);function SelectAction(){return _classCallCheck(this,SelectAction),r.apply(this,arguments)}return _createClass(SelectAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new qe)}}]),SelectAction}(Q);function select_shape_createSuper(t){var r=function select_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ye,Qe=function(t){_inherits(SelectShape,t);var r=select_shape_createSuper(SelectShape);function SelectShape(){return _classCallCheck(this,SelectShape),r.call(this,0,null)}return _createClass(SelectShape)}(ye);function select_group_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function select_group_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return select_group_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return select_group_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function select_group_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}!function(t){t[t.Select=0]="Select",t[t.Move=1]="Move"}(Ye||(Ye={}));var Xe=function(){function SelectGroupTool(){_classCallCheck(this,SelectGroupTool),_defineProperty(this,"mode",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"selectedShapes",void 0),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"initialized",void 0)}return _createClass(SelectGroupTool,[{key:"begin",value:function begin(t,r){this.sourcePoint=t.clone(),this.context=r,this.initialized=!1,this.shape=new Qe,this.context.page.addShape(this.shape),this.getSelectedShapes(),this.hasSelectedShapes()?this.hitSelected(t)?this.mode=Ye.Move:(this.context.beginBulkRender(),this.removeSelection(),this.context.endBulkRender(),this.mode=Ye.Select):this.mode=Ye.Select}},{key:"execute",value:function execute(t){this.mode==Ye.Select?(this.initialized||(this.shape.setP0(t),this.initialized=!0),this.shape.addPoint(t.clone()),this.shape.setP1(t),this.selectGroup(this.shape.bounds)):this.mode==Ye.Move&&(this.sourcePoint.subtract(t),this.moveShapes(this.sourcePoint),this.sourcePoint=t.clone())}},{key:"end",value:function end(t){this.context.page.removeShape(this.shape),this.initialized=!1}},{key:"selectGroup",value:function selectGroup(t){this.context.beginBulkRender(),this.removeSelection();var r,i=select_group_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(i.s();!(r=i.n()).done;){var o=r.value;o!==this.shape&&(o.intersects(t)&&this.addSelection(o))}}catch(t){i.e(t)}finally{i.f()}this.context.endBulkRender()}},{key:"addSelection",value:function addSelection(t){t.setSelected(!0),this.selectedShapes.push(t)}},{key:"getSelectedShapes",value:function getSelectedShapes(){this.selectedShapes=new Array;var t,r=select_group_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&this.selectedShapes.push(i)}}catch(t){r.e(t)}finally{r.f()}}},{key:"hasSelectedShapes",value:function hasSelectedShapes(){return 0!=this.selectedShapes.length}},{key:"hitSelected",value:function hitSelected(t){var r,i=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){if(r.value.contains(t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}},{key:"removeSelection",value:function removeSelection(){var t,r=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(r.s();!(t=r.n()).done;){t.value.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.selectedShapes.length=0}},{key:"moveShapes",value:function moveShapes(t){if(this.hasSelectedShapes()){this.context.beginBulkRender();var r,i=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){r.value.moveByDelta(t)}}catch(t){i.e(t)}finally{i.f()}this.context.endBulkRender()}}}]),SelectGroupTool}();function select_group_action_createSuper(t){var r=function select_group_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var $e=function(t){_inherits(SelectGroupAction,t);var r=select_group_action_createSuper(SelectGroupAction);function SelectGroupAction(){return _classCallCheck(this,SelectGroupAction),r.apply(this,arguments)}return _createClass(SelectGroupAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Xe)}}]),SelectGroupAction}(Q),Ke=function(){function PanTool(){_classCallCheck(this,PanTool),_defineProperty(this,"context",void 0),_defineProperty(this,"lastPoint",void 0)}return _createClass(PanTool,[{key:"begin",value:function begin(t,r){this.context=r,this.lastPoint=t}},{key:"execute",value:function execute(t){var r=this.context.page.getSlideShape(),i=r.bounds,o=i.x+(this.lastPoint.x-t.x),a=i.y+(this.lastPoint.y-t.y);r.setPageRect(new te(o,a,i.width,i.height)),this.lastPoint=t}},{key:"end",value:function end(t){}}]),PanTool}();function pan_action_createSuper(t){var r=function pan_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ze=function(t){_inherits(PanAction,t);var r=pan_action_createSuper(PanAction);function PanAction(){return _classCallCheck(this,PanAction),r.apply(this,arguments)}return _createClass(PanAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Ke)}}]),PanAction}(Q);function extend_view_tool_createSuper(t){var r=function extend_view_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var et=function(t){_inherits(ExtendViewTool,t);var r=extend_view_tool_createSuper(ExtendViewTool);function ExtendViewTool(t){var i;return _classCallCheck(this,ExtendViewTool),_defineProperty(_assertThisInitialized(i=r.call(this)),"rect",void 0),i.rect=t,i}return _createClass(ExtendViewTool,[{key:"begin",value:function begin(t,r){r.page.getSlideShape().setPageRect(this.rect)}}]),ExtendViewTool}(Le);function extend_view_action_createSuper(t){var r=function extend_view_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var tt=function(t){_inherits(ExtendViewAction,t);var r=extend_view_action_createSuper(ExtendViewAction);function ExtendViewAction(t){var i;return _classCallCheck(this,ExtendViewAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"rect",void 0),i.rect=t,i}return _createClass(ExtendViewAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.selectAndExecuteTool(new et(this.rect))}}]),ExtendViewAction}(Q);function zoom_shape_createSuper(t){var r=function zoom_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var nt=function(t){_inherits(ZoomShape,t);var r=zoom_shape_createSuper(ZoomShape);function ZoomShape(){return _classCallCheck(this,ZoomShape),r.call(this,0,null)}return _createClass(ZoomShape,[{key:"updateBounds",value:function updateBounds(){_get(_getPrototypeOf(ZoomShape.prototype),"updateBounds",this).call(this);var t=this.bounds.width,r=Math.abs(3*t/4)*Math.sign(this.bounds.height);this.bounds.height=r}}]),ZoomShape}(ye),rt=function(){function ZoomTool(){_classCallCheck(this,ZoomTool),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"initialized",void 0)}return _createClass(ZoomTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new nt,this.context.page.addShape(this.shape)}},{key:"execute",value:function execute(t){this.initialized||(this.shape.setP0(t),this.initialized=!0),this.shape.setP1(t)}},{key:"end",value:function end(t){this.initialized=!1,this.context.page.removeShape(this.shape),this.context.page.getSlideShape().setPageRect(this.shape.bounds)}}]),ZoomTool}();function zoom_action_createSuper(t){var r=function zoom_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var it=function(t){_inherits(ZoomAction,t);var r=zoom_action_createSuper(ZoomAction);function ZoomAction(t,i){return _classCallCheck(this,ZoomAction),r.call(this,0,i)}return _createClass(ZoomAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new rt)}}]),ZoomAction}(X);function zoom_out_tool_createSuper(t){var r=function zoom_out_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ot=function(t){_inherits(ZoomOutTool,t);var r=zoom_out_tool_createSuper(ZoomOutTool);function ZoomOutTool(){return _classCallCheck(this,ZoomOutTool),r.apply(this,arguments)}return _createClass(ZoomOutTool,[{key:"begin",value:function begin(t,r){r.page.getSlideShape().setPageRect(new te(0,0,1,1))}}]),ZoomOutTool}(Le);function zoom_out_action_createSuper(t){var r=function zoom_out_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var at=function(t){_inherits(ZoomOutAction,t);var r=zoom_out_action_createSuper(ZoomOutAction);function ZoomOutAction(){return _classCallCheck(this,ZoomOutAction),r.apply(this,arguments)}return _createClass(ZoomOutAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.selectAndExecuteTool(new ot)}}]),ZoomOutAction}(Q);function delete_shape_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function delete_shape_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return delete_shape_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return delete_shape_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function delete_shape_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var st=function(){function DeleteShapeTool(t){_classCallCheck(this,DeleteShapeTool),_defineProperty(this,"shapeHandle",void 0),this.shapeHandle=t}return _createClass(DeleteShapeTool,[{key:"begin",value:function begin(t,r){var i,o=delete_shape_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.handle===this.shapeHandle){r.page.addAction(new Ve(new Array(a)));break}}}catch(t){o.e(t)}finally{o.f()}}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),DeleteShapeTool}();function rubber_action_createSuper(t){var r=function rubber_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ct=function(t){_inherits(RubberAction,t);var r=rubber_action_createSuper(RubberAction);function RubberAction(t){var i;return _classCallCheck(this,RubberAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"shapeHandle",void 0),i.shapeHandle=t,i}return _createClass(RubberAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new st(this.shapeHandle)),t.beginTool(new Y(0,0,0))}}]),RubberAction}(Q);function typesetting_shape_createSuper(t){var r=function typesetting_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var lt=function(t){_inherits(TypesettingShape,t);var r=typesetting_shape_createSuper(TypesettingShape);function TypesettingShape(){var t;_classCallCheck(this,TypesettingShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"textAttributes",void 0),_defineProperty(_assertThisInitialized(t),"textColor",void 0),_defineProperty(_assertThisInitialized(t),"text",void 0),t}return _createClass(TypesettingShape,[{key:"setText",value:function setText(t){this.text!==t&&(this.text=t,this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"getText",value:function getText(){return this.text}},{key:"setTextColor",value:function setTextColor(t){this.textColor&&this.textColor.equals(t)||(this.textColor=t,this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"getTextColor",value:function getTextColor(){return this.textColor}},{key:"setTextAttributes",value:function setTextAttributes(t){this.textAttributes=new Map(t),this.fireShapeEvent(new ee(this,this.bounds))}},{key:"getTextAttributes",value:function getTextAttributes(){return this.textAttributes}},{key:"isUnderline",value:function isUnderline(){return this.textAttributes.get("underline")}},{key:"isStrikethrough",value:function isStrikethrough(){return this.textAttributes.get("strikethrough")}},{key:"setLocation",value:function setLocation(t){return(this.bounds.x!==t.x||this.bounds.y!==t.y)&&(this.bounds.x=t.x,this.bounds.y=t.y,this.fireShapeEvent(new ee(this,this.bounds)),!0)}},{key:"updateBounds",value:function updateBounds(){}}]),TypesettingShape}(ne);function text_shape_createSuper(t){var r=function text_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ut=function(t){_inherits(TextShape,t);var r=text_shape_createSuper(TextShape);function TextShape(){var t;_classCallCheck(this,TextShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"font",void 0),t}return _createClass(TextShape,[{key:"setFont",value:function setFont(t){this.font&&this.font.equals(t)||(this.font=t,this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"getFont",value:function getFont(){return this.font}},{key:"clone",value:function clone(){var t=new TextShape(this.handle);return t.setLocation(new a(this.bounds.x,this.bounds.y)),t.setFont(this.font),t.setTextColor(this.getTextColor()),t.setTextAttributes(new Map(this.getTextAttributes())),t}}]),TextShape}(lt),dt=function(){function TextTool(t){_classCallCheck(this,TextTool),_defineProperty(this,"handle",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),this.handle=t}return _createClass(TextTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new ut(this.handle)}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){this.shape.setLocation(t),this.context.page.addShape(this.shape)}}]),TextTool}();function text_action_createSuper(t){var r=function text_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ht=function(t){_inherits(TextAction,t);var r=text_action_createSuper(TextAction);function TextAction(t){var i;return _classCallCheck(this,TextAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new dt(this.handle))}}]),TextAction}(Q);function text_font_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_font_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_font_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_font_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_font_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_font_tool_createSuper(t){var r=function text_font_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pt=function(t){_inherits(TextFontTool,t);var r=text_font_tool_createSuper(TextFontTool);function TextFontTool(t,i,o,a){var c;return _classCallCheck(this,TextFontTool),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(TextFontTool,[{key:"begin",value:function begin(t,r){var i,o=text_font_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof ut&&a.handle===this.handle){a.setFont(this.font),a.setTextColor(this.textColor),a.setTextAttributes(this.textAttributes);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextFontTool}(Le);function text_font_action_createSuper(t){var r=function text_font_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ft=function(t){_inherits(TextFontAction,t);var r=text_font_action_createSuper(TextFontAction);function TextFontAction(t,i,o,a){var c;return _classCallCheck(this,TextFontAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(TextFontAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new pt(this.handle,this.font,this.textColor,this.textAttributes))}}]),TextFontAction}(Q);function text_change_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_change_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_change_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_change_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_change_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_change_tool_createSuper(t){var r=function text_change_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var gt=function(t){_inherits(TextChangeTool,t);var r=text_change_tool_createSuper(TextChangeTool);function TextChangeTool(t,i){var o;return _classCallCheck(this,TextChangeTool),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"text",void 0),o.handle=t,o.text=i,o}return _createClass(TextChangeTool,[{key:"begin",value:function begin(t,r){var i,o=text_change_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof lt&&a.handle===this.handle){a.setText(this.text);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextChangeTool}(Le);function text_change_action_createSuper(t){var r=function text_change_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var mt=function(t){_inherits(TextChangeAction,t);var r=text_change_action_createSuper(TextChangeAction);function TextChangeAction(t,i){var o;return _classCallCheck(this,TextChangeAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"text",void 0),o.handle=t,o.text=i,o}return _createClass(TextChangeAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new gt(this.handle,this.text))}}]),TextChangeAction}(Q);function text_move_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_move_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_move_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_move_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_move_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_move_tool_createSuper(t){var r=function text_move_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var yt=function(t){_inherits(TextMoveTool,t);var r=text_move_tool_createSuper(TextMoveTool);function TextMoveTool(t,i){var o;return _classCallCheck(this,TextMoveTool),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"point",void 0),o.handle=t,o.point=i,o}return _createClass(TextMoveTool,[{key:"begin",value:function begin(t,r){var i,o=text_move_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof lt&&a.handle===this.handle){r.beginBulkRender(),a.setLocation(this.point),r.endBulkRender();break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextMoveTool}(Le);function text_move_action_createSuper(t){var r=function text_move_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var vt=function(t){_inherits(TextMoveAction,t);var r=text_move_action_createSuper(TextMoveAction);function TextMoveAction(t,i){var o;return _classCallCheck(this,TextMoveAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"point",void 0),o.handle=t,o.point=i,o}return _createClass(TextMoveAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new yt(this.handle,this.point))}}]),TextMoveAction}(Q);function text_remove_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_remove_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_remove_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_remove_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_remove_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_remove_tool_createSuper(t){var r=function text_remove_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var _t=function(t){_inherits(TextRemoveTool,t);var r=text_remove_tool_createSuper(TextRemoveTool);function TextRemoveTool(t){var i;return _classCallCheck(this,TextRemoveTool),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextRemoveTool,[{key:"begin",value:function begin(t,r){var i,o=text_remove_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof lt&&a.handle===this.handle){r.page.removeShape(a);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextRemoveTool}(Le);function text_remove_action_createSuper(t){var r=function text_remove_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var bt=function(t){_inherits(TextRemoveAction,t);var r=text_remove_action_createSuper(TextRemoveAction);function TextRemoveAction(t){var i;return _classCallCheck(this,TextRemoveAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextRemoveAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new _t(this.handle))}}]),TextRemoveAction}(Q),At=function(){function Font(t,r,i,o){_classCallCheck(this,Font),_defineProperty(this,"family",void 0),_defineProperty(this,"size",void 0),_defineProperty(this,"style",void 0),_defineProperty(this,"weight",void 0),this.family=t,this.size=r,this.style=i,this.weight=o}return _createClass(Font,[{key:"equals",value:function equals(t){return!!t&&(this===t||this.family===t.family&&this.size===t.size&&this.style===t.style&&this.weight===t.weight)}},{key:"toString",value:function toString(){var t=this.size+"px "+this.family;return this.weight&&(t=this.weight+" "+t),this.style&&(t=this.style+" "+t),t}}]),Font}();function text_highlight_shape_createSuper(t){var r=function text_highlight_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var St=function(t){_inherits(TextHighlightShape,t);var r=text_highlight_shape_createSuper(TextHighlightShape);function TextHighlightShape(t,i){var o;return _classCallCheck(this,TextHighlightShape),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"color",void 0),o.color=i,o}return _createClass(TextHighlightShape,[{key:"addTextBounds",value:function addTextBounds(t){this.bounds.isEmpty()?this.bounds.set(t.x,t.y,t.width,t.height):this.bounds.union(t),this.fireShapeEvent(new ee(this,this.bounds))}},{key:"getColor",value:function getColor(){return this.color}},{key:"contains",value:function contains(t){return this.bounds.containsPoint(t)}},{key:"intersects",value:function intersects(t){return null!=this.bounds.intersection(t)}},{key:"clone",value:function clone(){var t=new TextHighlightShape(this.handle,this.color);return t.setKeyEvent(this.getKeyEvent()),t}},{key:"updateBounds",value:function updateBounds(){}}]),TextHighlightShape}(ne);function text_highlight_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_highlight_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_highlight_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_highlight_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_highlight_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Ct=function(){function TextHighlightTool(t,r,i){_classCallCheck(this,TextHighlightTool),_defineProperty(this,"shapeHandle",void 0),_defineProperty(this,"color",void 0),_defineProperty(this,"textBounds",void 0),this.shapeHandle=t,this.color=r,this.textBounds=i}return _createClass(TextHighlightTool,[{key:"begin",value:function begin(t,r){if(!(this.textBounds.length<1)){var i,o=null,a=text_highlight_tool_createForOfIteratorHelper(r.page.getShapes());try{for(a.s();!(i=a.n()).done;){var c=i.value;if(c.handle===this.shapeHandle){o=c;break}}}catch(t){a.e(t)}finally{a.f()}o||(o=new St(this.shapeHandle,this.color),r.page.addAction(new Z([o])));var l,u=text_highlight_tool_createForOfIteratorHelper(this.textBounds);try{for(u.s();!(l=u.n()).done;){var d=l.value;o.addTextBounds(d)}}catch(t){u.e(t)}finally{u.f()}}}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),TextHighlightTool}();function text_highlight_action_createSuper(t){var r=function text_highlight_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Pt=function(t){_inherits(TextHighlightAction,t);var r=text_highlight_action_createSuper(TextHighlightAction);function TextHighlightAction(t,i,o){var a;return _classCallCheck(this,TextHighlightAction),_defineProperty(_assertThisInitialized(a=r.call(this)),"shapeHandle",void 0),_defineProperty(_assertThisInitialized(a),"color",void 0),_defineProperty(_assertThisInitialized(a),"textBounds",void 0),a.shapeHandle=t,a.color=i,a.textBounds=o,a}return _createClass(TextHighlightAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Ct(this.shapeHandle,this.color,this.textBounds)),t.beginTool(new Y(0,0,0))}}]),TextHighlightAction}(Q);function latex_shape_createSuper(t){var r=function latex_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var wt=function(t){_inherits(LatexShape,t);var r=latex_shape_createSuper(LatexShape);function LatexShape(){var t;_classCallCheck(this,LatexShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"font",void 0),t}return _createClass(LatexShape,[{key:"setFont",value:function setFont(t){this.font&&this.font.equals(t)||(this.font=t,this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"getFont",value:function getFont(){return this.font}},{key:"clone",value:function clone(){var t=new LatexShape(this.handle);return t.setLocation(new a(this.bounds.x,this.bounds.y)),t.setFont(this.font),t.setTextColor(this.getTextColor()),t.setTextAttributes(new Map(this.getTextAttributes())),t}}]),LatexShape}(lt),xt=function(){function LatexTool(t){_classCallCheck(this,LatexTool),_defineProperty(this,"handle",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),this.handle=t}return _createClass(LatexTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new wt(this.handle)}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){this.shape.setLocation(t),this.context.page.addShape(this.shape)}}]),LatexTool}();function latex_action_createSuper(t){var r=function latex_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var kt=function(t){_inherits(LatexAction,t);var r=latex_action_createSuper(LatexAction);function LatexAction(t){var i;return _classCallCheck(this,LatexAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(LatexAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new xt(this.handle))}}]),LatexAction}(Q);function latex_font_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function latex_font_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return latex_font_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return latex_font_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function latex_font_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function latex_font_tool_createSuper(t){var r=function latex_font_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Tt=function(t){_inherits(LatexFontTool,t);var r=latex_font_tool_createSuper(LatexFontTool);function LatexFontTool(t,i,o,a){var c;return _classCallCheck(this,LatexFontTool),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(LatexFontTool,[{key:"begin",value:function begin(t,r){var i,o=latex_font_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof wt&&a.handle===this.handle){a.setFont(this.font),a.setTextColor(this.textColor),a.setTextAttributes(this.textAttributes);break}}}catch(t){o.e(t)}finally{o.f()}}}]),LatexFontTool}(Le);function latex_font_action_createSuper(t){var r=function latex_font_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Rt=function(t){_inherits(LatexFontAction,t);var r=latex_font_action_createSuper(LatexFontAction);function LatexFontAction(t,i,o,a){var c;return _classCallCheck(this,LatexFontAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(LatexFontAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Tt(this.handle,this.font,this.textColor,this.textAttributes))}}]),LatexFontAction}(Q),Et=function(){function ActionParser(){_classCallCheck(this,ActionParser)}return _createClass(ActionParser,null,[{key:"parse",value:function parse(t,r,i){var o=null,a=this.parseActionHeader(t);switch(i-=13,r){case G.CLEAR_SHAPES:o=this.atomicAction(t,ze);break;case G.UNDO:o=this.atomicAction(t,Ne);break;case G.REDO:o=this.atomicAction(t,je);break;case G.KEY:o=this.atomicAction(t,Je);break;case G.PEN:o=this.toolBrushAction(t,ce);break;case G.HIGHLIGHTER:o=this.toolBrushAction(t,pe);break;case G.POINTER:o=this.toolBrushAction(t,me);break;case G.ARROW:o=this.toolBrushAction(t,be);break;case G.LINE:o=this.toolBrushAction(t,Ce);break;case G.RECTANGLE:o=this.toolBrushAction(t,xe);break;case G.ELLIPSE:o=this.toolBrushAction(t,Ee);break;case G.CLONE:o=this.atomicAction(t,Ge);break;case G.SELECT:o=this.atomicAction(t,We);break;case G.SELECT_GROUP:o=this.atomicAction(t,$e);break;case G.LATEX:o=this.textAction(t,kt);break;case G.LATEX_FONT_CHANGE:o=this.latexFontAction(t);break;case G.TEXT:o=this.textAction(t,ht);break;case G.TEXT_CHANGE:o=this.textChangeAction(t);break;case G.TEXT_FONT_CHANGE:o=this.textFontAction(t);break;case G.TEXT_LOCATION_CHANGE:o=this.textMoveAction(t);break;case G.TEXT_REMOVE:o=this.textRemoveAction(t);break;case G.TEXT_SELECTION_EXT:o=this.textHighlightAction(t);break;case G.TOOL_BEGIN:o=this.toolDragAction(t,Me);break;case G.TOOL_EXECUTE:o=this.toolDragAction(t,De);break;case G.TOOL_END:o=this.toolDragAction(t,Oe);break;case G.PANNING:o=this.atomicAction(t,Ze);break;case G.EXTEND_VIEW:o=this.extendViewAction(t);break;case G.ZOOM:o=i<1?this.atomicAction(t,it):this.toolBrushAction(t,it);break;case G.ZOOM_OUT:o=this.atomicAction(t,at);break;case G.RUBBER_EXT:o=this.rubberAction(t)}return o&&(o.keyEvent=a),o}},{key:"parseActionHeader",value:function parseActionHeader(t){var r=null;return(t.getInt32()&this.KEY_EVENT_MASK)==this.KEY_EVENT_MASK&&(r=this.parseKeyEvent(t)),r}},{key:"parseKeyEvent",value:function parseKeyEvent(t){t.getInt32();var r,i=t.getInt32();switch(t.getInt8()){case 0:r="keydown";break;case 1:r="keyup";break;case 2:r="keypress";break;default:throw new Error("Unknown key event type")}return new KeyboardEvent(r,{shiftKey:0!=(2&i),ctrlKey:0!=(4&i),altKey:0!=(8&i)})}},{key:"atomicAction",value:function atomicAction(t,r){return new r}},{key:"toolBrushAction",value:function toolBrushAction(t,r){var i=t.getInt32(),o=t.getInt32(),a=(t.getInt8(),t.getFloat64()),c=de.fromRGBNumber(o);return new r(i,new le(c,a))}},{key:"rubberAction",value:function rubberAction(t){var r=t.getInt32();return new ct(r)}},{key:"toolDragAction",value:function toolDragAction(t,r){return new r(new Y(t.getFloat32(),t.getFloat32(),t.getFloat32()))}},{key:"extendViewAction",value:function extendViewAction(t){var r=t.getFloat64(),i=t.getFloat64(),o=t.getFloat64(),a=t.getFloat64();return new tt(new te(r,i,o,a))}},{key:"textAction",value:function textAction(t,r){return new r(t.getInt32())}},{key:"textChangeAction",value:function textChangeAction(t){var r=t.getInt32(),i=t.getInt32(),o=t.getString(i);return new mt(r,o)}},{key:"textMoveAction",value:function textMoveAction(t){var r=t.getInt32(),i=new a(t.getFloat64(),t.getFloat64());return new vt(r,i)}},{key:"textRemoveAction",value:function textRemoveAction(t){var r=t.getInt32();return new bt(r)}},{key:"textHighlightAction",value:function textHighlightAction(t){for(var r=t.getInt32(),i=t.getInt32(),o=t.getInt32(),a=de.fromRGBNumber(i),c=new Array,l=0;l<o;l++){var u=t.getFloat64(),d=t.getFloat64(),h=t.getFloat64(),p=t.getFloat64();c.push(new te(u,d,h,p))}return new Pt(r,a,c)}},{key:"textFontAction",value:function textFontAction(t){var r,i=t.getInt32(),o=t.getInt32(),a=t.getInt32(),c=t.getString(a),l=t.getFloat64(),u=t.getInt8(),d=t.getInt8(),h=t.getInt8()>0,p=t.getInt8()>0,g=100*(d+1);switch(u){case 0:r="normal";break;case 1:r="italic";break;default:console.error("Unsupported font style")}var m=de.fromRGBNumber(o),y=new At(c,l,r,g.toString()),v=new Map;return v.set("strikethrough",h),v.set("underline",p),new ft(i,y,m,v)}},{key:"latexFontAction",value:function latexFontAction(t){var r=t.getInt32(),i=(t.getInt32(),t.getFloat32()),o=t.getInt32(),a=de.fromRGBNumber(o),c=new At("Arial",i),l=new Map;return new Rt(r,c,a,l)}}]),ActionParser}();_defineProperty(Et,"KEY_EVENT_MASK",1);var It,Mt=_createClass((function RecordedPage(){_classCallCheck(this,RecordedPage),_defineProperty(this,"staticActions",[]),_defineProperty(this,"playbackActions",[]),_defineProperty(this,"pageNumber",void 0),_defineProperty(this,"timestamp",void 0)})),Dt=function(){function RecordedPageParser(){_classCallCheck(this,RecordedPageParser)}return _createClass(RecordedPageParser,[{key:"parse",value:function parse(t){var r=new Mt,i=t.getInt32(),o=t.getInt32();r.pageNumber=i,r.timestamp=o;var a=t.getInt32();if(a>0)for(var c=t.byteOffset+a;t.byteOffset<c;){var l=t.getInt32(),u=t.getInt8(),d=t.getInt32(),h=Et.parse(t,u,l);h.timestamp=d,h&&r.staticActions.push(h)}var p=t.getInt32();if(p>0)for(var g=t.byteOffset+p;t.byteOffset<g;){var m=t.getInt32(),y=t.getInt8(),v=t.getInt32(),_=Et.parse(t,y,m);_.timestamp=v,_&&r.playbackActions.push(_)}return r}}]),RecordedPageParser}(),Ot=function(){function ToolContext(t){_classCallCheck(this,ToolContext),_defineProperty(this,"renderController",void 0),_defineProperty(this,"page",void 0),_defineProperty(this,"keyEvent",void 0),this.renderController=t}return _createClass(ToolContext,[{key:"beginBulkRender",value:function beginBulkRender(){this.renderController.beginBulkRender()}},{key:"endBulkRender",value:function endBulkRender(){this.renderController.endBulkRender()}}]),ToolContext}(),Lt=function(){function SimpleActionExecutor(t){_classCallCheck(this,SimpleActionExecutor),_defineProperty(this,"document",void 0),_defineProperty(this,"toolContext",void 0),_defineProperty(this,"tool",void 0),_defineProperty(this,"previousTool",void 0),_defineProperty(this,"pageNumber",void 0),this.document=t,this.toolContext=new Ot(null)}return _createClass(SimpleActionExecutor,[{key:"setOnSelectPageIndex",value:function setOnSelectPageIndex(t){}},{key:"setSeek",value:function setSeek(t){}},{key:"setKeyEvent",value:function setKeyEvent(t){this.toolContext.keyEvent=t}},{key:"setDocument",value:function setDocument(t){}},{key:"setPageNumber",value:function setPageNumber(t){if(this.pageNumber!==t){var r=this.document.getPage(t);this.pageNumber=t,this.toolContext.page=r}}},{key:"removePageNumber",value:function removePageNumber(t){}},{key:"setTool",value:function setTool(t){if(!t)throw new Error("Tool must not be null");(this.tool||this.tool!==t)&&(this.setPreviousTool(this.tool),this.tool=t)}},{key:"selectAndExecuteTool",value:function selectAndExecuteTool(t){var r=Y.createZero();this.setTool(t),this.beginTool(r),this.executeTool(r),this.endTool(r),this.setPreviousTool(this.previousTool)}},{key:"beginTool",value:function beginTool(t){this.tool.begin(t.clone(),this.toolContext)}},{key:"executeTool",value:function executeTool(t){this.tool.execute(t.clone())}},{key:"endTool",value:function endTool(t){this.tool.end(t.clone())}},{key:"setPreviousTool",value:function setPreviousTool(t){t&&(t instanceof Le||(this.previousTool=t))}}]),SimpleActionExecutor}(),Ft=function(){function PageEvent(t,r,i,o){_classCallCheck(this,PageEvent),_defineProperty(this,"_changeType",void 0),_defineProperty(this,"_page",void 0),_defineProperty(this,"_shape",void 0),_defineProperty(this,"_dirtyRegion",void 0),this._page=t,this._changeType=r,this._shape=i,this._dirtyRegion=o}return _createClass(PageEvent,[{key:"changeType",get:function get(){return this._changeType}},{key:"page",get:function get(){return this._page}},{key:"shape",get:function get(){return this._shape}},{key:"dirtyRegion",get:function get(){return this._dirtyRegion}}]),PageEvent}();!function(t){t.Clear="Clear",t.ShapeAdded="ShapeAdded",t.ShapeRemoved="ShapeRemoved",t.ShapeModified="ShapeModified",t.PageTransform="PageTransform"}(It||(It={}));var Nt=function(){function ActionHandler(t){_classCallCheck(this,ActionHandler),_defineProperty(this,"undoActions",[]),_defineProperty(this,"redoActions",[]),_defineProperty(this,"model",void 0),this.model=t}return _createClass(ActionHandler,[{key:"executeAction",value:function executeAction(t){this.undoActions.push(t),this.redoActions.length=0,t.execute(this.model)}},{key:"undo",value:function undo(){if(!(this.undoActions.length<1)){var t=this.undoActions.pop();this.redoActions.push(t),t.undo(this.model)}}},{key:"redo",value:function redo(){if(!(this.redoActions.length<1)){var t=this.redoActions.pop();this.undoActions.push(t),t.redo(this.model)}}},{key:"clear",value:function clear(){this.undoActions.length=0,this.redoActions.length=0}}]),ActionHandler}();function slide_shape_createSuper(t){var r=function slide_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Bt=function(t){_inherits(SlideShape,t);var r=slide_shape_createSuper(SlideShape);function SlideShape(t){var i;return _classCallCheck(this,SlideShape),_defineProperty(_assertThisInitialized(i=r.call(this,0)),"page",void 0),i.page=t,i.updateBounds(),i}return _createClass(SlideShape,[{key:"getPage",value:function getPage(){return this.page}},{key:"setPageRect",value:function setPageRect(t){this.bounds.equals(t)||(this.bounds.set(t.x,t.y,t.width,t.height),this.fireShapeEvent(new ee(this,this.bounds)))}},{key:"updateBounds",value:function updateBounds(){this.bounds.set(0,0,1,1)}}]),SlideShape}(ne),jt=function(){function Page(t,r){_classCallCheck(this,Page),_defineProperty(this,"shapeChangeListener",void 0),_defineProperty(this,"actionHandler",new Nt(this)),_defineProperty(this,"changeEvent",new L),_defineProperty(this,"shapes",[]),_defineProperty(this,"slideShape",void 0),_defineProperty(this,"document",void 0),_defineProperty(this,"pageNumber",void 0),this.document=t,this.pageNumber=r,this.slideShape=new Bt(this),this.slideShape.addChangeListener(this.onSlideTransform.bind(this)),this.shapeChangeListener=this.onShapeModified.bind(this)}return _createClass(Page,[{key:"render",value:function render(t,r,i){return this.document.renderPage(this.pageNumber,t,r,i)}},{key:"renderText",value:function renderText(t,r){this.document.renderPageText(this.pageNumber,t,r,this.getSlideShape().bounds)}},{key:"addChangeListener",value:function addChangeListener(t){return this.changeEvent.subscribe(t)}},{key:"removeChangeListener",value:function removeChangeListener(t){this.changeEvent.unsubscribe(t)}},{key:"addShape",value:function addShape(t){var r=this.shapes.length;this.shapes.push(t)>r&&(t.addChangeListener(this.shapeChangeListener),this.firePageEvent(new Ft(this,It.ShapeAdded,t)))}},{key:"removeShape",value:function removeShape(t){var r=this.shapes.indexOf(t);r>-1&&(this.shapes.splice(r,1).length>0&&(t.removeChangeListener(this.shapeChangeListener),this.firePageEvent(new Ft(this,It.ShapeRemoved,t))))}},{key:"getPageNumber",value:function getPageNumber(){return this.pageNumber}},{key:"getSlideShape",value:function getSlideShape(){return this.slideShape}},{key:"getShapes",value:function getShapes(){return this.shapes}},{key:"hasShapes",value:function hasShapes(){return this.shapes.length>0}},{key:"addAction",value:function addAction(t){this.actionHandler.executeAction(t)}},{key:"undo",value:function undo(){this.actionHandler.undo()}},{key:"redo",value:function redo(){this.actionHandler.redo()}},{key:"clear",value:function clear(){this.actionHandler.clear(),this.shapes.length=0,this.firePageEvent(new Ft(this,It.Clear,null))}},{key:"onSlideTransform",value:function onSlideTransform(t){this.firePageEvent(new Ft(this,It.PageTransform,t.shape,t.dirtyRegion))}},{key:"onShapeModified",value:function onShapeModified(t){this.firePageEvent(new Ft(this,It.ShapeModified,t.shape,t.dirtyRegion))}},{key:"firePageEvent",value:function firePageEvent(t){this.changeEvent.publish(t)}}]),Page}(),Vt=function(){function SlideDocument(){_classCallCheck(this,SlideDocument),_defineProperty(this,"pages",void 0),_defineProperty(this,"documentId",void 0)}return _createClass(SlideDocument,[{key:"getDocumentId",value:function getDocumentId(){return this.documentId}},{key:"setDocumentId",value:function setDocumentId(t){this.documentId=t}},{key:"getPageCount",value:function getPageCount(){return this.pages.length}},{key:"getPage",value:function getPage(t){if(t<0||t>this.pages.length-1)throw new Error("Page number ".concat(t," out of bounds."));return this.pages[t]}},{key:"deletePage",value:function deletePage(t){this.pages.splice(t,1)}}]),SlideDocument}(),Ut=function(){function WhiteboardRenderer(){_classCallCheck(this,WhiteboardRenderer)}var t;return _createClass(WhiteboardRenderer,[{key:"render",value:(t=_asyncToGenerator(U().mark((function _callee(t,r,i){return U().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){t.canvas.width=i.width,t.canvas.height=i.height,t.fillStyle="white",t.fillRect(i.x,i.y,i.width,i.height),r(t.canvas)})));case 1:case"end":return r.stop()}}),_callee)}))),function render(r,i,o){return t.apply(this,arguments)})}]),WhiteboardRenderer}();function whiteboard_document_createSuper(t){var r=function whiteboard_document_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var zt=function(t){_inherits(WhiteboardDocument,t);var r,i=whiteboard_document_createSuper(WhiteboardDocument);function WhiteboardDocument(){var t;return _classCallCheck(this,WhiteboardDocument),_defineProperty(_assertThisInitialized(t=i.call(this)),"renderer",void 0),t.renderer=new Ut,t.loadPages(),t}return _createClass(WhiteboardDocument,[{key:"getPageText",value:(r=_asyncToGenerator(U().mark((function _callee(t){return U().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve(""));case 1:case"end":return t.stop()}}),_callee)}))),function getPageText(t){return r.apply(this,arguments)})},{key:"renderPage",value:function renderPage(t,r,i,o){return this.renderer.render(r,i,o)}},{key:"renderPageText",value:function renderPageText(t,r,i,o){}},{key:"loadPages",value:function loadPages(){this.pages=[];for(var t=0;t<300;t++)this.pages.push(new jt(this,t))}}]),WhiteboardDocument}(Vt);function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o,a,c=[],l=!0,u=!1;try{for(i=i.call(t);!(l=(o=i.next()).done)&&(c.push(o.value),!r||c.length!==r);l=!0);}catch(t){u=!0,a=t}finally{try{l||null==i.return||i.return()}finally{if(u)throw a}}return c}}(t,r)||unsupportedIterableToArray_unsupportedIterableToArray(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function http_request_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function http_request_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return http_request_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return http_request_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function http_request_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Jt=function(){function HttpRequest(t){_classCallCheck(this,HttpRequest),_defineProperty(this,"requestOptions",void 0),_defineProperty(this,"onProgress",void 0),this.requestOptions=t||{returnType:"body",responseType:"json",withCredentials:!1,timeout:0}}return _createClass(HttpRequest,[{key:"setHttpParams",value:function setHttpParams(t){return this.requestOptions.params=t,this}},{key:"setHttpHeaders",value:function setHttpHeaders(t){return this.requestOptions.headers=t,this}},{key:"setReturnType",value:function setReturnType(t){return this.requestOptions.returnType=t,this}},{key:"setResponseType",value:function setResponseType(t){return this.requestOptions.responseType=t,this}},{key:"setWithCredentials",value:function setWithCredentials(t){return this.requestOptions.withCredentials=t,this}},{key:"setTimeout",value:function setTimeout(t){return this.requestOptions.timeout=t,this}},{key:"setOptions",value:function setOptions(t){return this.requestOptions=t,this}},{key:"setOnProgress",value:function setOnProgress(t){return this.onProgress=t,this}},{key:"delete",value:function _delete(t){return this.request("DELETE",t)}},{key:"get",value:function get(t){return this.request("GET",t)}},{key:"head",value:function head(t){return this.request("HEAD",t)}},{key:"options",value:function options(t){return this.request("OPTIONS",t)}},{key:"patch",value:function patch(t,r){return this.request("PATCH",t,r)}},{key:"post",value:function post(t,r){return this.request("POST",t,r)}},{key:"put",value:function put(t,r){return this.request("PUT",t,r)}},{key:"request",value:function request(t,r,i){var o=this,request=new XMLHttpRequest;return request.open(t,this.composeUrl(r),!0),request.responseType=this.requestOptions.responseType,request.timeout=this.requestOptions.timeout,request.withCredentials=this.requestOptions.withCredentials,this.setHeaders(i,request),new Promise((function(t,r){var a=function errorHandler(){r(o.getResponse(request))};request.onload=function(){if(request.status>=200&&request.status<400){var r=null;r="response"===o.requestOptions.returnType?o.getResponse(request):o.decodeBody(request),t(r)}else a()},request.ontimeout=a,request.onerror=a,o.onProgress&&(i&&request.upload?request.upload.onprogress=o.onProgress:request.onprogress=o.onProgress),request.send(o.encodeBody(i))}))}},{key:"getResponse",value:function getResponse(t){return{body:this.decodeBody(t),headers:this.getHeaders(t),status:t.status,statusText:t.statusText}}},{key:"composeUrl",value:function composeUrl(t){var r=this.requestOptions.params;if(!r)return t;var i=r?r.toString():"";if(i){var o=t.indexOf("?");t=t+(-1===o?"?":o<t.length-1?"&":"")+i}return t}},{key:"getContentType",value:function getContentType(t){return null==t?null:t instanceof Blob?t.type:t instanceof FormData?null:"string"==typeof t?"text/plain":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=UTF-8":"object"===_typeof(t)||"number"==typeof t||Array.isArray(t)?"application/json":null}},{key:"encodeBody",value:function encodeBody(t){return null==t?null:t instanceof ArrayBuffer||t instanceof Blob||t instanceof FormData||"string"==typeof t?t:"object"===_typeof(t)||"boolean"==typeof t||Array.isArray(t)?JSON.stringify(t):t.toString()}},{key:"decodeBody",value:function decodeBody(t){var r=t.response||null,i=t.responseType;if(!i){i=t.getResponseHeader("Content-Type");var o=new RegExp("^\\w+/(\\w+);?").exec(i);o&&(i=o[1])}return"json"===i&&"string"==typeof r&&(r=""!==r?JSON.parse(r):null),r}},{key:"setHeaders",value:function setHeaders(t,r){var i=this.requestOptions.headers;if(i){var o,a=http_request_createForOfIteratorHelper(i);try{for(a.s();!(o=a.n()).done;){var c=_slicedToArray(o.value,2),l=c[0],u=c[1];if(Array.isArray(u)){var d,h=http_request_createForOfIteratorHelper(u);try{for(h.s();!(d=h.n()).done;){var p=d.value;r.setRequestHeader(l,p)}}catch(t){h.e(t)}finally{h.f()}}else r.setRequestHeader(l,u)}}catch(t){a.e(t)}finally{a.f()}}if(!i||!i.has("Content-Type")){var g=this.getContentType(t);g&&r.setRequestHeader("Content-Type",g)}i&&i.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*")}},{key:"getHeaders",value:function getHeaders(t){var r=new Map,i=t.getAllResponseHeaders();if(i){var o,a=http_request_createForOfIteratorHelper(i.trim().split(/[\r\n]+/));try{for(a.s();!(o=a.n()).done;){var c=o.value,l=c.indexOf(":");if(l>0){var u=c.slice(0,l),d=c.slice(l+1).trim(),h=u.toLowerCase(),p=r.get(h);p?("string"==typeof p?[p]:p).push(d):r.set(h,d)}}}catch(t){a.e(t)}finally{a.f()}}return r}}]),HttpRequest}(),Ht=__webpack_require__(299),Gt=function(){function PdfRenderer(){_classCallCheck(this,PdfRenderer),_defineProperty(this,"backCanvas",document.createElement("canvas")),_defineProperty(this,"renderTask",void 0)}var t;return _createClass(PdfRenderer,[{key:"render",value:(t=_asyncToGenerator(U().mark((function _callee(t,r,i,o){var a,c,l,u,d,h,p,g=this;return U().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(!this.renderTask){m.next=2;break}return m.abrupt("return",null);case 2:return a=1/i.width,c=o.width*a,l=i.x*c,u=i.y*c,d=t.view[2]-t.view[0],h=a*(o.width/d),(p=t.getViewport({scale:h,dontFlip:!1})).transform[4]-=l,p.transform[5]-=u,this.backCanvas.width=o.width,this.backCanvas.height=o.height,this.renderTask=t.render({canvasContext:this.backCanvas.getContext("2d"),viewport:p}),m.abrupt("return",this.renderTask.promise.then((function(){return r.canvas.width=g.backCanvas.width,r.canvas.height=g.backCanvas.height,r.drawImage(g.backCanvas,0,0),g.renderTask=null,g.backCanvas}),(function(t){})));case 15:case"end":return m.stop()}}),_callee,this)}))),function render(r,i,o,a){return t.apply(this,arguments)})}]),PdfRenderer}(),qt=__webpack_require__(963),Wt=function(){function PdfTextRenderer(){_classCallCheck(this,PdfTextRenderer)}var t;return _createClass(PdfTextRenderer,[{key:"render",value:(t=_asyncToGenerator(U().mark((function _callee(t,r,i,o){var a,c,l,u,d,h,p,g,m;return U().wrap((function _callee$(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,t.getTextContent();case 2:a=y.sent,c=1/o.width,l=i.width*c,u=o.x*l,d=o.y*l,h=t.view[2]-t.view[0],p=c*(i.width/h),(g=t.getViewport({scale:p,dontFlip:!1})).transform[4]-=u,g.transform[5]-=d,(0,Ht.renderTextLayer)({textContent:a,container:r,viewport:g,enhanceTextSelection:!0,textDivs:[]}).promise.catch((function(t){console.error(t)})),(m=new qt.PDFLinkService).externalLinkTarget=2,new qt.AnnotationLayerBuilder({pageDiv:r,pdfPage:t,linkService:m}).render(g);case 17:case"end":return y.stop()}}),_callee)}))),function render(r,i,o,a){return t.apply(this,arguments)})}]),PdfTextRenderer}();function pdf_js_document_createSuper(t){var r=function pdf_js_document_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Yt=function(t){_inherits(PdfJsDocument,t);var r,i,o,a=pdf_js_document_createSuper(PdfJsDocument);function PdfJsDocument(t){var r;return _classCallCheck(this,PdfJsDocument),_defineProperty(_assertThisInitialized(r=a.call(this)),"document",void 0),_defineProperty(_assertThisInitialized(r),"renderer",void 0),_defineProperty(_assertThisInitialized(r),"textRenderer",void 0),r.document=t,r.renderer=new Gt,r.textRenderer=new Wt,r.loadPages(t),r}return _createClass(PdfJsDocument,[{key:"getPageText",value:(o=_asyncToGenerator(U().mark((function _callee(t){var r,i;return U().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.document.getPage(t+1);case 2:return r=o.sent,o.next=5,r.getTextContent();case 5:return i=o.sent,o.abrupt("return",i.items.map((function(t){return t.str})).join(" "));case 7:case"end":return o.stop()}}),_callee,this)}))),function getPageText(t){return o.apply(this,arguments)})},{key:"renderPage",value:(i=_asyncToGenerator(U().mark((function _callee2(t,r,i,o){var a;return U().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getPdfPage(t);case 2:return a=c.sent,c.abrupt("return",this.renderer.render(a,r,i,o));case 4:case"end":return c.stop()}}),_callee2,this)}))),function renderPage(t,r,o,a){return i.apply(this,arguments)})},{key:"renderPageText",value:(r=_asyncToGenerator(U().mark((function _callee3(t,r,i,o){var a;return U().wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getPdfPage(t);case 2:a=c.sent,this.textRenderer.render(a,r,i,o);case 4:case"end":return c.stop()}}),_callee3,this)}))),function renderPageText(t,i,o,a){return r.apply(this,arguments)})},{key:"getPdfPage",value:function getPdfPage(t){return this.document.getPage(t+1)}},{key:"loadPages",value:function loadPages(t){this.pages=[];for(var r=0;r<t.numPages;r++)this.pages.push(new jt(this,r))}}]),PdfJsDocument}(Vt),Qt=function(){function DocumentService(){_classCallCheck(this,DocumentService)}return _createClass(DocumentService,[{key:"loadDocument",value:function loadDocument(t){return new Promise((function(r,i){(0,Ht.getDocument)(t).promise.then((function(t){r(new Yt(t))})).catch((function(t){i(t)}))}))}}]),DocumentService}();function course_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function course_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return course_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return course_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function course_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Xt=function(){function CourseStateService(t){_classCallCheck(this,CourseStateService),_defineProperty(this,"apiPath","/course/state"),_defineProperty(this,"host",void 0),this.host=t}return _createClass(CourseStateService,[{key:"getCourseState",value:function getCourseState(t){return(new Jt).get(this.getFullPath("/"+t))}},{key:"getStateDocument",value:function getStateDocument(t,r){var i=this;return r.documentFile?new Promise((function(o,a){(new Jt).setResponseType("arraybuffer").get(r.documentFile).then((function(t){if(!t)throw new Error("Received empty course document");var r=new Uint8Array(t);return(new Qt).loadDocument(r)})).then((function(c){c.setDocumentId(r.documentId),i.preloadSlideDocument(t,r,c).then((function(){o(c)})).catch((function(t){a(t)}))})).catch((function(t){a(t)}))})):new Promise((function(o,a){var c=new zt;c.setDocumentId(r.documentId),i.preloadSlideDocument(t,r,c).then((function(){o(c)})).catch((function(t){a(t)}))}))}},{key:"getStateDocumentActions",value:function getStateDocumentActions(t,r){var i=this;return new Promise((function(o,a){return(new Jt).setResponseType("arraybuffer").get(i.getFullPath("/"+t+"/pages/"+r.documentId)).then((function(t){if(t){for(var r=new W(t),i=t.byteLength,c=[];r.byteOffset<i;){r.getInt32();var l=(new Dt).parse(r);l&&c.push(l)}o(c)}else a("Received empty course document")})).catch((function(t){a(t)}))}))}},{key:"preloadSlideDocument",value:function preloadSlideDocument(t,r,i){var o=this;return this.getStateDocumentActions(t,r).then((function(t){var r,a=new Lt(i),c=course_service_createForOfIteratorHelper(t);try{for(c.s();!(r=c.n()).done;){var l=r.value;o.loadActions(a,l)}}catch(t){c.e(t)}finally{c.f()}}))}},{key:"loadActions",value:function loadActions(t,r){var i=r.playbackActions;if(!(i.length<1)){t.setPageNumber(r.pageNumber);var o,a=course_service_createForOfIteratorHelper(i);try{for(a.s();!(o=a.n()).done;){var c=o.value;try{c.execute(t)}catch(t){console.error(t)}}}catch(t){a.e(t)}finally{a.f()}}}},{key:"getFullPath",value:function getFullPath(t){return this.host+this.apiPath+t}}]),CourseStateService}(),$t=__webpack_require__(835).default;Janus.sessions={},Janus.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var t=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),r=33;return window.navigator.userAgent.match("Linux")&&(r=35),t>=26&&t<=r||Janus.extension.isInstalled()}return!0};var Kt={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(t){var r=window.setTimeout((function(){var r=new Error("NavigatorUserMediaError");return r.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',t(r)}),1e3);this.cache[r]=t,window.postMessage({type:"janusGetScreen",id:r},"*")},init:function(){var t={};this.cache=t,window.addEventListener("message",(function(r){if(r.origin==window.location.origin)if("janusGotScreen"==r.data.type&&t[r.data.id]){var i=t[r.data.id];if(delete t[r.data.id],""===r.data.sourceId){var o=new Error("NavigatorUserMediaError");o.name="You cancelled the request for permission, giving up...",i(o)}else i(null,r.data.sourceId)}else"janusGetScreenPending"==r.data.type&&(console.log("clearing ",r.data.id),window.clearTimeout(r.data.id))}))}};function Janus(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.destroyed="function"==typeof t.destroyed?t.destroyed:Janus.noop,!Janus.initDone)return t.error("Library not initialized"),{};if(!Janus.isWebrtcSupported())return t.error("WebRTC not supported by this browser"),{};if(Janus.log("Library initialized: "+Janus.initDone),!t.server)return t.error("Invalid server url"),{};var r=!1,i=null,o={},a=null,c=null,l=0,u=t.server;Janus.isArray(u)?(Janus.log("Multiple servers provided ("+u.length+"), will use the first that works"),u=null,c=t.server,Janus.debug(c)):0===u.indexOf("ws")?(r=!0,Janus.log("Using WebSockets to contact Janus: "+u)):(r=!1,Janus.log("Using REST API to contact Janus: "+u));var d=t.iceServers||[{urls:"stun:stun.l.google.com:19302"}],h=t.iceTransportPolicy,p=t.bundlePolicy,g=!0===t.ipv6,m=!1;void 0!==t.withCredentials&&null!==t.withCredentials&&(m=!0===t.withCredentials);var y=10;void 0!==t.max_poll_events&&null!==t.max_poll_events&&(y=t.max_poll_events),y<1&&(y=1);var v=null;void 0!==t.token&&null!==t.token&&(v=t.token);var _=null;void 0!==t.apisecret&&null!==t.apisecret&&(_=t.apisecret),this.destroyOnUnload=!0,void 0!==t.destroyOnUnload&&null!==t.destroyOnUnload&&(this.destroyOnUnload=!0===t.destroyOnUnload);var b=25e3;void 0!==t.keepAlivePeriod&&null!==t.keepAlivePeriod&&(b=t.keepAlivePeriod),isNaN(b)&&(b=25e3);var A=6e4;function getMaxBitrates(t){var r={high:9e5,medium:3e5,low:1e5};return null!=t&&(t.high&&(r.high=t.high),t.medium&&(r.medium=t.medium),t.low&&(r.low=t.low)),r}void 0!==t.longPollTimeout&&null!==t.longPollTimeout&&(A=t.longPollTimeout),isNaN(A)&&(A=6e4);var S=!1,C=null,P={},w=this,x=0,k={};function eventHandler(){if(null!=C)if(Janus.debug("Long poll..."),S){var r=u+"/"+C+"?rid="+(new Date).getTime();y&&(r=r+"&maxev="+y),v&&(r=r+"&token="+encodeURIComponent(v)),_&&(r=r+"&apisecret="+encodeURIComponent(_)),Janus.httpAPICall(r,{verb:"GET",withCredentials:m,success:handleEvent,timeout:A,error:function(r,i){if(Janus.error(r+":",i),++x>3)return S=!1,void t.error("Lost connection to the server (is it down?)");eventHandler()}})}else Janus.warn("Is the server down? (connected=false)")}function handleEvent(t,o){if(x=0,r||null==C||!0===o||eventHandler(),r||!Janus.isArray(t))if("keepalive"!==t.janus)if("server_info"!==t.janus)if("ack"!==t.janus)if("success"!==t.janus)if("trickle"===t.janus){const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];if(!i)return void Janus.debug("This handle is not attached to this session");var a=t.candidate;Janus.debug("Got a trickled candidate on session "+C),Janus.debug(a);var c=i.webrtcStuff;c.pc&&c.remoteSdp?(Janus.debug("Adding remote candidate:",a),a&&!0!==a.completed?c.pc.addIceCandidate(a):c.pc.addIceCandidate(Janus.endOfCandidates)):(Janus.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),c.candidates||(c.candidates=[]),c.candidates.push(a),Janus.debug(c.candidates))}else{if("webrtcup"===t.janus){Janus.debug("Got a webrtcup event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];return i?void i.webrtcState(!0):void Janus.debug("This handle is not attached to this session")}if("hangup"===t.janus){Janus.debug("Got a hangup event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.webrtcState(!1,t.reason),i.hangup()}else if("detached"===t.janus){Janus.debug("Got a detached event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];if(!i)return;i.ondetached(),i.detach()}else if("media"===t.janus){Janus.debug("Got a media event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.mediaState(t.type,t.receiving)}else if("slowlink"===t.janus){Janus.debug("Got a slowlink event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=P[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.slowLink(t.uplink,t.lost)}else{if("error"===t.janus){Janus.error("Ooops: "+t.error.code+" "+t.error.reason),Janus.debug(t);var l=t.transaction;if(l){var u=k[l];u&&u(t),delete k[l]}return}if("event"===t.janus){Janus.debug("Got a plugin event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");var d=t.plugindata;if(!d)return void Janus.warn("Missing plugindata...");Janus.debug("  -- Event is coming from "+r+" ("+d.plugin+")");var h=d.data;Janus.debug(h);const i=P[r];if(!i)return void Janus.warn("This handle is not attached to this session");var p=t.jsep;p&&(Janus.debug("Handling SDP as well..."),Janus.debug(p));var g=i.onmessage;g?(Janus.debug("Notifying application..."),g(h,p)):Janus.debug("No provided notification callback")}else{if("timeout"===t.janus)return Janus.error("Timeout on session "+C),Janus.debug(t),void(r&&i.close(3504,"Gateway timeout"));Janus.warn("Unknown message/event  '"+t.janus+"' on session "+C),Janus.debug(t)}}}else{Janus.debug("Got a success on session "+C),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else{Janus.debug("Got an ack on session "+C),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else{Janus.debug("Got info on the Janus instance"),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else Janus.vdebug("Got a keepalive on session "+C);else for(var m=0;m<t.length;m++)handleEvent(t[m],!0)}function keepAlive(){if(u&&r&&S){a=setTimeout(keepAlive,b);var t={janus:"keepalive",session_id:C,transaction:Janus.randomString(12)};v&&(t.token=v),_&&(t.apisecret=_),i.send(JSON.stringify(t))}}function createSession(d){var h=Janus.randomString(12),p={janus:"create",transaction:h};if(d.reconnect&&(S=!1,p.janus="claim",p.session_id=C,i&&(i.onopen=null,i.onerror=null,i.onclose=null,a&&(clearTimeout(a),a=null))),v&&(p.token=v),_&&(p.apisecret=_),!u&&Janus.isArray(c)&&(0===(u=c[l]).indexOf("ws")?(r=!0,Janus.log("Server #"+(l+1)+": trying WebSockets to contact Janus ("+u+")")):(r=!1,Janus.log("Server #"+(l+1)+": trying REST API to contact Janus ("+u+")"))),r)for(var g in i=Janus.newWebSocket(u,"janus-protocol"),o={error:function(){if(Janus.error("Error connecting to the Janus WebSockets server... "+u),Janus.isArray(c)&&!d.reconnect)return++l===c.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(u=null,void setTimeout((function(){createSession(d)}),200));d.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){k[h]=function(t){if(Janus.debug(t),"success"!==t.janus)return Janus.error("Ooops: "+t.error.code+" "+t.error.reason),void d.error(t.error.reason);a=setTimeout(keepAlive,b),S=!0,C=t.session_id?t.session_id:t.data.id,d.reconnect?Janus.log("Claimed session: "+C):Janus.log("Created session: "+C),Janus.sessions[C]=w,d.success()},i.send(JSON.stringify(p))},message:function(t){handleEvent(JSON.parse(t.data))},close:function(){u&&S&&(S=!1,t.error("Lost connection to the server (is it down?)"))}})i.addEventListener(g,o[g]);else Janus.httpAPICall(u,{verb:"POST",withCredentials:m,body:p,success:function(t){if(Janus.debug(t),"success"!==t.janus)return Janus.error("Ooops: "+t.error.code+" "+t.error.reason),void d.error(t.error.reason);S=!0,C=t.session_id?t.session_id:t.data.id,d.reconnect?Janus.log("Claimed session: "+C):Janus.log("Created session: "+C),Janus.sessions[C]=w,eventHandler(),d.success()},error:function(t,r){if(Janus.error(t+":",r),Janus.isArray(c)&&!d.reconnect)return++l===c.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(u=null,void setTimeout((function(){createSession(d)}),200));""===r?d.error(t+": Is the server down?"):r&&r.error?d.error(t+": "+r.error.message):d.error(t+": "+r)}})}function sendMessage(t,o){if((o=o||{}).success="function"==typeof o.success?o.success:Janus.noop,o.error="function"==typeof o.error?o.error:Janus.noop,!S)return Janus.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var a=P[t];if(!a||!a.webrtcStuff)return Janus.warn("Invalid handle"),void o.error("Invalid handle");var c=o.message,l=o.jsep,d=Janus.randomString(12),h={janus:"message",body:c,transaction:d};if(a.token&&(h.token=a.token),_&&(h.apisecret=_),l&&(h.jsep={type:l.type,sdp:l.sdp},l.e2ee&&(h.jsep.e2ee=!0),"hml"!==l.rid_order&&"lmh"!==l.rid_order||(h.jsep.rid_order=l.rid_order),l.force_relay&&(h.jsep.force_relay=!0)),Janus.debug("Sending message to plugin (handle="+t+"):"),Janus.debug(h),r)return h.session_id=C,h.handle_id=t,k[d]=function(t){if(Janus.debug("Message sent!"),Janus.debug(t),"success"===t.janus){var r=t.plugindata;if(!r)return Janus.warn("Request succeeded, but missing plugindata..."),void o.success();Janus.log("Synchronous transaction successful ("+r.plugin+")");var i=r.data;return Janus.debug(i),void o.success(i)}"ack"===t.janus?o.success():t.error?(Janus.error("Ooops: "+t.error.code+" "+t.error.reason),o.error(t.error.code+" "+t.error.reason)):(Janus.error("Unknown error"),o.error("Unknown error"))},void i.send(JSON.stringify(h));Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:h,success:function(t){if(Janus.debug("Message sent!"),Janus.debug(t),"success"===t.janus){var r=t.plugindata;if(!r)return Janus.warn("Request succeeded, but missing plugindata..."),void o.success();Janus.log("Synchronous transaction successful ("+r.plugin+")");var i=r.data;return Janus.debug(i),void o.success(i)}"ack"===t.janus?o.success():t.error?(Janus.error("Ooops: "+t.error.code+" "+t.error.reason),o.error(t.error.code+" "+t.error.reason)):(Janus.error("Unknown error"),o.error("Unknown error"))},error:function(t,r){Janus.error(t+":",r),o.error(t+": "+r)}})}function sendTrickleCandidate(t,o){if(S){var a=P[t];if(a&&a.webrtcStuff){var c={janus:"trickle",candidate:o,transaction:Janus.randomString(12)};if(a.token&&(c.token=a.token),_&&(c.apisecret=_),Janus.vdebug("Sending trickle candidate (handle="+t+"):"),Janus.vdebug(c),r)return c.session_id=C,c.handle_id=t,void i.send(JSON.stringify(c));Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:c,success:function(t){Janus.vdebug("Candidate sent!"),Janus.vdebug(t),"ack"===t.janus||Janus.error("Ooops: "+t.error.code+" "+t.error.reason)},error:function(t,r){Janus.error(t+":",r)}})}else Janus.warn("Invalid handle")}else Janus.warn("Is the server down? (connected=false)")}function createDataChannel(t,r,i,o,a){var c=P[t];if(c&&c.webrtcStuff){var l=c.webrtcStuff;if(l.pc){var onDataChannelStateChange=function(t){Janus.log("Received state change on data channel:",t);var r=t.target.label,i=t.target.protocol,o=l.dataChannel[r]?l.dataChannel[r].readyState:"null";if(Janus.log("State change on <"+r+"> data channel: "+o),"open"===o){if(l.dataChannel[r].pending&&l.dataChannel[r].pending.length>0){for(var a of(Janus.log("Sending pending messages on <"+r+">:",l.dataChannel[r].pending.length),l.dataChannel[r].pending))Janus.log("Sending data on data channel <"+r+">"),Janus.debug(a),l.dataChannel[r].send(a);l.dataChannel[r].pending=[]}c.ondataopen(r,i)}};if(o)l.dataChannel[r]=o;else{var u=l.dataChannelOptions;i&&(u.protocol=i),l.dataChannel[r]=l.pc.createDataChannel(r,u)}l.dataChannel[r].onmessage=function(t){Janus.log("Received message on data channel:",t);var r=t.target.label;c.ondata(t.data,r)},l.dataChannel[r].onopen=onDataChannelStateChange,l.dataChannel[r].onclose=onDataChannelStateChange,l.dataChannel[r].onerror=function(t){Janus.error("Got error on data channel:",t)},l.dataChannel[r].pending=[],a&&l.dataChannel[r].pending.push(a)}else Janus.warn("Invalid PeerConnection")}else Janus.warn("Invalid handle")}function sendData(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=P[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff,a=r.text||r.data;if(!a)return Janus.warn("Invalid data"),void r.error("Invalid data");var c=r.label?r.label:Janus.dataChanDefaultLabel;return o.dataChannel[c]?"open"!==o.dataChannel[c].readyState?(o.dataChannel[c].pending.push(a),void r.success()):(Janus.log("Sending data on data channel <"+c+">"),Janus.debug(a),o.dataChannel[c].send(a),void r.success()):(createDataChannel(t,c,r.protocol,!1,a,r.protocol),void r.success())}function sendDtmf(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=P[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff;if(!o.dtmfSender){if(o.pc){var a=o.pc.getSenders().find((function(t){return t.track&&"audio"===t.track.kind}));if(!a)return Janus.warn("Invalid DTMF configuration (no audio track)"),void r.error("Invalid DTMF configuration (no audio track)");o.dtmfSender=a.dtmf,o.dtmfSender&&(Janus.log("Created DTMF Sender"),o.dtmfSender.ontonechange=function(t){Janus.debug("Sent DTMF tone: "+t.tone)})}if(!o.dtmfSender)return Janus.warn("Invalid DTMF configuration"),void r.error("Invalid DTMF configuration")}var c=r.dtmf;if(!c)return Janus.warn("Invalid DTMF parameters"),void r.error("Invalid DTMF parameters");var l=c.tones;if(!l)return Janus.warn("Invalid DTMF string"),void r.error("Invalid DTMF string");var u="number"==typeof c.duration?c.duration:500,d="number"==typeof c.gap?c.gap:50;Janus.debug("Sending DTMF string "+l+" (duration "+u+"ms, gap "+d+"ms)"),o.dtmfSender.insertDTMF(l,u,d),r.success()}function destroyHandle(t,o){(o=o||{}).success="function"==typeof o.success?o.success:Janus.noop,o.error="function"==typeof o.error?o.error:Janus.noop;var a=!0===o.noRequest;Janus.log("Destroying handle "+t+" (only-locally="+a+")"),cleanupWebrtc(t);var c=P[t];if(!c||c.detached)return delete P[t],void o.success();if(c.detached=!0,a)return delete P[t],void o.success();if(!S)return Janus.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var l={janus:"detach",transaction:Janus.randomString(12)};if(c.token&&(l.token=c.token),_&&(l.apisecret=_),r)return l.session_id=C,l.handle_id=t,i.send(JSON.stringify(l)),delete P[t],void o.success();Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:l,success:function(r){Janus.log("Destroyed handle:"),Janus.debug(r),"success"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),delete P[t],o.success()},error:function(r,i){Janus.error(r+":",i),delete P[t],o.success()}})}function streamsDone(t,r,i,o,a){var c=P[t];if(!c||!c.webrtcStuff)return Janus.warn("Invalid handle"),o.stream||Janus.stopAllTracks(a),void o.error("Invalid handle");var l=c.webrtcStuff;Janus.debug("streamsDone:",a),a&&(Janus.debug("  -- Audio tracks:",a.getAudioTracks()),Janus.debug("  -- Video tracks:",a.getVideoTracks()));var u=!1;if(l.myStream&&i.update&&(!l.streamExternal||i.replaceAudio||i.replaceVideo)){if((!i.update&&isAudioSendEnabled(i)||i.update&&(i.addAudio||i.replaceAudio))&&a.getAudioTracks()&&a.getAudioTracks().length)if(l.myStream.addTrack(a.getAudioTracks()[0]),Janus.unifiedPlan){Janus.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]);var m=null;const t=l.pc.getTransceivers();if(t&&t.length>0)for(const r of t)if(r.sender&&r.sender.track&&"audio"===r.sender.track.kind||r.receiver&&r.receiver.track&&"audio"===r.receiver.track.kind){m=r;break}m&&m.sender?m.sender.replaceTrack(a.getAudioTracks()[0]):l.pc.addTrack(a.getAudioTracks()[0],a)}else Janus.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]),l.pc.addTrack(a.getAudioTracks()[0],a);if((!i.update&&isVideoSendEnabled(i)||i.update&&(i.addVideo||i.replaceVideo))&&a.getVideoTracks()&&a.getVideoTracks().length)if(l.myStream.addTrack(a.getVideoTracks()[0]),Janus.unifiedPlan){Janus.log((i.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]);var y=null;const t=l.pc.getTransceivers();if(t&&t.length>0)for(const r of t)if(r.sender&&r.sender.track&&"video"===r.sender.track.kind||r.receiver&&r.receiver.track&&"video"===r.receiver.track.kind){y=r;break}y&&y.sender?y.sender.replaceTrack(a.getVideoTracks()[0]):l.pc.addTrack(a.getVideoTracks()[0],a)}else Janus.log((i.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]),l.pc.addTrack(a.getVideoTracks()[0],a)}else l.myStream=a,u=!0;if(!l.pc){var v={iceServers:d,iceTransportPolicy:h,bundlePolicy:p};"chrome"===Janus.webRTCAdapter.browserDetails.browser&&(v.sdpSemantics=Janus.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var _={optional:[{DtlsSrtpKeyAgreement:!0}]};if(g&&_.optional.push({googIPv6:!0}),o.rtcConstraints&&"object"==typeof o.rtcConstraints)for(var b in Janus.debug("Adding custom PeerConnection constraints:",o.rtcConstraints),o.rtcConstraints)_.optional.push(o.rtcConstraints[b]);"edge"===Janus.webRTCAdapter.browserDetails.browser&&(v.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(o.senderTransforms||o.receiverTransforms)&&(l.senderTransforms=o.senderTransforms,l.receiverTransforms=o.receiverTransforms,v.forceEncodedAudioInsertableStreams=!0,v.forceEncodedVideoInsertableStreams=!0,v.encodedInsertableStreams=!0),Janus.log("Creating PeerConnection"),Janus.debug(_),l.pc=new RTCPeerConnection(v,_),Janus.debug(l.pc),l.pc.getStats&&(l.volume={},l.bitrate.value="0 kbits/sec"),Janus.log("Preparing local SDP and gathering candidates (trickle="+l.trickle+")"),l.pc.oniceconnectionstatechange=function(){l.pc&&c.iceState(l.pc.iceConnectionState)},l.pc.onicecandidate=function(r){if(!r.candidate||"edge"===Janus.webRTCAdapter.browserDetails.browser&&r.candidate.candidate.indexOf("endOfCandidates")>0)Janus.log("End of candidates."),l.iceDone=!0,!0===l.trickle?sendTrickleCandidate(t,{completed:!0}):function sendSDP(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=P[t];if(!i||!i.webrtcStuff)return void Janus.warn("Invalid handle, not sending anything");var o=i.webrtcStuff;if(Janus.log("Sending offer/answer SDP..."),!o.mySdp)return void Janus.warn("Local SDP instance is invalid, not sending anything...");o.mySdp={type:o.pc.localDescription.type,sdp:o.pc.localDescription.sdp},!1===o.trickle&&(o.mySdp.trickle=!1);Janus.debug(r),o.sdpSent=!0,r.success(o.mySdp)}(t,o);else{var i={candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex};!0===l.trickle&&sendTrickleCandidate(t,i)}},l.pc.ontrack=function(t){if(Janus.log("Handling Remote Track"),Janus.debug(t),t.streams&&(l.remoteStream=t.streams[0],c.onremotestream(l.remoteStream),!t.track.onended)){if(l.receiverTransforms){var r=null;RTCRtpSender.prototype.createEncodedStreams?r=t.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&l.receiverTransforms.audio?r=t.receiver.createEncodedAudioStreams():"video"===t.track.kind&&l.receiverTransforms.video&&(r=t.receiver.createEncodedVideoStreams())),r&&(console.log(r),r.readableStream&&r.writableStream?r.readableStream.pipeThrough(l.receiverTransforms[t.track.kind]).pipeTo(r.writableStream):r.readable&&r.writable&&r.readable.pipeThrough(l.receiverTransforms[t.track.kind]).pipeTo(r.writable))}var i=null;Janus.log("Adding onended callback to track:",t.track),t.track.onended=function(t){Janus.log("Remote track removed:",t),l.remoteStream&&(clearTimeout(i),l.remoteStream.removeTrack(t.target),c.onremotestream(l.remoteStream))},t.track.onmute=function(t){Janus.log("Remote track muted:",t),l.remoteStream&&null==i&&(i=setTimeout((function(){Janus.log("Removing remote track"),l.remoteStream&&(l.remoteStream.removeTrack(t.target),c.onremotestream(l.remoteStream)),i=null}),2520))},t.track.onunmute=function(t){if(Janus.log("Remote track flowing again:",t),null!=i)clearTimeout(i),i=null;else try{l.remoteStream.addTrack(t.target),c.onremotestream(l.remoteStream)}catch(t){Janus.error(t)}}}}}if(u&&a){Janus.log("Adding local stream");var A=(!0===o.simulcast||!0===o.simulcast2)&&Janus.unifiedPlan,S=o.svc;a.getTracks().forEach((function(t){Janus.log("Adding local track:",t);var r=null;if(!A&&!S||"audio"===t.kind)r=l.pc.addTrack(t,a);else if(A){Janus.log("Enabling rid-based simulcasting:",t);let i=getMaxBitrates(o.simulcastMaxBitrates),c=l.pc.addTransceiver(t,{direction:"sendrecv",streams:[a],sendEncodings:o.sendEncodings||[{rid:"h",active:!0,maxBitrate:i.high},{rid:"m",active:!0,maxBitrate:i.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:i.low,scaleResolutionDownBy:4}]});c&&(r=c.sender)}else{Janus.log("Enabling SVC ("+S+"):",t);let i=l.pc.addTransceiver(t,{direction:"sendrecv",streams:[a],sendEncodings:[{scalabilityMode:S}]});i&&(r=i.sender)}if(r&&l.senderTransforms){var i=null;RTCRtpSender.prototype.createEncodedStreams?i=r.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===r.track.kind&&l.senderTransforms.audio?i=r.createEncodedAudioStreams():"video"===r.track.kind&&l.senderTransforms.video&&(i=r.createEncodedVideoStreams())),i&&(console.log(i),i.readableStream&&i.writableStream?i.readableStream.pipeThrough(l.senderTransforms[r.track.kind]).pipeTo(i.writableStream):i.readable&&i.writable&&i.readable.pipeThrough(l.senderTransforms[r.track.kind]).pipeTo(i.writable))}}))}(function isDataEnabled(t){if(Janus.debug("isDataEnabled:",t),"edge"===Janus.webRTCAdapter.browserDetails.browser)return Janus.warn("Edge doesn't support data channels yet"),!1;return null!=t&&!0===t.data})(i)&&!l.dataChannel[Janus.dataChanDefaultLabel]&&(Janus.log("Creating default data channel"),createDataChannel(t,Janus.dataChanDefaultLabel,null,!1),l.pc.ondatachannel=function(r){Janus.log("Data channel created by Janus:",r),createDataChannel(t,r.channel.label,r.channel.protocol,r.channel)}),l.myStream&&c.onlocalstream(l.myStream),r?l.pc.setRemoteDescription(r).then((function(){if(Janus.log("Remote description accepted!"),l.remoteSdp=r.sdp,l.candidates&&l.candidates.length>0){for(var a=0;a<l.candidates.length;a++){var c=l.candidates[a];Janus.debug("Adding remote candidate:",c),c&&!0!==c.completed?l.pc.addIceCandidate(c):l.pc.addIceCandidate(Janus.endOfCandidates)}l.candidates=[]}!function createAnswer(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:Janus.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Janus.noop;var o=P[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var a=o.webrtcStuff,c=!0===i.simulcast||!0===i.simulcast2;c?Janus.log("Creating answer (iceDone="+a.iceDone+", simulcast="+c+")"):Janus.log("Creating answer (iceDone="+a.iceDone+")");var l=null;if(Janus.unifiedPlan){l={};var u=null,d=null,h=a.pc.getTransceivers();if(h&&h.length>0)for(var p of h)p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?u||(u=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(d||(d=p));var g=isAudioSendEnabled(r),m=isAudioRecvEnabled(r);if(g||m){if(g&&m){if(u)try{u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",Janus.log("Setting audio transceiver to sendrecv:",u)}catch(t){Janus.error(t)}}else if(g&&!m)try{u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",Janus.log("Setting audio transceiver to sendonly:",u))}catch(t){Janus.error(t)}else if(!g&&m)if(u)try{u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",Janus.log("Setting audio transceiver to recvonly:",u)}catch(t){Janus.error(t)}else u=a.pc.addTransceiver("audio",{direction:"recvonly"}),Janus.log("Adding recvonly audio transceiver:",u)}else if(r.removeAudio&&u)try{u.setDirection?u.setDirection("inactive"):u.direction="inactive",Janus.log("Setting audio transceiver to inactive:",u)}catch(t){Janus.error(t)}var y=isVideoSendEnabled(r),v=isVideoRecvEnabled(r);if(y||v){if(y&&v){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Janus.log("Setting video transceiver to sendrecv:",d)}catch(t){Janus.error(t)}}else if(y&&!v){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Janus.log("Setting video transceiver to sendonly:",d)}catch(t){Janus.error(t)}}else if(!y&&v)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Janus.log("Setting video transceiver to recvonly:",d)}catch(t){Janus.error(t)}else d=a.pc.addTransceiver("video",{direction:"recvonly"}),Janus.log("Adding recvonly video transceiver:",d)}else if(r.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",Janus.log("Setting video transceiver to inactive:",d)}catch(t){Janus.error(t)}}else l="firefox"===Janus.webRTCAdapter.browserDetails.browser||"edge"===Janus.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:isAudioRecvEnabled(r),offerToReceiveVideo:isVideoRecvEnabled(r)}:{mandatory:{OfferToReceiveAudio:isAudioRecvEnabled(r),OfferToReceiveVideo:isVideoRecvEnabled(r)}};Janus.debug(l);var _=isVideoSendEnabled(r);if(_&&c&&"firefox"===Janus.webRTCAdapter.browserDetails.browser){Janus.log("Enabling Simulcasting for Firefox (RID)");var b=a.pc.getSenders()[1];Janus.log(b);var A=b.getParameters();Janus.log(A);var S=getMaxBitrates(i.simulcastMaxBitrates);b.setParameters({encodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:S.high},{rid:"m",active:!0,maxBitrate:S.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:S.low,scaleResolutionDownBy:4}]})}a.pc.createAnswer(l).then((function(t){Janus.debug(t);var r={type:t.type,sdp:t.sdp};i.customizeSdp(r),t.sdp=r.sdp,Janus.log("Setting local description"),_&&c&&!Janus.unifiedPlan&&"chrome"===Janus.webRTCAdapter.browserDetails.browser&&Janus.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"),a.mySdp={type:"answer",sdp:t.sdp},a.pc.setLocalDescription(t).catch(i.error),a.mediaConstraints=l,a.iceDone||a.trickle?((a.senderTransforms||a.receiverTransforms)&&(t.e2ee=!0),i.success(t)):Janus.log("Waiting for all candidates...")}),i.error)}(t,i,o)}),o.error):function createOffer(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:Janus.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Janus.noop;var o=P[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var a=o.webrtcStuff,c=!0===i.simulcast;c?Janus.log("Creating offer (iceDone="+a.iceDone+", simulcast="+c+")"):Janus.log("Creating offer (iceDone="+a.iceDone+")");var l={};if(Janus.unifiedPlan){var u=null,d=null,h=a.pc.getTransceivers();if(h&&h.length>0)for(var p of h)p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?u||(u=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(d||(d=p));var g=isAudioSendEnabled(r),m=isAudioRecvEnabled(r);g||m?g&&m?u&&(u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",Janus.log("Setting audio transceiver to sendrecv:",u)):g&&!m?u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",Janus.log("Setting audio transceiver to sendonly:",u)):!g&&m&&(u?(u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",Janus.log("Setting audio transceiver to recvonly:",u)):(u=a.pc.addTransceiver("audio",{direction:"recvonly"}),Janus.log("Adding recvonly audio transceiver:",u))):r.removeAudio&&u&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive",Janus.log("Setting audio transceiver to inactive:",u));var y=isVideoSendEnabled(r),v=isVideoRecvEnabled(r);y||v?y&&v?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Janus.log("Setting video transceiver to sendrecv:",d)):y&&!v?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Janus.log("Setting video transceiver to sendonly:",d)):!y&&v&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Janus.log("Setting video transceiver to recvonly:",d)):(d=a.pc.addTransceiver("video",{direction:"recvonly"}),Janus.log("Adding recvonly video transceiver:",d))):r.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",Janus.log("Setting video transceiver to inactive:",d))}else l.offerToReceiveAudio=isAudioRecvEnabled(r),l.offerToReceiveVideo=isVideoRecvEnabled(r);!0===i.iceRestart&&(l.iceRestart=!0);Janus.debug(l);var _=isVideoSendEnabled(r);if(_&&c&&"firefox"===Janus.webRTCAdapter.browserDetails.browser){Janus.log("Enabling Simulcasting for Firefox (RID)");var b=a.pc.getSenders().find((function(t){return t.track&&"video"===t.track.kind}));if(b){var A=b.getParameters();A||(A={});var S=getMaxBitrates(i.simulcastMaxBitrates);A.encodings=i.sendEncodings||[{rid:"h",active:!0,maxBitrate:S.high},{rid:"m",active:!0,maxBitrate:S.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:S.low,scaleResolutionDownBy:4}],b.setParameters(A)}}a.pc.createOffer(l).then((function(t){Janus.debug(t);var r={type:t.type,sdp:t.sdp};i.customizeSdp(r),t.sdp=r.sdp,Janus.log("Setting local description"),_&&c&&!Janus.unifiedPlan&&("chrome"!==Janus.webRTCAdapter.browserDetails.browser&&"safari"!==Janus.webRTCAdapter.browserDetails.browser||(Janus.log("Enabling Simulcasting for Chrome (SDP munging)"),t.sdp=function mungeSdpForSimulcasting(t){var r=t.split("\r\n"),i=!1,o=[-1],a=[-1],c=null,l=null,u=null,d=null,h=-1;for(let y=0;y<r.length;y++){const v=r[y].match(/m=(\w+) */);if(v){if("video"===v[1]){if(!(o[0]<0)){h=y;break}i=!0}else if(o[0]>-1){h=y;break}}else if(i){var p=r[y].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/);if(p)return Janus.warn("The SDP already contains a SIM attribute, munging will be skipped"),t;var g=r[y].match(/a=ssrc-group:FID (\d+) (\d+)/);if(g)o[0]=g[1],a[0]=g[2],r.splice(y,1),y--;else{if(o[0]){var m=r[y].match("a=ssrc:"+o[0]+" cname:(.+)");if(m&&(c=m[1]),m=r[y].match("a=ssrc:"+o[0]+" msid:(.+)"),m&&(l=m[1]),m=r[y].match("a=ssrc:"+o[0]+" mslabel:(.+)"),m&&(u=m[1]),m=r[y].match("a=ssrc:"+o[0]+" label:(.+)"),m&&(d=m[1]),0===r[y].indexOf("a=ssrc:"+a[0])){r.splice(y,1),y--;continue}if(0===r[y].indexOf("a=ssrc:"+o[0])){r.splice(y,1),y--;continue}}0!=r[y].length||(r.splice(y,1),y--)}}}if(o[0]<0){h=-1,i=!1;for(let t=0;t<r.length;t++){const p=r[t].match(/m=(\w+) */);if(p){if("video"===p[1]){if(!(o[0]<0)){h=t;break}i=!0}else if(o[0]>-1){h=t;break}}else if(i){if(o[0]<0){var y=r[t].match(/a=ssrc:(\d+)/);if(y){o[0]=y[1],r.splice(t,1),t--;continue}}else{let i=r[t].match("a=ssrc:"+o[0]+" cname:(.+)");if(i&&(c=i[1]),i=r[t].match("a=ssrc:"+o[0]+" msid:(.+)"),i&&(l=i[1]),i=r[t].match("a=ssrc:"+o[0]+" mslabel:(.+)"),i&&(u=i[1]),i=r[t].match("a=ssrc:"+o[0]+" label:(.+)"),i&&(d=i[1]),0===r[t].indexOf("a=ssrc:"+a[0])){r.splice(t,1),t--;continue}if(0===r[t].indexOf("a=ssrc:"+o[0])){r.splice(t,1),t--;continue}}0!==r[t].length||(r.splice(t,1),t--)}}}if(o[0]<0)return Janus.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),t;h<0&&(h=r.length);o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random()),a[1]=Math.floor(4294967295*Math.random()),a[2]=Math.floor(4294967295*Math.random());for(var v=0;v<o.length;v++)c&&(r.splice(h,0,"a=ssrc:"+o[v]+" cname:"+c),h++),l&&(r.splice(h,0,"a=ssrc:"+o[v]+" msid:"+l),h++),u&&(r.splice(h,0,"a=ssrc:"+o[v]+" mslabel:"+u),h++),d&&(r.splice(h,0,"a=ssrc:"+o[v]+" label:"+d),h++),c&&(r.splice(h,0,"a=ssrc:"+a[v]+" cname:"+c),h++),l&&(r.splice(h,0,"a=ssrc:"+a[v]+" msid:"+l),h++),u&&(r.splice(h,0,"a=ssrc:"+a[v]+" mslabel:"+u),h++),d&&(r.splice(h,0,"a=ssrc:"+a[v]+" label:"+d),h++);r.splice(h,0,"a=ssrc-group:FID "+o[2]+" "+a[2]),r.splice(h,0,"a=ssrc-group:FID "+o[1]+" "+a[1]),r.splice(h,0,"a=ssrc-group:FID "+o[0]+" "+a[0]),r.splice(h,0,"a=ssrc-group:SIM "+o[0]+" "+o[1]+" "+o[2]),(t=r.join("\r\n")).endsWith("\r\n")||(t+="\r\n");return t}(t.sdp))),a.mySdp={type:"offer",sdp:t.sdp},a.pc.setLocalDescription(t).catch(i.error),a.mediaConstraints=l,a.iceDone||a.trickle?((a.senderTransforms||a.receiverTransforms)&&(t.e2ee=!0),i.success(t)):Janus.log("Waiting for all candidates...")}),i.error)}(t,i,o)}function prepareWebrtc(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:webrtcError;var o=i.jsep;if(r&&o)return Janus.error("Provided a JSEP to a createOffer"),void i.error("Provided a JSEP to a createOffer");if(!(r||o&&o.type&&o.sdp))return Janus.error("A valid JSEP is required for createAnswer"),void i.error("A valid JSEP is required for createAnswer");i.media="object"==typeof i.media&&i.media?i.media:{audio:!0,video:!0};var a=i.media,c=P[t];if(!c||!c.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var l=c.webrtcStuff;if(l.trickle=function isTrickleEnabled(t){return Janus.debug("isTrickleEnabled:",t),!1!==t}(i.trickle),l.pc){if(Janus.log("Updating existing media session"),a.update=!0,i.stream)i.stream!==l.myStream&&Janus.log("Renegotiation involves a new external stream");else{if(a.addAudio){if(a.keepAudio=!1,a.replaceAudio=!1,a.removeAudio=!1,a.audioSend=!0,l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length)return Janus.error("Can't add audio stream, there already is one"),void i.error("Can't add audio stream, there already is one")}else a.removeAudio?(a.keepAudio=!1,a.replaceAudio=!1,a.addAudio=!1,a.audioSend=!1):a.replaceAudio&&(a.keepAudio=!1,a.addAudio=!1,a.removeAudio=!1,a.audioSend=!0);if(l.myStream&&l.myStream.getAudioTracks()&&0!==l.myStream.getAudioTracks().length?!isAudioSendEnabled(a)||a.removeAudio||a.replaceAudio||(a.keepAudio=!0):(a.replaceAudio&&(a.keepAudio=!1,a.replaceAudio=!1,a.addAudio=!0,a.audioSend=!0),isAudioSendEnabled(a)&&(a.keepAudio=!1,a.addAudio=!0)),a.addVideo){if(a.keepVideo=!1,a.replaceVideo=!1,a.removeVideo=!1,a.videoSend=!0,l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length)return Janus.error("Can't add video stream, there already is one"),void i.error("Can't add video stream, there already is one")}else a.removeVideo?(a.keepVideo=!1,a.replaceVideo=!1,a.addVideo=!1,a.videoSend=!1):a.replaceVideo&&(a.keepVideo=!1,a.addVideo=!1,a.removeVideo=!1,a.videoSend=!0);l.myStream&&l.myStream.getVideoTracks()&&0!==l.myStream.getVideoTracks().length?!isVideoSendEnabled(a)||a.removeVideo||a.replaceVideo||(a.keepVideo=!0):(a.replaceVideo&&(a.keepVideo=!1,a.replaceVideo=!1,a.addVideo=!0,a.videoSend=!0),isVideoSendEnabled(a)&&(a.keepVideo=!1,a.addVideo=!0)),a.addData&&(a.data=!0)}if(isAudioSendEnabled(a)&&a.keepAudio&&isVideoSendEnabled(a)&&a.keepVideo)return c.consentDialog(!1),void streamsDone(t,o,a,i,l.myStream)}else a.update=!1,a.keepAudio=!1,a.keepVideo=!1;if(a.update&&(!l.streamExternal||l.streamExternal&&(a.replaceAudio||a.replaceVideo))){if(a.removeAudio||a.replaceAudio){if(l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length){var u=l.myStream.getAudioTracks()[0];Janus.log("Removing audio track:",u),l.myStream.removeTrack(u);try{u.stop()}catch(t){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var d=!0;if(a.replaceAudio&&Janus.unifiedPlan&&(d=!1),d)for(var h of l.pc.getSenders())h&&h.track&&"audio"===h.track.kind&&(Janus.log("Removing audio sender:",h),l.pc.removeTrack(h))}}if(a.removeVideo||a.replaceVideo){if(l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length){var p=l.myStream.getVideoTracks()[0];Janus.log("Removing video track:",p),l.myStream.removeTrack(p);try{p.stop()}catch(t){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var g=!0;if(a.replaceVideo&&Janus.unifiedPlan&&(g=!1),g)for(var m of l.pc.getSenders())m&&m.track&&"video"===m.track.kind&&(Janus.log("Removing video sender:",m),l.pc.removeTrack(m))}}}if(i.stream){var y=i.stream;return Janus.log("MediaStream provided by the application"),Janus.debug(y),!a.update||!l.myStream||l.myStream===i.stream||l.streamExternal||a.replaceAudio||a.replaceVideo||(Janus.stopAllTracks(l.myStream),l.myStream=null),l.streamExternal=!0,c.consentDialog(!1),void streamsDone(t,o,a,i,y)}if(isAudioSendEnabled(a)||isVideoSendEnabled(a)){if(!Janus.isGetUserMediaAvailable())return void i.error("getUserMedia not available");var v={mandatory:{},optional:[]};c.consentDialog(!0);var _=isAudioSendEnabled(a);_&&a&&"object"==typeof a.audio&&(_=a.audio);var b=isVideoSendEnabled(a);if(b&&a){var A=!0===i.simulcast||!0===i.simulcast2,S=i.svc;if(!A&&!S||o||a.video||(a.video="hires"),a.video&&"screen"!=a.video&&"window"!=a.video)if("object"==typeof a.video)b=a.video;else{var C=0,w=0;"lowres"===a.video?(w=240,C=320):"lowres-16:9"===a.video?(w=180,C=320):"hires"===a.video||"hires-16:9"===a.video||"hdres"===a.video?(w=720,C=1280):"fhdres"===a.video?(w=1080,C=1920):"4kres"===a.video?(w=2160,C=3840):"stdres"===a.video?(w=480,C=640):"stdres-16:9"===a.video?(w=360,C=640):(Janus.log("Default video setting is stdres 4:3"),w=480,C=640),Janus.log("Adding media constraint:",a.video),b={height:{ideal:w},width:{ideal:C}},Janus.log("Adding video constraint:",b)}else if("screen"===a.video||"window"===a.video){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return v.video={},a.screenshareFrameRate&&(v.video.frameRate=a.screenshareFrameRate),a.screenshareHeight&&(v.video.height=a.screenshareHeight),a.screenshareWidth&&(v.video.width=a.screenshareWidth),v.audio=a.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(v).then((function(r){c.consentDialog(!1),isAudioSendEnabled(a)&&!a.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(c){r.addTrack(c.getAudioTracks()[0]),streamsDone(t,o,a,i,r)})):streamsDone(t,o,a,i,r)}),(function(t){c.consentDialog(!1),i.error(t)}));const callbackUserMedia=function(r,l){c.consentDialog(!1),r?i.error(r):streamsDone(t,o,a,i,l)},getScreenMedia=function(t,r,i){Janus.log("Adding media constraint (screen capture)"),Janus.debug(t),navigator.mediaDevices.getUserMedia(t).then((function(t){i?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(i){t.addTrack(i.getAudioTracks()[0]),r(null,t)})):r(null,t)})).catch((function(t){c.consentDialog(!1),r(t)}))};if("chrome"===Janus.webRTCAdapter.browserDetails.browser){var x=Janus.webRTCAdapter.browserDetails.version,k=33;window.navigator.userAgent.match("Linux")&&(k=35),x>=26&&x<=k?(v={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:a.screenshareFrameRate,maxFrameRate:a.screenshareFrameRate,chromeMediaSource:"screen"}},audio:isAudioSendEnabled(a)&&!a.keepAudio},getScreenMedia(v,callbackUserMedia)):Janus.extension.getScreen((function(t,r){if(t)return c.consentDialog(!1),i.error(t);(v={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:a.screenshareFrameRate,maxFrameRate:a.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=r,getScreenMedia(v,callbackUserMedia,isAudioSendEnabled(a)&&!a.keepAudio)}))}else if("firefox"===Janus.webRTCAdapter.browserDetails.browser){if(!(Janus.webRTCAdapter.browserDetails.version>=33)){var T=new Error("NavigatorUserMediaError");return T.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",c.consentDialog(!1),void i.error(T)}v={video:{mozMediaSource:a.video,mediaSource:a.video},audio:isAudioSendEnabled(a)&&!a.keepAudio},getScreenMedia(v,(function(t,r){if(callbackUserMedia(t,r),!t)var i=r.currentTime,o=window.setInterval((function(){r||window.clearInterval(o),r.currentTime==i&&(window.clearInterval(o),r.onended&&r.onended()),i=r.currentTime}),500)}))}return}}a&&"screen"===a.video||navigator.mediaDevices.enumerateDevices().then((function(r){var l=r.some((function(t){return"audioinput"===t.kind})),u=function isScreenSendEnabled(t){if(Janus.debug("isScreenSendEnabled:",t),!t)return!1;if("object"!=typeof t.video||"object"!=typeof t.video.mandatory)return!1;var r=t.video.mandatory;if(r.chromeMediaSource)return"desktop"===r.chromeMediaSource||"screen"===r.chromeMediaSource;if(r.mozMediaSource)return"window"===r.mozMediaSource||"screen"===r.mozMediaSource;if(r.mediaSource)return"window"===r.mediaSource||"screen"===r.mediaSource;return!1}(a)||r.some((function(t){return"videoinput"===t.kind})),d=isAudioSendEnabled(a),h=isVideoSendEnabled(a),p=function isAudioSendRequired(t){return Janus.debug("isAudioSendRequired:",t),!!t&&(!1!==t.audio&&!1!==t.audioSend&&(void 0!==t.failIfNoAudio&&null!==t.failIfNoAudio&&!0===t.failIfNoAudio))}(a),g=function isVideoSendRequired(t){return Janus.debug("isVideoSendRequired:",t),!!t&&(!1!==t.video&&!1!==t.videoSend&&(void 0!==t.failIfNoVideo&&null!==t.failIfNoVideo&&!0===t.failIfNoVideo))}(a);if(d||h||p||g){var m=!!d&&l,v=!!h&&u;if(!m&&!v)return c.consentDialog(!1),i.error("No capture device found"),!1;if(!m&&p)return c.consentDialog(!1),i.error("Audio capture is required, but no capture device found"),!1;if(!v&&g)return c.consentDialog(!1),i.error("Video capture is required, but no capture device found"),!1}var A={audio:!(!l||a.keepAudio)&&_,video:!(!u||a.keepVideo)&&b};Janus.debug("getUserMedia constraints",A),A.audio||A.video?navigator.mediaDevices.getUserMedia(A).then((function(r){c.consentDialog(!1),streamsDone(t,o,a,i,r)})).catch((function(t){c.consentDialog(!1),i.error({code:t.code,name:t.name,message:t.message})})):(c.consentDialog(!1),streamsDone(t,o,a,i,y))})).catch((function(t){c.consentDialog(!1),i.error(t)}))}else streamsDone(t,o,a,i)}function prepareWebrtcPeer(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:webrtcError,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:Janus.noop;var i=r.jsep,o=P[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var a=o.webrtcStuff;if(i){if(!a.pc)return Janus.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void r.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");r.customizeSdp(i),a.pc.setRemoteDescription(i).then((function(){if(Janus.log("Remote description accepted!"),a.remoteSdp=i.sdp,a.candidates&&a.candidates.length>0){for(var t=0;t<a.candidates.length;t++){var o=a.candidates[t];Janus.debug("Adding remote candidate:",o),o&&!0!==o.completed?a.pc.addIceCandidate(o):a.pc.addIceCandidate(Janus.endOfCandidates)}a.candidates=[]}r.success()}),r.error)}else r.error("Invalid JSEP")}function getVolume(t,r){var i=P[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),0;var o=r?"remote":"local",a=i.webrtcStuff;return a.volume[o]||(a.volume[o]={value:0}),!a.pc.getStats||"chrome"!==Janus.webRTCAdapter.browserDetails.browser&&"safari"!==Janus.webRTCAdapter.browserDetails.browser?(Janus.warn("Getting the "+o+" volume unsupported by browser"),0):r&&!a.remoteStream?(Janus.warn("Remote stream unavailable"),0):r||a.myStream?a.volume[o].timer?a.volume[o].value:(Janus.log("Starting "+o+" volume monitor"),a.volume[o].timer=setInterval((function(){a.pc.getStats().then((function(t){t.forEach((function(t){t&&"audio"===t.kind&&(r&&!t.remoteSource||!r&&"media-source"!==t.type||(a.volume[o].value=t.audioLevel?t.audioLevel:0))}))}))}),200),0):(Janus.warn("Local stream unavailable"),0)}function isMuted(t,r){var i=P[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),!0;var o=i.webrtcStuff;return o.pc?o.myStream?r?o.myStream.getVideoTracks()&&0!==o.myStream.getVideoTracks().length?!o.myStream.getVideoTracks()[0].enabled:(Janus.warn("No video track"),!0):o.myStream.getAudioTracks()&&0!==o.myStream.getAudioTracks().length?!o.myStream.getAudioTracks()[0].enabled:(Janus.warn("No audio track"),!0):(Janus.warn("Invalid local MediaStream"),!0):(Janus.warn("Invalid PeerConnection"),!0)}function mute(t,r,i){var o=P[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),!1;var a=o.webrtcStuff;return a.pc?a.myStream?r?a.myStream.getVideoTracks()&&0!==a.myStream.getVideoTracks().length?(a.myStream.getVideoTracks()[0].enabled=!i,!0):(Janus.warn("No video track"),!1):a.myStream.getAudioTracks()&&0!==a.myStream.getAudioTracks().length?(a.myStream.getAudioTracks()[0].enabled=!i,!0):(Janus.warn("No audio track"),!1):(Janus.warn("Invalid local MediaStream"),!1):(Janus.warn("Invalid PeerConnection"),!1)}function getBitrate(t){var r=P[t];if(!r||!r.webrtcStuff)return Janus.warn("Invalid handle"),"Invalid handle";var i=r.webrtcStuff;return i.pc?i.pc.getStats?i.bitrate.timer?i.bitrate.value:(Janus.log("Starting bitrate timer (via getStats)"),i.bitrate.timer=setInterval((function(){i.pc.getStats().then((function(t){t.forEach((function(t){if(t){var r=!1;if(("video"===t.mediaType||t.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===t.type&&t.id.indexOf("rtcp")<0?r=!0:"ssrc"!=t.type||!t.bytesReceived||"VP8"!==t.googCodecName&&""!==t.googCodecName||(r=!0),r)if(i.bitrate.bsnow=t.bytesReceived,i.bitrate.tsnow=t.timestamp,null===i.bitrate.bsbefore||null===i.bitrate.tsbefore)i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow;else{var o=i.bitrate.tsnow-i.bitrate.tsbefore;"safari"===Janus.webRTCAdapter.browserDetails.browser&&(o/=1e3);var a=Math.round(8*(i.bitrate.bsnow-i.bitrate.bsbefore)/o);"safari"===Janus.webRTCAdapter.browserDetails.browser&&(a=parseInt(a/1e3)),i.bitrate.value=a+" kbits/sec",i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(Janus.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function webrtcError(t){Janus.error("WebRTC error:",t)}function cleanupWebrtc(t,o){Janus.log("Cleaning WebRTC stuff");var a=P[t];if(a){var c=a.webrtcStuff;if(c){if(!0===o){var l={janus:"hangup",transaction:Janus.randomString(12)};a.token&&(l.token=a.token),_&&(l.apisecret=_),Janus.debug("Sending hangup request (handle="+t+"):"),Janus.debug(l),r?(l.session_id=C,l.handle_id=t,i.send(JSON.stringify(l))):Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:l})}c.remoteStream=null,c.volume&&(c.volume.local&&c.volume.local.timer&&clearInterval(c.volume.local.timer),c.volume.remote&&c.volume.remote.timer&&clearInterval(c.volume.remote.timer)),c.volume={},c.bitrate.timer&&clearInterval(c.bitrate.timer),c.bitrate.timer=null,c.bitrate.bsnow=null,c.bitrate.bsbefore=null,c.bitrate.tsnow=null,c.bitrate.tsbefore=null,c.bitrate.value=null,!c.streamExternal&&c.myStream&&(Janus.log("Stopping local stream tracks"),Janus.stopAllTracks(c.myStream)),c.streamExternal=!1,c.myStream=null;try{c.pc.close()}catch(t){}c.pc=null,c.candidates=null,c.mySdp=null,c.remoteSdp=null,c.iceDone=!1,c.dataChannel={},c.dtmfSender=null,c.senderTransforms=null,c.receiverTransforms=null}a.oncleanup()}}function isAudioSendEnabled(t){return Janus.debug("isAudioSendEnabled:",t),!t||!1!==t.audio&&(void 0===t.audioSend||null===t.audioSend||!0===t.audioSend)}function isAudioRecvEnabled(t){return Janus.debug("isAudioRecvEnabled:",t),!t||!1!==t.audio&&(void 0===t.audioRecv||null===t.audioRecv||!0===t.audioRecv)}function isVideoSendEnabled(t){return Janus.debug("isVideoSendEnabled:",t),!t||!1!==t.video&&(void 0===t.videoSend||null===t.videoSend||!0===t.videoSend)}function isVideoRecvEnabled(t){return Janus.debug("isVideoRecvEnabled:",t),!t||!1!==t.video&&(void 0===t.videoRecv||null===t.videoRecv||!0===t.videoRecv)}createSession(t),this.getServer=function(){return u},this.isConnected=function(){return S},this.reconnect=function(t){(t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.reconnect=!0,createSession(t)},this.getSessionId=function(){return C},this.getInfo=function(t){!function getInfo(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,Janus.log("Getting info on Janus instance"),!S)return Janus.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=Janus.randomString(12),a={janus:"info",transaction:o};v&&(a.token=v);_&&(a.apisecret=_);if(r)return k[o]=function(r){Janus.log("Server info:"),Janus.debug(r),"server_info"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),t.success(r)},void i.send(JSON.stringify(a));Janus.httpAPICall(u,{verb:"POST",withCredentials:m,body:a,success:function(r){Janus.log("Server info:"),Janus.debug(r),"server_info"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),t.success(r)},error:function(r,i){Janus.error(r+":",i),""===i?t.error(r+": Is the server down?"):t.error(r+": "+i)}})}(t)},this.destroy=function(c){!function destroySession(c){(c=c||{}).success="function"==typeof c.success?c.success:Janus.noop,c.error="function"==typeof c.error?c.error:Janus.noop;var l=!0===c.unload,d=!0;void 0!==c.notifyDestroyed&&null!==c.notifyDestroyed&&(d=!0===c.notifyDestroyed);var h=!0===c.cleanupHandles;if(Janus.log("Destroying session "+C+" (unload="+l+")"),!C)return Janus.warn("No session to destroy"),c.success(),void(d&&t.destroyed());if(h)for(var p in P)destroyHandle(p,{noRequest:!0});if(!S)return Janus.warn("Is the server down? (connected=false)"),C=null,void c.success();var g={janus:"destroy",transaction:Janus.randomString(12)};v&&(g.token=v);_&&(g.apisecret=_);if(l)return r?(i.onclose=null,i.close(),i=null):navigator.sendBeacon(u+"/"+C,JSON.stringify(g)),Janus.log("Destroyed session:"),C=null,S=!1,c.success(),void(d&&t.destroyed());if(r){g.session_id=C;var unbindWebSocket=function(){for(var t in o)i.removeEventListener(t,o[t]);i.removeEventListener("message",onUnbindMessage),i.removeEventListener("error",onUnbindError),a&&clearTimeout(a),i.close()},onUnbindMessage=function(r){var i=JSON.parse(r.data);i.session_id==g.session_id&&i.transaction==g.transaction&&(unbindWebSocket(),c.success(),d&&t.destroyed())},onUnbindError=function(){unbindWebSocket(),c.error("Failed to destroy the server: Is the server down?"),d&&t.destroyed()};return i.addEventListener("message",onUnbindMessage),i.addEventListener("error",onUnbindError),void(1===i.readyState?i.send(JSON.stringify(g)):onUnbindError())}Janus.httpAPICall(u+"/"+C,{verb:"POST",withCredentials:m,body:g,success:function(r){Janus.log("Destroyed session:"),Janus.debug(r),C=null,S=!1,"success"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),c.success(),d&&t.destroyed()},error:function(r,i){Janus.error(r+":",i),C=null,S=!1,c.success(),d&&t.destroyed()}})}(c)},this.attach=function(t){!function createHandle(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.dataChannelOptions=t.dataChannelOptions||{ordered:!0},t.consentDialog="function"==typeof t.consentDialog?t.consentDialog:Janus.noop,t.iceState="function"==typeof t.iceState?t.iceState:Janus.noop,t.mediaState="function"==typeof t.mediaState?t.mediaState:Janus.noop,t.webrtcState="function"==typeof t.webrtcState?t.webrtcState:Janus.noop,t.slowLink="function"==typeof t.slowLink?t.slowLink:Janus.noop,t.onmessage="function"==typeof t.onmessage?t.onmessage:Janus.noop,t.onlocalstream="function"==typeof t.onlocalstream?t.onlocalstream:Janus.noop,t.onremotestream="function"==typeof t.onremotestream?t.onremotestream:Janus.noop,t.ondata="function"==typeof t.ondata?t.ondata:Janus.noop,t.ondataopen="function"==typeof t.ondataopen?t.ondataopen:Janus.noop,t.oncleanup="function"==typeof t.oncleanup?t.oncleanup:Janus.noop,t.ondetached="function"==typeof t.ondetached?t.ondetached:Janus.noop,!S)return Janus.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=t.plugin;if(!o)return Janus.error("Invalid plugin"),void t.error("Invalid plugin");var a=t.opaqueId,c=t.loopIndex,l=t.token?t.token:v,d=Janus.randomString(12),h={janus:"attach",plugin:o,opaque_id:a,loop_index:c,transaction:d};l&&(h.token=l);_&&(h.apisecret=_);if(r)return k[d]=function(r){if(Janus.debug(r),"success"!==r.janus)return Janus.error("Ooops: "+r.error.code+" "+r.error.reason),void t.error("Ooops: "+r.error.code+" "+r.error.reason);var i=r.data.id;Janus.log("Created handle: "+i);var a={session:w,plugin:o,id:i,token:l,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:t.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return o},getVolume:function(){return getVolume(i,!0)},getRemoteVolume:function(){return getVolume(i,!0)},getLocalVolume:function(){return getVolume(i,!1)},isAudioMuted:function(){return isMuted(i,!1)},muteAudio:function(){return mute(i,!1,!0)},unmuteAudio:function(){return mute(i,!1,!1)},isVideoMuted:function(){return isMuted(i,!0)},muteVideo:function(){return mute(i,!0,!0)},unmuteVideo:function(){return mute(i,!0,!1)},getBitrate:function(){return getBitrate(i)},send:function(t){sendMessage(i,t)},data:function(t){sendData(i,t)},dtmf:function(t){sendDtmf(i,t)},consentDialog:t.consentDialog,iceState:t.iceState,mediaState:t.mediaState,webrtcState:t.webrtcState,slowLink:t.slowLink,onmessage:t.onmessage,createOffer:function(t){prepareWebrtc(i,!0,t)},createAnswer:function(t){prepareWebrtc(i,!1,t)},handleRemoteJsep:function(t){prepareWebrtcPeer(i,t)},onlocalstream:t.onlocalstream,onremotestream:t.onremotestream,ondata:t.ondata,ondataopen:t.ondataopen,oncleanup:t.oncleanup,ondetached:t.ondetached,hangup:function(t){cleanupWebrtc(i,!0===t)},detach:function(t){destroyHandle(i,t)}};P[i]=a,t.success(a)},h.session_id=C,void i.send(JSON.stringify(h));Janus.httpAPICall(u+"/"+C,{verb:"POST",withCredentials:m,body:h,success:function(r){if(Janus.debug(r),"success"!==r.janus)return Janus.error("Ooops: "+r.error.code+" "+r.error.reason),void t.error("Ooops: "+r.error.code+" "+r.error.reason);var i=r.data.id;Janus.log("Created handle: "+i);var a={session:w,plugin:o,id:i,token:l,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:t.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return o},getVolume:function(){return getVolume(i,!0)},getRemoteVolume:function(){return getVolume(i,!0)},getLocalVolume:function(){return getVolume(i,!1)},isAudioMuted:function(){return isMuted(i,!1)},muteAudio:function(){return mute(i,!1,!0)},unmuteAudio:function(){return mute(i,!1,!1)},isVideoMuted:function(){return isMuted(i,!0)},muteVideo:function(){return mute(i,!0,!0)},unmuteVideo:function(){return mute(i,!0,!1)},getBitrate:function(){return getBitrate(i)},send:function(t){sendMessage(i,t)},data:function(t){sendData(i,t)},dtmf:function(t){sendDtmf(i,t)},consentDialog:t.consentDialog,iceState:t.iceState,mediaState:t.mediaState,webrtcState:t.webrtcState,slowLink:t.slowLink,onmessage:t.onmessage,createOffer:function(t){prepareWebrtc(i,!0,t)},createAnswer:function(t){prepareWebrtc(i,!1,t)},handleRemoteJsep:function(t){prepareWebrtcPeer(i,t)},onlocalstream:t.onlocalstream,onremotestream:t.onremotestream,ondata:t.ondata,ondataopen:t.ondataopen,oncleanup:t.oncleanup,ondetached:t.ondetached,hangup:function(t){cleanupWebrtc(i,!0===t)},detach:function(t){destroyHandle(i,t)}};P[i]=a,t.success(a)},error:function(r,i){Janus.error(r+":",i),""===i?t.error(r+": Is the server down?"):t.error(r+": "+i)}})}(t)}}Janus.useDefaultDependencies=function(t){var r=t&&t.fetch||fetch,i=t&&t.Promise||Promise,o=t&&t.WebSocket||WebSocket;return{newWebSocket:function(t,r){return new o(t,r)},extension:t&&t.extension||Kt,isArray:function(t){return Array.isArray(t)},webRTCAdapter:t&&t.adapter||$t,httpAPICall:function(t,o){var a={method:o.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===o.verb&&(a.headers["Content-Type"]="application/json"),void 0!==o.withCredentials&&(a.credentials=!0===o.withCredentials?"include":o.withCredentials?o.withCredentials:"omit"),o.body&&(a.body=JSON.stringify(o.body));var c=r(t,a).catch((function(t){return i.reject({message:"Probably a network error, is the server down?",error:t})}));if(o.timeout){var l=new i((function(t,r){var i=setTimeout((function(){return clearTimeout(i),r({message:"Request timed out",timeout:o.timeout})}),o.timeout)}));c=i.race([c,l])}return c.then((function(t){return t.ok?typeof o.success==typeof Janus.noop?t.json().then((function(t){try{o.success(t)}catch(t){Janus.error("Unhandled httpAPICall success callback error",t)}}),(function(r){return i.reject({message:"Failed to parse response body",error:r,response:t})})):void 0:i.reject({message:"API call failed",response:t})})).catch((function(t){typeof o.error==typeof Janus.noop&&o.error(t.message||"<< internal error >>",t)})),c}}},Janus.useOldDependencies=function(t){var r=t&&t.jQuery||jQuery,i=t&&t.WebSocket||WebSocket;return{newWebSocket:function(t,r){return new i(t,r)},isArray:function(t){return r.isArray(t)},extension:t&&t.extension||Kt,webRTCAdapter:t&&t.adapter||$t,httpAPICall:function(t,i){var o=void 0!==i.body?{contentType:"application/json",data:JSON.stringify(i.body)}:{},a=void 0!==i.withCredentials?{xhrFields:{withCredentials:i.withCredentials}}:{};return r.ajax(r.extend(o,a,{url:t,type:i.verb,cache:!1,dataType:"json",async:i.async,timeout:i.timeout,success:function(t){typeof i.success==typeof Janus.noop&&i.success(t)},error:function(t,r,o){typeof i.error==typeof Janus.noop&&i.error(r,o)}}))}}},Janus.noop=function(){},Janus.dataChanDefaultLabel="JanusDataChannel",Janus.endOfCandidates=null,Janus.stopAllTracks=function(t){try{var r=t.getTracks();for(var i of r)Janus.log(i),i&&i.stop()}catch(t){}},Janus.init=function(t){if((t=t||{}).callback="function"==typeof t.callback?t.callback:Janus.noop,Janus.initDone)t.callback();else{if(void 0===console.log&&(console.log=function(){}),Janus.trace=Janus.noop,Janus.debug=Janus.noop,Janus.vdebug=Janus.noop,Janus.log=Janus.noop,Janus.warn=Janus.noop,Janus.error=Janus.noop,!0===t.debug||"all"===t.debug)Janus.trace=console.trace.bind(console),Janus.debug=console.debug.bind(console),Janus.vdebug=console.debug.bind(console),Janus.log=console.log.bind(console),Janus.warn=console.warn.bind(console),Janus.error=console.error.bind(console);else if(Array.isArray(t.debug))for(var r of t.debug)switch(r){case"trace":Janus.trace=console.trace.bind(console);break;case"debug":Janus.debug=console.debug.bind(console);break;case"vdebug":Janus.vdebug=console.debug.bind(console);break;case"log":Janus.log=console.log.bind(console);break;case"warn":Janus.warn=console.warn.bind(console);break;case"error":Janus.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+r+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}Janus.log("Initializing library");var i=t.dependencies||Janus.useDefaultDependencies();Janus.isArray=i.isArray,Janus.webRTCAdapter=i.webRTCAdapter,Janus.httpAPICall=i.httpAPICall,Janus.newWebSocket=i.newWebSocket,Janus.extension=i.extension,Janus.extension.init(),Janus.listDevices=function(t,r){t="function"==typeof t?t:Janus.noop,null==r&&(r={audio:!0,video:!0}),Janus.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(r).then((function(r){navigator.mediaDevices.enumerateDevices().then((function(i){Janus.debug(i),t(i),Janus.stopAllTracks(r)}))})).catch((function(r){Janus.error(r),t([])})):(Janus.warn("navigator.mediaDevices unavailable"),t([]))},Janus.attachMediaStream=function(t,r){try{t.srcObject=r}catch(i){try{t.src=URL.createObjectURL(r)}catch(t){Janus.error("Error attaching stream to element")}}},Janus.reattachMediaStream=function(t,r){try{t.srcObject=r.srcObject}catch(i){try{t.src=r.src}catch(t){Janus.error("Error reattaching stream to element")}}};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",a=window["on"+o];if(window.addEventListener(o,(function(){for(var t in Janus.log("Closing window"),Janus.sessions)Janus.sessions[t]&&Janus.sessions[t].destroyOnUnload&&(Janus.log("Destroying session "+t),Janus.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));a&&"function"==typeof a&&a()})),Janus.safariVp8=!1,"safari"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var c of RTCRtpSender.getCapabilities("video").codecs)if(c&&c.mimeType&&"video/vp8"===c.mimeType.toLowerCase()){Janus.safariVp8=!0;break}Janus.safariVp8?Janus.log("This version of Safari supports VP8"):Janus.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var l=new RTCPeerConnection({});l.createOffer({offerToReceiveVideo:!0}).then((function(t){Janus.safariVp8=-1!==t.sdp.indexOf("VP8"),Janus.safariVp8?Janus.log("This version of Safari supports VP8"):Janus.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),l.close(),l=null}))}if(Janus.unifiedPlan=!1,"firefox"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=59)Janus.unifiedPlan=!0;else if("chrome"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=72)Janus.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var u=new RTCPeerConnection;try{u.addTransceiver("audio"),Janus.unifiedPlan=!0}catch(t){}u.close()}else Janus.unifiedPlan=!1;Janus.initDone=!0,t.callback()}},Janus.isWebrtcSupported=function(){return!!window.RTCPeerConnection},Janus.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},Janus.randomString=function(t){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",o=0;o<t;o++){var a=Math.floor(Math.random()*r.length);i+=r.substring(a,a+1)}return i};var Zt=function(){function Utils(){_classCallCheck(this,Utils)}return _createClass(Utils,null,[{key:"isFunction",value:function isFunction(t){return"function"==typeof t}},{key:"checkFunction",value:function checkFunction(t){this.isFunction(t)||console.error("Consumer is not a function")}}]),Utils}();function janus_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function janus_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return janus_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return janus_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function janus_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var en,tn=function(){function JanusService(t,r){_classCallCheck(this,JanusService),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"serverUrl",void 0),_defineProperty(this,"playerView",void 0),_defineProperty(this,"janus",void 0),_defineProperty(this,"publisherLocalStream",void 0),_defineProperty(this,"publisherHandle",void 0),_defineProperty(this,"publisherId",void 0),_defineProperty(this,"remoteFeeds",void 0),_defineProperty(this,"myroom",void 0),_defineProperty(this,"opaqueId",void 0),_defineProperty(this,"deviceConstraints",void 0),_defineProperty(this,"myusername",void 0),_defineProperty(this,"dataCallback",void 0),_defineProperty(this,"errorCallback",void 0),this.serverUrl=t,this.playbackModel=r,this.janus=null,this.publisherHandle=null,this.publisherId=null,this.publisherLocalStream=null,this.dataCallback=null,this.remoteFeeds=[],this.opaqueId="course-"+Janus.randomString(12),this.myusername=Janus.randomString(12)}return _createClass(JanusService,[{key:"setPlayerView",value:function setPlayerView(t){this.playerView=t}},{key:"setDeviceConstraints",value:function setDeviceConstraints(t){this.deviceConstraints=t}},{key:"setUserId",value:function setUserId(t){this.opaqueId=t}},{key:"setRoomId",value:function setRoomId(t){this.myroom=t}},{key:"setOnData",value:function setOnData(t){Zt.checkFunction(t),this.dataCallback=t}},{key:"setOnError",value:function setOnError(t){Zt.checkFunction(t),this.errorCallback=t}},{key:"start",value:function start(){var t=this;Janus.init({callback:function callback(){Janus.isWebrtcSupported()?t.createSession():console.error("No WebRTC support...")}})}},{key:"addPeer",value:function addPeer(t){var r=Number(t);this.publisherId!==r&&this.attachToPublisher({id:r},!1)}},{key:"startSpeech",value:function startSpeech(t){var r=this;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(t){Janus.log("Plugin attached! ("+t.getPlugin()+", id="+t.getId()+")"),r.publisherHandle=t,r.joinAsPublisher(r.publisherHandle)},error:function error(t){Janus.error("  -- Error attaching plugin...",t)},consentDialog:function consentDialog(t){},iceState:function iceState(t){Janus.log("ICE state changed to "+t)},mediaState:function mediaState(t,r,i){Janus.log("Janus "+(r?"started":"stopped")+" receiving our "+t)},webrtcState:function webrtcState(t){Janus.log("Janus says our WebRTC PeerConnection is "+(t?"up":"down")+" now"),r.playbackModel.webrtcPublisherConnected=t,t||(r.playbackModel.localVideoAvailable=!1,r.playbackModel.raisedHand=!1)},onmessage:function onmessage(i,o){var a=i.videoroom;if(i.error)Janus.error(i.error);else if(a&&"joined"===a&&(r.publisherId=i.id,r.publishOwnFeed(r.publisherHandle,t)),o){r.publisherHandle.handleRemoteJsep({jsep:o});var c=i.audio_codec,l=i.video_codec;r.publisherLocalStream&&r.publisherLocalStream.getAudioTracks()&&r.publisherLocalStream.getAudioTracks().length>0&&!c&&console.log("Our audio stream has been rejected, viewers won't hear us"),r.publisherLocalStream&&r.publisherLocalStream.getVideoTracks()&&r.publisherLocalStream.getVideoTracks().length>0&&!l&&console.log("Our video stream has been rejected, viewers won't see us")}},onlocalstream:function onlocalstream(t){r.publisherLocalStream=t;var i=r.getElementById("localVideoFeed");Janus.attachMediaStream(i,t),i.muted=!0;var o,a=!1,c={width:{min:640,ideal:640,max:1280},height:{min:360,ideal:360},aspectRatio:{ideal:1.7777777778},frameRate:{max:30},facingMode:{ideal:"user"}},l=janus_service_createForOfIteratorHelper(t.getVideoTracks());try{for(l.s();!(o=l.n()).done;){var u=o.value;if(u.applyConstraints(c),0==u.muted){a=!0;break}}}catch(t){l.e(t)}finally{l.f()}r.playbackModel.localVideoAvailable=a},onremotestream:function onremotestream(t){},oncleanup:function oncleanup(){},detached:function detached(){}})}},{key:"stopSpeech",value:function stopSpeech(){if(this.publisherId=null,this.publisherHandle){this.publisherHandle.send({message:{request:"unpublish"}}),this.playbackModel.localVideoAvailable=!1}}},{key:"createSession",value:function createSession(){var t=this;this.janus=new Janus({server:this.serverUrl,success:function success(){t.attach()},error:function error(r){Janus.error(r),t.errorCallback&&t.errorCallback(r)},destroyed:function destroyed(){Janus.log("Janus destroyed")}})}},{key:"attach",value:function attach(){var t=this;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(r){Janus.log("Plugin attached! ("+r.getPlugin()+", id="+r.getId()+")"),t.getParticipants(r)},onmessage:function onmessage(t,r){console.log("init handler",t)},error:function error(t){console.error("  -- Error attaching plugin...",t)},detached:function detached(){console.log("detached main...")}})}},{key:"getParticipants",value:function getParticipants(t){var r=this,i={request:"listparticipants",room:this.myroom};t.send({message:i,success:function success(i){if(i.participants&&i.participants.length>0)for(var o in i.participants){var a=i.participants[o];r.attachToPublisher(a,!a.display)}else Janus.error("Requested feed is not available anymore");t.detach()}})}},{key:"attachToPublisher",value:function attachToPublisher(t,r){var i=this,o=null;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(a){(o=a).isPrimary=r,o.hasVideo=!1;var c={request:"join",room:i.myroom,ptype:"subscriber",feed:t.id};o.send({message:c})},error:function error(t){Janus.error("  -- Error attaching plugin...",t),o.isPrimary&&i.stopSpeech()},iceState:function iceState(t){Janus.log("ICE state changed to "+t),"failed"===t&&i.errorCallback&&i.errorCallback({cause:"ICE failed"})},mediaState:function mediaState(t,r,i){Janus.log("Janus "+(r?"started":"stopped")+" receiving our "+t)},webrtcState:function webrtcState(t){Janus.log("Janus says our WebRTC PeerConnection is "+(t?"up":"down")+" now"),o.isPrimary&&(i.playbackModel.webrtcConnected=t,t||i.stopSpeech())},onmessage:function onmessage(t,r){var a=t.videoroom;t.error?console.error(t.error):(a&&"attached"===a&&(Janus.log("Successfully attached to feed "+t.id+" ("+t.display+") in room "+t.room),o.rfid=t.id,i.remoteFeeds.push(o)),r&&i.createAnswer(o,r,o.isPrimary))},onremotestream:function onremotestream(r){var a,c=!1,l=janus_service_createForOfIteratorHelper(r.getVideoTracks());try{for(l.s();!(a=l.n()).done;){if(0==a.value.muted)if("break"===(r.addEventListener("removetrack",(function removeListener(t){i.onVideoTrackRemoved(o,t.track),r.removeEventListener("removetrack",removeListener)})),c=!0,"break"))break}}catch(t){l.e(t)}finally{l.f()}if(o.hasVideo=c,o.isPrimary){var u=i.playerView.getMediaElement();Janus.attachMediaStream(u,r),i.setAudioSink(u,i.deviceConstraints.audioOutput),i.playbackModel.mainVideoAvailable=c}else{var d=i.getElementById("videoFeed-"+t.id);if(!d){(d=document.createElement("video")).id="videoFeed-"+t.id,d.autoplay=!0,d.playsInline=!0;var h=document.createElement("div");h.id="videoFeedDiv-"+t.id,h.classList.add("feed-container","invisible"),h.appendChild(d),i.getElementById("videoFeedContainer").appendChild(h)}if(c)i.getElementById("videoFeedDiv-"+t.id).classList.remove("invisible");Janus.attachMediaStream(d,r),i.setAudioSink(d,i.deviceConstraints.audioOutput)}i.checkVideoCount()},ondataopen:function ondataopen(t,r){Janus.log("The DataChannel is available! - "+t+" - "+r)},ondata:function ondata(t){o.isPrimary&&i.dataCallback(t)},oncleanup:function oncleanup(){if(!o.isPrimary){var r=i.getElementById("videoFeedContainer"),a=i.getElementById("videoFeedDiv-"+t.id);r.removeChild(a)}i.remoteFeeds=i.remoteFeeds.filter((function(t){return t!==o})),o.isPrimary&&i.stopSpeech(),i.checkVideoCount(),o.isPrimary&&i.janus.destroy()},detached:function detached(){Janus.log("detached...")}})}},{key:"setAudioSink",value:function setAudioSink(t,r){"sinkId"in HTMLMediaElement.prototype&&t.setSinkId(r).catch((function(t){console.error(t)}))}},{key:"onVideoTrackRemoved",value:function onVideoTrackRemoved(t,r){this.playbackModel.mainVideoAvailable=!1,t.hasVideo=!1,this.checkVideoCount()}},{key:"checkVideoCount",value:function checkVideoCount(){var t,r=!1,i=janus_service_createForOfIteratorHelper(this.remoteFeeds);try{for(i.s();!(t=i.n()).done;){if(!0===t.value.hasVideo){r=!0;break}}}catch(t){i.e(t)}finally{i.f()}this.playbackModel.videoAvailable=r}},{key:"joinAsPublisher",value:function joinAsPublisher(t){var r={request:"join",room:this.myroom,ptype:"publisher",display:this.myusername};t.send({message:r})}},{key:"createAnswer",value:function createAnswer(t,r,i){var o=this;t.createAnswer({jsep:r,media:{audioSend:!1,videoSend:!1,data:i},success:function success(r){var i={request:"start",room:o.myroom};t.send({message:i,jsep:r})},error:function error(t){Janus.error("WebRTC error: ",t)}})}},{key:"publishOwnFeed",value:function publishOwnFeed(t,r){var i=null!=r.videoDeviceId;t.createOffer({media:{audioRecv:!1,videoRecv:!1,audioSend:!0,videoSend:i,audio:{deviceId:r.audioDeviceId,echoCancellation:!0},video:{deviceId:r.videoDeviceId,width:1280,height:720},failIfNoAudio:!0,failIfNoVideo:!1},success:function success(r){Janus.debug("Got publisher SDP!",r);var o={request:"configure",audio:!0,video:i};t.send({message:o,jsep:r})},error:function error(i){Janus.error("WebRTC error:",i),console.error("WebRTC error:",i),r.videoDeviceId=null,this.publishOwnFeed(t,r)}})}},{key:"getElementById",value:function getElementById(t){return document.getElementById(t)}}]),JanusService}();!function(t){t[t.STREAM_INIT=0]="STREAM_INIT",t[t.STREAM_START=1]="STREAM_START",t[t.STREAM_PAGE_ACTION=2]="STREAM_PAGE_ACTION",t[t.STREAM_PAGE_ACTIONS=3]="STREAM_PAGE_ACTIONS",t[t.STREAM_PAGE_CREATED=4]="STREAM_PAGE_CREATED",t[t.STREAM_PAGE_DELETED=5]="STREAM_PAGE_DELETED",t[t.STREAM_PAGE_SELECTED=6]="STREAM_PAGE_SELECTED",t[t.STREAM_DOCUMENT_CREATED=7]="STREAM_DOCUMENT_CREATED",t[t.STREAM_DOCUMENT_CLOSED=8]="STREAM_DOCUMENT_CLOSED",t[t.STREAM_DOCUMENT_SELECTED=9]="STREAM_DOCUMENT_SELECTED",t[t.STREAM_SPEECH_PUBLISHED=10]="STREAM_SPEECH_PUBLISHED"}(en||(en={}));var nn=_createClass((function StreamAction(){_classCallCheck(this,StreamAction)}));function stream_document_action_createSuper(t){var r=function stream_document_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var rn=function(t){_inherits(StreamDocumentAction,t);var r=stream_document_action_createSuper(StreamDocumentAction);function StreamDocumentAction(t,i,o,a){var c;return _classCallCheck(this,StreamDocumentAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(c),"documentType",void 0),_defineProperty(_assertThisInitialized(c),"documentTitle",void 0),_defineProperty(_assertThisInitialized(c),"documentFile",void 0),c.documentId=t,c.documentType=i,c.documentTitle=o,c.documentFile=a,c}return _createClass(StreamDocumentAction)}(nn);function stream_document_closed_action_createSuper(t){var r=function stream_document_closed_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var on=function(t){_inherits(StreamDocumentClosedAction,t);var r=stream_document_closed_action_createSuper(StreamDocumentClosedAction);function StreamDocumentClosedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentClosedAction),r.call(this,t,i,o,a)}return _createClass(StreamDocumentClosedAction)}(rn);function stream_document_created_action_createSuper(t){var r=function stream_document_created_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var an=function(t){_inherits(StreamDocumentCreatedAction,t);var r=stream_document_created_action_createSuper(StreamDocumentCreatedAction);function StreamDocumentCreatedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentCreatedAction),r.call(this,t,i,o,a)}return _createClass(StreamDocumentCreatedAction)}(rn);function stream_document_selected_action_createSuper(t){var r=function stream_document_selected_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var sn=function(t){_inherits(StreamDocumentSelectedAction,t);var r=stream_document_selected_action_createSuper(StreamDocumentSelectedAction);function StreamDocumentSelectedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentSelectedAction),r.call(this,t,i,o,a)}return _createClass(StreamDocumentSelectedAction)}(rn);function stream_page_action_createSuper(t){var r=function stream_page_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var cn=function(t){_inherits(StreamPageAction,t);var r=stream_page_action_createSuper(StreamPageAction);function StreamPageAction(t,i){var o;return _classCallCheck(this,StreamPageAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(o),"pageNumber",void 0),o.documentId=t,o.pageNumber=i,o}return _createClass(StreamPageAction)}(nn);function stream_page_created_action_createSuper(t){var r=function stream_page_created_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ln=function(t){_inherits(StreamPageCreatedAction,t);var r=stream_page_created_action_createSuper(StreamPageCreatedAction);function StreamPageCreatedAction(t,i){return _classCallCheck(this,StreamPageCreatedAction),r.call(this,t,i)}return _createClass(StreamPageCreatedAction)}(cn);function stream_page_deleted_action_createSuper(t){var r=function stream_page_deleted_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var un=function(t){_inherits(StreamPageDeletedAction,t);var r=stream_page_deleted_action_createSuper(StreamPageDeletedAction);function StreamPageDeletedAction(t,i){return _classCallCheck(this,StreamPageDeletedAction),r.call(this,t,i)}return _createClass(StreamPageDeletedAction)}(cn);function stream_page_selected_action_createSuper(t){var r=function stream_page_selected_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var dn=function(t){_inherits(StreamPageSelectedAction,t);var r=stream_page_selected_action_createSuper(StreamPageSelectedAction);function StreamPageSelectedAction(t,i){return _classCallCheck(this,StreamPageSelectedAction),r.call(this,t,i)}return _createClass(StreamPageSelectedAction)}(cn);function stream_playback_action_createSuper(t){var r=function stream_playback_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var hn=function(t){_inherits(StreamPagePlaybackAction,t);var r=stream_playback_action_createSuper(StreamPagePlaybackAction);function StreamPagePlaybackAction(t,i,o){var a;return _classCallCheck(this,StreamPagePlaybackAction),_defineProperty(_assertThisInitialized(a=r.call(this,t,i)),"action",void 0),a.action=o,a}return _createClass(StreamPagePlaybackAction)}(cn);function stream_playbacks_action_createSuper(t){var r=function stream_playbacks_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pn=function(t){_inherits(StreamPageActionsAction,t);var r=stream_playbacks_action_createSuper(StreamPageActionsAction);function StreamPageActionsAction(t,i){var o;return _classCallCheck(this,StreamPageActionsAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(o),"recordedPage",void 0),o.documentId=t,o.recordedPage=i,o}return _createClass(StreamPageActionsAction)}(nn);function stream_start_action_createSuper(t){var r=function stream_start_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var fn=function(t){_inherits(StreamStartAction,t);var r=stream_start_action_createSuper(StreamStartAction);function StreamStartAction(t){var i;return _classCallCheck(this,StreamStartAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"courseId",void 0),i.courseId=t,i}return _createClass(StreamStartAction)}(nn);function stream_speech_action_createSuper(t){var r=function stream_speech_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function stream_speech_published_action_createSuper(t){var r=function stream_speech_published_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var gn=function(t){_inherits(StreamSpeechPublishedAction,t);var r=stream_speech_published_action_createSuper(StreamSpeechPublishedAction);function StreamSpeechPublishedAction(t){return _classCallCheck(this,StreamSpeechPublishedAction),r.call(this,t)}return _createClass(StreamSpeechPublishedAction)}(function(t){_inherits(StreamSpeechAction,t);var r=stream_speech_action_createSuper(StreamSpeechAction);function StreamSpeechAction(t){var i;return _classCallCheck(this,StreamSpeechAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"publisherId",void 0),i.publisherId=t,i}return _createClass(StreamSpeechAction)}(nn)),mn=function(){function StreamActionParser(){_classCallCheck(this,StreamActionParser)}return _createClass(StreamActionParser,null,[{key:"parse",value:function parse(t,r,i){var o=null;switch(r){case en.STREAM_INIT:break;case en.STREAM_START:o=this.startAction(t);break;case en.STREAM_PAGE_ACTION:o=this.playbackAction(t);break;case en.STREAM_PAGE_ACTIONS:o=this.playbackActions(t);break;case en.STREAM_PAGE_CREATED:o=this.pageAction(t,ln);break;case en.STREAM_PAGE_DELETED:o=this.pageAction(t,un);break;case en.STREAM_PAGE_SELECTED:o=this.pageAction(t,dn);break;case en.STREAM_DOCUMENT_CREATED:o=this.documentAction(t,an);break;case en.STREAM_DOCUMENT_CLOSED:o=this.documentAction(t,on);break;case en.STREAM_DOCUMENT_SELECTED:o=this.documentAction(t,sn);break;case en.STREAM_SPEECH_PUBLISHED:o=this.speechAction(t,gn)}return o}},{key:"startAction",value:function startAction(t){var r=t.getUint32();return new fn(r)}},{key:"playbackAction",value:function playbackAction(t){var r=t.getInt64(),i=t.getInt32(),o=t.getInt32(),a=t.getInt8(),c=t.getInt32(),l=Et.parse(t,a,o);return l.timestamp=c,new hn(r,i,l)}},{key:"playbackActions",value:function playbackActions(t){var r=t.getInt64(),i=(t.getInt32(),(new Dt).parse(t));return new pn(r,i)}},{key:"pageAction",value:function pageAction(t,r){return new r(t.getInt64(),t.getInt32())}},{key:"documentAction",value:function documentAction(t,r){var i=t.getInt64(),o=t.getInt8(),a=t.getInt32(),c=t.getInt32(),l=t.getInt32(),u=t.getString(a),d=t.getString(c);t.getString(l);return new r(i,o,u,d)}},{key:"speechAction",value:function speechAction(t,r){var i=t.getInt32(),o=t.getString(i);return new r(BigInt(o))}}]),StreamActionParser}();function page_action_createSuper(t){var r=function page_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var yn,vn=function(t){_inherits(PageAction,t);var r=page_action_createSuper(PageAction);function PageAction(t){var i;return _classCallCheck(this,PageAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"pageNumber",void 0),i.pageNumber=t,i}return _createClass(PageAction,[{key:"execute",value:function execute(t){t.setPageNumber(this.pageNumber)}}]),PageAction}(Q),_n=function(){function StreamActionExecutor(t){_classCallCheck(this,StreamActionExecutor),_defineProperty(this,"renderController",void 0),_defineProperty(this,"toolContext",void 0),_defineProperty(this,"document",void 0),_defineProperty(this,"tool",void 0),_defineProperty(this,"previousTool",void 0),_defineProperty(this,"pageIndexObserver",void 0),this.renderController=t,this.toolContext=new Ot(t)}return _createClass(StreamActionExecutor,[{key:"setOnSelectPageIndex",value:function setOnSelectPageIndex(t){this.pageIndexObserver=t}},{key:"setKeyEvent",value:function setKeyEvent(t){this.toolContext.keyEvent=t}},{key:"setSeek",value:function setSeek(t){this.renderController.setSeek(t)}},{key:"setDocument",value:function setDocument(t){this.document=t}},{key:"setPageNumber",value:function setPageNumber(t){var r=this.document.getPage(t);this.toolContext.page=r,this.renderController.setPage(r),this.pageIndexObserver&&this.pageIndexObserver(t)}},{key:"removePageNumber",value:function removePageNumber(t){this.document.deletePage(t)}},{key:"setTool",value:function setTool(t){if(!t)throw new Error("Tool must not be null");(this.tool||this.tool!==t)&&(this.setPreviousTool(this.tool),this.tool=t)}},{key:"selectAndExecuteTool",value:function selectAndExecuteTool(t){this.executeAtomicTool(t)}},{key:"beginTool",value:function beginTool(t){this.tool.begin(t.clone(),this.toolContext)}},{key:"executeTool",value:function executeTool(t){this.tool.execute(t.clone())}},{key:"endTool",value:function endTool(t){this.tool.end(t.clone())}},{key:"executeAtomicTool",value:function executeAtomicTool(t){var r=Y.createZero();this.setTool(t),this.beginTool(r),this.executeTool(r),this.endTool(r),this.setPreviousTool(this.previousTool)}},{key:"setPreviousTool",value:function setPreviousTool(t){t&&(t instanceof Le||(this.previousTool=t))}}]),StreamActionExecutor}();!function(t){t.Created="Created",t.Initializing="Initializing",t.Initialized="Initialized",t.Starting="Starting",t.Started="Started",t.Stopping="Stopping",t.Stopped="Stopped",t.Suspending="Suspending",t.Suspended="Suspended",t.Destroying="Destroying",t.Destroyed="Destroyed",t.Error="Error"}(yn||(yn={}));var bn=function(){function Executable(){_classCallCheck(this,Executable),_defineProperty(this,"stateEvent",new L),_defineProperty(this,"_state",yn.Created),_defineProperty(this,"_prevState",yn.Created)}return _createClass(Executable,[{key:"state",get:function get(){return this._state}},{key:"previousState",get:function get(){return this._prevState}},{key:"initialized",value:function initialized(){return this._state===yn.Initialized}},{key:"created",value:function created(){return this._state===yn.Created}},{key:"started",value:function started(){return this._state===yn.Started}},{key:"stopped",value:function stopped(){return this._state===yn.Stopped}},{key:"suspended",value:function suspended(){return this._state===yn.Suspended}},{key:"destroyed",value:function destroyed(){return this._state===yn.Destroyed}},{key:"error",value:function error(){return this._state===yn.Error}},{key:"addStateListener",value:function addStateListener(t){return this.stateEvent.subscribe(t)}},{key:"removeStateListener",value:function removeStateListener(t){this.stateEvent.unsubscribe(t)}},{key:"fireStateChanged",value:function fireStateChanged(){this.stateEvent.publish(this._state)}},{key:"setState",value:function setState(t){if(!this.validateNextState(t))throw new Error("Invalid state transition for ".concat(this.constructor.name,": [").concat(this.state,"] -> [").concat(t,"]."));this._prevState=this._state,this._state=t,this.fireStateChanged()}},{key:"validateNextState",value:function validateNextState(t){switch(this._state){case yn.Created:return this.isAllowed(t,yn.Initializing,yn.Destroying);case yn.Initializing:return this.isAllowed(t,yn.Initialized,yn.Error);case yn.Initialized:return this.isAllowed(t,yn.Starting,yn.Destroying);case yn.Starting:return this.isAllowed(t,yn.Started,yn.Error);case yn.Started:return this.isAllowed(t,yn.Suspending,yn.Stopping,yn.Destroying,yn.Error);case yn.Stopping:return this.isAllowed(t,yn.Stopped,yn.Error);case yn.Stopped:return this.isAllowed(t,yn.Starting,yn.Destroying);case yn.Suspending:return this.isAllowed(t,yn.Suspended,yn.Error);case yn.Suspended:return this.isAllowed(t,yn.Starting,yn.Stopping,yn.Destroying);case yn.Destroying:return this.isAllowed(t,yn.Destroyed,yn.Error);case yn.Destroyed:return this.isAllowed(t,yn.Initializing);case yn.Error:return this.isAllowed(t,yn.Starting,yn.Stopping,yn.Destroying);default:return!1}}},{key:"isAllowed",value:function isAllowed(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(!i)throw new Error("No allowed states provided.");for(var a=0,c=i;a<c.length;a++){var l=c[a];if(t==l)return!0}return!1}}]),Executable}();function executable_base_createSuper(t){var r=function executable_base_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function action_player_createSuper(t){var r=function action_player_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function stream_action_player_createSuper(t){var r=function stream_action_player_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var An=function(t){_inherits(StreamActionPlayer,t);var r=stream_action_player_createSuper(StreamActionPlayer);function StreamActionPlayer(t,i){var o;return _classCallCheck(this,StreamActionPlayer),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"syncState",void 0),_defineProperty(_assertThisInitialized(o),"actions",void 0),_defineProperty(_assertThisInitialized(o),"requestID",void 0),o.syncState=i,o}return _createClass(StreamActionPlayer,[{key:"addAction",value:function addAction(t){if("hidden"===document.visibilityState)try{t.execute(this.executor)}catch(t){console.error(t)}else this.actions.push(t)}},{key:"setDocument",value:function setDocument(t){this.executor.setDocument(t)}},{key:"seekByTime",value:function seekByTime(t){throw new Error("Method not implemented.")}},{key:"seekByPage",value:function seekByPage(t){throw new Error("Method not implemented.")}},{key:"executeActions",value:function executeActions(){for(var t=this.actions.length;t>0;){var r=this.actions[0];this.syncState.audioTime;try{r.execute(this.executor)}catch(t){}this.actions.shift(),t=this.actions.length}}},{key:"initInternal",value:function initInternal(){this.actions=[]}},{key:"startInternal",value:function startInternal(){try{this.run()}catch(t){throw console.error(t),new Error("Execute action failed.")}}},{key:"stopInternal",value:function stopInternal(){cancelAnimationFrame(this.requestID)}},{key:"suspendInternal",value:function suspendInternal(){cancelAnimationFrame(this.requestID)}},{key:"destroyInternal",value:function destroyInternal(){this.actions.length=0}},{key:"run",value:function run(){this.executeActions(),this.requestID=requestAnimationFrame(this.run.bind(this))}}]),StreamActionPlayer}(function(t){_inherits(ActionPlayer,t);var r=action_player_createSuper(ActionPlayer);function ActionPlayer(t){var i;return _classCallCheck(this,ActionPlayer),_defineProperty(_assertThisInitialized(i=r.call(this)),"executor",void 0),i.executor=t,i}return _createClass(ActionPlayer)}(function(t){_inherits(ExecutableBase,t);var r=executable_base_createSuper(ExecutableBase);function ExecutableBase(){return _classCallCheck(this,ExecutableBase),r.apply(this,arguments)}return _createClass(ExecutableBase,[{key:"init",value:function init(){this.setState(yn.Initializing);try{this.initInternal()}catch(t){throw this.setState(yn.Error),new Error("Failed to init ".concat(this.constructor.name,": ").concat(t))}this.setState(yn.Initialized)}},{key:"start",value:function start(){(this.created()||this.destroyed())&&this.init(),this.setState(yn.Starting);try{this.startInternal()}catch(t){throw this.setState(yn.Error),new Error("Failed to start ".concat(this.constructor.name,": ").concat(t))}this.setState(yn.Started)}},{key:"stop",value:function stop(){this.setState(yn.Stopping);try{this.stopInternal()}catch(t){throw this.setState(yn.Error),new Error("Failed to stop ".concat(this.constructor.name,": ").concat(t))}this.setState(yn.Stopped)}},{key:"suspend",value:function suspend(){this.setState(yn.Suspending);try{this.suspendInternal()}catch(t){throw this.setState(yn.Error),new Error("Failed to suspend ".concat(this.constructor.name,": ").concat(t))}this.setState(yn.Suspended)}},{key:"suspendInternal",value:function suspendInternal(){}},{key:"destroy",value:function destroy(){(this.started()||this.suspended())&&stop(),this.setState(yn.Destroying);try{this.destroyInternal()}catch(t){throw this.setState(yn.Error),new Error("Failed to destroy ".concat(this.constructor.name,": ").concat(t))}this.setState(yn.Destroyed)}}]),ExecutableBase}(bn))),Sn=function(){function MediaPlayer(t){_classCallCheck(this,MediaPlayer),_defineProperty(this,"media",void 0),this.media=t}return _createClass(MediaPlayer,[{key:"source",set:function set(t){this.media.src=t}},{key:"duration",get:function get(){return this.media.duration}},{key:"time",get:function get(){return this.media.currentTime},set:function set(t){this.media.currentTime=t}},{key:"muted",get:function get(){return this.media.muted},set:function set(t){this.media.muted=t}},{key:"volume",get:function get(){return this.media.volume},set:function set(t){this.media.volume=t}},{key:"start",value:function start(){this.media.play()}},{key:"stop",value:function stop(){this.media.pause()}},{key:"addDurationListener",value:function addDurationListener(t){var r=this;this.media.addEventListener("durationchange",(function(){t(r.media.duration)}),!1)}},{key:"addTimeListener",value:function addTimeListener(t){var r=this;this.media.addEventListener("timeupdate",(function(){t(r.media.currentTime)}),!1)}},{key:"addVolumeListener",value:function addVolumeListener(t){var r=this;this.media.addEventListener("volumechange",(function(){t(r.media.volume)}),!1)}},{key:"addMutedListener",value:function addMutedListener(t){var r=this;this.media.addEventListener("volumechange",(function(){t(r.media.muted)}),!1)}}]),MediaPlayer}(),Cn=function(){function HighlighterRenderer(){_classCallCheck(this,HighlighterRenderer)}return _createClass(HighlighterRenderer,[{key:"render",value:function render(t,r,i){var o=r.points,a=o.length;if(!(a<1)){var c=r.brush,l=r.isSelected()?"rgba(255, 0, 100, 0.5)":c.color.toRgba(),u=0,d=o[u++];if(u!==a){for(t.beginPath(),t.strokeStyle=l,t.lineWidth=c.width,t.lineCap="round",t.lineJoin="round",t.globalAlpha=1,t.globalCompositeOperation="multiply",t.moveTo(d.x,d.y);u<a;)d=o[u++],t.lineTo(d.x,d.y);t.stroke()}else this.drawCircle(t,c,d.x,d.y,d.p)}}},{key:"drawCircle",value:function drawCircle(t,r,i,o,a){var c=a*r.width/2;t.beginPath(),t.fillStyle=r.color.toRgba(),t.arc(i,o,c,0,2*Math.PI),t.fill()}}]),HighlighterRenderer}(),Pn=function(){function SlideRenderer(){_classCallCheck(this,SlideRenderer)}var t;return _createClass(SlideRenderer,[{key:"render",value:(t=_asyncToGenerator(U().mark((function _callee(t,r,i){var o;return U().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return o=r.getPage(),a.abrupt("return",o.render(t,r.bounds,i));case 2:case"end":return a.stop()}}),_callee)}))),function render(r,i,o){return t.apply(this,arguments)})}]),SlideRenderer}(),wn=function(){function PointerRenderer(){_classCallCheck(this,PointerRenderer)}return _createClass(PointerRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0];if(o){var a=r.brush,c=a.width,l=c/2;t.beginPath(),t.fillStyle=a.color.toAlpha(.4),t.arc(o.x,o.y,c,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle=a.color.toRgb(),t.lineWidth=c/4,t.arc(o.x,o.y,l,0,2*Math.PI),t.stroke()}}}]),PointerRenderer}(),xn=function(){function ArrowRenderer(){_classCallCheck(this,ArrowRenderer)}return _createClass(ArrowRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush;if(t.save(),this.createArrowPath(t,c,o,a,l.width),t.fillStyle=l.color.toRgba(),t.fill(),t.restore(),r.isSelected()){var u=t.getTransformExt().getScaleX();this.createArrowPath(t,c,o,a,l.width),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=2/u,t.setLineDash([5/u]),t.stroke()}}}},{key:"createArrowPath",value:function createArrowPath(t,r,i,o,a){var c=null!=r&&r.altKey,l=null!=r&&r.shiftKey,u=i.x,d=i.y,h=c?2*a:a,p=h/2,g=o.x-u,m=o.y-d,y=Math.atan2(m,g),v=Math.sqrt(g*g+m*m),_=.5,b=5*h,A=v-.5*h/_,S=v-.5*b,C=_*b*.5*.35,P=_*b,w=l?.5*h/_+.75*b:0;if(t.translate(u,d),t.rotate(y),t.beginPath(),t.moveTo(w,-p),t.lineTo(A-.75*b,-p),t.lineTo(A-b,-P),t.quadraticCurveTo(S,-C,v,0),t.quadraticCurveTo(S,C,A-b,P),t.lineTo(A-.75*b,p),t.lineTo(w,p),l){var x=w-.5*b,k=_*b*.5*.35;t.lineTo(w+.25*b,P),t.quadraticCurveTo(x,k,0,0),t.quadraticCurveTo(x,-k,w+.25*b,-P)}t.closePath()}}]),ArrowRenderer}(),kn=function(){function RectangleRenderer(){_classCallCheck(this,RectangleRenderer)}return _createClass(RectangleRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;if(!o.isEmpty()){var a=r.getKeyEvent(),c=r.brush,l=c.color.toRgba(),u=a&&a.altKey,d=o.x,h=o.y,p=o.width,g=o.height;t.beginPath(),u?(t.fillStyle=l,t.rect(d,h,p,g),t.fill()):(t.strokeStyle=l,t.lineWidth=c.width,t.rect(d,h,p,g),t.stroke()),r.isSelected()&&(u&&(d+=c.width/2,h+=c.width/2,p-=c.width,g-=c.width),t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=c.width,t.setLineDash([5/t.getTransformExt().getScaleX()]),t.rect(d,h,p,g),t.stroke())}}}]),RectangleRenderer}(),Tn=function(){function LineRenderer(){_classCallCheck(this,LineRenderer)}return _createClass(LineRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush,u=null!=c&&c.altKey,d=u?2*l.width:l.width;if(t.beginPath(),t.strokeStyle=l.color.toRgba(),t.lineWidth=d,t.lineCap="round",t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke(),r.isSelected()){var h=t.getTransformExt().getScaleX(),p=u?7/h:5/h,g=u?15/h:12/h;t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=d,t.setLineDash([p,g]),t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke()}}}}]),LineRenderer}(),Rn=function(){function EllipseRenderer(){_classCallCheck(this,EllipseRenderer)}return _createClass(EllipseRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush,u=l.color.toRgba(),d=c&&c.altKey,h=Math.min(o.x,a.x),p=Math.min(o.y,a.y),g=Math.max(o.x,a.x),m=Math.max(o.y,a.y),y=.5*Math.abs(g-h),v=.5*Math.abs(m-p),_=h+y,b=p+v;if(t.beginPath(),d?(t.fillStyle=u,t.ellipse(_,b,y,v,0,0,2*Math.PI),t.fill()):(t.strokeStyle=u,t.lineWidth=l.width,t.ellipse(_,b,y,v,0,0,2*Math.PI),t.stroke()),r.isSelected()){var A=0;d&&(A=l.width/2),t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=l.width,t.setLineDash([5/t.getTransformExt().getScaleX()]),t.ellipse(_,b,y-A,v-A,0,0,2*Math.PI),t.stroke()}}}}]),EllipseRenderer}(),En=function(){function SelectRenderer(){_classCallCheck(this,SelectRenderer),_defineProperty(this,"FRAME_COLOR","#FF0064")}return _createClass(SelectRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=2/t.getTransformExt().getScaleX(),l=4/t.getTransformExt().getScaleY();t.beginPath(),t.strokeStyle=this.FRAME_COLOR,t.lineWidth=c,t.lineDashOffset=0,t.setLineDash([l]),t.lineCap="butt",t.lineJoin="bevel",t.rect(o.x,o.y,a.x-o.x,a.y-o.y),t.stroke()}}}]),SelectRenderer}(),In=function(){function ZoomRenderer(){_classCallCheck(this,ZoomRenderer),_defineProperty(this,"FILL_COLOR","rgba(0, 163, 232, 0.4)"),_defineProperty(this,"FRAME_COLOR","rgb(255, 0, 100)")}return _createClass(ZoomRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;t.fillStyle=this.FILL_COLOR,t.fillRect(o.x,o.y,o.width,o.height),t.beginPath(),t.strokeStyle=this.FRAME_COLOR,t.lineWidth=2/t.getTransformExt().getScaleX(),t.rect(o.x,o.y,o.width,o.height),t.stroke()}}]),ZoomRenderer}(),Mn=function(){function TextRenderer(){_classCallCheck(this,TextRenderer)}return _createClass(TextRenderer,[{key:"render",value:function render(t,r,i){var o=r.getText();if(o&&0!==o.length){var a=r.bounds,c=r.getFont(),l=t.getTransformExt(),u=l.getScaleX(),d=c.size*u,h=l.getTranslateX()+a.x*u,p=l.getTranslateY()+a.y*u,g=new At(c.family,d,c.style,c.weight);t.setTransform(1,0,0,1,0,0),t.font=g.toString(),t.fillStyle=r.getTextColor().toRgba(),t.fillText(o,h,p+d)}}}]),TextRenderer}(),Dn=function(){function TextHighlightRenderer(){_classCallCheck(this,TextHighlightRenderer)}return _createClass(TextHighlightRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;o.isEmpty()||(t.beginPath(),t.globalAlpha=1,t.globalCompositeOperation="multiply",t.fillStyle=r.getColor().toRgba(),t.rect(o.x,o.y,o.width,o.height),t.fill())}}]),TextHighlightRenderer}(),On=function(){function LatexRenderer(){_classCallCheck(this,LatexRenderer)}return _createClass(LatexRenderer,[{key:"render",value:function render(t,r,i){var o=r.getText();if(o&&0!==o.length){var a=r.bounds,c=r.getFont(),l=t.getTransformExt(),u=l.getScaleX(),d=c.size*u,h=l.getTranslateX()+a.x*u,p=l.getTranslateY()+a.y*u,g=new At(c.family,d,c.style,c.weight);t.setTransform(1,0,0,1,0,0),t.font=g.toString(),t.fillStyle=r.getTextColor().toRgba(),t.fillText(o,h,p+d)}}}]),LatexRenderer}(),Ln=function(){function PenRenderer(){_classCallCheck(this,PenRenderer)}return _createClass(PenRenderer,[{key:"render",value:function render(t,r,i){var o=r.brush,a=r.isSelected()?"rgb(255, 0, 100)":o.color.toRgb(),c=r.getPenStroke().getStrokeList(),l=c.length,u=0,d=c[u++];for(t.beginPath(),t.fillStyle=a,t.beginPath(),t.moveTo(d.x,d.y);u<l;)d=c[u++],u<l&&t.lineTo(d.x,d.y);t.fill()}}]),PenRenderer}(),Fn=function(){function RenderController(){var t=this;_classCallCheck(this,RenderController),_defineProperty(this,"pageChangeListener",void 0),_defineProperty(this,"slideRenderSurface",void 0),_defineProperty(this,"actionRenderSurface",void 0),_defineProperty(this,"volatileRenderSurface",void 0),_defineProperty(this,"textLayerSurface",void 0),_defineProperty(this,"page",void 0),_defineProperty(this,"lastShape",void 0),_defineProperty(this,"lastTransform",void 0),_defineProperty(this,"seek",!1),this.pageChangeListener=this.pageChanged.bind(this),this.lastTransform=new c,document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&setTimeout((function(){window.dispatchEvent(new Event("resize")),t.renderAllLayers(t.page)}),100)}))}return _createClass(RenderController,[{key:"setPage",value:function setPage(t){this.page&&this.disableRendering(),this.page=t,this.seek||this.enableRendering(),this.renderAllLayers(t)}},{key:"setSeek",value:function setSeek(t){this.seek=t,t?this.disableRendering():(this.enableRendering(),this.lastTransform.equals(this.getPageTransform())?this.refreshAnnotationLayers():this.renderAllLayers(this.page))}},{key:"setSlideRenderSurface",value:function setSlideRenderSurface(t){this.slideRenderSurface=t,this.slideRenderSurface.registerRenderer(Bt.name,new Pn),this.slideRenderSurface.addSizeListener(this.slideRenderSurfaceSizeChanged.bind(this))}},{key:"setActionRenderSurface",value:function setActionRenderSurface(t){this.actionRenderSurface=t,this.actionRenderSurface.addSizeListener(this.actionRenderSurfaceSizeChanged.bind(this)),this.registerShapeRenderers(t)}},{key:"setVolatileRenderSurface",value:function setVolatileRenderSurface(t){this.volatileRenderSurface=t,this.registerShapeRenderers(t)}},{key:"setTextLayerSurface",value:function setTextLayerSurface(t){this.textLayerSurface=t}},{key:"beginBulkRender",value:function beginBulkRender(){this.seek||this.disableRendering()}},{key:"endBulkRender",value:function endBulkRender(){this.seek||(this.refreshAnnotationLayers(),this.enableRendering())}},{key:"enableRendering",value:function enableRendering(){this.page.addChangeListener(this.pageChangeListener)}},{key:"disableRendering",value:function disableRendering(){this.page.removeChangeListener(this.pageChangeListener)}},{key:"slideRenderSurfaceSizeChanged",value:function slideRenderSurfaceSizeChanged(t){this.renderAllLayers(this.page)}},{key:"actionRenderSurfaceSizeChanged",value:function actionRenderSurfaceSizeChanged(t){this.refreshAnnotationLayers()}},{key:"pageChanged",value:function pageChanged(t){switch(t.changeType){case It.PageTransform:this.renderAllLayers(this.page);break;case It.Clear:this.clearAnnotationLayers();break;case It.ShapeAdded:if(this.lastShape&&this.lastShape!=t.shape){var r=this.actionRenderSurface.getSize(),i=new te(0,0,r.width,r.height);this.renderPermanentLayer(this.lastShape,i)}this.renderVolatileLayer(t.shape,t.dirtyRegion);break;case It.ShapeRemoved:this.refreshAnnotationLayers();break;case It.ShapeModified:this.renderVolatileLayer(t.shape,t.dirtyRegion)}}},{key:"clearAnnotationLayers",value:function clearAnnotationLayers(){this.volatileRenderSurface.clear(),this.actionRenderSurface.renderSurface(this.slideRenderSurface),this.lastShape=null}},{key:"refreshAnnotationLayers",value:function refreshAnnotationLayers(){var t=this.page.getShapes(),r=t.length-1;if(r>=0){this.actionRenderSurface.renderSurface(this.slideRenderSurface),r>0&&this.actionRenderSurface.renderShapes(t.slice(0,r));var i=t[r];this.renderVolatileLayer(i,i.bounds)}else this.volatileRenderSurface.clear(),this.actionRenderSurface.renderSurface(this.slideRenderSurface),this.lastShape=null}},{key:"renderAllLayers",value:function renderAllLayers(t){var r=this;this.renderSlideLayer(t).then((function(i){if(i){var o=r.getPageTransform();r.lastTransform.setTransform(o),r.actionRenderSurface.setTransform(o),r.volatileRenderSurface.setTransform(o),r.actionRenderSurface.renderImageSource(i),r.actionRenderSurface.renderShapes(t.getShapes()),r.volatileRenderSurface.clear(),r.textLayerSurface.render(t),r.lastShape=null,Object.is(t,r.page)||r.renderAllLayers(r.page)}})).catch((function(t){console.error(t)}))}},{key:"renderPermanentLayer",value:function renderPermanentLayer(t,r){this.actionRenderSurface.renderShape(t,r)}},{key:"renderVolatileLayer",value:function renderVolatileLayer(t,r){this.volatileRenderSurface.renderSurface(this.actionRenderSurface),this.volatileRenderSurface.renderShape(t,r),this.lastShape=t}},{key:"renderSlideLayer",value:function renderSlideLayer(t){var r=this.slideRenderSurface.getSize();if(!r)return this.slideRenderSurface.renderSlideShape(t.getSlideShape(),new te(0,0,0,0));var i=new te(0,0,r.width,r.height);return this.slideRenderSurface.renderSlideShape(t.getSlideShape(),i)}},{key:"getPageTransform",value:function getPageTransform(){var t=this.page.getSlideShape().bounds,r=new c;return r.translate(t.x,t.y),r.scale(1/t.width,1/t.height),r}},{key:"registerShapeRenderers",value:function registerShapeRenderers(t){t.registerRenderer(ae.name,new Ln),t.registerRenderer(ie.name,new Cn),t.registerRenderer(fe.name,new wn),t.registerRenderer(ve.name,new xn),t.registerRenderer(Pe.name,new kn),t.registerRenderer(Ae.name,new Tn),t.registerRenderer(Te.name,new Rn),t.registerRenderer(Qe.name,new En),t.registerRenderer(ut.name,new Mn),t.registerRenderer(St.name,new Dn),t.registerRenderer(wt.name,new On),t.registerRenderer(nt.name,new In)}}]),RenderController}(),Nn=function(){function SyncState(t){_classCallCheck(this,SyncState),_defineProperty(this,"mediaPlayer",void 0),this.mediaPlayer=t}return _createClass(SyncState,[{key:"audioTime",get:function get(){return 1e3*this.mediaPlayer.time}}]),SyncState}();function playback_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function playback_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return playback_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return playback_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function playback_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Bn=function(){function PlaybackService(t){_classCallCheck(this,PlaybackService),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"documents",void 0),_defineProperty(this,"actionPlayer",void 0),this.playbackModel=t,this.documents=new Map}return _createClass(PlaybackService,[{key:"initialize",value:function initialize(t,r,i,o){var a=this;i.forEach((function(t){a.addDocument(t)}));var c=Number(o),l=t.getSlideView(),u=new Sn(t.getMediaElement());u.muted=this.playbackModel.getMuted(),u.addTimeListener((function(){t.setDuration(Date.now()-c)})),t.setOnMute((function(t){u.muted=t})),t.setOnVolume((function(t){u.muted=!1,u.volume=t}));var d,h=r.avtiveDocument,p=null,g=playback_service_createForOfIteratorHelper(i);try{for(g.s();!(d=g.n()).done;){var m=d.value;if(m.getDocumentId()==h.documentId){p=m;break}}}catch(t){g.e(t)}finally{g.f()}var y=new Fn;y.setActionRenderSurface(l.getActionRenderSurface()),y.setSlideRenderSurface(l.getSlideRenderSurface()),y.setVolatileRenderSurface(l.getVolatileRenderSurface()),y.setTextLayerSurface(l.getTextLayerSurface());var v=new _n(y);v.setDocument(p),v.setPageNumber(h.activePage.pageNumber),this.actionPlayer=new An(v,new Nn(u)),this.actionPlayer.start(),this.playbackModel.webrtcConnectedProperty.subscribe((function(){t.show()}))}},{key:"addAction",value:function addAction(t){this.actionPlayer.addAction(t)}},{key:"addDocument",value:function addDocument(t){this.documents.set(BigInt(t.getDocumentId()),t)}},{key:"removeDocument",value:function removeDocument(t){this.documents.delete(BigInt(t))}},{key:"selectDocument",value:function selectDocument(t){var r=this.documents.get(BigInt(t));r&&this.actionPlayer.setDocument(r)}}]),PlaybackService}();function property_createSuper(t){var r=function property_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var jn=function(t){_inherits(Property,t);var r=property_createSuper(Property);function Property(t){var i;return _classCallCheck(this,Property),_defineProperty(_assertThisInitialized(i=r.call(this)),"_value",void 0),i._value=t,i}return _createClass(Property,[{key:"value",get:function get(){return this._value},set:function set(t){this._value!==t&&(this._value=t,this.notify(this._value))}},{key:"notifyObservers",value:function notifyObservers(){_get(_getPrototypeOf(Property.prototype),"notify",this).call(this,this._value)}}]),Property}(function(){function Observable(){_classCallCheck(this,Observable),_defineProperty(this,"observers",void 0),this.observers=[]}return _createClass(Observable,[{key:"subscribe",value:function subscribe(t){this.observers.push(t)}},{key:"unsubscribe",value:function unsubscribe(t){this.observers=this.observers.filter((function(r){return r!==t}))}},{key:"notify",value:function notify(t){this.observers.forEach((function(r){return r(t)}))}}]),Observable}()),Vn=function(){function PlaybackModel(){_classCallCheck(this,PlaybackModel),_defineProperty(this,"_elementA",new jn),_defineProperty(this,"_state",new jn),_defineProperty(this,"_raisedHand",new jn),_defineProperty(this,"_showQuiz",new jn),_defineProperty(this,"_showChat",new jn),_defineProperty(this,"_showQuizActive",new jn),_defineProperty(this,"_webrtcConnected",new jn),_defineProperty(this,"_webrtcPublisherConnected",new jn),_defineProperty(this,"_videoAvailable",new jn),_defineProperty(this,"_mainVideoAvailable",new jn),_defineProperty(this,"_localVideoAvailable",new jn),_defineProperty(this,"_selectedPageIndex",new jn),_defineProperty(this,"_duration",new jn),_defineProperty(this,"_time",new jn),_defineProperty(this,"_volume",new jn),_defineProperty(this,"_muted",new jn)}return _createClass(PlaybackModel,[{key:"elementAProperty",get:function get(){return this._elementA}},{key:"selectedPageIndexProperty",get:function get(){return this._selectedPageIndex}},{key:"selectedPageIndex",get:function get(){return this._selectedPageIndex.value},set:function set(t){this._selectedPageIndex.value=t}},{key:"stateProperty",get:function get(){return this._state}},{key:"raisedHandProperty",get:function get(){return this._raisedHand}},{key:"raisedHand",set:function set(t){this._raisedHand.value=t}},{key:"showChatProperty",get:function get(){return this._showChat}},{key:"showChat",get:function get(){return this._showChat.value},set:function set(t){this._showChat.value=t}},{key:"showQuizProperty",get:function get(){return this._showQuiz}},{key:"showQuiz",set:function set(t){this._showQuiz.value=t}},{key:"showQuizActiveProperty",get:function get(){return this._showQuizActive}},{key:"showQuizActive",set:function set(t){this._showQuizActive.value=t}},{key:"webrtcConnectedProperty",get:function get(){return this._webrtcConnected}},{key:"webrtcConnected",set:function set(t){this._webrtcConnected.value=t}},{key:"webrtcPublisherConnectedProperty",get:function get(){return this._webrtcPublisherConnected}},{key:"webrtcPublisherConnected",set:function set(t){this._webrtcPublisherConnected.value=t}},{key:"videoAvailableProperty",get:function get(){return this._videoAvailable}},{key:"videoAvailable",get:function get(){return this._videoAvailable.value},set:function set(t){this._videoAvailable.value=t}},{key:"mainVideoAvailableProperty",get:function get(){return this._mainVideoAvailable}},{key:"mainVideoAvailable",get:function get(){return this._mainVideoAvailable.value},set:function set(t){this._mainVideoAvailable.value=t}},{key:"localVideoAvailableProperty",get:function get(){return this._localVideoAvailable}},{key:"localVideoAvailable",get:function get(){return this._localVideoAvailable.value},set:function set(t){this._localVideoAvailable.value=t}},{key:"getState",value:function getState(){return this._state.value}},{key:"setState",value:function setState(t){this._state.value=t}},{key:"durationProperty",get:function get(){return this._duration}},{key:"getDuration",value:function getDuration(){return this._duration.value}},{key:"setDuration",value:function setDuration(t){this._duration.value=t}},{key:"timeProperty",get:function get(){return this._time}},{key:"getTime",value:function getTime(){return this._time.value}},{key:"setTime",value:function setTime(t){this._time.value=t}},{key:"volumeProperty",get:function get(){return this._volume}},{key:"getVolume",value:function getVolume(){return this._volume.value}},{key:"setVolume",value:function setVolume(t){this._volume.value=t}},{key:"mutedProperty",get:function get(){return this._muted}},{key:"getMuted",value:function getMuted(){return this._muted.value}},{key:"setMuted",value:function setMuted(t){this._muted.value=t}}]),PlaybackModel}();function page_delete_action_createSuper(t){var r=function page_delete_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Un=function(t){_inherits(PageDeleteAction,t);var r=page_delete_action_createSuper(PageDeleteAction);function PageDeleteAction(t,i){var o;return _classCallCheck(this,PageDeleteAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(o),"pageNumber",void 0),o.pageNumber=t,o.documentId=i,o}return _createClass(PageDeleteAction,[{key:"execute",value:function execute(t){t.removePageNumber(this.pageNumber)}}]),PageDeleteAction}(Q),zn=__webpack_require__(299),Jn=__webpack_require__(941);"undefined"!=typeof window&&"Worker"in window&&(zn.GlobalWorkerOptions.workerPort=new Jn);var Hn=function(){function LecturePlayer(){_classCallCheck(this,LecturePlayer),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"streamActionBuffer",void 0),_defineProperty(this,"courseStateService",void 0),_defineProperty(this,"janusService",void 0),_defineProperty(this,"playbackService",void 0),_defineProperty(this,"container",void 0),_defineProperty(this,"onSettingsConsumer",void 0),_defineProperty(this,"roomId",void 0),_defineProperty(this,"startTime",void 0),this.playbackModel=new Vn,this.courseStateService=new Xt("https://"+window.location.host),this.janusService=new tn("https://"+window.location.hostname+":8089/janus",this.playbackModel),this.playbackService=new Bn(this.playbackModel)}return _createClass(LecturePlayer,[{key:"start",value:function start(){var t=this;return new Promise((function(r,i){t.courseStateService.getCourseState(t.roomId).then((function(o){console.log("Course state",o);for(var a=[],c=0,l=Object.values(o.documentMap);c<l.length;c++){var u=l[c],d=t.courseStateService.getStateDocument(t.roomId,u);a.push(d)}Promise.all(a).then((function(a){try{t.setDocuments(o,a)}catch(t){return void i(t)}r()})).catch((function(t){i(t)}))})).catch((function(t){i(t)}))}))}},{key:"addPeer",value:function addPeer(t){this.janusService.addPeer(t)}},{key:"startSpeech",value:function startSpeech(t){this.janusService.startSpeech(t)}},{key:"stopSpeech",value:function stopSpeech(){this.janusService.stopSpeech(),this.setRaiseHand(!1)}},{key:"setDeviceConstraints",value:function setDeviceConstraints(t){this.janusService.setDeviceConstraints(t)}},{key:"setContainer",value:function setContainer(t){this.container=t}},{key:"setContainerA",value:function setContainerA(t){this.playbackModel.elementAProperty.value=t}},{key:"setOnError",value:function setOnError(t){this.janusService.setOnError(t)}},{key:"setOnConnectedState",value:function setOnConnectedState(t){this.playbackModel.webrtcConnectedProperty.subscribe(t)}},{key:"setOnConnectedSpeechState",value:function setOnConnectedSpeechState(t){this.playbackModel.webrtcPublisherConnectedProperty.subscribe(t)}},{key:"setOnSettings",value:function setOnSettings(t){this.onSettingsConsumer=t}},{key:"setOnRaiseHand",value:function setOnRaiseHand(t){this.playbackModel.raisedHandProperty.subscribe(t)}},{key:"setOnShowQuiz",value:function setOnShowQuiz(t){this.playbackModel.showQuizProperty.subscribe(t)}},{key:"setShowQuiz",value:function setShowQuiz(t){this.playbackModel.showQuiz=t}},{key:"setQuizActive",value:function setQuizActive(t){this.playbackModel.showQuizActive=t}},{key:"setRaiseHand",value:function setRaiseHand(t){this.playbackModel.raisedHand=t}},{key:"setStartTime",value:function setStartTime(t){this.startTime=t}},{key:"setMuted",value:function setMuted(t){this.playbackModel.setMuted(t)}},{key:"setUserId",value:function setUserId(t){this.janusService.setUserId(t)}},{key:"setRoomId",value:function setRoomId(t){this.roomId=t,this.janusService.setRoomId(t)}},{key:"setDocuments",value:function setDocuments(t,r){var i=new q(this.playbackModel);this.setView(i),this.playbackService.initialize(i,t,r,this.startTime),this.janusService.setPlayerView(i),this.janusService.setOnData(this.onData.bind(this)),this.janusService.start()}},{key:"onData",value:function onData(t){var r=this;t instanceof Blob?t.arrayBuffer().then((function(t){r.processData(t)})):this.processData(t)}},{key:"processData",value:function processData(t){var r=this,i=new W(t),o=i.getInt32(),a=i.getInt8(),c=mn.parse(i,a,o);if(c instanceof sn)this.bufferAction(c,c.documentId)||this.playbackService.selectDocument(c.documentId);else if(c instanceof an){this.streamActionBuffer={bufferedActions:[],docId:BigInt(c.documentId)};var l={activePage:null,documentFile:c.documentFile,documentId:c.documentId,documentName:c.documentTitle,pages:null,type:"pdf"};this.courseStateService.getStateDocument(this.roomId,l).then((function(t){r.playbackService.addDocument(t),r.flushActionBuffer(t.getDocumentId())})).catch((function(t){console.error(t)}))}else if(c instanceof on)this.playbackService.removeDocument(c.documentId);else if(c instanceof dn){if(!this.bufferAction(c,c.documentId)){var u=new vn(c.pageNumber);u.timestamp=0,this.playbackService.addAction(u)}}else if(c instanceof un){if(!this.bufferAction(c,c.documentId)){var d=new Un(c.pageNumber,c.documentId);d.timestamp=0,this.playbackService.addAction(d)}}else c instanceof hn?this.bufferAction(c,c.documentId)||this.playbackService.addAction(c.action):c instanceof gn&&this.janusService.addPeer(c.publisherId)}},{key:"setView",value:function setView(t){if(!(t instanceof HTMLElement))throw new Error("View is expected to be of type HTMLElement");this.container.firstElementChild&&this.container.removeChild(this.container.firstElementChild),this.container.appendChild(t),this.onSettingsConsumer&&t.setOnSettings(this.onSettingsConsumer)}},{key:"bufferAction",value:function bufferAction(t,r){return!(!this.streamActionBuffer||this.streamActionBuffer.docId!==BigInt(r))&&(this.streamActionBuffer.bufferedActions.push(t),!0)}},{key:"flushActionBuffer",value:function flushActionBuffer(t){var r=this;this.streamActionBuffer&&this.streamActionBuffer.docId===BigInt(t)&&this.streamActionBuffer.bufferedActions.forEach((function(t){if(t instanceof sn)r.playbackService.selectDocument(t.documentId);else if(t instanceof dn){var i=new vn(t.pageNumber);i.timestamp=0,r.playbackService.addAction(i)}else t instanceof hn&&r.playbackService.addAction(t.action)})),this.streamActionBuffer=null}}]),LecturePlayer}()})(),__webpack_exports__})()));