/*! For license information please see main.js.LICENSE.txt */
!function webpackUniversalModuleDefinition(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.lect=r():t.lect=r()}(self,(function(){return(()=>{var __webpack_modules__={757:(t,r,i)=>{t.exports=i(666)},576:(t,r,i)=>{"use strict";i.d(r,{Z:()=>d});var o=i(645),a=i.n(o),c=i(516),l=i(849),u=a()((function(t){return t[1]}));u.i(c.Z),u.i(l.Z),u.push([t.id,".fullscreen {\n\tz-index: 1000; \n\twidth: 100%; \n\theight: 100%; \n\tposition: fixed; \n\ttop: 0; \n\tleft: 0; \n}",""]);const d=u},516:(t,r,i)=>{"use strict";i.d(r,{Z:()=>p});var o=i(645),a=i.n(o),c=i(667),l=i.n(c),u=i(67),d=a()((function(t){return t[1]})),h=l()(u);d.push([t.id,"@font-face {\n\tfont-family: 'player-icons';\n\tsrc: url("+h+') format(\'truetype\');\n\tfont-weight: normal;\n\tfont-style: normal;\n}\n\n[class^="icon-"], [class*=" icon-"] {\n\t/* use !important to prevent issues with browser extensions that change fonts */\n\tfont-family: \'player-icons\' !important;\n\tspeak: none;\n\tfont-style: normal;\n\tfont-weight: normal;\n\tfont-variant: normal;\n\ttext-transform: none;\n\tline-height: 1;\n\n\t/* Better Font Rendering =========== */\n\t-webkit-font-smoothing: antialiased;\n\t-moz-osx-font-smoothing: grayscale;\n}\n\n.icon-document:before {\n\tcontent: "\\ed43";\n}\n.icon-sidebar-left:before {\n\tcontent: "\\e900";\n}\n.icon-sidebar-none:before {\n\tcontent: "\\e901";\n}\n.icon-sidebar-right:before {\n\tcontent: "\\e902";\n}\n.icon-search:before {\n\tcontent: "\\e908";\n}\n.icon-contract:before {\n\tcontent: "\\e906";\n}\n.icon-expand:before {\n\tcontent: "\\e905";\n}\n.icon-arrow-dropdown:before {\n\tcontent: "\\e903";\n}\n.icon-arrow-dropup:before {\n\tcontent: "\\e904";\n}\n.icon-close-circle-outline:before {\n\tcontent: "\\e907";\n}\n.icon-previous:before {\n\tcontent: "\\ed7f";\n}\n.icon-next:before {\n\tcontent: "\\ed16";\n}\n.icon-pause:before {\n\tcontent: "\\ed4f";\n}\n.icon-play:before {\n\tcontent: "\\ed6c";\n}\n.icon-playback-rate:before {\n\tcontent: "\\ed72";\n}\n.icon-mute:before {\n\tcontent: "\\ecf9";\n}\n.icon-volume0:before {\n\tcontent: "\\ef0c";\n}\n.icon-volume1:before {\n\tcontent: "\\ef0d";\n}\n.icon-volume2:before {\n\tcontent: "\\ef0e";\n}\n.icon-volume3:before {\n\tcontent: "\\ef0f";\n}\n',""]);const p=d},849:(t,r,i)=>{"use strict";i.d(r,{Z:()=>c});var o=i(645),a=i.n(o)()((function(t){return t[1]}));a.push([t.id,"[tooltip],\n[tooltip-bottom],\n[tooltip-left],\n[tooltip-right] {\n\tposition: relative;\n}\n\n[tooltip]:before,\n[tooltip]:after,\n[tooltip-bottom]:before,\n[tooltip-bottom]:after,\n[tooltip-left]:before,\n[tooltip-left]:after,\n[tooltip-right]:before,\n[tooltip-right]:after {\n\tposition: absolute;\n\tvisibility: hidden;\n\topacity: 0;\n\tpointer-events: none;\n\n\t-webkit-transition:\n\t\topacity 0.2s ease-in-out,\n\t\tvisibility 0.2s ease-in-out;\n\t-moz-transition:\n\t\topacity 0.2s ease-in-out,\n\t\tvisibility 0.2s ease-in-out;\n\ttransition:\n\t\topacity 0.2s ease-in-out,\n\t\tvisibility 0.2s ease-in-out;\n}\n\n[tooltip]:hover:before,\n[tooltip]:hover:after,\n[tooltip]:focus:before,\n[tooltip]:focus:after,\n[tooltip-bottom]:hover:before,\n[tooltip-bottom]:hover:after,\n[tooltip-bottom]:focus:before,\n[tooltip-bottom]:focus:after,\n[tooltip-left]:hover:before,\n[tooltip-left]:hover:after,\n[tooltip-left]:focus:before,\n[tooltip-left]:focus:after,\n[tooltip-right]:hover:before,\n[tooltip-right]:hover:after,\n[tooltip-right]:focus:before,\n[tooltip-right]:focus:after {\n\tvisibility: visible;\n\topacity: 1;\n}\n\n/* Base styles for the tooltip's directional arrow */\n[tooltip]:before,\n[tooltip-bottom]:before,\n[tooltip-left]:before,\n[tooltip-right]:before {\n\tz-index: 1001;\n\tborder: 6px solid transparent;\n\tbackground: transparent;\n\tcontent: \"\";\n}\n\n/* Base styles for the tooltip's content area */\n[tooltip]:after,\n[tooltip-bottom]:after,\n[tooltip-left]:after,\n[tooltip-right]:after {\n\tz-index: 1000;\n\tpadding: 8px;\n\tmargin: 0;\n\tbackground-color: #000;\n\tbackground-color: hsl(0, 0%, 20%);\n\tcolor: #fff;\n\tfont-size: 14px;\n\tline-height: 1.2;\n\twhite-space: pre;\n}\n\n/* Top (default) */\n[tooltip]:after {\n\tmargin-bottom: 12px;\n\tcontent: attr(tooltip);\n}\n\n[tooltip]:before,\n[tooltip]:after {\n\tbottom: 100%;\n\tleft: 50%;\n\n\t-webkit-transform: translateX(-50%);\n\ttransform: translateX(-50%);\n}\n\n[tooltip]:before {\n\tborder-top-color: #000;\n\tborder-top-color: hsl(0, 0%, 20%);\n}\n\n/* Bottom */\n[tooltip-bottom]:after {\n\tmargin-top: 12px;\n\tcontent: attr(tooltip-bottom);\n}\n\n[tooltip-bottom]:before,\n[tooltip-bottom]:after {\n\ttop: 100%;\n\tleft: 50%;\n\n\t-webkit-transform: translateX(-50%);\n\ttransform: translateX(-50%);\n}\n\n[tooltip-bottom]:before {\n\tborder-bottom-color: #000;\n\tborder-bottom-color: hsl(0, 0%, 20%);\n}\n\n/* Left */\n[tooltip-left]:before,\n[tooltip-left]:after {\n\ttop: 50%;\n\tright: 100%;\n\t-webkit-transform: translateY(-50%);\n\ttransform: translateY(-50%);\n}\n\n[tooltip-left]:before {\n\tbottom: 50%;\n\tmargin-bottom: 0;\n\tborder-top-color: transparent;\n\tborder-left-color: #000;\n\tborder-left-color: hsl(0, 0%, 20%);\n}\n\n[tooltip-left]:after {\n\tmargin-right: 12px;\n\tcontent: attr(tooltip-left);\n}\n\n/* Right */\n[tooltip-right]:before,\n[tooltip-right]:after {\n\ttop: 50%;\n\tleft: 100%;\n\t-webkit-transform: translateY(-50%);\n\ttransform: translateY(-50%);\n}\n\n[tooltip-right]:before {\n\tbottom: 50%;\n\tmargin-bottom: 0;\n\tborder-top-color: transparent;\n\tborder-right-color: #000;\n\tborder-right-color: hsl(0, 0%, 20%);\n}\n\n[tooltip-right]:after {\n\tmargin-left: 12px;\n\tcontent: attr(tooltip-right);\n}",""]);const c=a},645:t=>{"use strict";t.exports=function(t){var r=[];return r.toString=function toString(){return this.map((function(r){var i=t(r);return r[2]?"@media ".concat(r[2]," {").concat(i,"}"):i})).join("")},r.i=function(t,i,o){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(o)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var d=[].concat(t[u]);o&&a[d[0]]||(i&&(d[2]?d[2]="".concat(i," and ").concat(d[2]):d[2]=i),r.push(d))}},r}},667:t=>{"use strict";t.exports=function(t,r){return r||(r={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),r.hash&&(t+=r.hash),/["'() \t\n]/.test(t)||r.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},466:function(t){t.exports=function(){"use strict";var t=Object.prototype.toString,r=Array.isArray||function isArrayPolyfill(r){return"[object Array]"===t.call(r)};function isFunction(t){return"function"==typeof t}function typeStr(t){return r(t)?"array":typeof t}function escapeRegExp(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(t,r){return null!=t&&"object"==typeof t&&r in t}function primitiveHasOwnProperty(t,r){return null!=t&&"object"!=typeof t&&t.hasOwnProperty&&t.hasOwnProperty(r)}var i=RegExp.prototype.test;function testRegExp(t,r){return i.call(t,r)}var o=/\S/;function isWhitespace(t){return!testRegExp(o,t)}var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(t){return String(t).replace(/[&<>"'`=\/]/g,(function fromEntityMap(t){return a[t]}))}var c=/\s*/,l=/\s+/,u=/\s*=/,d=/\s*\}/,h=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(t,i){if(!t)return[];var o,a,g,m=!1,y=[],v=[],_=[],A=!1,b=!1,S="",C=0;function stripSpace(){if(A&&!b)for(;_.length;)delete v[_.pop()];else _=[];A=!1,b=!1}function compileTags(t){if("string"==typeof t&&(t=t.split(l,2)),!r(t)||2!==t.length)throw new Error("Invalid tags: "+t);o=new RegExp(escapeRegExp(t[0])+"\\s*"),a=new RegExp("\\s*"+escapeRegExp(t[1])),g=new RegExp("\\s*"+escapeRegExp("}"+t[1]))}compileTags(i||p.tags);for(var w,P,x,k,T,R,E=new Scanner(t);!E.eos();){if(w=E.pos,x=E.scanUntil(o))for(var I=0,D=x.length;I<D;++I)isWhitespace(k=x.charAt(I))?(_.push(v.length),S+=k):(b=!0,m=!0,S+=" "),v.push(["text",k,w,w+1]),w+=1,"\n"===k&&(stripSpace(),S="",C=0,m=!1);if(!E.scan(o))break;if(A=!0,P=E.scan(h)||"name",E.scan(c),"="===P?(x=E.scanUntil(u),E.scan(u),E.scanUntil(a)):"{"===P?(x=E.scanUntil(g),E.scan(d),E.scanUntil(a),P="&"):x=E.scanUntil(a),!E.scan(a))throw new Error("Unclosed tag at "+E.pos);if(T=">"==P?[P,x,w,E.pos,S,C,m]:[P,x,w,E.pos],C++,v.push(T),"#"===P||"^"===P)y.push(T);else if("/"===P){if(!(R=y.pop()))throw new Error('Unopened section "'+x+'" at '+w);if(R[1]!==x)throw new Error('Unclosed section "'+R[1]+'" at '+w)}else"name"===P||"{"===P||"&"===P?b=!0:"="===P&&compileTags(x)}if(stripSpace(),R=y.pop())throw new Error('Unclosed section "'+R[1]+'" at '+E.pos);return nestTokens(squashTokens(v))}function squashTokens(t){for(var r,i,o=[],a=0,c=t.length;a<c;++a)(r=t[a])&&("text"===r[0]&&i&&"text"===i[0]?(i[1]+=r[1],i[3]=r[3]):(o.push(r),i=r));return o}function nestTokens(t){for(var r,i=[],o=i,a=[],c=0,l=t.length;c<l;++c)switch((r=t[c])[0]){case"#":case"^":o.push(r),a.push(r),o=r[4]=[];break;case"/":a.pop()[5]=r[2],o=a.length>0?a[a.length-1][4]:i;break;default:o.push(r)}return i}function Scanner(t){this.string=t,this.tail=t,this.pos=0}function Context(t,r){this.view=t,this.cache={".":this.view},this.parent=r}function Writer(){this.cache={}}Scanner.prototype.eos=function eos(){return""===this.tail},Scanner.prototype.scan=function scan(t){var r=this.tail.match(t);if(!r||0!==r.index)return"";var i=r[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},Scanner.prototype.scanUntil=function scanUntil(t){var r,i=this.tail.search(t);switch(i){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=r.length,r},Context.prototype.push=function push(t){return new Context(t,this)},Context.prototype.lookup=function lookup(t){var r,i=this.cache;if(i.hasOwnProperty(t))r=i[t];else{for(var o,a,c,l=this,u=!1;l;){if(t.indexOf(".")>0)for(o=l.view,a=t.split("."),c=0;null!=o&&c<a.length;)c===a.length-1&&(u=hasProperty(o,a[c])||primitiveHasOwnProperty(o,a[c])),o=o[a[c++]];else o=l.view[t],u=hasProperty(l.view,t);if(u){r=o;break}l=l.parent}i[t]=r}return isFunction(r)&&(r=r.call(this.view)),r},Writer.prototype.clearCache=function clearCache(){this.cache={}},Writer.prototype.parse=function parse(t,r){var i=this.cache,o=t+":"+(r||p.tags).join(":"),a=i[o];return null==a&&(a=i[o]=parseTemplate(t,r)),a},Writer.prototype.render=function render(t,r,i,o){var a=this.parse(t,o),c=r instanceof Context?r:new Context(r,void 0);return this.renderTokens(a,c,i,t,o)},Writer.prototype.renderTokens=function renderTokens(t,r,i,o,a){for(var c,l,u,d="",h=0,p=t.length;h<p;++h)u=void 0,"#"===(l=(c=t[h])[0])?u=this.renderSection(c,r,i,o):"^"===l?u=this.renderInverted(c,r,i,o):">"===l?u=this.renderPartial(c,r,i,a):"&"===l?u=this.unescapedValue(c,r):"name"===l?u=this.escapedValue(c,r):"text"===l&&(u=this.rawValue(c)),void 0!==u&&(d+=u);return d},Writer.prototype.renderSection=function renderSection(t,i,o,a){var c=this,l="",u=i.lookup(t[1]);function subRender(t){return c.render(t,i,o)}if(u){if(r(u))for(var d=0,h=u.length;d<h;++d)l+=this.renderTokens(t[4],i.push(u[d]),o,a);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)l+=this.renderTokens(t[4],i.push(u),o,a);else if(isFunction(u)){if("string"!=typeof a)throw new Error("Cannot use higher-order sections without the original template");null!=(u=u.call(i.view,a.slice(t[3],t[5]),subRender))&&(l+=u)}else l+=this.renderTokens(t[4],i,o,a);return l}},Writer.prototype.renderInverted=function renderInverted(t,i,o,a){var c=i.lookup(t[1]);if(!c||r(c)&&0===c.length)return this.renderTokens(t[4],i,o,a)},Writer.prototype.indentPartial=function indentPartial(t,r,i){for(var o=r.replace(/[^ \t]/g,""),a=t.split("\n"),c=0;c<a.length;c++)a[c].length&&(c>0||!i)&&(a[c]=o+a[c]);return a.join("\n")},Writer.prototype.renderPartial=function renderPartial(t,r,i,o){if(i){var a=isFunction(i)?i(t[1]):i[t[1]];if(null!=a){var c=t[6],l=t[5],u=t[4],d=a;return 0==l&&u&&(d=this.indentPartial(a,u,c)),this.renderTokens(this.parse(d,o),r,i,d)}}},Writer.prototype.unescapedValue=function unescapedValue(t,r){var i=r.lookup(t[1]);if(null!=i)return i},Writer.prototype.escapedValue=function escapedValue(t,r){var i=r.lookup(t[1]);if(null!=i)return p.escape(i)},Writer.prototype.rawValue=function rawValue(t){return t[1]};var p={name:"mustache.js",version:"3.2.1",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,to_html:void 0,Scanner:void 0,Context:void 0,Writer:void 0},g=new Writer;return p.clearCache=function clearCache(){return g.clearCache()},p.parse=function parse(t,r){return g.parse(t,r)},p.render=function render(t,r,i,o){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+typeStr(t)+'" was given as the first argument for mustache#render(template, view, partials)');return g.render(t,r,i,o)},p.to_html=function to_html(t,r,i,o){var a=p.render(t,r,i);if(!isFunction(o))return a;o(a)},p.escape=escapeHtml,p.Scanner=Scanner,p.Context=Context,p.Writer=Writer,p}()},299:function(module,__unused_webpack_exports,__webpack_require__){!function webpackUniversalModuleDefinition(t,r){module.exports=r()}(0,(function(){return(()=>{"use strict";var __webpack_modules__=[,(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.addLinkAttributes=function addLinkAttributes(t,{url:r,target:i,rel:a,enabled:u=!0}={}){(0,o.assert)(r&&"string"==typeof r,'addLinkAttributes: A valid "url" parameter must provided.');const d=(0,o.removeNullCharacters)(r);u?t.href=t.title=d:(t.href="",t.title=`Disabled: ${d}`,t.onclick=()=>!1);let h="";switch(i){case l.NONE:break;case l.SELF:h="_self";break;case l.BLANK:h="_blank";break;case l.PARENT:h="_parent";break;case l.TOP:h="_top"}t.target=h,t.rel="string"==typeof a?a:c},r.deprecated=function deprecated(t){console.log("Deprecated API usage: "+t)},r.getFilenameFromUrl=function getFilenameFromUrl(t){const r=t.indexOf("#"),i=t.indexOf("?"),o=Math.min(r>0?r:t.length,i>0?i:t.length);return t.substring(t.lastIndexOf("/",o)+1,o)},r.getPdfFilenameFromUrl=function getPdfFilenameFromUrl(t,r="document.pdf"){if("string"!=typeof t)return r;if(isDataScheme(t))return(0,o.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),r;const i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,a=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let c=i.exec(a[1])||i.exec(a[2])||i.exec(a[3]);if(c&&(c=c[0],c.includes("%")))try{c=i.exec(decodeURIComponent(c))[0]}catch(t){}return c||r},r.getXfaPageViewport=function getXfaPageViewport(t,{scale:r=1,rotation:i=0}){const{width:o,height:a}=t.attributes.style,c=[0,0,parseInt(o),parseInt(a)];return new PageViewport({viewBox:c,scale:r,rotation:i})},r.isDataScheme=isDataScheme,r.isPdfFile=function isPdfFile(t){return"string"==typeof t&&/\.pdf$/i.test(t)},r.isValidFetchUrl=isValidFetchUrl,r.loadScript=function loadScript(t,r=!1){return new Promise(((i,o)=>{const a=document.createElement("script");a.src=t,a.onload=function(t){r&&a.remove(),i(t)},a.onerror=function(){o(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).appendChild(a)}))},r.StatTimer=r.RenderingCancelledException=r.PDFDateString=r.PageViewport=r.LinkTarget=r.DOMSVGFactory=r.DOMStandardFontDataFactory=r.DOMCMapReaderFactory=r.DOMCanvasFactory=r.DEFAULT_LINK_REL=void 0;var o=i(2),a=i(5);const c="noopener noreferrer nofollow";r.DEFAULT_LINK_REL=c;class DOMCanvasFactory extends a.BaseCanvasFactory{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,r){const i=this._document.createElement("canvas");return i.width=t,i.height=r,i}}async function fetchData(t,r=!1){if(isValidFetchUrl(t,document.baseURI)){const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);return r?new Uint8Array(await i.arrayBuffer()):(0,o.stringToBytes)(await i.text())}return new Promise(((i,a)=>{const c=new XMLHttpRequest;c.open("GET",t,!0),r&&(c.responseType="arraybuffer"),c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE){if(200===c.status||0===c.status){let t;if(r&&c.response?t=new Uint8Array(c.response):!r&&c.responseText&&(t=(0,o.stringToBytes)(c.responseText)),t)return void i(t)}a(new Error(c.statusText))}},c.send(null)}))}r.DOMCanvasFactory=DOMCanvasFactory;class DOMCMapReaderFactory extends a.BaseCMapReaderFactory{_fetchData(t,r){return fetchData(t,this.isCompressed).then((t=>({cMapData:t,compressionType:r})))}}r.DOMCMapReaderFactory=DOMCMapReaderFactory;class DOMStandardFontDataFactory extends a.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t,!0)}}r.DOMStandardFontDataFactory=DOMStandardFontDataFactory;class DOMSVGFactory extends a.BaseSVGFactory{_createSVG(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}}r.DOMSVGFactory=DOMSVGFactory;class PageViewport{constructor({viewBox:t,scale:r,rotation:i,offsetX:o=0,offsetY:a=0,dontFlip:c=!1}){this.viewBox=t,this.scale=r,this.rotation=i,this.offsetX=o,this.offsetY=a;const l=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let d,h,p,g,m,y,v,_;switch((i%=360)<0&&(i+=360),i){case 180:d=-1,h=0,p=0,g=1;break;case 90:d=0,h=1,p=1,g=0;break;case 270:d=0,h=-1,p=-1,g=0;break;case 0:d=1,h=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(p=-p,g=-g),0===d?(m=Math.abs(u-t[1])*r+o,y=Math.abs(l-t[0])*r+a,v=Math.abs(t[3]-t[1])*r,_=Math.abs(t[2]-t[0])*r):(m=Math.abs(l-t[0])*r+o,y=Math.abs(u-t[1])*r+a,v=Math.abs(t[2]-t[0])*r,_=Math.abs(t[3]-t[1])*r),this.transform=[d*r,h*r,p*r,g*r,m-d*r*l-p*r*u,y-h*r*l-g*r*u],this.width=v,this.height=_}clone({scale:t=this.scale,rotation:r=this.rotation,offsetX:i=this.offsetX,offsetY:o=this.offsetY,dontFlip:a=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),scale:t,rotation:r,offsetX:i,offsetY:o,dontFlip:a})}convertToViewportPoint(t,r){return o.Util.applyTransform([t,r],this.transform)}convertToViewportRectangle(t){const r=o.Util.applyTransform([t[0],t[1]],this.transform),i=o.Util.applyTransform([t[2],t[3]],this.transform);return[r[0],r[1],i[0],i[1]]}convertToPdfPoint(t,r){return o.Util.applyInverseTransform([t,r],this.transform)}}r.PageViewport=PageViewport;class RenderingCancelledException extends o.BaseException{constructor(t,r){super(t),this.type=r}}r.RenderingCancelledException=RenderingCancelledException;const l={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function isDataScheme(t){const r=t.length;let i=0;for(;i<r&&""===t[i].trim();)i++;return"data:"===t.substring(i,i+5).toLowerCase()}r.LinkTarget=l;function isValidFetchUrl(t,r){try{const{protocol:i}=r?new URL(t,r):new URL(t);return"http:"===i||"https:"===i}catch(t){return!1}}let u;r.StatTimer=class StatTimer{constructor(){this.started=Object.create(null),this.times=[]}time(t){t in this.started&&(0,o.warn)(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||(0,o.warn)(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let r=0;for(const t of this.times){const i=t.name;i.length>r&&(r=i.length)}for(const i of this.times){const o=i.end-i.start;t.push(`${i.name.padEnd(r)} ${o}ms\n`)}return t.join("")}};r.PDFDateString=class PDFDateString{static toDateObject(t){if(!t||!(0,o.isString)(t))return null;u||(u=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const r=u.exec(t);if(!r)return null;const i=parseInt(r[1],10);let a=parseInt(r[2],10);a=a>=1&&a<=12?a-1:0;let c=parseInt(r[3],10);c=c>=1&&c<=31?c:1;let l=parseInt(r[4],10);l=l>=0&&l<=23?l:0;let d=parseInt(r[5],10);d=d>=0&&d<=59?d:0;let h=parseInt(r[6],10);h=h>=0&&h<=59?h:0;const p=r[7]||"Z";let g=parseInt(r[8],10);g=g>=0&&g<=23?g:0;let m=parseInt(r[9],10)||0;return m=m>=0&&m<=59?m:0,"-"===p?(l+=g,d+=m):"+"===p&&(l-=g,d-=m),new Date(Date.UTC(i,a,c,l,d,h))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.arrayByteLength=arrayByteLength,r.arraysToBytes=function arraysToBytes(t){const r=t.length;if(1===r&&t[0]instanceof Uint8Array)return t[0];let i=0;for(let o=0;o<r;o++)i+=arrayByteLength(t[o]);let o=0;const a=new Uint8Array(i);for(let i=0;i<r;i++){let r=t[i];r instanceof Uint8Array||(r="string"==typeof r?stringToBytes(r):new Uint8Array(r));const c=r.byteLength;a.set(r,o),o+=c}return a},r.assert=assert,r.bytesToString=function bytesToString(t){assert(null!==t&&"object"==typeof t&&void 0!==t.length,"Invalid argument for bytesToString");const r=t.length,i=8192;if(r<i)return String.fromCharCode.apply(null,t);const o=[];for(let a=0;a<r;a+=i){const c=Math.min(a+i,r),l=t.subarray(a,c);o.push(String.fromCharCode.apply(null,l))}return o.join("")},r.createObjectURL=function createObjectURL(t,r="",i=!1){if(URL.createObjectURL&&!i)return URL.createObjectURL(new Blob([t],{type:r}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a=`data:${r};base64,`;for(let r=0,i=t.length;r<i;r+=3){const c=255&t[r],l=255&t[r+1],u=255&t[r+2];a+=o[c>>2]+o[(3&c)<<4|l>>4]+o[r+1<i?(15&l)<<2|u>>6:64]+o[r+2<i?63&u:64]}return a},r.createPromiseCapability=function createPromiseCapability(){const t=Object.create(null);let r=!1;return Object.defineProperty(t,"settled",{get:()=>r}),t.promise=new Promise((function(i,o){t.resolve=function(t){r=!0,i(t)},t.reject=function(t){r=!0,o(t)}})),t},r.createValidAbsoluteUrl=function createValidAbsoluteUrl(t,r){if(!t)return null;try{const i=r?new URL(t,r):new URL(t);if(function _isValidProtocol(t){if(!t)return!1;switch(t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch(t){}return null},r.escapeString=function escapeString(t){return t.replace(/([()\\\n\r])/g,(t=>"\n"===t?"\\n":"\r"===t?"\\r":`\\${t}`))},r.getModificationDate=function getModificationDate(t=new Date){return[t.getUTCFullYear().toString(),(t.getUTCMonth()+1).toString().padStart(2,"0"),t.getUTCDate().toString().padStart(2,"0"),t.getUTCHours().toString().padStart(2,"0"),t.getUTCMinutes().toString().padStart(2,"0"),t.getUTCSeconds().toString().padStart(2,"0")].join("")},r.getVerbosityLevel=function getVerbosityLevel(){return a},r.info=function info(t){a>=o.INFOS&&console.log(`Info: ${t}`)},r.isArrayBuffer=function isArrayBuffer(t){return"object"==typeof t&&null!==t&&void 0!==t.byteLength},r.isArrayEqual=function isArrayEqual(t,r){if(t.length!==r.length)return!1;for(let i=0,o=t.length;i<o;i++)if(t[i]!==r[i])return!1;return!0},r.isAscii=function isAscii(t){return/^[\x00-\x7F]*$/.test(t)},r.isBool=function isBool(t){return"boolean"==typeof t},r.isNum=function isNum(t){return"number"==typeof t},r.isSameOrigin=function isSameOrigin(t,r){let i;try{if(i=new URL(t),!i.origin||"null"===i.origin)return!1}catch(t){return!1}const o=new URL(r,i);return i.origin===o.origin},r.isString=function isString(t){return"string"==typeof t},r.objectFromMap=function objectFromMap(t){const r=Object.create(null);for(const[i,o]of t)r[i]=o;return r},r.objectSize=function objectSize(t){return Object.keys(t).length},r.removeNullCharacters=function removeNullCharacters(t){if("string"!=typeof t)return warn("The argument for removeNullCharacters must be a string."),t;return t.replace(l,"")},r.setVerbosityLevel=function setVerbosityLevel(t){Number.isInteger(t)&&(a=t)},r.shadow=shadow,r.string32=function string32(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)},r.stringToBytes=stringToBytes,r.stringToPDFString=function stringToPDFString(t){const r=t.length,i=[];if("þ"===t[0]&&"ÿ"===t[1])for(let o=2;o<r;o+=2)i.push(String.fromCharCode(t.charCodeAt(o)<<8|t.charCodeAt(o+1)));else if("ÿ"===t[0]&&"þ"===t[1])for(let o=2;o<r;o+=2)i.push(String.fromCharCode(t.charCodeAt(o+1)<<8|t.charCodeAt(o)));else for(let o=0;o<r;++o){const r=p[t.charCodeAt(o)];i.push(r?String.fromCharCode(r):t.charAt(o))}return i.join("")},r.stringToUTF16BEString=function stringToUTF16BEString(t){const r=["þÿ"];for(let i=0,o=t.length;i<o;i++){const o=t.charCodeAt(i);r.push(String.fromCharCode(o>>8&255),String.fromCharCode(255&o))}return r.join("")},r.stringToUTF8String=function stringToUTF8String(t){return decodeURIComponent(escape(t))},r.unreachable=unreachable,r.utf8StringToString=function utf8StringToString(t){return unescape(encodeURIComponent(t))},r.warn=warn,r.VerbosityLevel=r.Util=r.UNSUPPORTED_FEATURES=r.UnknownErrorException=r.UnexpectedResponseException=r.TextRenderingMode=r.StreamType=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.IsLittleEndianCached=r.IsEvalSupportedCached=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,i(3);r.IDENTITY_MATRIX=[1,0,0,1,0,0];r.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0];r.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"};r.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReplyType={GROUP:"Group",REPLY:"R"};r.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.PageActionEventType={O:"PageOpen",C:"PageClose"};r.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const o={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=o;r.CMapCompressionType={NONE:0,BINARY:1,STREAM:2};r.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"};r.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let a=o.WARNINGS;function warn(t){a>=o.WARNINGS&&console.log(`Warning: ${t}`)}function unreachable(t){throw new Error(t)}function assert(t,r){t||unreachable(r)}function shadow(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!1}),i}const c=function BaseExceptionClosure(){function BaseException(t){this.constructor===BaseException&&unreachable("Cannot initialize BaseException."),this.message=t,this.name=this.constructor.name}return BaseException.prototype=new Error,BaseException.constructor=BaseException,BaseException}();r.BaseException=c;r.PasswordException=class PasswordException extends c{constructor(t,r){super(t),this.code=r}};r.UnknownErrorException=class UnknownErrorException extends c{constructor(t,r){super(t),this.details=r}};r.InvalidPDFException=class InvalidPDFException extends c{};r.MissingPDFException=class MissingPDFException extends c{};r.UnexpectedResponseException=class UnexpectedResponseException extends c{constructor(t,r){super(t),this.status=r}};r.FormatError=class FormatError extends c{};r.AbortException=class AbortException extends c{};const l=/\x00/g;function stringToBytes(t){assert("string"==typeof t,"Invalid argument for stringToBytes");const r=t.length,i=new Uint8Array(r);for(let o=0;o<r;++o)i[o]=255&t.charCodeAt(o);return i}function arrayByteLength(t){return void 0!==t.length?t.length:(assert(void 0!==t.byteLength,"arrayByteLength - invalid argument."),t.byteLength)}const u={get value(){return shadow(this,"value",function isLittleEndian(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}};r.IsLittleEndianCached=u;const d={get value(){return shadow(this,"value",function isEvalSupported(){try{return new Function(""),!0}catch(t){return!1}}())}};r.IsEvalSupportedCached=d;const h=[...Array(256).keys()].map((t=>t.toString(16).padStart(2,"0")));class Util{static makeHexColor(t,r,i){return`#${h[t]}${h[r]}${h[i]}`}static transform(t,r){return[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1],t[0]*r[2]+t[2]*r[3],t[1]*r[2]+t[3]*r[3],t[0]*r[4]+t[2]*r[5]+t[4],t[1]*r[4]+t[3]*r[5]+t[5]]}static applyTransform(t,r){return[t[0]*r[0]+t[1]*r[2]+r[4],t[0]*r[1]+t[1]*r[3]+r[5]]}static applyInverseTransform(t,r){const i=r[0]*r[3]-r[1]*r[2];return[(t[0]*r[3]-t[1]*r[2]+r[2]*r[5]-r[4]*r[3])/i,(-t[0]*r[1]+t[1]*r[0]+r[4]*r[1]-r[5]*r[0])/i]}static getAxialAlignedBoundingBox(t,r){const i=Util.applyTransform(t,r),o=Util.applyTransform(t.slice(2,4),r),a=Util.applyTransform([t[0],t[3]],r),c=Util.applyTransform([t[2],t[1]],r);return[Math.min(i[0],o[0],a[0],c[0]),Math.min(i[1],o[1],a[1],c[1]),Math.max(i[0],o[0],a[0],c[0]),Math.max(i[1],o[1],a[1],c[1])]}static inverseTransform(t){const r=t[0]*t[3]-t[1]*t[2];return[t[3]/r,-t[1]/r,-t[2]/r,t[0]/r,(t[2]*t[5]-t[4]*t[3])/r,(t[4]*t[1]-t[5]*t[0])/r]}static apply3dTransform(t,r){return[t[0]*r[0]+t[1]*r[1]+t[2]*r[2],t[3]*r[0]+t[4]*r[1]+t[5]*r[2],t[6]*r[0]+t[7]*r[1]+t[8]*r[2]]}static singularValueDecompose2dScale(t){const r=[t[0],t[2],t[1],t[3]],i=t[0]*r[0]+t[1]*r[2],o=t[0]*r[1]+t[1]*r[3],a=t[2]*r[0]+t[3]*r[2],c=t[2]*r[1]+t[3]*r[3],l=(i+c)/2,u=Math.sqrt((i+c)**2-4*(i*c-a*o))/2,d=l+u||1,h=l-u||1;return[Math.sqrt(d),Math.sqrt(h)]}static normalizeRect(t){const r=t.slice(0);return t[0]>t[2]&&(r[0]=t[2],r[2]=t[0]),t[1]>t[3]&&(r[1]=t[3],r[3]=t[1]),r}static intersect(t,r){function compare(t,r){return t-r}const i=[t[0],t[2],r[0],r[2]].sort(compare),o=[t[1],t[3],r[1],r[3]].sort(compare),a=[];return t=Util.normalizeRect(t),r=Util.normalizeRect(r),i[0]===t[0]&&i[1]===r[0]||i[0]===r[0]&&i[1]===t[0]?(a[0]=i[1],a[2]=i[2],o[0]===t[1]&&o[1]===r[1]||o[0]===r[1]&&o[1]===t[1]?(a[1]=o[1],a[3]=o[2],a):null):null}}r.Util=Util;const p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364]},(t,r,i)=>{i(4)},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const i=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);r.isNodeJS=i},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSVGFactory=r.BaseStandardFontDataFactory=r.BaseCMapReaderFactory=r.BaseCanvasFactory=void 0;var o=i(2);class BaseCanvasFactory{constructor(){this.constructor===BaseCanvasFactory&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,r){if(t<=0||r<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,r);return{canvas:i,context:i.getContext("2d")}}reset(t,r,i){if(!t.canvas)throw new Error("Canvas is not specified");if(r<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=r,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,r){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=BaseCanvasFactory;class BaseCMapReaderFactory{constructor({baseUrl:t=null,isCompressed:r=!1}){this.constructor===BaseCMapReaderFactory&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=r}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const r=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData(r,i).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${r}`)}))}_fetchData(t,r){(0,o.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=BaseCMapReaderFactory;class BaseStandardFontDataFactory{constructor({baseUrl:t=null}){this.constructor===BaseStandardFontDataFactory&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const r=`${this.baseUrl}${t}`;return this._fetchData(r).catch((t=>{throw new Error(`Unable to load font data at: ${r}`)}))}_fetchData(t){(0,o.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=BaseStandardFontDataFactory;class BaseSVGFactory{constructor(){this.constructor===BaseSVGFactory&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,r){if(t<=0||r<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),i.setAttribute("width",`${t}px`),i.setAttribute("height",`${r}px`),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${r}`),i}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,o.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=BaseSVGFactory},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(7),_node_utils=__w_pdfjs_require__(8),_annotation_storage=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?_node_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(t){createPDFNetworkStream=t}function getDocument(t){const r=new PDFDocumentLoadingTask;let i;if("string"==typeof t||t instanceof URL)i={url:t};else if((0,_util.isArrayBuffer)(t))i={data:t};else if(t instanceof PDFDataRangeTransport)i={range:t};else{if("object"!=typeof t)throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");i=t}const o=Object.create(null);let a=null,c=null;for(const t in i){const r=i[t];switch(t){case"url":if("undefined"!=typeof window)try{o[t]=new URL(r,window.location).href;continue}catch(t){(0,_util.warn)(`Cannot create valid URL: "${t}".`)}else if("string"==typeof r||r instanceof URL){o[t]=r.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":a=r;continue;case"worker":c=r;continue;case"data":if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&r instanceof Buffer)o[t]=new Uint8Array(r);else{if(r instanceof Uint8Array)break;if("string"==typeof r)o[t]=(0,_util.stringToBytes)(r);else if("object"!=typeof r||null===r||isNaN(r.length)){if(!(0,_util.isArrayBuffer)(r))throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.");o[t]=new Uint8Array(r)}else o[t]=new Uint8Array(r)}continue}o[t]=r}if(o.rangeChunkSize=o.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,o.CMapReaderFactory=o.CMapReaderFactory||DefaultCMapReaderFactory,o.StandardFontDataFactory=o.StandardFontDataFactory||DefaultStandardFontDataFactory,o.ignoreErrors=!0!==o.stopAtErrors,o.fontExtraProperties=!0===o.fontExtraProperties,o.pdfBug=!0===o.pdfBug,o.enableXfa=!0===o.enableXfa,("string"!=typeof o.docBaseUrl||(0,_display_utils.isDataScheme)(o.docBaseUrl))&&(o.docBaseUrl=null),Number.isInteger(o.maxImageSize)||(o.maxImageSize=-1),"boolean"!=typeof o.useWorkerFetch&&(o.useWorkerFetch=o.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&o.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof o.isEvalSupported&&(o.isEvalSupported=!0),"boolean"!=typeof o.disableFontFace&&(o.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof o.useSystemFonts&&(o.useSystemFonts=!_is_node.isNodeJS&&!o.disableFontFace),void 0===o.ownerDocument&&(o.ownerDocument=globalThis.document),"boolean"!=typeof o.disableRange&&(o.disableRange=!1),"boolean"!=typeof o.disableStream&&(o.disableStream=!1),"boolean"!=typeof o.disableAutoFetch&&(o.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(o.verbosity),!c){const t={verbosity:o.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};c=t.port?PDFWorker.fromPort(t):new PDFWorker(t),r._worker=c}const l=r.docId;return c.promise.then((function(){if(r.destroyed)throw new Error("Loading aborted");const t=_fetchDocument(c,o,a,l),i=new Promise((function(t){let r;a?r=new _transport_stream.PDFDataTransportStream({length:o.length,initialData:o.initialData,progressiveDone:o.progressiveDone,contentDispositionFilename:o.contentDispositionFilename,disableRange:o.disableRange,disableStream:o.disableStream},a):o.data||(r=createPDFNetworkStream({url:o.url,length:o.length,httpHeaders:o.httpHeaders,withCredentials:o.withCredentials,rangeChunkSize:o.rangeChunkSize,disableRange:o.disableRange,disableStream:o.disableStream})),t(r)}));return Promise.all([t,i]).then((function([t,i]){if(r.destroyed)throw new Error("Loading aborted");const a=new _message_handler.MessageHandler(l,t,c.port);a.postMessageTransfers=c.postMessageTransfers;const u=new WorkerTransport(a,r,i,o);r._transport=u,a.send("Ready",null)}))})).catch(r._capability.reject),r}function _fetchDocument(t,r,i,o){return t.destroyed?Promise.reject(new Error("Worker was destroyed")):(i&&(r.length=i.length,r.initialData=i.initialData,r.progressiveDone=i.progressiveDone,r.contentDispositionFilename=i.contentDispositionFilename),t.messageHandler.sendWithPromise("GetDocRequest",{docId:o,apiVersion:"2.10.377",source:{data:r.data,url:r.url,password:r.password,disableAutoFetch:r.disableAutoFetch,rangeChunkSize:r.rangeChunkSize,length:r.length},maxImageSize:r.maxImageSize,disableFontFace:r.disableFontFace,postMessageTransfers:t.postMessageTransfers,docBaseUrl:r.docBaseUrl,ignoreErrors:r.ignoreErrors,isEvalSupported:r.isEvalSupported,fontExtraProperties:r.fontExtraProperties,enableXfa:r.enableXfa,useSystemFonts:r.useSystemFonts,cMapUrl:r.useWorkerFetch?r.cMapUrl:null,standardFontDataUrl:r.useWorkerFetch?r.standardFontDataUrl:null}).then((function(r){if(t.destroyed)throw new Error("Worker was destroyed");return r})))}exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;const PDFDocumentLoadingTask=function PDFDocumentLoadingTaskClosure(){let t=0;return class PDFDocumentLoadingTask{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){this.destroyed=!0;return(this._transport?this._transport.destroy():Promise.resolve()).then((()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}))}}}();class PDFDataRangeTransport{constructor(t,r,i=!1,o=null){this.length=t,this.initialData=r,this.progressiveDone=i,this.contentDispositionFilename=o,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,r){for(const i of this._rangeListeners)i(t,r)}onDataProgress(t,r){this._readyCapability.promise.then((()=>{for(const i of this._progressListeners)i(t,r)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const r of this._progressiveReadListeners)r(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,r){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,r){this._pdfInfo=t,this._transport=r,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,r,i,o,a=!1){this._pageIndex=t,this._pageInfo=r,this._ownerDocument=o,this._transport=i,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:r=this.rotate,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:r,offsetX:i,offsetY:o,dontFlip:a})}getAnnotations({intent:t=null}={}){const r="display"===t||"print"===t?t:null;return this._annotationsPromise&&this._annotationsIntent===r||(this._annotationsPromise=this._transport.getAnnotations(this._pageIndex,r),this._annotationsIntent=r),this._annotationsPromise}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:r,intent:i="display",renderInteractiveForms:o=!1,transform:a=null,imageLayer:c=null,canvasFactory:l=null,background:u=null,includeAnnotationStorage:d=!1,optionalContentConfigPromise:h=null}){var p;this._stats&&this._stats.time("Overall");const g="print"===i?"print":"display";this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const y=l||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),v=d?this._transport.annotationStorage.serializable:null;m.displayReadyCapability||(m.displayReadyCapability=(0,_util.createPromiseCapability)(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:g,renderInteractiveForms:!0===o,annotationStorage:v}));const complete=t=>{m.renderTasks.delete(_),(this.cleanupAfterRender||"print"===g)&&(this.pendingCleanup=!0),this._tryCleanup(),t?(_.capability.reject(t),this._abortOperatorList({intentState:m,reason:t})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},_=new InternalRenderTask({callback:complete,params:{canvasContext:t,viewport:r,transform:a,imageLayer:c,background:u},objs:this.objs,commonObjs:this.commonObjs,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:y,useRequestAnimationFrame:"print"!==g,pdfBug:this._pdfBug});((p=m).renderTasks||(p.renderTasks=new Set)).add(_);const A=_.task;return Promise.all([m.displayReadyCapability.promise,h]).then((([t,r])=>{this.pendingCleanup?complete():(this._stats&&this._stats.time("Rendering"),_.initializeGraphics({transparency:t,optionalContentConfig:r}),_.operatorListChanged())})).catch(complete),A}getOperatorList({intent:t="display"}={}){const r="oplist-"+("print"===t?"print":"display");let i,o=this._intentStates.get(r);var a;(o||(o=Object.create(null),this._intentStates.set(r,o)),o.opListReadCapability)||(i=Object.create(null),i.operatorListChanged=function operatorListChanged(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(i))},o.opListReadCapability=(0,_util.createPromiseCapability)(),((a=o).renderTasks||(a.renderTasks=new Set)).add(i),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:r}));return o.opListReadCapability.promise}streamTextContent({normalizeWhitespace:t=!1,disableCombineTextItems:r=!1,includeMarkedContent:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:!0===t,combineTextItems:!0!==r,includeMarkedContent:!0===i},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){const r=this.streamTextContent(t);return new Promise((function(t,i){const o=r.getReader(),a={items:[],styles:Object.create(null)};!function pump(){o.read().then((function({value:r,done:i}){i?t(a):(Object.assign(a.styles,r.styles),a.items.push(...r.items),pump())}),i)}()}))}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const t=[];for(const[r,i]of this._intentStates)if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!r.startsWith("oplist-"))for(const r of i.renderTasks)t.push(r.completed),r.cancel();return this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationsPromise=null,this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(t,r){const i=this._intentStates.get(r);i&&(this._stats&&this._stats.timeEnd("Page Request"),i.displayReadyCapability&&i.displayReadyCapability.resolve(t))}_renderPageChunk(t,r){for(let i=0,o=t.length;i<o;i++)r.operatorList.fnArray.push(t.fnArray[i]),r.operatorList.argsArray.push(t.argsArray[i]);r.operatorList.lastChunk=t.lastChunk;for(const t of r.renderTasks)t.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList(t){(0,_util.assert)(t.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const r=this._transport.messageHandler.sendWithStream("GetOperatorList",t).getReader(),i=this._intentStates.get(t.intent);i.streamReader=r;const pump=()=>{r.read().then((({value:t,done:r})=>{r?i.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,i),pump())}),(t=>{if(i.streamReader=null,!this._transport.destroyed){if(i.operatorList){i.operatorList.lastChunk=!0;for(const t of i.renderTasks)t.operatorListChanged();this._tryCleanup()}if(i.displayReadyCapability)i.displayReadyCapability.reject(t);else{if(!i.opListReadCapability)throw t;i.opListReadCapability.reject(t)}}}))};pump()}_abortOperatorList({intentState:t,reason:r,force:i=!1}){if((0,_util.assert)(r instanceof Error||"object"==typeof r&&null!==r,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),t.streamReader){if(!i){if(t.renderTasks.size>0)return;if(r instanceof _display_utils.RenderingCancelledException)return void(t.streamReaderCancelTimeout=setTimeout((()=>{this._abortOperatorList({intentState:t,reason:r,force:!0}),t.streamReaderCancelTimeout=null}),RENDERING_CANCELLED_TIMEOUT))}if(t.streamReader.cancel(new _util.AbortException(r?.message)),t.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(t,r){const i=new WeakMap,o={data:function cloneValue(t){if("function"==typeof t||"symbol"==typeof t||t instanceof URL)throw new Error(`LoopbackPort.postMessage - cannot clone: ${t?.toString()}`);if("object"!=typeof t||null===t)return t;if(i.has(t))return i.get(t);let o,a;if((o=t.buffer)&&(0,_util.isArrayBuffer)(o))return a=r?.includes(o)?new t.constructor(o,t.byteOffset,t.byteLength):new t.constructor(t),i.set(t,a),a;if(t instanceof Map){a=new Map,i.set(t,a);for(const[r,i]of t)a.set(r,cloneValue(i));return a}if(t instanceof Set){a=new Set,i.set(t,a);for(const r of t)a.add(cloneValue(r));return a}a=Array.isArray(t)?[]:Object.create(null),i.set(t,a);for(const r in t){let i,o=t;for(;!(i=Object.getOwnPropertyDescriptor(o,r));)o=Object.getPrototypeOf(o);void 0!==i.value&&(("function"!=typeof i.value||t.hasOwnProperty?.(r))&&(a[r]=cloneValue(i.value)))}return a}(t)};this._deferred.then((()=>{for(const t of this._listeners)t.call(this,o)}))}addEventListener(t,r){this._listeners.push(r)}removeEventListener(t,r){const i=this._listeners.indexOf(r);this._listeners.splice(i,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS)isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document&&"currentScript"in document){const t=document.currentScript?.src;t&&(fallbackWorkerSrc=t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(void 0!==fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){let t;try{t=globalThis.pdfjsWorker?.WorkerMessageHandler}catch(t){}return t||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(t){const r="importScripts('"+t+"');";return URL.createObjectURL(new Blob([r]))}class PDFWorker{constructor({name:t=null,port:r=null,verbosity:i=(0,_util.getVerbosityLevel)()}={}){if(r&&pdfWorkerPorts.has(r))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=t,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=i,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,r)return pdfWorkerPorts.set(r,this),void this._initializeFromPort(r);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new _message_handler.MessageHandler("main","worker",t),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}_initialize(){if("undefined"!=typeof Worker&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let t=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,t)||(t=createCDNWrapper(new URL(t,window.location).href));const r=new Worker(t),i=new _message_handler.MessageHandler("main","worker",r),terminateEarly=()=>{r.removeEventListener("error",onWorkerError),i.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},onWorkerError=()=>{this._webWorker||terminateEarly()};r.addEventListener("error",onWorkerError),i.on("test",(t=>{r.removeEventListener("error",onWorkerError),this.destroyed?terminateEarly():t?(this._messageHandler=i,this._port=r,this._webWorker=r,t.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),r.terminate())})),i.on("ready",(t=>{if(r.removeEventListener("error",onWorkerError),this.destroyed)terminateEarly();else try{sendTest()}catch(t){this._setupFakeWorker()}}));const sendTest=()=>{const t=new Uint8Array([this.postMessageTransfers?255:0]);try{i.send("test",t,[t.buffer])}catch(r){(0,_util.warn)("Cannot use postMessage transfers."),t[0]=0,i.send("test",t)}};return void sendTest()}catch(t){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const r=new LoopbackPort;this._port=r;const i="fake"+nextFakeWorkerId++,o=new _message_handler.MessageHandler(i+"_worker",i,r);t.setup(o,r);const a=new _message_handler.MessageHandler(i,i+"_worker",r);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t||!t.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(t.port)?pdfWorkerPorts.get(t.port):new PDFWorker(t)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(t,r,i,o){this.messageHandler=t,this.loadingTask=r,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:r.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this._params=o,o.useWorkerFetch||(this.CMapReaderFactory=new o.CMapReaderFactory({baseUrl:o.cMapUrl,isCompressed:o.cMapPacked}),this.StandardFontDataFactory=new o.StandardFontDataFactory({baseUrl:o.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of this.pageCache)r&&t.push(r._destroy());this.pageCache.length=0,this.pagePromises.length=0,this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const r=this.messageHandler.sendWithPromise("Terminate",null);return t.push(r),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:r}=this;t.on("GetReader",((t,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},r.onPull=()=>{this._fullReader.read().then((function({value:t,done:i}){i?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(t),"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{r.error(t)}))},r.onCancel=t=>{this._fullReader.cancel(t),r.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(t=>{const i=(0,_util.createPromiseCapability)(),o=this._fullReader;return o.headersReady.then((()=>{o.isStreamingSupported&&o.isRangeSupported||(this._lastProgress&&r.onProgress&&r.onProgress(this._lastProgress),o.onProgress=t=>{r.onProgress&&r.onProgress({loaded:t.loaded,total:t.total})}),i.resolve({isStreamingSupported:o.isStreamingSupported,isRangeSupported:o.isRangeSupported,contentLength:o.contentLength})}),i.reject),i.promise})),t.on("GetRangeReader",((t,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(t.begin,t.end);i?(r.onPull=()=>{i.read().then((function({value:t,done:i}){i?r.close():((0,_util.assert)((0,_util.isArrayBuffer)(t),"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{r.error(t)}))},r.onCancel=t=>{i.cancel(t),r.ready.catch((t=>{if(!this.destroyed)throw t}))}):r.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,r._capability.resolve(new PDFDocumentProxy(t,this))})),t.on("DocException",(function(t){let i;switch(t.name){case"PasswordException":i=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":i=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(t.message,t.details)}if(!(i instanceof Error)){const t="DocException - expected a valid Error.";(0,_util.warn)(t)}r._capability.reject(i)})),t.on("PasswordRequest",(t=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),r.onPassword){const updatePassword=t=>{this._passwordCapability.resolve({password:t})};try{r.onPassword(updatePassword,t.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise})),t.on("DataLoaded",(t=>{r.onProgress&&r.onProgress({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{if(this.destroyed)return;this.pageCache[t.pageIndex]._startRenderPage(t.transparency,t.intent)})),t.on("commonobj",(r=>{if(this.destroyed)return;const[i,o,a]=r;if(!this.commonObjs.has(i))switch(o){case"Font":const r=this._params;if("error"in a){const t=a.error;(0,_util.warn)(`Error during font loading: ${t}`),this.commonObjs.resolve(i,t);break}let c=null;r.pdfBug&&globalThis.FontInspector?.enabled&&(c={registerFont(t,r){globalThis.FontInspector.fontAdded(t,r)}});const l=new _font_loader.FontFaceObject(a,{isEvalSupported:r.isEvalSupported,disableFontFace:r.disableFontFace,ignoreErrors:r.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:c});this.fontLoader.bind(l).catch((r=>t.sendWithPromise("FontFallback",{id:i}))).finally((()=>{!r.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)}));break;case"FontPath":case"Image":this.commonObjs.resolve(i,a);break;default:throw new Error(`Got unknown common object type ${o}`)}})),t.on("obj",(t=>{if(this.destroyed)return;const[r,i,o,a]=t,c=this.pageCache[i];if(!c.objs.has(r))switch(o){case"Image":c.objs.resolve(r,a);const t=8e6;a?.data?.length>t&&(c.cleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${o}`)}})),t.on("DocProgress",(t=>{this.destroyed||r.onProgress&&r.onProgress({loaded:t.loaded,total:t.total})})),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.")))),t.on("FetchStandardFontData",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))))}_onUnsupportedFeature({featureId:t}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request"));const r=t-1;if(r in this.pagePromises)return this.pagePromises[r];const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then((t=>{if(this.destroyed)throw new Error("Transport destroyed");const i=new PDFPageProxy(r,t,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[r]=i,i}));return this.pagePromises[r]=i,i}getPageIndex(t){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:t}).catch((function(t){return Promise.reject(new Error(t))}))}getAnnotations(t,r){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:r})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally((()=>{this.annotationStorage.resetModified()}))}getFieldObjects(){return this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((t=>new _optional_content_config.OptionalContentConfig(t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then((t=>({info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let t=0,r=this.pageCache.length;t<r;t++){const r=this.pageCache[t];if(!r)continue;if(!r.cleanup())throw new Error(`startCleanup: Page ${t+1} is currently rendering.`)}this.commonObjs.clear(),t||this.fontLoader.clear(),this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(t){return this._objs[t]?this._objs[t]:this._objs[t]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(t,r=null){if(r)return this._ensureObj(t).capability.promise.then(r),null;const i=this._objs[t];if(!i||!i.resolved)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){return this._objs[t]?.resolved||!1}resolve(t,r){const i=this._ensureObj(t);i.resolved=!0,i.data=r,i.capability.resolve(r)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(t){this._internalRenderTask=t,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function InternalRenderTaskClosure(){const t=new WeakSet;return class InternalRenderTask{constructor({callback:t,params:r,objs:i,commonObjs:o,operatorList:a,pageIndex:c,canvasFactory:l,useRequestAnimationFrame:u=!1,pdfBug:d=!1}){this.callback=t,this.params=r,this.objs=i,this.commonObjs=o,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=c,this.canvasFactory=l,this._pdfBug=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===u&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:r=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:o,viewport:a,transform:c,imageLayer:l,background:u}=this.params;this.gfx=new _canvas.CanvasGraphics(o,this.commonObjs,this.objs,this.canvasFactory,l,i),this.gfx.beginDrawing({transform:c,viewport:a,transparency:r,background:u}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(r=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&t.delete(this._canvas),this.callback(r||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&t.delete(this._canvas),this.callback())))}}}(),version="2.10.377";exports.version=version;const build="156762c48";exports.build=build},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var o=i(2);class BaseFontLoader{constructor({docId:t,onUnsupportedFeature:r,ownerDocument:i=globalThis.document,styleElement:a=null}){this.constructor===BaseFontLoader&&(0,o.unreachable)("Cannot initialize BaseFontLoader."),this.docId=t,this._onUnsupportedFeature=r,this._document=i,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(t){this.nativeFontFaces.push(t),this._document.fonts.add(t)}insertRule(t){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(r));const i=r.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(t){if(t.attached||t.missingFile)return;if(t.attached=!0,this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,o.warn)(`Failed to load font '${r.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const r=t.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise((i=>{const o=this._queueLoadingCallback(i);this._prepareFontLoadEvent([r],[t],o)}))}}_queueLoadingCallback(t){(0,o.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return(0,o.shadow)(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){(0,o.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,o.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(t,r,i){(0,o.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;r.FontLoader=a,r.FontLoader=a=class GenericFontLoader extends BaseFontLoader{constructor(t){super(t),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let t=!1;if("undefined"==typeof navigator)t=!0;else{/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14&&(t=!0)}return(0,o.shadow)(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const r=this.loadingContext,i={id:"pdfjs-font-loading-"+r.nextRequestId++,done:!1,complete:function completeRequest(){for((0,o.assert)(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.requests.length>0&&r.requests[0].done;){const t=r.requests.shift();setTimeout(t.callback,0)}},callback:t};return r.requests.push(i),i}get _loadTestFont(){return(0,o.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,r,i){function int32(t,r){return t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|255&t.charCodeAt(r+3)}function spliceString(t,r,i,o){return t.substring(0,r)+o+t.substring(r+i)}let a,c;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let d=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=spliceString(p,976,h.length,h);const g=1482184792;let m=int32(p,16);for(a=0,c=h.length-3;a<c;a+=4)m=m-g+int32(h,a)|0;a<h.length&&(m=m-g+int32(h+"XXX",a)|0),p=spliceString(p,16,4,(0,o.string32)(m));const y=`@font-face {font-family:"${h}";src:${`url(data:font/opentype;base64,${btoa(p)});`}}`;this.insertRule(y);const v=[];for(const t of r)v.push(t.loadedName);v.push(h);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const t of v){const r=this._document.createElement("span");r.textContent="Hi",r.style.fontFamily=t,_.appendChild(r)}this._document.body.appendChild(_),function isFontReady(t,r){if(d++,d>30)return(0,o.warn)("Load test font never loaded."),void r();u.font="30px "+t,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0?r():setTimeout(isFontReady.bind(null,t,r))}(h,(()=>{this._document.body.removeChild(_),i.complete()}))}};r.FontFaceObject=class FontFaceObject{constructor(t,{isEvalSupported:r=!0,disableFontFace:i=!1,ignoreErrors:o=!1,onUnsupportedFeature:a,fontRegistry:c=null}){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this.isEvalSupported=!1!==r,this.disableFontFace=!0===i,this.ignoreErrors=!0===o,this._onUnsupportedFeature=a,this.fontRegistry=c}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}else t=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=(0,o.bytesToString)(this.data),r=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${r}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${r}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,r),i}getPathGenerator(t,r){if(void 0!==this.compiledGlyphs[r])return this.compiledGlyphs[r];let i;try{i=t.get(this.loadedName+"_path_"+r)}catch(t){if(!this.ignoreErrors)throw t;return this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,o.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[r]=function(t,r){}}if(this.isEvalSupported&&o.IsEvalSupportedCached.value){const t=[];for(const r of i){const i=void 0!==r.args?r.args.join(","):"";t.push("c.",r.cmd,"(",i,");\n")}return this.compiledGlyphs[r]=new Function("c","size",t.join(""))}return this.compiledGlyphs[r]=function(t,r){for(const o of i)"scale"===o.cmd&&(o.args=[r,-r]),t[o.cmd].apply(t,o.args)}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCMapReaderFactory=r.NodeCanvasFactory=void 0;var o=i(5),a=i(4),c=i(2);let l=class{constructor(){(0,c.unreachable)("Not implemented: NodeCanvasFactory")}};r.NodeCanvasFactory=l;let u=class{constructor(){(0,c.unreachable)("Not implemented: NodeCMapReaderFactory")}};r.NodeCMapReaderFactory=u;let d=class{constructor(){(0,c.unreachable)("Not implemented: NodeStandardFontDataFactory")}};if(r.NodeStandardFontDataFactory=d,a.isNodeJS){const fetchData=function(t){return new Promise(((r,i)=>{__webpack_require__(172).readFile(t,((t,o)=>{!t&&o?r(new Uint8Array(o)):i(new Error(t))}))}))};r.NodeCanvasFactory=l=class extends o.BaseCanvasFactory{_createCanvas(t,r){return __webpack_require__(414).createCanvas(t,r)}},r.NodeCMapReaderFactory=u=class extends o.BaseCMapReaderFactory{_fetchData(t,r){return fetchData(t).then((t=>({cMapData:t,compressionType:r})))}},r.NodeStandardFontDataFactory=d=class extends o.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t)}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationStorage=void 0;var o=i(2);r.AnnotationStorage=class AnnotationStorage{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(t,r){const i=this._storage.get(t);return void 0!==i?i:r}setValue(t,r){const i=this._storage.get(t);let o=!1;if(void 0!==i)for(const[t,a]of Object.entries(r))i[t]!==a&&(o=!0,i[t]=a);else this._storage.set(t,r),o=!0;o&&this._setModified()}getAll(){return this._storage.size>0?(0,o.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var o=i(2),a=i(11);const c=4096,l=16;function addContextCurrentTransform(t){if(!t.mozCurrentTransform){t._originalSave=t.save,t._originalRestore=t.restore,t._originalRotate=t.rotate,t._originalScale=t.scale,t._originalTranslate=t.translate,t._originalTransform=t.transform,t._originalSetTransform=t.setTransform,t._originalResetTransform=t.resetTransform,t._transformMatrix=t._transformMatrix||[1,0,0,1,0,0],t._transformStack=[];try{const r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"lineWidth");t._setLineWidth=r.set,t._getLineWidth=r.get,Object.defineProperty(t,"lineWidth",{set:function setLineWidth(t){this._setLineWidth(1.000001*t)},get:function getLineWidth(){return this._getLineWidth()}})}catch(t){}Object.defineProperty(t,"mozCurrentTransform",{get:function getCurrentTransform(){return this._transformMatrix}}),Object.defineProperty(t,"mozCurrentTransformInverse",{get:function getCurrentTransformInverse(){const[t,r,i,o,a,c]=this._transformMatrix,l=t*o-r*i,u=r*i-t*o;return[o/l,r/u,i/u,t/l,(o*a-i*c)/u,(r*a-t*c)/l]}}),t.save=function ctxSave(){const t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},t.restore=function ctxRestore(){const t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},t.translate=function ctxTranslate(t,r){const i=this._transformMatrix;i[4]=i[0]*t+i[2]*r+i[4],i[5]=i[1]*t+i[3]*r+i[5],this._originalTranslate(t,r)},t.scale=function ctxScale(t,r){const i=this._transformMatrix;i[0]*=t,i[1]*=t,i[2]*=r,i[3]*=r,this._originalScale(t,r)},t.transform=function ctxTransform(r,i,o,a,c,l){const u=this._transformMatrix;this._transformMatrix=[u[0]*r+u[2]*i,u[1]*r+u[3]*i,u[0]*o+u[2]*a,u[1]*o+u[3]*a,u[0]*c+u[2]*l+u[4],u[1]*c+u[3]*l+u[5]],t._originalTransform(r,i,o,a,c,l)},t.setTransform=function ctxSetTransform(r,i,o,a,c,l){this._transformMatrix=[r,i,o,a,c,l],t._originalSetTransform(r,i,o,a,c,l)},t.resetTransform=function ctxResetTransform(){this._transformMatrix=[1,0,0,1,0,0],t._originalResetTransform()},t.rotate=function ctxRotate(t){const r=Math.cos(t),i=Math.sin(t),o=this._transformMatrix;this._transformMatrix=[o[0]*r+o[2]*i,o[1]*r+o[3]*i,o[0]*-i+o[2]*r,o[1]*-i+o[3]*r,o[4],o[5]],this._originalRotate(t)}}}class CachedCanvases{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,r,i,o){let a;return void 0!==this.cache[t]?(a=this.cache[t],this.canvasFactory.reset(a,r,i),a.context.setTransform(1,0,0,1,0,0)):(a=this.canvasFactory.create(r,i),this.cache[t]=a),o&&addContextCurrentTransform(a.context),a}clear(){for(const t in this.cache){const r=this.cache[t];this.canvasFactory.destroy(r),delete this.cache[t]}}}class CanvasExtraState{constructor(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=o.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}clone(){return Object.create(this)}setCurrentPoint(t,r){this.x=t,this.y=r}}const u=function CanvasGraphicsClosure(){function putBinaryImageData(t,r,i=null){if("undefined"!=typeof ImageData&&r instanceof ImageData)return void t.putImageData(r,0,0);const a=r.height,c=r.width,u=a%l,d=(a-u)/l,h=0===u?d:d+1,p=t.createImageData(c,l);let g,m=0;const y=r.data,v=p.data;let _,A,b,S,C,w,P,x;if(i)switch(i.length){case 1:C=i[0],w=i[0],P=i[0],x=i[0];break;case 4:C=i[0],w=i[1],P=i[2],x=i[3]}if(r.kind===o.ImageKind.GRAYSCALE_1BPP){const r=y.byteLength,i=new Uint32Array(v.buffer,0,v.byteLength>>2),a=i.length,S=c+7>>3;let C=4294967295,w=o.IsLittleEndianCached.value?4278190080:255;for(x&&255===x[0]&&0===x[255]&&([C,w]=[w,C]),_=0;_<h;_++){for(b=_<d?l:u,g=0,A=0;A<b;A++){const t=r-m;let o=0;const a=t>S?c:8*t-7,l=-8&a;let u=0,d=0;for(;o<l;o+=8)d=y[m++],i[g++]=128&d?C:w,i[g++]=64&d?C:w,i[g++]=32&d?C:w,i[g++]=16&d?C:w,i[g++]=8&d?C:w,i[g++]=4&d?C:w,i[g++]=2&d?C:w,i[g++]=1&d?C:w;for(;o<a;o++)0===u&&(d=y[m++],u=128),i[g++]=d&u?C:w,u>>=1}for(;g<a;)i[g++]=0;t.putImageData(p,0,_*l)}}else if(r.kind===o.ImageKind.RGBA_32BPP){const r=!!(C||w||P);for(A=0,S=c*l*4,_=0;_<d;_++){if(v.set(y.subarray(m,m+S)),m+=S,r)for(let t=0;t<S;t+=4)C&&(v[t+0]=C[v[t+0]]),w&&(v[t+1]=w[v[t+1]]),P&&(v[t+2]=P[v[t+2]]);t.putImageData(p,0,A),A+=l}if(_<h){if(S=c*u*4,v.set(y.subarray(m,m+S)),r)for(let t=0;t<S;t+=4)C&&(v[t+0]=C[v[t+0]]),w&&(v[t+1]=w[v[t+1]]),P&&(v[t+2]=P[v[t+2]]);t.putImageData(p,0,A)}}else{if(r.kind!==o.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${r.kind}`);{const r=!!(C||w||P);for(b=l,S=c*b,_=0;_<h;_++){for(_>=d&&(b=u,S=c*b),g=0,A=S;A--;)v[g++]=y[m++],v[g++]=y[m++],v[g++]=y[m++],v[g++]=255;if(r)for(let t=0;t<g;t+=4)C&&(v[t+0]=C[v[t+0]]),w&&(v[t+1]=w[v[t+1]]),P&&(v[t+2]=P[v[t+2]]);t.putImageData(p,0,_*l)}}}}function putBinaryImageMask(t,r){const i=r.height,o=r.width,a=i%l,c=(i-a)/l,u=0===a?c:c+1,d=t.createImageData(o,l);let h=0;const p=r.data,g=d.data;for(let r=0;r<u;r++){const i=r<c?l:a;let u=3;for(let t=0;t<i;t++){let t,r=0;for(let i=0;i<o;i++)r||(t=p[h++],r=128),g[u]=t&r?0:255,u+=4,r>>=1}t.putImageData(d,0,r*l)}}function copyCtxState(t,r){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let o=0,a=i.length;o<a;o++){const a=i[o];void 0!==t[a]&&(r[a]=t[a])}void 0!==t.setLineDash&&(r.setLineDash(t.getLineDash()),r.lineDashOffset=t.lineDashOffset)}function resetCtxToDefault(t){t.strokeStyle="#000000",t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0)}function composeSMaskBackdrop(t,r,i,o){const a=t.length;for(let c=3;c<a;c+=4){const a=t[c];if(0===a)t[c-3]=r,t[c-2]=i,t[c-1]=o;else if(a<255){const l=255-a;t[c-3]=t[c-3]*a+r*l>>8,t[c-2]=t[c-2]*a+i*l>>8,t[c-1]=t[c-1]*a+o*l>>8}}}function composeSMaskAlpha(t,r,i){const o=t.length;for(let a=3;a<o;a+=4){const o=i?i[t[a]]:t[a];r[a]=r[a]*o*.00392156862745098|0}}function composeSMaskLuminosity(t,r,i){const o=t.length;for(let a=3;a<o;a+=4){const o=77*t[a-3]+152*t[a-2]+28*t[a-1];r[a]=i?r[a]*i[o>>8]>>8:r[a]*o>>16}}function composeSMask(t,r,i){const o=r.canvas,a=r.context;t.setTransform(r.scaleX,0,0,r.scaleY,r.offsetX,r.offsetY),function genericComposeSMask(t,r,i,o,a,c,l){const u=!!c,d=u?c[0]:0,h=u?c[1]:0,p=u?c[2]:0;let g;g="Luminosity"===a?composeSMaskLuminosity:composeSMaskAlpha;const m=Math.min(o,Math.ceil(1048576/i));for(let a=0;a<o;a+=m){const c=Math.min(m,o-a),y=t.getImageData(0,a,i,c),v=r.getImageData(0,a,i,c);u&&composeSMaskBackdrop(y.data,d,h,p),g(y.data,v.data,l),t.putImageData(v,0,a)}}(a,i,o.width,o.height,r.subtype,r.backdrop,r.transferMap),t.drawImage(o,0,0)}const t=["butt","round","square"],r=["miter","round","bevel"],i={},u={};class CanvasGraphics{constructor(t,r,i,o,a,c){this.ctx=t,this.current=new CanvasExtraState,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=i,this.canvasFactory=o,this.imageLayer=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=c,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,t&&addContextCurrentTransform(t),this._cachedGetSinglePixelWidth=null}beginDrawing({transform:t,viewport:r,transparency:i=!1,background:o=null}){const a=this.ctx.canvas.width,c=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=o||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,a,c),this.ctx.restore(),i){const t=this.cachedCanvases.getCanvas("transparent",a,c,!0);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),resetCtxToDefault(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,r.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(t,r,i,a){const c=t.argsArray,l=t.fnArray;let u=r||0;const d=c.length;if(d===u)return u;const h=d-u>10&&"function"==typeof i,p=h?Date.now()+15:0;let g=0;const m=this.commonObjs,y=this.objs;let v;for(;;){if(void 0!==a&&u===a.nextBreakPoint)return a.breakIt(u,i),u;if(v=l[u],v!==o.OPS.dependency)this[v].apply(this,c[u]);else for(const t of c[u]){const r=t.startsWith("g_")?m:y;if(!r.has(t))return r.get(t,i),u}if(u++,u===d)return u;if(h&&++g>10){if(Date.now()>p)return i(),u;g=0}}}endDrawing(){for(;this.stateStack.length||null!==this.current.activeSMask;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedPatterns.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(t,r){const i=t.width,o=t.height;let a,c,l=Math.max(Math.hypot(r[0],r[1]),1),u=Math.max(Math.hypot(r[2],r[3]),1),d=i,h=o,p="prescale1";for(;l>2&&d>1||u>2&&h>1;){let r=d,i=h;l>2&&d>1&&(r=Math.ceil(d/2),l/=d/r),u>2&&h>1&&(i=Math.ceil(h/2),u/=h/i),a=this.cachedCanvases.getCanvas(p,r,i),c=a.context,c.clearRect(0,0,r,i),c.drawImage(t,0,0,d,h,0,0,r,i),t=a.canvas,d=r,h=i,p="prescale1"===p?"prescale2":"prescale1"}return{img:t,paintWidth:d,paintHeight:h}}_createMaskCanvas(t){const r=this.ctx,i=t.width,a=t.height,c=this.current.fillColor,l=this.current.patternFill,u=this.cachedCanvases.getCanvas("maskCanvas",i,a);putBinaryImageMask(u.context,t);const d=r.mozCurrentTransform;let h=o.Util.transform(d,[1/i,0,0,-1/a,0,0]);h=o.Util.transform(h,[1,0,0,1,0,-a]);const p=o.Util.applyTransform([0,0],h),g=o.Util.applyTransform([i,a],h),m=o.Util.normalizeRect([p[0],p[1],g[0],g[1]]),y=Math.ceil(m[2]-m[0]),v=Math.ceil(m[3]-m[1]),_=this.cachedCanvases.getCanvas("fillCanvas",y,v,!0),A=_.context,b=Math.min(p[0],g[0]),S=Math.min(p[1],g[1]);A.translate(-b,-S),A.transform.apply(A,h);const C=this._scaleImage(u.canvas,A.mozCurrentTransformInverse);A.drawImage(C.img,0,0,C.img.width,C.img.height,0,0,i,a),A.globalCompositeOperation="source-in";const w=o.Util.transform(A.mozCurrentTransformInverse,[1,0,0,1,-b,-S]);return A.fillStyle=l?c.getPattern(r,this,w,!1):c,A.fillRect(0,0,i,a),{canvas:_.canvas,offsetX:Math.round(b),offsetY:Math.round(S)}}setLineWidth(t){this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(r){this.ctx.lineCap=t[r]}setLineJoin(t){this.ctx.lineJoin=r[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,r){const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(let r=0,i=t.length;r<i;r++){const i=t[r],o=i[0],a=i[1];switch(o){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=a?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=a}}}beginSMaskGroup(){const t=this.current.activeSMask,r=t.canvas.width,i=t.canvas.height,o="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(o,r,i,!0),c=this.ctx,l=c.mozCurrentTransform;this.ctx.save();const u=a.context;u.scale(1/t.scaleX,1/t.scaleY),u.translate(-t.offsetX,-t.offsetY),u.transform.apply(u,l),t.startTransformInverse=u.mozCurrentTransformInverse,copyCtxState(c,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}suspendSMaskGroup(){const t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),composeSMask(this.ctx,this.current.activeSMask,t),this.ctx.restore(),this.ctx.save(),copyCtxState(t,this.ctx),this.current.resumeSMaskCtx=t;const r=o.Util.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,r),t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()}resumeSMaskGroup(){const t=this.current.resumeSMaskCtx,r=this.ctx;this.ctx=t,this.groupStack.push(r),this.groupLevel++}endSMaskGroup(){const t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),composeSMask(this.ctx,this.current.activeSMask,t),this.ctx.restore(),copyCtxState(t,this.ctx);const r=o.Util.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,r)}save(){this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.current.resumeSMaskCtx=null}restore(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null}transform(t,r,i,o,a,c){this.ctx.transform(t,r,i,o,a,c),this._cachedGetSinglePixelWidth=null}constructPath(t,r){const i=this.ctx,a=this.current;let c=a.x,l=a.y;for(let a=0,u=0,d=t.length;a<d;a++)switch(0|t[a]){case o.OPS.rectangle:c=r[u++],l=r[u++];const t=r[u++],a=r[u++],d=c+t,h=l+a;i.moveTo(c,l),0===t||0===a?i.lineTo(d,h):(i.lineTo(d,l),i.lineTo(d,h),i.lineTo(c,h)),i.closePath();break;case o.OPS.moveTo:c=r[u++],l=r[u++],i.moveTo(c,l);break;case o.OPS.lineTo:c=r[u++],l=r[u++],i.lineTo(c,l);break;case o.OPS.curveTo:c=r[u+4],l=r[u+5],i.bezierCurveTo(r[u],r[u+1],r[u+2],r[u+3],c,l),u+=6;break;case o.OPS.curveTo2:i.bezierCurveTo(c,l,r[u],r[u+1],r[u+2],r[u+3]),c=r[u+2],l=r[u+3],u+=4;break;case o.OPS.curveTo3:c=r[u+2],l=r[u+3],i.bezierCurveTo(r[u],r[u+1],c,l,c,l),u+=4;break;case o.OPS.closePath:i.closePath()}a.setCurrentPoint(c,l)}closePath(){this.ctx.closePath()}stroke(t){t=void 0===t||t;const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"==typeof i&&i?.getPattern){const t=this.getSinglePixelWidth();r.save(),r.strokeStyle=i.getPattern(r,this,r.mozCurrentTransformInverse),r.lineWidth=Math.max(t,this.current.lineWidth),r.stroke(),r.restore()}else{const t=this.getSinglePixelWidth();t<0&&-t>=this.current.lineWidth?(r.save(),r.resetTransform(),r.lineWidth=Math.round(this._combinedScaleFactor),r.stroke(),r.restore()):(r.lineWidth=Math.max(t,this.current.lineWidth),r.stroke())}t&&this.consumePath(),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t){t=void 0===t||t;const r=this.ctx,i=this.current.fillColor;let o=!1;this.current.patternFill&&(r.save(),r.fillStyle=i.getPattern(r,this,r.mozCurrentTransformInverse),o=!0),this.contentVisible&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),o&&r.restore(),t&&this.consumePath()}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=i}eoClip(){this.pendingClip=u}beginText(){this.current.textMatrix=o.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,r=this.ctx;if(void 0!==t){r.save(),r.beginPath();for(let i=0;i<t.length;i++){const o=t[i];r.setTransform.apply(r,o.transform),r.translate(o.x,o.y),o.addToPath(r,o.fontSize)}r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}else r.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,r){const i=this.commonObjs.get(t),a=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=i.fontMatrix||o.FONT_IDENTITY_MATRIX,0!==a.fontMatrix[0]&&0!==a.fontMatrix[3]||(0,o.warn)("Invalid font matrix for font "+t),r<0?(r=-r,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const c=i.loadedName||"sans-serif";let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal",d=`"${c}", ${i.fallbackName}`;let h=r;r<16?h=16:r>100&&(h=100),this.current.fontSizeScale=r/h,this.ctx.font=`${u} ${l} ${h}px ${d}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,r){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(t,r){this.setLeading(-r),this.moveText(t,r)}setTextMatrix(t,r,i,o,a,c){this.current.textMatrix=[t,r,i,o,a,c],this.current.textMatrixScale=Math.hypot(t,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,r,i,a,c){const l=this.ctx,u=this.current,d=u.font,h=u.textRenderingMode,p=u.fontSize/u.fontSizeScale,g=h&o.TextRenderingMode.FILL_STROKE_MASK,m=!!(h&o.TextRenderingMode.ADD_TO_PATH_FLAG),y=u.patternFill&&!d.missingFile;let v;if((d.disableFontFace||m||y)&&(v=d.getPathGenerator(this.commonObjs,t)),d.disableFontFace||y?(l.save(),l.translate(r,i),l.beginPath(),v(l,p),a&&l.setTransform.apply(l,a),g!==o.TextRenderingMode.FILL&&g!==o.TextRenderingMode.FILL_STROKE||l.fill(),g!==o.TextRenderingMode.STROKE&&g!==o.TextRenderingMode.FILL_STROKE||(c&&(l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor)),l.stroke()),l.restore()):(g!==o.TextRenderingMode.FILL&&g!==o.TextRenderingMode.FILL_STROKE||l.fillText(t,r,i),g!==o.TextRenderingMode.STROKE&&g!==o.TextRenderingMode.FILL_STROKE||(c?(l.save(),l.moveTo(r,i),l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor),l.strokeText(t,0,0),l.restore()):l.strokeText(t,r,i))),m){(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:l.mozCurrentTransform,x:r,y:i,fontSize:p,addToPath:v})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const r=t.getImageData(0,0,10,10).data;let i=!1;for(let t=3;t<r.length;t+=4)if(r[t]>0&&r[t]<255){i=!0;break}return(0,o.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(t){const r=this.current,i=r.font;if(i.isType3Font)return this.showType3Text(t);const a=r.fontSize;if(0===a)return;const c=this.ctx,l=r.fontSizeScale,u=r.charSpacing,d=r.wordSpacing,h=r.fontDirection,p=r.textHScale*h,g=t.length,m=i.vertical,y=m?1:-1,v=i.defaultVMetrics,_=a*r.fontMatrix[0],A=r.textRenderingMode===o.TextRenderingMode.FILL&&!i.disableFontFace&&!r.patternFill;let b;if(c.save(),r.patternFill){c.save();const t=r.fillColor.getPattern(c,this,c.mozCurrentTransformInverse);b=c.mozCurrentTransform,c.restore(),c.fillStyle=t}c.transform.apply(c,r.textMatrix),c.translate(r.x,r.y+r.textRise),h>0?c.scale(p,-1):c.scale(p,1);let S=r.lineWidth,C=!1;const w=r.textMatrixScale;if(0===w||0===S){const t=r.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;t!==o.TextRenderingMode.STROKE&&t!==o.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,S=this.getSinglePixelWidth(),C=S<0)}else S/=w;1!==l&&(c.scale(l,l),S/=l),c.lineWidth=S;let P,x=0;for(P=0;P<g;++P){const r=t[P];if((0,o.isNum)(r)){x+=y*r*a/1e3;continue}let p=!1;const g=(r.isSpace?d:0)+u,S=r.fontChar,w=r.accent;let k,T,R,E=r.width;if(m){const t=r.vmetric||v,i=-(r.vmetric?t[1]:.5*E)*_,o=t[2]*_;E=t?-t[0]:E,k=i/l,T=(x+o)/l}else k=x/l,T=0;if(i.remeasure&&E>0){const t=1e3*c.measureText(S).width/a*l;if(E<t&&this.isFontSubpixelAAEnabled){const r=E/t;p=!0,c.save(),c.scale(r,1),k/=r}else E!==t&&(k+=(E-t)/2e3*a/l)}if(this.contentVisible&&(r.isInFont||i.missingFile))if(A&&!w)c.fillText(S,k,T);else if(this.paintChar(S,k,T,b,C),w){const t=k+a*w.offset.x/l,r=T-a*w.offset.y/l;this.paintChar(w.fontChar,t,r,b,C)}R=m?E*_-g*h:E*_+g*h,x+=R,p&&c.restore()}m?r.y-=x:r.x+=x*p,c.restore()}showType3Text(t){const r=this.ctx,i=this.current,a=i.font,c=i.fontSize,l=i.fontDirection,u=a.vertical?1:-1,d=i.charSpacing,h=i.wordSpacing,p=i.textHScale*l,g=i.fontMatrix||o.FONT_IDENTITY_MATRIX,m=t.length;let y,v,_,A;if(!(i.textRenderingMode===o.TextRenderingMode.INVISIBLE)&&0!==c){for(this._cachedGetSinglePixelWidth=null,r.save(),r.transform.apply(r,i.textMatrix),r.translate(i.x,i.y),r.scale(p,l),y=0;y<m;++y){if(v=t[y],(0,o.isNum)(v)){A=u*v*c/1e3,this.ctx.translate(A,0),i.x+=A*p;continue}const l=(v.isSpace?h:0)+d,m=a.charProcOperatorList[v.operatorListId];if(!m){(0,o.warn)(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),r.scale(c,c),r.transform.apply(r,g),this.executeOperatorList(m),this.restore());_=o.Util.applyTransform([v.width,0],g)[0]*c+l,r.translate(_,0),i.x+=_*p}r.restore(),this.processingType3=null}}setCharWidth(t,r){}setCharWidthAndBounds(t,r,i,o,a,c){this.ctx.rect(i,o,a-i,c-o),this.clip(),this.endPath()}getColorN_Pattern(t){let r;if("TilingPattern"===t[0]){const i=t[1],o=this.baseTransform||this.ctx.mozCurrentTransform.slice(),c={createCanvasGraphics:t=>new CanvasGraphics(t,this.commonObjs,this.objs,this.canvasFactory)};r=new a.TilingPattern(t,i,this.ctx,c,o)}else r=this._getPattern(t[1]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,r,i){const a=o.Util.makeHexColor(t,r,i);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(t,r,i){const a=o.Util.makeHexColor(t,r,i);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(t){if(this.cachedPatterns.has(t))return this.cachedPatterns.get(t);const r=(0,a.getShadingPattern)(this.objs.get(t));return this.cachedPatterns.set(t,r),r}shadingFill(t){if(!this.contentVisible)return;const r=this.ctx;this.save();const i=this._getPattern(t);r.fillStyle=i.getPattern(r,this,r.mozCurrentTransformInverse,!0);const a=r.mozCurrentTransformInverse;if(a){const t=r.canvas,i=t.width,c=t.height,l=o.Util.applyTransform([0,0],a),u=o.Util.applyTransform([0,c],a),d=o.Util.applyTransform([i,0],a),h=o.Util.applyTransform([i,c],a),p=Math.min(l[0],u[0],d[0],h[0]),g=Math.min(l[1],u[1],d[1],h[1]),m=Math.max(l[0],u[0],d[0],h[0]),y=Math.max(l[1],u[1],d[1],h[1]);this.ctx.fillRect(p,g,m-p,y-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}beginInlineImage(){(0,o.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,o.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(t,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(t)&&6===t.length&&this.transform.apply(this,t),this.baseTransform=this.ctx.mozCurrentTransform,r)){const t=r[2]-r[0],i=r[3]-r[1];this.ctx.rect(r[0],r[1],t,i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save();const r=this.ctx;t.isolated||(0,o.info)("TODO: Support non-isolated groups."),t.knockout&&(0,o.warn)("Knockout groups not supported.");const i=r.mozCurrentTransform;if(t.matrix&&r.transform.apply(r,t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=o.Util.getAxialAlignedBoundingBox(t.bbox,r.mozCurrentTransform);const l=[0,0,r.canvas.width,r.canvas.height];a=o.Util.intersect(a,l)||[0,0,0,0];const u=Math.floor(a[0]),d=Math.floor(a[1]);let h=Math.max(Math.ceil(a[2])-u,1),p=Math.max(Math.ceil(a[3])-d,1),g=1,m=1;h>c&&(g=h/c,h=c),p>c&&(m=p/c,p=c);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,h,p,!0),_=v.context;_.scale(1/g,1/m),_.translate(-u,-d),_.transform.apply(_,i),t.smask?this.smaskStack.push({canvas:v.canvas,context:_,offsetX:u,offsetY:d,scaleX:g,scaleY:m,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(u,d),r.scale(g,m)),copyCtxState(r,_),this.ctx=_,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++,this.current.activeSMask=null}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,t.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(r.canvas,0,0),this.restore()}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(t,r,i,o){if(this.save(),resetCtxToDefault(this.ctx),this.current=new CanvasExtraState,Array.isArray(r)&&4===r.length){const t=r[2]-r[0],i=r[3]-r[1];this.ctx.rect(r[0],r[1],t,i),this.clip(),this.endPath()}this.transform.apply(this,i),this.transform.apply(this,o)}endAnnotation(){this.restore()}paintImageMaskXObject(t){if(!this.contentVisible)return;const r=this.ctx,i=t.width,o=t.height,a=this.processingType3;if(a&&void 0===a.compiled&&(a.compiled=i<=1e3&&o<=1e3?function compileType3Glyph(t){const r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=t.width,o=t.height,a=i+1;let c,l,u,d;const h=new Uint8Array(a*(o+1)),p=i+7&-8,g=t.data,m=new Uint8Array(p*o);let y=0;for(c=0,l=g.length;c<l;c++){const t=g[c];let r=128;for(;r>0;)m[y++]=t&r?0:255,r>>=1}let v=0;for(y=0,0!==m[y]&&(h[0]=1,++v),u=1;u<i;u++)m[y]!==m[y+1]&&(h[u]=m[y]?2:1,++v),y++;for(0!==m[y]&&(h[u]=2,++v),c=1;c<o;c++){y=c*p,d=c*a,m[y-p]!==m[y]&&(h[d]=m[y]?1:8,++v);let t=(m[y]?4:0)+(m[y-p]?8:0);for(u=1;u<i;u++)t=(t>>2)+(m[y+1]?4:0)+(m[y-p+1]?8:0),r[t]&&(h[d+u]=r[t],++v),y++;if(m[y-p]!==m[y]&&(h[d+u]=m[y]?2:4,++v),v>1e3)return null}for(y=p*(o-1),d=c*a,0!==m[y]&&(h[d]=8,++v),u=1;u<i;u++)m[y]!==m[y+1]&&(h[d+u]=m[y]?4:8,++v),y++;if(0!==m[y]&&(h[d+u]=4,++v),v>1e3)return null;const _=new Int32Array([0,a,-1,0,-a,0,0,0,1]),A=[];for(c=0;v&&c<=o;c++){let t=c*a;const r=t+i;for(;t<r&&!h[t];)t++;if(t===r)continue;const o=[t%a,c],l=t;let u=h[t];do{const r=_[u];do{t+=r}while(!h[t]);const i=h[t];5!==i&&10!==i?(u=i,h[t]=0):(u=i&51*u>>4,h[t]&=u>>2|u<<2),o.push(t%a,t/a|0),h[t]||--v}while(l!==t);A.push(o),--c}return function(t){t.save(),t.scale(1/i,-1/o),t.translate(0,-o),t.beginPath();for(let r=0,i=A.length;r<i;r++){const i=A[r];t.moveTo(i[0],i[1]);for(let r=2,o=i.length;r<o;r+=2)t.lineTo(i[r],i[r+1])}t.fill(),t.beginPath(),t.restore()}}({data:t.data,width:i,height:o}):null),a?.compiled)return void a.compiled(r);const c=this._createMaskCanvas(t),l=c.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,c.offsetX,c.offsetY),r.restore()}paintImageMaskXObjectRepeat(t,r,i=0,a=0,c,l){if(!this.contentVisible)return;const u=this.ctx;u.save();const d=u.mozCurrentTransform;u.transform(r,i,a,c,0,0);const h=this._createMaskCanvas(t);u.setTransform(1,0,0,1,0,0);for(let t=0,p=l.length;t<p;t+=2){const p=o.Util.transform(d,[r,i,a,c,l[t],l[t+1]]),[g,m]=o.Util.applyTransform([0,0],p);u.drawImage(h.canvas,g,m)}u.restore()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;for(let a=0,c=t.length;a<c;a++){const c=t[a],l=c.width,u=c.height,d=this.cachedCanvases.getCanvas("maskCanvas",l,u),h=d.context;h.save(),putBinaryImageMask(h,c),h.globalCompositeOperation="source-in",h.fillStyle=o?i.getPattern(h,this,r.mozCurrentTransformInverse,!1):i,h.fillRect(0,0,l,u),h.restore(),r.save(),r.transform.apply(r,c.transform),r.scale(1,-1),r.drawImage(d.canvas,0,0,l,u,0,-1,1,1),r.restore()}}paintImageXObject(t){if(!this.contentVisible)return;const r=t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t);r?this.paintInlineImageXObject(r):(0,o.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,r,i,a){if(!this.contentVisible)return;const c=t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t);if(!c)return void(0,o.warn)("Dependent image isn't ready yet");const l=c.width,u=c.height,d=[];for(let t=0,o=a.length;t<o;t+=2)d.push({transform:[r,0,0,i,a[t],a[t+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(c,d)}paintInlineImageXObject(t){if(!this.contentVisible)return;const r=t.width,i=t.height,o=this.ctx;let a;if(this.save(),o.scale(1/r,-1/i),"function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const o=this.cachedCanvases.getCanvas("inlineImage",r,i);putBinaryImageData(o.context,t,this.current.transferMaps),a=o.canvas}const c=this._scaleImage(a,o.mozCurrentTransformInverse);if(o.drawImage(c.img,0,0,c.paintWidth,c.paintHeight,0,-i,r,i),this.imageLayer){const a=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:t,left:a[0],top:a[1],width:r/o.mozCurrentTransformInverse[0],height:i/o.mozCurrentTransformInverse[3]})}this.restore()}paintInlineImageXObjectGroup(t,r){if(!this.contentVisible)return;const i=this.ctx,o=t.width,a=t.height,c=this.cachedCanvases.getCanvas("inlineImage",o,a);putBinaryImageData(c.context,t,this.current.transferMaps);for(let l=0,u=r.length;l<u;l++){const u=r[l];if(i.save(),i.transform.apply(i,u.transform),i.scale(1,-1),i.drawImage(c.canvas,u.x,u.y,u.w,u.h,0,-1,1,1),this.imageLayer){const r=this.getCanvasPosition(u.x,u.y);this.imageLayer.appendImage({imgData:t,left:r[0],top:r[1],width:o,height:a})}i.restore()}}paintSolidColorImageMask(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)}markPoint(t){}markPointProps(t,r){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,r){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(){const t=this.ctx;this.pendingClip&&(this.pendingClip===u?t.clip("evenodd"):t.clip(),this.pendingClip=null),t.beginPath()}getSinglePixelWidth(){if(null===this._cachedGetSinglePixelWidth){const t=this.ctx.mozCurrentTransform,r=Math.abs(t[0]*t[3]-t[2]*t[1]),i=t[0]**2+t[2]**2,o=t[1]**2+t[3]**2,a=Math.sqrt(Math.max(i,o))/r;i!==o&&this._combinedScaleFactor*a>1?this._cachedGetSinglePixelWidth=-this._combinedScaleFactor*a:r>Number.EPSILON?this._cachedGetSinglePixelWidth=a:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth}getCanvasPosition(t,r){const i=this.ctx.mozCurrentTransform;return[i[0]*t+i[2]*r+i[4],i[1]*t+i[3]*r+i[5]]}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const t in o.OPS)CanvasGraphics.prototype[o.OPS[t]]=CanvasGraphics.prototype[t];return CanvasGraphics}();r.CanvasGraphics=u},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getShadingPattern=function getShadingPattern(t){switch(t[0]){case"RadialAxial":return new RadialAxialShadingPattern(t);case"Mesh":return new MeshShadingPattern(t);case"Dummy":return new DummyShadingPattern}throw new Error(`Unknown IR type: ${t[0]}`)},r.TilingPattern=void 0;var o=i(2);function applyBoundingBox(t,r){if(!r||"undefined"==typeof Path2D)return;const i=r[2]-r[0],o=r[3]-r[1],a=new Path2D;a.rect(r[0],r[1],i,o),t.clip(a)}class BaseShadingPattern{constructor(){this.constructor===BaseShadingPattern&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class RadialAxialShadingPattern extends BaseShadingPattern{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this._matrix=t[8],this._patternCache=null}_createGradient(t){let r;"axial"===this._type?r=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(r=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)r.addColorStop(t[0],t[1]);return r}getPattern(t,r,i,a=!1){let c;if(this._patternCache)c=this._patternCache;else{if(a)applyBoundingBox(t,this._bbox),c=this._createGradient(t);else{const i=r.cachedCanvases.getCanvas("pattern",r.ctx.canvas.width,r.ctx.canvas.height,!0),o=i.context;o.clearRect(0,0,o.canvas.width,o.canvas.height),o.beginPath(),o.rect(0,0,o.canvas.width,o.canvas.height),o.setTransform.apply(o,r.baseTransform),this._matrix&&o.transform.apply(o,this._matrix),applyBoundingBox(o,this._bbox),o.fillStyle=this._createGradient(o),o.fill(),c=t.createPattern(i.canvas,"repeat")}this._patternCache=c}if(!a){const t=new DOMMatrix(i);try{c.setTransform(t)}catch(t){(0,o.warn)(`RadialAxialShadingPattern.getPattern: "${t?.message}".`)}}return c}}function drawTriangle(t,r,i,o,a,c,l,u){const d=r.coords,h=r.colors,p=t.data,g=4*t.width;let m;d[i+1]>d[o+1]&&(m=i,i=o,o=m,m=c,c=l,l=m),d[o+1]>d[a+1]&&(m=o,o=a,a=m,m=l,l=u,u=m),d[i+1]>d[o+1]&&(m=i,i=o,o=m,m=c,c=l,l=m);const y=(d[i]+r.offsetX)*r.scaleX,v=(d[i+1]+r.offsetY)*r.scaleY,_=(d[o]+r.offsetX)*r.scaleX,A=(d[o+1]+r.offsetY)*r.scaleY,b=(d[a]+r.offsetX)*r.scaleX,S=(d[a+1]+r.offsetY)*r.scaleY;if(v>=S)return;const C=h[c],w=h[c+1],P=h[c+2],x=h[l],k=h[l+1],T=h[l+2],R=h[u],E=h[u+1],I=h[u+2],D=Math.round(v),M=Math.round(S);let L,O,N,B,j,V,U,J;for(let t=D;t<=M;t++){if(t<A){let r;r=t<v?0:(v-t)/(v-A),L=y-(y-_)*r,O=C-(C-x)*r,N=w-(w-k)*r,B=P-(P-T)*r}else{let r;r=t>S?1:A===S?0:(A-t)/(A-S),L=_-(_-b)*r,O=x-(x-R)*r,N=k-(k-E)*r,B=T-(T-I)*r}let r;r=t<v?0:t>S?1:(v-t)/(v-S),j=y-(y-b)*r,V=C-(C-R)*r,U=w-(w-E)*r,J=P-(P-I)*r;const i=Math.round(Math.min(L,j)),o=Math.round(Math.max(L,j));let a=g*t+4*i;for(let t=i;t<=o;t++)r=(L-t)/(L-j),r<0?r=0:r>1&&(r=1),p[a++]=O-(O-V)*r|0,p[a++]=N-(N-U)*r|0,p[a++]=B-(B-J)*r|0,p[a++]=255}}function drawFigure(t,r,i){const o=r.coords,a=r.colors;let c,l;switch(r.type){case"lattice":const u=r.verticesPerRow,d=Math.floor(o.length/u)-1,h=u-1;for(c=0;c<d;c++){let r=c*u;for(let c=0;c<h;c++,r++)drawTriangle(t,i,o[r],o[r+1],o[r+u],a[r],a[r+1],a[r+u]),drawTriangle(t,i,o[r+u+1],o[r+1],o[r+u],a[r+u+1],a[r+1],a[r+u])}break;case"triangles":for(c=0,l=o.length;c<l;c+=3)drawTriangle(t,i,o[c],o[c+1],o[c+2],a[c],a[c+1],a[c+2]);break;default:throw new Error("illegal figure")}}class MeshShadingPattern extends BaseShadingPattern{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._matrix=t[6],this._bbox=t[7],this._background=t[8]}_createMeshCanvas(t,r,i){const o=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,l=Math.ceil(this._bounds[3])-a,u=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(l*t[1]*1.1)),3e3),h=c/u,p=l/d,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-a,scaleX:1/h,scaleY:1/p},m=u+4,y=d+4,v=i.getCanvas("mesh",m,y,!1),_=v.context,A=_.createImageData(u,d);if(r){const t=A.data;for(let i=0,o=t.length;i<o;i+=4)t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2],t[i+3]=255}for(const t of this._figures)drawFigure(A,t,g);_.putImageData(A,2,2);return{canvas:v.canvas,offsetX:o-2*h,offsetY:a-2*p,scaleX:h,scaleY:p}}getPattern(t,r,i,a=!1){let c;if(applyBoundingBox(t,this._bbox),a)c=o.Util.singularValueDecompose2dScale(t.mozCurrentTransform);else if(c=o.Util.singularValueDecompose2dScale(r.baseTransform),this._matrix){const t=o.Util.singularValueDecompose2dScale(this._matrix);c=[c[0]*t[0],c[1]*t[1]]}const l=this._createMeshCanvas(c,a?null:this._background,r.cachedCanvases);return a||(t.setTransform.apply(t,r.baseTransform),this._matrix&&t.transform.apply(t,this._matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}}const a=1,c=2;class TilingPattern{static get MAX_PATTERN_SIZE(){return(0,o.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(t,r,i,o,a){this.operatorList=t[2],this.matrix=t[3]||[1,0,0,1,0,0],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=r,this.ctx=i,this.canvasGraphicsFactory=o,this.baseTransform=a}createPatternCanvas(t){const r=this.operatorList,i=this.bbox,a=this.xstep,c=this.ystep,l=this.paintType,u=this.tilingType,d=this.color,h=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+u);const p=i[0],g=i[1],m=i[2],y=i[3],v=o.Util.singularValueDecompose2dScale(this.matrix),_=o.Util.singularValueDecompose2dScale(this.baseTransform),A=[v[0]*_[0],v[1]*_[1]],b=this.getSizeAndScale(a,this.ctx.canvas.width,A[0]),S=this.getSizeAndScale(c,this.ctx.canvas.height,A[1]),C=t.cachedCanvases.getCanvas("pattern",b.size,S.size,!0),w=C.context,P=h.createCanvasGraphics(w);P.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(P,l,d);let x=p,k=g,T=m,R=y;return p<0&&(x=0,T+=Math.abs(p)),g<0&&(k=0,R+=Math.abs(g)),w.translate(-b.scale*x,-S.scale*k),P.transform(b.scale,0,0,S.scale,0,0),this.clipBbox(P,x,k,T,R),P.baseTransform=P.ctx.mozCurrentTransform.slice(),P.executeOperatorList(r),P.endDrawing(),{canvas:C.canvas,scaleX:b.scale,scaleY:S.scale,offsetX:x,offsetY:k}}getSizeAndScale(t,r,i){t=Math.abs(t);const o=Math.max(TilingPattern.MAX_PATTERN_SIZE,r);let a=Math.ceil(t*i);return a>=o?a=o:i=a/t,{scale:i,size:a}}clipBbox(t,r,i,o,a){const c=o-r,l=a-i;t.ctx.rect(r,i,c,l),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,r,i){const l=t.ctx,u=t.current;switch(r){case a:const t=this.ctx;l.fillStyle=t.fillStyle,l.strokeStyle=t.strokeStyle,u.fillColor=t.fillStyle,u.strokeColor=t.strokeStyle;break;case c:const d=o.Util.makeHexColor(i[0],i[1],i[2]);l.fillStyle=d,l.strokeStyle=d,u.fillColor=d,u.strokeColor=d;break;default:throw new o.FormatError(`Unsupported paint type: ${r}`)}}getPattern(t,r,i,a=!1){let c=i;a||(c=o.Util.transform(c,r.baseTransform),this.matrix&&(c=o.Util.transform(c,this.matrix)));const l=this.createPatternCanvas(r);let u=new DOMMatrix(c);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const d=t.createPattern(l.canvas,"repeat");try{d.setTransform(u)}catch(t){(0,o.warn)(`TilingPattern.getPattern: "${t?.message}".`)}return d}}r.TilingPattern=TilingPattern},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const i=Object.create(null);r.GlobalWorkerOptions=i,i.workerPort=void 0===i.workerPort?null:i.workerPort,i.workerSrc=void 0===i.workerSrc?"":i.workerSrc},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var o=i(2);const a=1,c=2,l=1,u=2,d=3,h=4,p=5,g=6,m=7,y=8;function wrapReason(t){if("object"!=typeof t||null===t)return t;switch(t.name){case"AbortException":return new o.AbortException(t.message);case"MissingPDFException":return new o.MissingPDFException(t.message);case"UnexpectedResponseException":return new o.UnexpectedResponseException(t.message,t.status);case"UnknownErrorException":return new o.UnknownErrorException(t.message,t.details);default:return new o.UnknownErrorException(t.message,t.toString())}}r.MessageHandler=class MessageHandler{constructor(t,r,i){this.sourceName=t,this.targetName=r,this.comObj=i,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=t=>{const r=t.data;if(r.targetName!==this.sourceName)return;if(r.stream)return void this._processStreamMessage(r);if(r.callback){const t=r.callbackId,i=this.callbackCapabilities[t];if(!i)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],r.callback===a)i.resolve(r.data);else{if(r.callback!==c)throw new Error("Unexpected callback case");i.reject(wrapReason(r.reason))}return}const o=this.actionHandler[r.action];if(!o)throw new Error(`Unknown action from worker: ${r.action}`);if(r.callbackId){const t=this.sourceName,l=r.sourceName;new Promise((function(t){t(o(r.data))})).then((function(o){i.postMessage({sourceName:t,targetName:l,callback:a,callbackId:r.callbackId,data:o})}),(function(o){i.postMessage({sourceName:t,targetName:l,callback:c,callbackId:r.callbackId,reason:wrapReason(o)})}))}else r.streamId?this._createStreamSink(r):o(r.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,r){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=r}send(t,r,i){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:r},i)}sendWithPromise(t,r,i){const a=this.callbackId++,c=(0,o.createPromiseCapability)();this.callbackCapabilities[a]=c;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:r},i)}catch(t){c.reject(t)}return c.promise}sendWithStream(t,r,i,a){const c=this.streamId++,u=this.sourceName,d=this.targetName,h=this.comObj;return new ReadableStream({start:i=>{const l=(0,o.createPromiseCapability)();return this.streamControllers[c]={controller:i,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:u,targetName:d,action:t,streamId:c,data:r,desiredSize:i.desiredSize},a),l.promise},pull:t=>{const r=(0,o.createPromiseCapability)();return this.streamControllers[c].pullCall=r,h.postMessage({sourceName:u,targetName:d,stream:g,streamId:c,desiredSize:t.desiredSize}),r.promise},cancel:t=>{(0,o.assert)(t instanceof Error,"cancel must have a valid reason");const r=(0,o.createPromiseCapability)();return this.streamControllers[c].cancelCall=r,this.streamControllers[c].isClosed=!0,h.postMessage({sourceName:u,targetName:d,stream:l,streamId:c,reason:wrapReason(t)}),r.promise}},i)}_createStreamSink(t){const r=this,i=this.actionHandler[t.action],a=t.streamId,c=this.sourceName,l=t.sourceName,u=this.comObj,g={enqueue(t,i=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=i,d>0&&this.desiredSize<=0&&(this.sinkCapability=(0,o.createPromiseCapability)(),this.ready=this.sinkCapability.promise),r._postMessage({sourceName:c,targetName:l,stream:h,streamId:a,chunk:t},u)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:c,targetName:l,stream:d,streamId:a}),delete r.streamSinks[a])},error(t){(0,o.assert)(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:c,targetName:l,stream:p,streamId:a,reason:wrapReason(t)}))},sinkCapability:(0,o.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[a]=g,new Promise((function(r){r(i(t.data,g))})).then((function(){u.postMessage({sourceName:c,targetName:l,stream:y,streamId:a,success:!0})}),(function(t){u.postMessage({sourceName:c,targetName:l,stream:y,streamId:a,reason:wrapReason(t)})}))}_processStreamMessage(t){const r=t.streamId,i=this.sourceName,a=t.sourceName,c=this.comObj;switch(t.stream){case y:t.success?this.streamControllers[r].startCall.resolve():this.streamControllers[r].startCall.reject(wrapReason(t.reason));break;case m:t.success?this.streamControllers[r].pullCall.resolve():this.streamControllers[r].pullCall.reject(wrapReason(t.reason));break;case g:if(!this.streamSinks[r]){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,success:!0});break}this.streamSinks[r].desiredSize<=0&&t.desiredSize>0&&this.streamSinks[r].sinkCapability.resolve(),this.streamSinks[r].desiredSize=t.desiredSize;const{onPull:v}=this.streamSinks[t.streamId];new Promise((function(t){t(v&&v())})).then((function(){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,success:!0})}),(function(t){c.postMessage({sourceName:i,targetName:a,stream:m,streamId:r,reason:wrapReason(t)})}));break;case h:if((0,o.assert)(this.streamControllers[r],"enqueue should have stream controller"),this.streamControllers[r].isClosed)break;this.streamControllers[r].controller.enqueue(t.chunk);break;case d:if((0,o.assert)(this.streamControllers[r],"close should have stream controller"),this.streamControllers[r].isClosed)break;this.streamControllers[r].isClosed=!0,this.streamControllers[r].controller.close(),this._deleteStreamController(r);break;case p:(0,o.assert)(this.streamControllers[r],"error should have stream controller"),this.streamControllers[r].controller.error(wrapReason(t.reason)),this._deleteStreamController(r);break;case u:t.success?this.streamControllers[r].cancelCall.resolve():this.streamControllers[r].cancelCall.reject(wrapReason(t.reason)),this._deleteStreamController(r);break;case l:if(!this.streamSinks[r])break;const{onCancel:_}=this.streamSinks[t.streamId];new Promise((function(r){r(_&&_(wrapReason(t.reason)))})).then((function(){c.postMessage({sourceName:i,targetName:a,stream:u,streamId:r,success:!0})}),(function(t){c.postMessage({sourceName:i,targetName:a,stream:u,streamId:r,reason:wrapReason(t)})})),this.streamSinks[r].sinkCapability.reject(wrapReason(t.reason)),this.streamSinks[r].isCancelled=!0,delete this.streamSinks[r];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(t){await Promise.allSettled([this.streamControllers[t].startCall,this.streamControllers[t].pullCall,this.streamControllers[t].cancelCall].map((function(t){return t&&t.promise}))),delete this.streamControllers[t]}_postMessage(t,r){r&&this.postMessageTransfers?this.comObj.postMessage(t,r):this.comObj.postMessage(t)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var o=i(2);r.Metadata=class Metadata{constructor({parsedData:t,rawData:r}){this._metadataMap=t,this._data=r}getRaw(){return this._data}get(t){return this._metadataMap.get(t)??null}getAll(){return(0,o.objectFromMap)(this._metadataMap)}has(t){return this._metadataMap.has(t)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var o=i(2);class OptionalContentGroup{constructor(t,r){this.visible=!0,this.name=t,this.intent=r}}r.OptionalContentConfig=class OptionalContentConfig{constructor(t){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,null!==t){this.name=t.name,this.creator=t.creator,this._order=t.order;for(const r of t.groups)this._groups.set(r.id,new OptionalContentGroup(r.name,r.intent));if("OFF"===t.baseState)for(const t of this._groups)t.visible=!1;for(const r of t.on)this._groups.get(r).visible=!0;for(const r of t.off)this._groups.get(r).visible=!1}}_evaluateVisibilityExpression(t){const r=t.length;if(r<2)return!0;const i=t[0];for(let a=1;a<r;a++){const r=t[a];let c;if(Array.isArray(r))c=this._evaluateVisibilityExpression(r);else{if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;c=this._groups.get(r).visible}switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return"And"===i}isVisible(t){if("OCG"===t.type)return this._groups.has(t.id)?this._groups.get(t.id).visible:((0,o.warn)(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this._evaluateVisibilityExpression(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(this._groups.get(r).visible)return!0}return!1}if("AllOn"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(!this._groups.get(r).visible)return!1}return!0}if("AnyOff"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(!this._groups.get(r).visible)return!0}return!1}if("AllOff"===t.policy){for(const r of t.ids){if(!this._groups.has(r))return(0,o.warn)(`Optional content group not found: ${r}`),!0;if(this._groups.get(r).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,o.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,r=!0){this._groups.has(t)?this._groups.get(t).visible=!!r:(0,o.warn)(`Optional content group not found: ${t}`)}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,o.objectFromMap)(this._groups):null}getGroup(t){return this._groups.get(t)||null}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var o=i(2),a=i(1);r.PDFDataTransportStream=class PDFDataTransportStream{constructor(t,r){(0,o.assert)(r,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=t.progressiveDone||!1,this._contentDispositionFilename=t.contentDispositionFilename||null;const i=t.initialData;if(i?.length>0){const t=new Uint8Array(i).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=r,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._contentLength=t.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(((t,r)=>{this._onReceiveData({begin:t,chunk:r})})),this._pdfDataRangeTransport.addProgressListener(((t,r)=>{this._onProgress({loaded:t,total:r})})),this._pdfDataRangeTransport.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),this._pdfDataRangeTransport.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}_onReceiveData(t){const r=new Uint8Array(t.chunk).buffer;if(void 0===t.begin)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some((function(i){return i._begin===t.begin&&(i._enqueue(r),!0)}));(0,o.assert)(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){if(void 0===t.total){const r=this._rangeReaders[0];r?.onProgress&&r.onProgress({loaded:t.loaded})}else{const r=this._fullRequestReader;r?.onProgress&&r.onProgress({loaded:t.loaded,total:t.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const r=this._rangeReaders.indexOf(t);r>=0&&this._rangeReaders.splice(r,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=new PDFDataTransportStreamRangeReader(this,t,r);return this._pdfDataRangeTransport.requestDataRange(t,r),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeReaders.slice(0))r.cancel(t);this._pdfDataRangeTransport.abort()}};class PDFDataTransportStreamReader{constructor(t,r,i=!1,o=null){this._stream=t,this._done=i||!1,this._filename=(0,a.isPdfFile)(o)?o:null,this._queuedChunks=r||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PDFDataTransportStreamRangeReader{constructor(t,r,i){this._stream=t,this._begin=r,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var o=i(1),a=i(2),c=i(9),l=i(18);class AnnotationElementFactory{static create(t){switch(t.data.annotationType){case a.AnnotationType.LINK:return new LinkAnnotationElement(t);case a.AnnotationType.TEXT:return new TextAnnotationElement(t);case a.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(t);case"Btn":return t.data.radioButton?new RadioButtonWidgetAnnotationElement(t):t.data.checkBox?new CheckboxWidgetAnnotationElement(t):new PushButtonWidgetAnnotationElement(t);case"Ch":return new ChoiceWidgetAnnotationElement(t)}return new WidgetAnnotationElement(t);case a.AnnotationType.POPUP:return new PopupAnnotationElement(t);case a.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(t);case a.AnnotationType.LINE:return new LineAnnotationElement(t);case a.AnnotationType.SQUARE:return new SquareAnnotationElement(t);case a.AnnotationType.CIRCLE:return new CircleAnnotationElement(t);case a.AnnotationType.POLYLINE:return new PolylineAnnotationElement(t);case a.AnnotationType.CARET:return new CaretAnnotationElement(t);case a.AnnotationType.INK:return new InkAnnotationElement(t);case a.AnnotationType.POLYGON:return new PolygonAnnotationElement(t);case a.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(t);case a.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(t);case a.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(t);case a.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(t);case a.AnnotationType.STAMP:return new StampAnnotationElement(t);case a.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(t);default:return new AnnotationElement(t)}}}class AnnotationElement{constructor(t,{isRenderable:r=!1,ignoreBorder:i=!1,createQuadrilaterals:o=!1}={}){this.isRenderable=r,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._mouseState=t.mouseState,r&&(this.container=this._createContainer(i)),o&&(this.quadrilaterals=this._createQuadrilaterals(i))}_createContainer(t=!1){const r=this.data,i=this.page,o=this.viewport,c=document.createElement("section");let l=r.rect[2]-r.rect[0],u=r.rect[3]-r.rect[1];c.setAttribute("data-annotation-id",r.id);const d=a.Util.normalizeRect([r.rect[0],i.view[3]-r.rect[1]+i.view[1],r.rect[2],i.view[3]-r.rect[3]+i.view[1]]);if(c.style.transform=`matrix(${o.transform.join(",")})`,c.style.transformOrigin=`${-d[0]}px ${-d[1]}px`,!t&&r.borderStyle.width>0){c.style.borderWidth=`${r.borderStyle.width}px`,r.borderStyle.style!==a.AnnotationBorderStyleType.UNDERLINE&&(l-=2*r.borderStyle.width,u-=2*r.borderStyle.width);const t=r.borderStyle.horizontalCornerRadius,i=r.borderStyle.verticalCornerRadius;if(t>0||i>0){const r=`${t}px / ${i}px`;c.style.borderRadius=r}switch(r.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:c.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:c.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:c.style.borderBottomStyle="solid"}r.color?c.style.borderColor=a.Util.makeHexColor(0|r.color[0],0|r.color[1],0|r.color[2]):c.style.borderWidth=0}return c.style.left=`${d[0]}px`,c.style.top=`${d[1]}px`,c.style.width=`${l}px`,c.style.height=`${u}px`,c}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const r=[],i=this.data.rect;for(const i of this.data.quadPoints)this.data.rect=[i[2].x,i[2].y,i[1].x,i[1].y],r.push(this._createContainer(t));return this.data.rect=i,r}_createPopup(t,r){let i=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,i=this.quadrilaterals[0]),t||((t=document.createElement("div")).style.height=i.style.height,t.style.width=i.style.width,i.appendChild(t));const o=new PopupElement({container:i,trigger:t,color:r.color,title:r.title,modificationDate:r.modificationDate,contents:r.contents,hideWrapper:!0}).render();o.style.left=i.style.width,i.appendChild(o)}_renderQuadrilaterals(t){for(const r of this.quadrilaterals)r.className=t;return this.quadrilaterals}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}}class LinkAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.url||t.data.dest||t.data.action||t.data.isTooltipOnly||t.data.actions&&(t.data.actions.Action||t.data.actions["Mouse Up"]||t.data.actions["Mouse Down"])),createQuadrilaterals:!0})}render(){const{data:t,linkService:r}=this,i=document.createElement("a");return t.url?(0,o.addLinkAttributes)(i,{url:t.url,target:t.newWindow?o.LinkTarget.BLANK:r.externalLinkTarget,rel:r.externalLinkRel,enabled:r.externalLinkEnabled}):t.action?this._bindNamedAction(i,t.action):t.dest?this._bindLink(i,t.dest):t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions?this._bindJSAction(i,t):this._bindLink(i,""),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map(((t,r)=>{const o=0===r?i:i.cloneNode();return t.appendChild(o),t})):(this.container.className="linkAnnotation",this.container.appendChild(i),this.container)}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||""===r)&&(t.className="internalLink")}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),t.className="internalLink"}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(r.actions)){const a=i.get(o);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:o}}),!1))}t.className="internalLink"}}class TextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents)})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.appendChild(t),this.container}}class WidgetAnnotationElement extends AnnotationElement{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){return navigator.platform.includes("Win")&&t.ctrlKey||navigator.platform.includes("Mac")&&t.metaKey}_setEventListener(t,r,i,o){r.includes("mouse")?t.addEventListener(r,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(r,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:t.target.checked}})}))}_setEventListeners(t,r,i){for(const[o,a]of r)("Action"===a||this.data.actions?.[a])&&this._setEventListener(t,o,a,i)}_dispatchEventFromSandbox(t,r){const setColor=(t,r,i)=>{const o=i.detail[t];i.target.style[r]=l.ColorConverters[`${o[0]}_HTML`](o.slice(1))},i={display:t=>{const r=t.detail.display%2==1;t.target.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r,print:0===t.detail.display||3===t.detail.display})},print:t=>{this.annotationStorage.setValue(this.data.id,{print:t.detail.print})},hidden:t=>{t.target.style.visibility=t.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:t.detail.hidden})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.detail.readonly?t.target.setAttribute("readonly",""):t.target.removeAttribute("readonly")},required:t=>{t.detail.required?t.target.setAttribute("required",""):t.target.removeAttribute("required")},bgColor:t=>{setColor("bgColor","backgroundColor",t)},fillColor:t=>{setColor("fillColor","backgroundColor",t)},fgColor:t=>{setColor("fgColor","color",t)},textColor:t=>{setColor("textColor","color",t)},borderColor:t=>{setColor("borderColor","borderColor",t)},strokeColor:t=>{setColor("strokeColor","borderColor",t)}};for(const o of Object.keys(r.detail)){const a=t[o]||i[o];a&&a(r)}}}class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderInteractiveForms||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,r,i,o){const a=this.annotationStorage;for(const c of document.getElementsByName(t.name))if(c!==t){c[r]=i;const t=Object.create(null);t[o]=i,a.setValue(c.getAttribute("id"),t)}}render(){const t=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let i=null;if(this.renderInteractiveForms){const o=t.getValue(r,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),a=o.valueAsString||o.value||"",c={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a):(i=document.createElement("input"),i.type="text",i.setAttribute("value",a)),c.userValue=a,i.setAttribute("id",r),i.addEventListener("input",(o=>{t.setValue(r,{value:o.target.value}),this.setPropertyOnSiblings(i,"value",o.target.value,"value")}));let blurListener=t=>{c.formattedValue&&(t.target.value=c.formattedValue),t.target.scrollLeft=0,c.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",(t=>{c.userValue&&(t.target.value=c.userValue)})),i.addEventListener("updatefromsandbox",(i=>{const o={value(i){c.userValue=i.detail.value||"",t.setValue(r,{value:c.userValue.toString()}),c.formattedValue||(i.target.value=c.userValue)},valueAsString(i){c.formattedValue=i.detail.valueAsString||"",i.target!==document.activeElement&&(i.target.value=c.formattedValue),t.setValue(r,{formattedValue:c.formattedValue})},selRange(t){const[r,i]=t.detail.selRange;r>=0&&i<t.target.value.length&&t.target.setSelectionRange(r,i)}};this._dispatchEventFromSandbox(o,i)})),i.addEventListener("keydown",(t=>{c.beforeInputValue=t.target.value;let i=-1;"Escape"===t.key?i=0:"Enter"===t.key?i=2:"Tab"===t.key&&(i=3),-1!==i&&(c.userValue=t.target.value,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:t.target.value,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const o=blurListener;blurListener=null,i.addEventListener("blur",(t=>{this._mouseState.isDown&&(c.userValue=t.target.value,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:t.target.value,willCommit:!0,commitKey:1,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}})),o(t)})),i.addEventListener("mousedown",(t=>{c.beforeInputValue=t.target.value,c.beforeInputSelectionRange=null})),i.addEventListener("keyup",(t=>{t.target.selectionStart===t.target.selectionEnd&&(c.beforeInputSelectionRange=null)})),i.addEventListener("select",(t=>{c.beforeInputSelectionRange=[t.target.selectionStart,t.target.selectionEnd]})),this.data.actions?.Keystroke&&i.addEventListener("input",(t=>{let i=-1,o=-1;c.beforeInputSelectionRange&&([i,o]=c.beforeInputSelectionRange),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:c.beforeInputValue,change:t.data,willCommit:!1,selStart:i,selEnd:o}})})),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(blurListener&&i.addEventListener("blur",blurListener),i.disabled=this.data.readOnly,i.name=this.data.fieldName,null!==this.data.maxLen&&(i.maxLength=this.data.maxLen),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;i.classList.add("comb"),i.style.letterSpacing=`calc(${t}px - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";return this._setTextStyle(i),this.container.appendChild(i),this.container}_setTextStyle(t){const r=["left","center","right"],{fontSize:i,fontColor:o}=this.data.defaultAppearanceData,c=t.style;i&&(c.fontSize=`${i}px`),c.color=a.Util.makeHexColor(o[0],o[1],o[2]),null!==this.data.textAlignment&&(c.textAlign=r[this.data.textAlignment])}}class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderInteractiveForms})}render(){const t=this.annotationStorage,r=this.data,i=r.id;let o=t.getValue(i,{value:r.fieldValue&&(r.exportValue&&r.exportValue===r.fieldValue||!r.exportValue&&"Off"!==r.fieldValue)}).value;"string"==typeof o&&(o="Off"!==o,t.setValue(i,{value:o})),this.container.className="buttonWidgetAnnotation checkBox";const a=document.createElement("input");return a.disabled=r.readOnly,a.type="checkbox",a.name=this.data.fieldName,o&&a.setAttribute("checked",!0),a.setAttribute("id",i),a.addEventListener("change",(function(r){const o=r.target.name;for(const i of document.getElementsByName(o))i!==r.target&&(i.checked=!1,t.setValue(i.parentNode.getAttribute("data-annotation-id"),{value:!1}));t.setValue(i,{value:r.target.checked})})),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",(r=>{const o={value(r){r.target.checked="Off"!==r.detail.value,t.setValue(i,{value:r.target.checked})}};this._dispatchEventFromSandbox(o,r)})),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this.container.appendChild(a),this.container}}class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderInteractiveForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,r=this.data,i=r.id;let o=t.getValue(i,{value:r.fieldValue===r.buttonValue}).value;"string"==typeof o&&(o=o!==r.buttonValue,t.setValue(i,{value:o}));const a=document.createElement("input");if(a.disabled=r.readOnly,a.type="radio",a.name=r.fieldName,o&&a.setAttribute("checked",!0),a.setAttribute("id",i),a.addEventListener("change",(function(r){const{target:o}=r;for(const r of document.getElementsByName(o.name))r!==o&&t.setValue(r.getAttribute("id"),{value:!1});t.setValue(i,{value:o.checked})})),this.enableScripting&&this.hasJSActions){const o=r.buttonValue;a.addEventListener("updatefromsandbox",(r=>{const a={value(r){const a=o===r.detail.value;for(const o of document.getElementsByName(r.target.name)){const r=o.getAttribute("id");o.checked=r===i&&a,t.setValue(r,{value:o.checked})}}};this._dispatchEventFromSandbox(a,r)})),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this.container.appendChild(a),this.container}}class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{render(){const t=super.render();return t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText),t}}class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderInteractiveForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,r=this.data.id;t.getValue(r,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});const i=document.createElement("select");i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.setAttribute("id",r),this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0));for(const t of this.data.options){const r=document.createElement("option");r.textContent=t.displayValue,r.value=t.exportValue,this.data.fieldValue.includes(t.exportValue)&&r.setAttribute("selected",!0),i.appendChild(r)}const getValue=(t,r)=>{const i=r?"value":"textContent",o=t.target.options;return t.target.multiple?Array.prototype.filter.call(o,(t=>t.selected)).map((t=>t[i])):-1===o.selectedIndex?null:o[o.selectedIndex][i]},getItems=t=>{const r=t.target.options;return Array.prototype.map.call(r,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(o=>{const a={value(o){const a=i.options,c=o.detail.value,l=new Set(Array.isArray(c)?c:[c]);Array.prototype.forEach.call(a,(t=>{t.selected=l.has(t.value)})),t.setValue(r,{value:getValue(o,!0)})},multipleSelection(t){i.multiple=!0},remove(o){const a=i.options,c=o.detail.remove;if(a[c].selected=!1,i.remove(c),a.length>0){-1===Array.prototype.findIndex.call(a,(t=>t.selected))&&(a[0].selected=!0)}t.setValue(r,{value:getValue(o,!0),items:getItems(o)})},clear(o){for(;0!==i.length;)i.remove(0);t.setValue(r,{value:null,items:[]})},insert(o){const{index:a,displayValue:c,exportValue:l}=o.detail.insert,u=document.createElement("option");u.textContent=c,u.value=l,i.insertBefore(u,i.children[a]),t.setValue(r,{value:getValue(o,!0),items:getItems(o)})},items(o){const{items:a}=o.detail;for(;0!==i.length;)i.remove(0);for(const t of a){const{displayValue:r,exportValue:o}=t,a=document.createElement("option");a.textContent=r,a.value=o,i.appendChild(a)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(r,{value:getValue(o,!0),items:getItems(o)})},indices(i){const o=new Set(i.detail.indices),a=i.target.options;Array.prototype.forEach.call(a,((t,r)=>{t.selected=o.has(r)})),t.setValue(r,{value:getValue(i,!0)})},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(a,o)})),i.addEventListener("input",(i=>{const o=getValue(i,!0),a=getValue(i,!1);t.setValue(r,{value:o}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:a,changeEx:o,willCommit:!0,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],(t=>t.target.checked))):i.addEventListener("input",(function(i){t.setValue(r,{value:getValue(i)})})),this.container.appendChild(i),this.container}}class PopupAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!(!t.data.title&&!t.data.contents)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const t=`[data-annotation-id="${this.data.parentId}"]`,r=this.layer.querySelectorAll(t);if(0===r.length)return this.container;const i=new PopupElement({container:this.container,trigger:Array.from(r),color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),o=this.page,c=a.Util.normalizeRect([this.data.parentRect[0],o.view[3]-this.data.parentRect[1]+o.view[1],this.data.parentRect[2],o.view[3]-this.data.parentRect[3]+o.view[1]]),l=c[0]+this.data.parentRect[2]-this.data.parentRect[0],u=c[1];return this.container.style.transformOrigin=`${-l}px ${-u}px`,this.container.style.left=`${l}px`,this.container.style.top=`${u}px`,this.container.appendChild(i.render()),this.container}}class PopupElement{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.modificationDate=t.modificationDate,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const t=document.createElement("div");t.className="popupWrapper",this.hideElement=this.hideWrapper?t:this.container,this.hideElement.hidden=!0;const r=document.createElement("div");r.className="popup";const i=this.color;if(i){const t=.7*(255-i[0])+i[0],o=.7*(255-i[1])+i[1],c=.7*(255-i[2])+i[2];r.style.backgroundColor=a.Util.makeHexColor(0|t,0|o,0|c)}const c=document.createElement("h1");c.textContent=this.title,r.appendChild(c);const l=o.PDFDateString.toDateObject(this.modificationDate);if(l){const t=document.createElement("span");t.textContent="{{date}}, {{time}}",t.dataset.l10nId="annotation_date_string",t.dataset.l10nArgs=JSON.stringify({date:l.toLocaleDateString(),time:l.toLocaleTimeString()}),r.appendChild(t)}const u=this._formatContents(this.contents);r.appendChild(u),Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const t of this.trigger)t.addEventListener("click",this._toggle.bind(this)),t.addEventListener("mouseover",this._show.bind(this,!1)),t.addEventListener("mouseout",this._hide.bind(this,!1));return r.addEventListener("click",this._hide.bind(this,!0)),t.appendChild(r),t}_formatContents(t){const r=document.createElement("p"),i=t.split(/(?:\r\n?|\n)/);for(let t=0,o=i.length;t<o;++t){const a=i[t];r.appendChild(document.createTextNode(a)),t<o-1&&r.appendChild(document.createElement("br"))}return r}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(t=!0){t&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class FreeTextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class LineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,r=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],o=this.svgFactory.create(r,i),a=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),o.appendChild(a),this.container.append(o),this._createPopup(a,t),this.container}}class SquareAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,r=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],o=this.svgFactory.create(r,i),a=t.borderStyle.width,c=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",a/2),c.setAttribute("y",a/2),c.setAttribute("width",r-a),c.setAttribute("height",i-a),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","none"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class CircleAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,r=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],o=this.svgFactory.create(r,i),a=t.borderStyle.width,c=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",r/2),c.setAttribute("cy",i/2),c.setAttribute("rx",r/2-a/2),c.setAttribute("ry",i/2-a/2),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","none"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class PolylineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,r=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],o=this.svgFactory.create(r,i);let a=[];for(const r of t.vertices){const i=r.x-t.rect[0],o=t.rect[3]-r.y;a.push(i+","+o)}a=a.join(" ");const c=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",a),c.setAttribute("stroke-width",t.borderStyle.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","none"),o.appendChild(c),this.container.append(o),this._createPopup(c,t),this.container}}class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class CaretAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class InkAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,r=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],o=this.svgFactory.create(r,i);for(const r of t.inkLists){let i=[];for(const o of r){const r=o.x-t.rect[0],a=t.rect[3]-o.y;i.push(`${r},${a}`)}i=i.join(" ");const a=this.svgFactory.createElement(this.svgElementName);a.setAttribute("points",i),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","none"),this._createPopup(a,t),o.appendChild(a)}return this.container.append(o),this.container}}class HighlightAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class UnderlineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class SquigglyAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class StrikeOutAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class StampAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.hasPopup||t.data.title||t.data.contents),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class FileAttachmentAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!0});const{filename:r,content:i}=this.data.file;this.filename=(0,o.getFilenameFromUrl)(r),this.content=i,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,id:(0,a.stringToPDFString)(r),filename:r,content:i})}render(){this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(t,this.data),this.container.appendChild(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}r.AnnotationLayer=class AnnotationLayer{static render(t){const r=[],i=[];for(const o of t.annotations)o&&(o.annotationType!==a.AnnotationType.POPUP?r.push(o):i.push(o));i.length&&r.push(...i);for(const i of r){const r=AnnotationElementFactory.create({data:i,layer:t.div,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderInteractiveForms:!1!==t.renderInteractiveForms,svgFactory:new o.DOMSVGFactory,annotationStorage:t.annotationStorage||new c.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,mouseState:t.mouseState||{isDown:!1}});if(r.isRenderable){const o=r.render();if(i.hidden&&(o.style.visibility="hidden"),Array.isArray(o))for(const r of o)t.div.appendChild(r);else r instanceof PopupAnnotationElement?t.div.prepend(o):t.div.appendChild(o)}}}static update(t){const r=`matrix(${t.viewport.transform.join(",")})`;for(const i of t.annotations){const o=t.div.querySelectorAll(`[data-annotation-id="${i.id}"]`);if(o)for(const t of o)t.style.transform=r}t.div.hidden=!1}}},(t,r)=>{function makeColorComp(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;r.ColorConverters=class ColorConverters{static CMYK_G([t,r,i,o]){return["G",1-Math.min(1,.3*t+.59*i+.11*r+o)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_HTML([t]){const r=makeColorComp(t);return`#${r}${r}${r}`}static RGB_G([t,r,i]){return["G",.3*t+.59*r+.11*i]}static RGB_HTML([t,r,i]){return`#${makeColorComp(t)}${makeColorComp(r)}${makeColorComp(i)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([t,r,i,o]){return["RGB",1-Math.min(1,t+o),1-Math.min(1,i+o),1-Math.min(1,r+o)]}static CMYK_HTML(t){return this.RGB_HTML(this.CMYK_RGB(t))}static RGB_CMYK([t,r,i]){const o=1-t,a=1-r,c=1-i;return["CMYK",o,a,c,Math.min(o,a,c)]}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.renderTextLayer=function renderTextLayer(t){const r=new TextLayerRenderTask({textContent:t.textContent,textContentStream:t.textContentStream,container:t.container,viewport:t.viewport,textDivs:t.textDivs,textContentItemsStr:t.textContentItemsStr,enhanceTextSelection:t.enhanceTextSelection});return r._render(t.timeout),r};var o=i(2);const a=30,c=new Map,l=/^\s+$/g;function appendText(t,r,i,u){const d=document.createElement("span"),h={angle:0,canvasWidth:0,hasText:""!==r.str,hasEOL:r.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};t._textDivs.push(d);const p=o.Util.transform(t._viewport.transform,r.transform);let g=Math.atan2(p[1],p[0]);const m=i[r.fontName];m.vertical&&(g+=Math.PI/2);const y=Math.hypot(p[2],p[3]),v=y*function getAscent(t,r){const i=c.get(t);if(i)return i;r.save(),r.font=`30px ${t}`;const o=r.measureText("");let l=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);if(l){r.restore();const i=l/(l+u);return c.set(t,i),i}r.strokeStyle="red",r.clearRect(0,0,a,a),r.strokeText("g",0,0);let d=r.getImageData(0,0,a,a).data;u=0;for(let t=d.length-1-3;t>=0;t-=4)if(d[t]>0){u=Math.ceil(t/4/a);break}r.clearRect(0,0,a,a),r.strokeText("A",0,a),d=r.getImageData(0,0,a,a).data,l=0;for(let t=0,r=d.length;t<r;t+=4)if(d[t]>0){l=a-Math.floor(t/4/a);break}if(r.restore(),l){const r=l/(l+u);return c.set(t,r),r}return c.set(t,.8),.8}(m.fontFamily,u);let _,A;0===g?(_=p[4],A=p[5]-v):(_=p[4]+v*Math.sin(g),A=p[5]-v*Math.cos(g)),d.style.left=`${_}px`,d.style.top=`${A}px`,d.style.fontSize=`${y}px`,d.style.fontFamily=m.fontFamily,d.setAttribute("role","presentation"),d.textContent=r.str,d.dir=r.dir,t._fontInspectorEnabled&&(d.dataset.fontName=r.fontName),0!==g&&(h.angle=g*(180/Math.PI));let b=!1;if(r.str.length>1||t._enhanceTextSelection&&l.test(r.str))b=!0;else if(r.transform[0]!==r.transform[3]){const t=Math.abs(r.transform[0]),i=Math.abs(r.transform[3]);t!==i&&Math.max(t,i)/Math.min(t,i)>1.5&&(b=!0)}if(b&&(m.vertical?h.canvasWidth=r.height*t._viewport.scale:h.canvasWidth=r.width*t._viewport.scale),t._textDivProperties.set(d,h),t._textContentStream&&t._layoutText(d),t._enhanceTextSelection&&h.hasText){let i=1,a=0;0!==g&&(i=Math.cos(g),a=Math.sin(g));const c=(m.vertical?r.height:r.width)*t._viewport.scale,l=y;let u,h;0!==g?(u=[i,a,-a,i,_,A],h=o.Util.getAxialAlignedBoundingBox([0,0,c,l],u)):h=[_,A,_+c,A+l],t._bounds.push({left:h[0],top:h[1],right:h[2],bottom:h[3],div:d,size:[c,l],m:u})}}function render(t){if(t._canceled)return;const r=t._textDivs,i=t._capability,o=r.length;if(o>1e5)return t._renderingDone=!0,void i.resolve();if(!t._textContentStream)for(let i=0;i<o;i++)t._layoutText(r[i]);t._renderingDone=!0,i.resolve()}function findPositiveMin(t,r,i){let o=0;for(let a=0;a<i;a++){const i=t[r++];i>0&&(o=o?Math.min(i,o):i)}return o}function expand(t){const r=t._bounds,i=t._viewport,a=function expandBounds(t,r,i){const o=i.map((function(t,r){return{x1:t.left,y1:t.top,x2:t.right,y2:t.bottom,index:r,x1New:void 0,x2New:void 0}}));expandBoundsLTR(t,o);const a=new Array(i.length);for(const t of o){const r=t.index;a[r]={left:t.x1New,top:0,right:t.x2New,bottom:0}}i.map((function(r,i){const c=a[i],l=o[i];l.x1=r.top,l.y1=t-c.right,l.x2=r.bottom,l.y2=t-c.left,l.index=i,l.x1New=void 0,l.x2New=void 0})),expandBoundsLTR(r,o);for(const t of o){const r=t.index;a[r].top=t.x1New,a[r].bottom=t.x2New}return a}(i.width,i.height,r);for(let i=0;i<a.length;i++){const c=r[i].div,l=t._textDivProperties.get(c);if(0===l.angle){l.paddingLeft=r[i].left-a[i].left,l.paddingTop=r[i].top-a[i].top,l.paddingRight=a[i].right-r[i].right,l.paddingBottom=a[i].bottom-r[i].bottom,t._textDivProperties.set(c,l);continue}const u=a[i],d=r[i],h=d.m,p=h[0],g=h[1],m=[[0,0],[0,d.size[1]],[d.size[0],0],d.size],y=new Float64Array(64);for(let t=0,r=m.length;t<r;t++){const r=o.Util.applyTransform(m[t],h);y[t+0]=p&&(u.left-r[0])/p,y[t+4]=g&&(u.top-r[1])/g,y[t+8]=p&&(u.right-r[0])/p,y[t+12]=g&&(u.bottom-r[1])/g,y[t+16]=g&&(u.left-r[0])/-g,y[t+20]=p&&(u.top-r[1])/p,y[t+24]=g&&(u.right-r[0])/-g,y[t+28]=p&&(u.bottom-r[1])/p,y[t+32]=p&&(u.left-r[0])/-p,y[t+36]=g&&(u.top-r[1])/-g,y[t+40]=p&&(u.right-r[0])/-p,y[t+44]=g&&(u.bottom-r[1])/-g,y[t+48]=g&&(u.left-r[0])/g,y[t+52]=p&&(u.top-r[1])/-p,y[t+56]=g&&(u.right-r[0])/g,y[t+60]=p&&(u.bottom-r[1])/-p}const v=1+Math.min(Math.abs(p),Math.abs(g));l.paddingLeft=findPositiveMin(y,32,16)/v,l.paddingTop=findPositiveMin(y,48,16)/v,l.paddingRight=findPositiveMin(y,0,16)/v,l.paddingBottom=findPositiveMin(y,16,16)/v,t._textDivProperties.set(c,l)}}function expandBoundsLTR(t,r){r.sort((function(t,r){return t.x1-r.x1||t.index-r.index}));const i=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const t of r){let r=0;for(;r<i.length&&i[r].end<=t.y1;)r++;let o,a,c=i.length-1;for(;c>=0&&i[c].start>=t.y2;)c--;let l,u,d=-1/0;for(l=r;l<=c;l++){let r;o=i[l],a=o.boundary,r=a.x2>t.x1?a.index>t.index?a.x1New:t.x1:void 0===a.x2New?(a.x2+t.x1)/2:a.x2New,r>d&&(d=r)}for(t.x1New=d,l=r;l<=c;l++)o=i[l],a=o.boundary,void 0===a.x2New?a.x2>t.x1?a.index>t.index&&(a.x2New=a.x2):a.x2New=d:a.x2New>d&&(a.x2New=Math.max(d,a.x2));const h=[];let p=null;for(l=r;l<=c;l++){o=i[l],a=o.boundary;const r=a.x2>t.x2?a:t;p===r?h[h.length-1].end=o.end:(h.push({start:o.start,end:o.end,boundary:r}),p=r)}for(i[r].start<t.y1&&(h[0].start=t.y1,h.unshift({start:i[r].start,end:t.y1,boundary:i[r].boundary})),t.y2<i[c].end&&(h[h.length-1].end=t.y2,h.push({start:t.y2,end:i[c].end,boundary:i[c].boundary})),l=r;l<=c;l++){if(o=i[l],a=o.boundary,void 0!==a.x2New)continue;let t=!1;for(u=r-1;!t&&u>=0&&i[u].start>=a.y1;u--)t=i[u].boundary===a;for(u=c+1;!t&&u<i.length&&i[u].end<=a.y2;u++)t=i[u].boundary===a;for(u=0;!t&&u<h.length;u++)t=h[u].boundary===a;t||(a.x2New=d)}Array.prototype.splice.apply(i,[r,c-r+1].concat(h))}for(const r of i){const i=r.boundary;void 0===i.x2New&&(i.x2New=Math.max(t,i.x2))}}class TextLayerRenderTask{constructor({textContent:t,textContentStream:r,container:i,viewport:a,textDivs:c,textContentItemsStr:l,enhanceTextSelection:u}){this._textContent=t,this._textContentStream=r,this._container=i,this._document=i.ownerDocument,this._viewport=a,this._textDivs=c||[],this._textContentItemsStr=l||[],this._enhanceTextSelection=!!u,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,o.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally((()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)})).catch((()=>{}))}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(t,r){for(let i=0,o=t.length;i<o;i++)if(void 0!==t[i].str)this._textContentItemsStr.push(t[i].str),appendText(this,t[i],r,this._layoutTextCtx);else if("beginMarkedContentProps"===t[i].type||"beginMarkedContent"===t[i].type){const r=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==t[i].id&&this._container.setAttribute("id",`${t[i].id}`),r.appendChild(this._container)}else"endMarkedContent"===t[i].type&&(this._container=this._container.parentNode)}_layoutText(t){const r=this._textDivProperties.get(t);let i="";if(0!==r.canvasWidth&&r.hasText){const{fontSize:o,fontFamily:a}=t.style;o===this._layoutTextLastFontSize&&a===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=`${o} ${a}`,this._layoutTextLastFontSize=o,this._layoutTextLastFontFamily=a);const{width:c}=this._layoutTextCtx.measureText(t.textContent);c>0&&(r.scale=r.canvasWidth/c,i=`scaleX(${r.scale})`)}if(0!==r.angle&&(i=`rotate(${r.angle}deg) ${i}`),i.length>0&&(this._enhanceTextSelection&&(r.originalTransform=i),t.style.transform=i),r.hasText&&this._container.appendChild(t),r.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this._container.appendChild(t)}}_render(t=0){const r=(0,o.createPromiseCapability)();let i=Object.create(null);const c=this._document.createElement("canvas");if(c.height=c.width=a,c.mozOpaque=!0,this._layoutTextCtx=c.getContext("2d",{alpha:!1}),this._textContent){const t=this._textContent.items,i=this._textContent.styles;this._processItems(t,i),r.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const pump=()=>{this._reader.read().then((({value:t,done:o})=>{o?r.resolve():(Object.assign(i,t.styles),this._processItems(t.items,i),pump())}),r.reject)};this._reader=this._textContentStream.getReader(),pump()}}r.promise.then((()=>{i=null,t?this._renderTimer=setTimeout((()=>{render(this),this._renderTimer=null}),t):render(this)}),this._capability.reject)}expandTextDivs(t=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(expand(this),this._bounds=null);const r=[],i=[];for(let o=0,a=this._textDivs.length;o<a;o++){const a=this._textDivs[o],c=this._textDivProperties.get(a);c.hasText&&(t?(r.length=0,i.length=0,c.originalTransform&&r.push(c.originalTransform),c.paddingTop>0?(i.push(`${c.paddingTop}px`),r.push(`translateY(${-c.paddingTop}px)`)):i.push(0),c.paddingRight>0?i.push(c.paddingRight/c.scale+"px"):i.push(0),c.paddingBottom>0?i.push(`${c.paddingBottom}px`):i.push(0),c.paddingLeft>0?(i.push(c.paddingLeft/c.scale+"px"),r.push(`translateX(${-c.paddingLeft/c.scale}px)`)):i.push(0),a.style.padding=i.join(" "),r.length&&(a.style.transform=r.join(" "))):(a.style.padding=null,a.style.transform=c.originalTransform))}}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var o=i(2),a=i(1),c=i(4);let l=class{constructor(){(0,o.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=l;{const t={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},i="http://www.w3.org/XML/1998/namespace",u="http://www.w3.org/1999/xlink",d=["butt","round","square"],h=["miter","round","bevel"],p=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),r=new Int32Array(256);for(let t=0;t<256;t++){let i=t;for(let t=0;t<8;t++)i=1&i?3988292384^i>>1&2147483647:i>>1&2147483647;r[t]=i}function writePngChunk(t,i,o,a){let c=a;const l=i.length;o[c]=l>>24&255,o[c+1]=l>>16&255,o[c+2]=l>>8&255,o[c+3]=255&l,c+=4,o[c]=255&t.charCodeAt(0),o[c+1]=255&t.charCodeAt(1),o[c+2]=255&t.charCodeAt(2),o[c+3]=255&t.charCodeAt(3),c+=4,o.set(i,c),c+=i.length;const u=function crc32(t,i,o){let a=-1;for(let c=i;c<o;c++){const i=255&(a^t[c]);a=a>>>8^r[i]}return-1^a}(o,a+4,c);o[c]=u>>24&255,o[c+1]=u>>16&255,o[c+2]=u>>8&255,o[c+3]=255&u}function deflateSyncUncompressed(t){let r=t.length;const i=65535,o=Math.ceil(r/i),a=new Uint8Array(2+r+5*o+4);let c=0;a[c++]=120,a[c++]=156;let l=0;for(;r>i;)a[c++]=0,a[c++]=255,a[c++]=255,a[c++]=0,a[c++]=0,a.set(t.subarray(l,l+i),c),c+=i,l+=i,r-=i;a[c++]=1,a[c++]=255&r,a[c++]=r>>8&255,a[c++]=255&~r,a[c++]=(65535&~r)>>8&255,a.set(t.subarray(l),c),c+=t.length-l;const u=function adler32(t,r,i){let o=1,a=0;for(let c=r;c<i;++c)o=(o+(255&t[c]))%65521,a=(a+o)%65521;return a<<16|o}(t,0,t.length);return a[c++]=u>>24&255,a[c++]=u>>16&255,a[c++]=u>>8&255,a[c++]=255&u,a}function encode(r,i,a,l){const u=r.width,d=r.height;let h,p,g;const m=r.data;switch(i){case o.ImageKind.GRAYSCALE_1BPP:p=0,h=1,g=u+7>>3;break;case o.ImageKind.RGB_24BPP:p=2,h=8,g=3*u;break;case o.ImageKind.RGBA_32BPP:p=6,h=8,g=4*u;break;default:throw new Error("invalid format")}const y=new Uint8Array((1+g)*d);let v=0,_=0;for(let t=0;t<d;++t)y[v++]=0,y.set(m.subarray(_,_+g),v),_+=g,v+=g;if(i===o.ImageKind.GRAYSCALE_1BPP&&l){v=0;for(let t=0;t<d;t++){v++;for(let t=0;t<g;t++)y[v++]^=255}}const A=new Uint8Array([u>>24&255,u>>16&255,u>>8&255,255&u,d>>24&255,d>>16&255,d>>8&255,255&d,h,p,0,0,0]),b=function deflateSync(t){if(!c.isNodeJS)return deflateSyncUncompressed(t);try{let r;r=parseInt(process.versions.node)>=8?t:Buffer.from(t);const i=__webpack_require__(258).deflateSync(r,{level:9});return i instanceof Uint8Array?i:new Uint8Array(i)}catch(t){(0,o.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return deflateSyncUncompressed(t)}(y),S=t.length+36+A.length+b.length,C=new Uint8Array(S);let w=0;return C.set(t,w),w+=t.length,writePngChunk("IHDR",A,C,w),w+=12+A.length,writePngChunk("IDATA",b,C,w),w+=12+b.length,writePngChunk("IEND",new Uint8Array(0),C,w),(0,o.createObjectURL)(C,"image/png",a)}return function convertImgDataToPng(t,r,i){return encode(t,void 0===t.kind?o.ImageKind.GRAYSCALE_1BPP:t.kind,r,i)}}();class SVGExtraState{constructor(){this.fontSizeScale=1,this.fontWeight=t.fontWeight,this.fontSize=0,this.textMatrix=o.IDENTITY_MATRIX,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=o.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=t.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(t,r){this.x=t,this.y=r}}function opListToTree(t){let r=[];const i=[];for(const o of t)"save"!==o.fn?"restore"===o.fn?r=i.pop():r.push(o):(r.push({fnId:92,fn:"group",items:[]}),i.push(r),r=r[r.length-1].items);return r}function pf(t){if(Number.isInteger(t))return t.toString();const r=t.toFixed(10);let i=r.length-1;if("0"!==r[i])return r;do{i--}while("0"===r[i]);return r.substring(0,"."===r[i]?i:i+1)}function pm(t){if(0===t[4]&&0===t[5]){if(0===t[1]&&0===t[2])return 1===t[0]&&1===t[3]?"":`scale(${pf(t[0])} ${pf(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){return`rotate(${pf(180*Math.acos(t[0])/Math.PI)})`}}else if(1===t[0]&&0===t[1]&&0===t[2]&&1===t[3])return`translate(${pf(t[4])} ${pf(t[5])})`;return`matrix(${pf(t[0])} ${pf(t[1])} ${pf(t[2])} ${pf(t[3])} ${pf(t[4])} ${pf(t[5])})`}let g=0,m=0,y=0;r.SVGGraphics=l=class{constructor(t,r,i=!1){this.svgFactory=new a.DOMSVGFactory,this.current=new SVGExtraState,this.transformMatrix=o.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=r,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!i,this._operatorIdMapping=[];for(const t in o.OPS)this._operatorIdMapping[o.OPS[t]]=t}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const r=t.fnArray,i=t.argsArray;for(let t=0,a=r.length;t<a;t++)if(r[t]===o.OPS.dependency)for(const r of i[t]){const t=r.startsWith("g_")?this.commonObjs:this.objs,i=new Promise((i=>{t.get(r,i)}));this.current.dependencies.push(i)}return Promise.all(this.current.dependencies)}transform(t,r,i,a,c,l){const u=[t,r,i,a,c,l];this.transformMatrix=o.Util.transform(this.transformMatrix,u),this.tgrp=null}getSVG(t,r){this.viewport=r;const i=this._initialize(r);return this.loadDependencies(t).then((()=>(this.transformMatrix=o.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),i)))}convertOpList(t){const r=this._operatorIdMapping,i=t.argsArray,o=t.fnArray,a=[];for(let t=0,c=o.length;t<c;t++){const c=o[t];a.push({fnId:c,fn:r[c],args:i[t]})}return opListToTree(a)}executeOpTree(t){for(const r of t){const t=r.fn,i=r.fnId,a=r.args;switch(0|i){case o.OPS.beginText:this.beginText();break;case o.OPS.dependency:break;case o.OPS.setLeading:this.setLeading(a);break;case o.OPS.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case o.OPS.setFont:this.setFont(a);break;case o.OPS.showText:case o.OPS.showSpacedText:this.showText(a[0]);break;case o.OPS.endText:this.endText();break;case o.OPS.moveText:this.moveText(a[0],a[1]);break;case o.OPS.setCharSpacing:this.setCharSpacing(a[0]);break;case o.OPS.setWordSpacing:this.setWordSpacing(a[0]);break;case o.OPS.setHScale:this.setHScale(a[0]);break;case o.OPS.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.OPS.setTextRise:this.setTextRise(a[0]);break;case o.OPS.setTextRenderingMode:this.setTextRenderingMode(a[0]);break;case o.OPS.setLineWidth:this.setLineWidth(a[0]);break;case o.OPS.setLineJoin:this.setLineJoin(a[0]);break;case o.OPS.setLineCap:this.setLineCap(a[0]);break;case o.OPS.setMiterLimit:this.setMiterLimit(a[0]);break;case o.OPS.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case o.OPS.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case o.OPS.setStrokeColorN:this.setStrokeColorN(a);break;case o.OPS.setFillColorN:this.setFillColorN(a);break;case o.OPS.shadingFill:this.shadingFill(a[0]);break;case o.OPS.setDash:this.setDash(a[0],a[1]);break;case o.OPS.setRenderingIntent:this.setRenderingIntent(a[0]);break;case o.OPS.setFlatness:this.setFlatness(a[0]);break;case o.OPS.setGState:this.setGState(a[0]);break;case o.OPS.fill:this.fill();break;case o.OPS.eoFill:this.eoFill();break;case o.OPS.stroke:this.stroke();break;case o.OPS.fillStroke:this.fillStroke();break;case o.OPS.eoFillStroke:this.eoFillStroke();break;case o.OPS.clip:this.clip("nonzero");break;case o.OPS.eoClip:this.clip("evenodd");break;case o.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.OPS.paintImageXObject:this.paintImageXObject(a[0]);break;case o.OPS.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case o.OPS.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case o.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case o.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.OPS.closePath:this.closePath();break;case o.OPS.closeStroke:this.closeStroke();break;case o.OPS.closeFillStroke:this.closeFillStroke();break;case o.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case o.OPS.nextLine:this.nextLine();break;case o.OPS.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.OPS.constructPath:this.constructPath(a[0],a[1]);break;case o.OPS.endPath:this.endPath();break;case 92:this.group(r.items);break;default:(0,o.warn)(`Unimplemented operator ${t}`)}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,r,i,o,a,c){const l=this.current;l.textMatrix=l.lineMatrix=[t,r,i,o,a,c],l.textMatrixScale=Math.hypot(t,r),l.x=l.lineX=0,l.y=l.lineY=0,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${pf(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",pf(-l.y)),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtElement.appendChild(l.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=o.IDENTITY_MATRIX,t.lineMatrix=o.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,r){const i=this.current;i.x=i.lineX+=t,i.y=i.lineY+=r,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${pf(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",pf(-i.y))}showText(r){const a=this.current,c=a.font,l=a.fontSize;if(0===l)return;const u=a.fontSizeScale,d=a.charSpacing,h=a.wordSpacing,p=a.fontDirection,g=a.textHScale*p,m=c.vertical,y=m?1:-1,v=c.defaultVMetrics,_=l*a.fontMatrix[0];let A=0;for(const t of r){if(null===t){A+=p*h;continue}if((0,o.isNum)(t)){A+=y*t*l/1e3;continue}const r=(t.isSpace?h:0)+d,i=t.fontChar;let g,b,S,C=t.width;if(m){let r;const i=t.vmetric||v;r=t.vmetric?i[1]:.5*C,r=-r*_;const o=i[2]*_;C=i?-i[0]:C,g=r/u,b=(A+o)/u}else g=A/u,b=0;(t.isInFont||c.missingFile)&&(a.xcoords.push(a.x+g),m&&a.ycoords.push(-a.y+b),a.tspan.textContent+=i),S=m?C*_-r*p:C*_+r*p,A+=S}a.tspan.setAttributeNS(null,"x",a.xcoords.map(pf).join(" ")),m?a.tspan.setAttributeNS(null,"y",a.ycoords.map(pf).join(" ")):a.tspan.setAttributeNS(null,"y",pf(-a.y)),m?a.y-=A:a.x+=A*g,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${pf(a.fontSize)}px`),a.fontStyle!==t.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==t.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const b=a.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;if(b===o.TextRenderingMode.FILL||b===o.TextRenderingMode.FILL_STROKE?(a.fillColor!==t.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===o.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),b===o.TextRenderingMode.STROKE||b===o.TextRenderingMode.FILL_STROKE){const t=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,t)}let S=a.textMatrix;0!==a.textRise&&(S=S.slice(),S[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${pm(S)} scale(${pf(g)}, -1)`),a.txtElement.setAttributeNS(i,"xml:space","preserve"),a.txtElement.appendChild(a.tspan),a.txtgrp.appendChild(a.txtElement),this._ensureTransformGroup().appendChild(a.txtElement)}setLeadingMoveText(t,r){this.setLeading(-r),this.moveText(t,r)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const r=(0,o.createObjectURL)(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${r}); }\n`}setFont(t){const r=this.current,i=this.commonObjs.get(t[0]);let a=t[1];r.font=i,!this.embedFonts||i.missingFile||this.embeddedFonts[i.loadedName]||(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),r.fontMatrix=i.fontMatrix||o.FONT_IDENTITY_MATRIX;let c="normal";i.black?c="900":i.bold&&(c="bold");const l=i.italic?"italic":"normal";a<0?(a=-a,r.fontDirection=-1):r.fontDirection=1,r.fontSize=a,r.fontFamily=i.loadedName,r.fontWeight=c,r.fontStyle=l,r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"y",pf(-r.y)),r.xcoords=[],r.ycoords=[]}endText(){const t=this.current;t.textRenderingMode&o.TextRenderingMode.ADD_TO_PATH_FLAG&&t.txtElement?.hasChildNodes()&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=d[t]}setLineJoin(t){this.current.lineJoin=h[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,r,i){this.current.strokeColor=o.Util.makeHexColor(t,r,i)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,r,i){this.current.fillColor=o.Util.makeHexColor(t,r,i),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const r=this.viewport.width,i=this.viewport.height,a=o.Util.inverseTransform(this.transformMatrix),c=o.Util.applyTransform([0,0],a),l=o.Util.applyTransform([0,i],a),u=o.Util.applyTransform([r,0],a),d=o.Util.applyTransform([r,i],a),h=Math.min(c[0],l[0],u[0],d[0]),p=Math.min(c[1],l[1],u[1],d[1]),g=Math.max(c[0],l[0],u[0],d[0]),m=Math.max(c[1],l[1],u[1],d[1]),y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",h),y.setAttributeNS(null,"y",p),y.setAttributeNS(null,"width",g-h),y.setAttributeNS(null,"height",m-p),y.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(y)}_makeColorN_Pattern(t){return"TilingPattern"===t[0]?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const r=t[1],i=t[2],a=t[3]||o.IDENTITY_MATRIX,[c,l,u,d]=t[4],h=t[5],p=t[6],g=t[7],m="shading"+y++,[v,_,A,b]=o.Util.normalizeRect([...o.Util.applyTransform([c,l],a),...o.Util.applyTransform([u,d],a)]),[S,C]=o.Util.singularValueDecompose2dScale(a),w=h*S,P=p*C,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",m),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",w),x.setAttributeNS(null,"height",P),x.setAttributeNS(null,"x",`${v}`),x.setAttributeNS(null,"y",`${_}`);const k=this.svg,T=this.transformMatrix,R=this.current.fillColor,E=this.current.strokeColor,I=this.svgFactory.create(A-v,b-_);if(this.svg=I,this.transformMatrix=a,2===g){const t=o.Util.makeHexColor(...r);this.current.fillColor=t,this.current.strokeColor=t}return this.executeOpTree(this.convertOpList(i)),this.svg=k,this.transformMatrix=T,this.current.fillColor=R,this.current.strokeColor=E,x.appendChild(I.childNodes[0]),this.defs.appendChild(x),`url(#${m})`}_makeShadingPattern(t){switch(t[0]){case"RadialAxial":const r="shading"+y++,i=t[3];let a;switch(t[1]){case"axial":const i=t[4],o=t[5];a=this.svgFactory.createElement("svg:linearGradient"),a.setAttributeNS(null,"id",r),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"x1",i[0]),a.setAttributeNS(null,"y1",i[1]),a.setAttributeNS(null,"x2",o[0]),a.setAttributeNS(null,"y2",o[1]);break;case"radial":const c=t[4],l=t[5],u=t[6],d=t[7];a=this.svgFactory.createElement("svg:radialGradient"),a.setAttributeNS(null,"id",r),a.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),a.setAttributeNS(null,"cx",l[0]),a.setAttributeNS(null,"cy",l[1]),a.setAttributeNS(null,"r",d),a.setAttributeNS(null,"fx",c[0]),a.setAttributeNS(null,"fy",c[1]),a.setAttributeNS(null,"fr",u);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const t of i){const r=this.svgFactory.createElement("svg:stop");r.setAttributeNS(null,"offset",t[0]),r.setAttributeNS(null,"stop-color",t[1]),a.appendChild(r)}return this.defs.appendChild(a),`url(#${r})`;case"Mesh":return(0,o.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,r){this.current.dashArray=t,this.current.dashPhase=r}constructPath(t,r){const i=this.current;let a=i.x,c=i.y,l=[],u=0;for(const i of t)switch(0|i){case o.OPS.rectangle:a=r[u++],c=r[u++];const t=a+r[u++],i=c+r[u++];l.push("M",pf(a),pf(c),"L",pf(t),pf(c),"L",pf(t),pf(i),"L",pf(a),pf(i),"Z");break;case o.OPS.moveTo:a=r[u++],c=r[u++],l.push("M",pf(a),pf(c));break;case o.OPS.lineTo:a=r[u++],c=r[u++],l.push("L",pf(a),pf(c));break;case o.OPS.curveTo:a=r[u+4],c=r[u+5],l.push("C",pf(r[u]),pf(r[u+1]),pf(r[u+2]),pf(r[u+3]),pf(a),pf(c)),u+=6;break;case o.OPS.curveTo2:l.push("C",pf(a),pf(c),pf(r[u]),pf(r[u+1]),pf(r[u+2]),pf(r[u+3])),a=r[u+2],c=r[u+3],u+=4;break;case o.OPS.curveTo3:a=r[u+2],c=r[u+3],l.push("C",pf(r[u]),pf(r[u+1]),pf(a),pf(c),pf(a),pf(c)),u+=4;break;case o.OPS.closePath:l.push("Z")}l=l.join(" "),i.path&&t.length>0&&t[0]!==o.OPS.rectangle&&t[0]!==o.OPS.moveTo?l=i.path.getAttributeNS(null,"d")+l:(i.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(i.path)),i.path.setAttributeNS(null,"d",l),i.path.setAttributeNS(null,"fill","none"),i.element=i.path,i.setCurrentPoint(a,c)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element)return void(this.pendingClip=null);const r="clippath"+g++,i=this.svgFactory.createElement("svg:clipPath");i.setAttributeNS(null,"id",r),i.setAttributeNS(null,"transform",pm(this.transformMatrix));const o=t.element.cloneNode(!0);if("evenodd"===this.pendingClip?o.setAttributeNS(null,"clip-rule","evenodd"):o.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,i.appendChild(o),this.defs.appendChild(i),t.activeClipUrl){t.clipGroup=null;for(const t of this.extraStack)t.clipGroup=null;i.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${r})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const r=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",r)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[r,i]of t)switch(r){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i);break;case"CA":this.setStrokeAlpha(i);break;case"ca":this.setFillAlpha(i);break;default:(0,o.warn)(`Unimplemented graphic state operator ${r}`)}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,r=1){const i=this.current;let o=i.dashArray;1!==r&&o.length>0&&(o=o.map((function(t){return r*t}))),t.setAttributeNS(null,"stroke",i.strokeColor),t.setAttributeNS(null,"stroke-opacity",i.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",pf(i.miterLimit)),t.setAttributeNS(null,"stroke-linecap",i.lineCap),t.setAttributeNS(null,"stroke-linejoin",i.lineJoin),t.setAttributeNS(null,"stroke-width",pf(r*i.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",o.map(pf).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",pf(r*i.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(t)}paintImageXObject(t){const r=t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t);r?this.paintInlineImageXObject(r):(0,o.warn)(`Dependent image with object ID ${t} is not ready yet`)}paintInlineImageXObject(t,r){const i=t.width,o=t.height,a=p(t,this.forceDataSchema,!!r),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width",pf(i)),c.setAttributeNS(null,"height",pf(o)),this.current.element=c,this.clip("nonzero");const l=this.svgFactory.createElement("svg:image");l.setAttributeNS(u,"xlink:href",a),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",pf(-o)),l.setAttributeNS(null,"width",pf(i)+"px"),l.setAttributeNS(null,"height",pf(o)+"px"),l.setAttributeNS(null,"transform",`scale(${pf(1/i)} ${pf(-1/o)})`),r?r.appendChild(l):this._ensureTransformGroup().appendChild(l)}paintImageMaskXObject(t){const r=this.current,i=t.width,o=t.height,a=r.fillColor;r.maskId="mask"+m++;const c=this.svgFactory.createElement("svg:mask");c.setAttributeNS(null,"id",r.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",pf(i)),l.setAttributeNS(null,"height",pf(o)),l.setAttributeNS(null,"fill",a),l.setAttributeNS(null,"mask",`url(#${r.maskId})`),this.defs.appendChild(c),this._ensureTransformGroup().appendChild(l),this.paintInlineImageXObject(t,c)}paintFormXObjectBegin(t,r){if(Array.isArray(t)&&6===t.length&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),r){const t=r[2]-r[0],i=r[3]-r[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",r[0]),o.setAttributeNS(null,"y",r[1]),o.setAttributeNS(null,"width",pf(t)),o.setAttributeNS(null,"height",pf(i)),this.current.element=o,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const r=this.svgFactory.create(t.width,t.height),i=this.svgFactory.createElement("svg:defs");r.appendChild(i),this.defs=i;const o=this.svgFactory.createElement("svg:g");return o.setAttributeNS(null,"transform",pm(t.transform)),r.appendChild(o),this.svg=o,r}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;r.XfaLayer=class XfaLayer{static setupStorage(t,r,i,o,a){const c=o.getValue(r,{value:null});switch(i.name){case"textarea":if(null!==c.value&&(t.textContent=c.value),"print"===a)break;t.addEventListener("input",(t=>{o.setValue(r,{value:t.target.value})}));break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(c.value===i.attributes.xfaOn&&t.setAttribute("checked",!0),"print"===a)break;t.addEventListener("change",(t=>{o.setValue(r,{value:t.target.getAttribute("xfaOn")})}))}else{if(null!==c.value&&t.setAttribute("value",c.value),"print"===a)break;t.addEventListener("input",(t=>{o.setValue(r,{value:t.target.value})}))}break;case"select":if(null!==c.value)for(const t of i.children)t.attributes.value===c.value&&(t.attributes.selected=!0);t.addEventListener("input",(t=>{const i=t.target.options,a=-1===i.selectedIndex?"":i[i.selectedIndex].value;o.setValue(r,{value:a})}))}}static setAttributes(t,r,i,o){const{attributes:a}=r;"radio"===a.type&&(a.name=`${a.name}-${o}`);for(const[r,i]of Object.entries(a))null!=i&&"dataId"!==r&&("style"!==r?"textContent"===r?t.textContent=i:"class"===r?t.setAttribute(r,i.join(" ")):t.setAttribute(r,i):Object.assign(t.style,i));i&&a.dataId&&this.setupStorage(t,a.dataId,r,i)}static render(t){const r=t.annotationStorage,i=t.xfa,o=t.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes(a,i);const c=[[i,-1,a]],l=t.div;l.appendChild(a);const u=`matrix(${t.viewport.transform.join(",")})`;for(l.style.transform=u,l.setAttribute("class","xfaLayer xfaFont");c.length>0;){const[t,i,a]=c[c.length-1];if(i+1===t.children.length){c.pop();continue}const l=t.children[++c[c.length-1][1]];if(null===l)continue;const{name:u}=l;if("#text"===u){a.appendChild(document.createTextNode(l.value));continue}let d;d=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,u):document.createElement(u),a.appendChild(d),l.attributes&&this.setAttributes(d,l,r,o),l.children&&l.children.length>0?c.push([l,-1,d]):l.value&&d.appendChild(document.createTextNode(l.value))}for(const t of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0)}static update(t){const r=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=r,t.div.hidden=!1}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var o=i(2),a=i(23);const c=__webpack_require__(172),l=__webpack_require__(1),u=__webpack_require__(779),d=__webpack_require__(558),h=/^file:\/\/\/[a-zA-Z]:\//;r.PDFNodeStream=class PDFNodeStream{constructor(t){this.source=t,this.url=function parseUrl(t){const r=d.parse(t);return"file:"===r.protocol||r.host?r:/^[a-z]:[/\\]/i.test(t)?d.parse(`file:///${t}`):(r.host||(r.protocol="file:"),r)}(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this),this._fullRequestReader}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,t,r):new PDFNodeStreamRangeReader(this,t,r);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class BaseFullReader{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=t.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)(),this._headersCapability=(0,o.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=(0,o.createPromiseCapability)(),this.read();this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class BaseRangeReader{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)();const r=t.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=(0,o.createPromiseCapability)(),this.read();this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}function createRequestOptions(t,r){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:r}}class PDFNodeStreamFullReader extends BaseFullReader{constructor(t){super(t);const handleResponse=r=>{if(404===r.statusCode){const t=new o.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(r);const getResponseHeader=t=>this._readableStream.headers[t.toLowerCase()],{allowRangeRequests:i,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader)};this._request=null,"http:"===this._url.protocol?this._request=l.request(createRequestOptions(this._url,t.httpHeaders),handleResponse):this._request=u.request(createRequestOptions(this._url,t.httpHeaders),handleResponse),this._request.on("error",(t=>{this._storedError=t,this._headersCapability.reject(t)})),this._request.end()}}class PDFNodeStreamRangeReader extends BaseRangeReader{constructor(t,r,i){super(t),this._httpHeaders={};for(const r in t.httpHeaders){const i=t.httpHeaders[r];void 0!==i&&(this._httpHeaders[r]=i)}this._httpHeaders.Range=`bytes=${r}-${i-1}`;const handleResponse=t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=t}};this._request=null,"http:"===this._url.protocol?this._request=l.request(createRequestOptions(this._url,this._httpHeaders),handleResponse):this._request=u.request(createRequestOptions(this._url,this._httpHeaders),handleResponse),this._request.on("error",(t=>{this._storedError=t})),this._request.end()}}class PDFNodeStreamFsFullReader extends BaseFullReader{constructor(t){super(t);let r=decodeURIComponent(this._url.path);h.test(this._url.href)&&(r=r.replace(/^\//,"")),c.lstat(r,((t,i)=>{if(t)return"ENOENT"===t.code&&(t=new o.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=t,void this._headersCapability.reject(t);this._contentLength=i.size,this._setReadableStream(c.createReadStream(r)),this._headersCapability.resolve()}))}}class PDFNodeStreamFsRangeReader extends BaseRangeReader{constructor(t,r,i){super(t);let o=decodeURIComponent(this._url.path);h.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(c.createReadStream(o,{start:r,end:i-1}))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=function createResponseStatusError(t,r){if(404===t||0===t&&r.startsWith("file:"))return new o.MissingPDFException('Missing PDF "'+r+'".');return new o.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${r}".`,t)},r.extractFilenameFromHeader=function extractFilenameFromHeader(t){const r=t("Content-Disposition");if(r){let t=(0,a.getFilenameFromContentDispositionHeader)(r);if(t.includes("%"))try{t=decodeURIComponent(t)}catch(t){}if((0,c.isPdfFile)(t))return t}return null},r.validateRangeRequestCapabilities=function validateRangeRequestCapabilities({getResponseHeader:t,isHttp:r,rangeChunkSize:i,disableRange:a}){(0,o.assert)(i>0,"Range chunk size must be larger than zero");const c={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(t("Content-Length"),10);if(!Number.isInteger(l))return c;if(c.suggestedLength=l,l<=2*i)return c;if(a||!r)return c;if("bytes"!==t("Accept-Ranges"))return c;if("identity"!==(t("Content-Encoding")||"identity"))return c;return c.allowRangeRequests=!0,c},r.validateResponseStatus=function validateResponseStatus(t){return 200===t||206===t};var o=i(2),a=i(24),c=i(1)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=function getFilenameFromContentDispositionHeader(t){let r=!0,i=toParamRegExp("filename\\*","i").exec(t);if(i){i=i[1];let t=rfc2616unquote(i);return t=unescape(t),t=rfc5987decode(t),t=rfc2047decode(t),fixupEncoding(t)}if(i=function rfc2231getparam(t){const r=[];let i;const o=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(i=o.exec(t));){let[,t,o,a]=i;if(t=parseInt(t,10),t in r){if(0===t)break}else r[t]=[o,a]}const a=[];for(let t=0;t<r.length&&t in r;++t){let[i,o]=r[t];o=rfc2616unquote(o),i&&(o=unescape(o),0===t&&(o=rfc5987decode(o))),a.push(o)}return a.join("")}(t),i){return fixupEncoding(rfc2047decode(i))}if(i=toParamRegExp("filename","i").exec(t),i){i=i[1];let t=rfc2616unquote(i);return t=rfc2047decode(t),fixupEncoding(t)}function toParamRegExp(t,r){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function textdecode(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const a=new TextDecoder(t,{fatal:!0}),c=(0,o.stringToBytes)(i);i=a.decode(c),r=!1}catch(o){if(/^utf-?8$/i.test(t))try{i=decodeURIComponent(escape(i)),r=!1}catch(t){}}}return i}function fixupEncoding(t){return r&&/[\x80-\xff]/.test(t)&&(t=textdecode("utf-8",t),r&&(t=textdecode("iso-8859-1",t))),t}function rfc2616unquote(t){if(t.startsWith('"')){const r=t.slice(1).split('\\"');for(let t=0;t<r.length;++t){const i=r[t].indexOf('"');-1!==i&&(r[t]=r[t].slice(0,i),r.length=t+1),r[t]=r[t].replace(/\\(.)/g,"$1")}t=r.join('"')}return t}function rfc5987decode(t){const r=t.indexOf("'");if(-1===r)return t;return textdecode(t.slice(0,r),t.slice(r+1).replace(/^[^']*'/,""))}function rfc2047decode(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,r,i,o){if("q"===i||"Q"===i)return textdecode(r,o=(o=o.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(t,r){return String.fromCharCode(parseInt(r,16))})));try{o=atob(o)}catch(t){}return textdecode(r,o)}))}return""};var o=i(2)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var o=i(2),a=i(23);class NetworkManager{constructor(t,r){this.url=t,r=r||{},this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&r.httpHeaders||{},this.withCredentials=r.withCredentials||!1,this.getXhr=r.getXhr||function NetworkManager_getXhr(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,r,i){const o={begin:t,end:r};for(const t in i)o[t]=i[t];return this.request(o)}requestFull(t){return this.request(t)}request(t){const r=this.getXhr(),i=this.currXhrId++,o=this.pendingRequests[i]={xhr:r};r.open("GET",this.url),r.withCredentials=this.withCredentials;for(const t in this.httpHeaders){const i=this.httpHeaders[t];void 0!==i&&r.setRequestHeader(t,i)}return this.isHttp&&"begin"in t&&"end"in t?(r.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),o.expectedStatus=206):o.expectedStatus=200,r.responseType="arraybuffer",t.onError&&(r.onerror=function(i){t.onError(r.status)}),r.onreadystatechange=this.onStateChange.bind(this,i),r.onprogress=this.onProgress.bind(this,i),o.onHeadersReceived=t.onHeadersReceived,o.onDone=t.onDone,o.onError=t.onError,o.onProgress=t.onProgress,r.send(null),i}onProgress(t,r){const i=this.pendingRequests[t];i&&i.onProgress&&i.onProgress(r)}onStateChange(t,r){const i=this.pendingRequests[t];if(!i)return;const a=i.xhr;if(a.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==a.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===a.status&&this.isHttp)return void(i.onError&&i.onError(a.status));const c=a.status||200;if(!(200===c&&206===i.expectedStatus)&&c!==i.expectedStatus)return void(i.onError&&i.onError(a.status));const l=function getArrayBuffer(t){const r=t.response;return"string"!=typeof r?r:(0,o.stringToBytes)(r).buffer}(a);if(206===c){const t=a.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);i.onDone({begin:parseInt(r[1],10),chunk:l})}else l?i.onDone({begin:0,chunk:l}):i.onError&&i.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const r=this.pendingRequests[t].xhr;delete this.pendingRequests[t],r.abort()}}r.PDFNetworkStream=class PDFNetworkStream{constructor(t){this._source=t,this._manager=new NetworkManager(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const r=this._rangeRequestReaders.indexOf(t);r>=0&&this._rangeRequestReaders.splice(r,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}getRangeReader(t,r){const i=new PDFNetworkStreamRangeRequestReader(this._manager,t,r);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class PDFNetworkStreamFullRequestReader{constructor(t,r){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=r.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._contentLength=r.length,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,r=this._manager.getRequestXhr(t),getResponseHeader=t=>r.getResponseHeader(t),{allowRangeRequests:i,suggestedLength:o}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){this._requests.shift().resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){const r=this._url,i=(0,a.createResponseStatusError)(t,r);this._storedError=i,this._headersReceivedCapability.reject(i);for(const t of this._requests)t.reject(i);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress&&this.onProgress({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class PDFNetworkStreamRangeRequestReader{constructor(t,r,i){this._manager=t;const o={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=t.requestRange(r,i,o),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(t){const r=t.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:r,done:!1})}else this._queuedChunk=r;this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onProgress(t){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,o.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var o=i(2),a=i(23);function createFetchOptions(t,r,i){return{method:"GET",headers:t,signal:i?.signal,mode:"cors",credentials:r?"include":"same-origin",redirect:"follow"}}function createHeaders(t){const r=new Headers;for(const i in t){const o=t[i];void 0!==o&&r.append(i,o)}return r}r.PDFFetchStream=class PDFFetchStream{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}getRangeReader(t,r){if(r<=this._progressiveDataLength)return null;const i=new PDFFetchStreamRangeReader(this,t,r);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader&&this._fullRequestReader.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}};class PDFFetchStreamReader{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const r=t.source;this._withCredentials=r.withCredentials||!1,this._contentLength=r.length,this._headersCapability=(0,o.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._headers=createHeaders(this._stream.httpHeaders);const i=r.url;fetch(i,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const getResponseHeader=r=>t.headers.get(r),{allowRangeRequests:r,suggestedLength:c}=(0,a.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=c||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(getResponseHeader),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:r}=await this._reader.read();if(r)return{value:t,done:r};this._loaded+=t.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}}class PDFFetchStreamRangeReader{constructor(t,r,i){this._stream=t,this._reader=null,this._loaded=0;const c=t.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,o.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=createHeaders(this._stream.httpHeaders),this._headers.append("Range",`bytes=${r}-${i-1}`);const l=c.url;fetch(l,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,l);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch((t=>{if("AbortError"!==t?.name)throw t})),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:r}=await this._reader.read();if(r)return{value:t,done:r};this._loaded+=t.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(t){var r=__webpack_module_cache__[t];if(void 0!==r)return r.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](i,i.exports,__w_pdfjs_require__),i.exports}var __webpack_exports__={};return(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLinkAttributes",{enumerable:!0,get:function(){return r.addLinkAttributes}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(t,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(t,"LinkTarget",{enumerable:!0,get:function(){return r.LinkTarget}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(t,"LoopbackPort",{enumerable:!0,get:function(){return i.LoopbackPort}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return i.version}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(t,"createObjectURL",{enumerable:!0,get:function(){return o.createObjectURL}}),Object.defineProperty(t,"createPromiseCapability",{enumerable:!0,get:function(){return o.createPromiseCapability}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(t,"removeNullCharacters",{enumerable:!0,get:function(){return o.removeNullCharacters}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(t,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return o.UNSUPPORTED_FEATURES}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return d.SVGGraphics}}),Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return h.XfaLayer}});var r=__w_pdfjs_require__(1),i=__w_pdfjs_require__(6),o=__w_pdfjs_require__(2),a=__w_pdfjs_require__(17),c=__w_pdfjs_require__(12),l=__w_pdfjs_require__(4),u=__w_pdfjs_require__(19),d=__w_pdfjs_require__(20),h=__w_pdfjs_require__(21);if(l.isNodeJS){const{PDFNodeStream:t}=__w_pdfjs_require__(22);(0,i.setPDFNetworkStreamFactory)((r=>new t(r)))}else{const{PDFNetworkStream:t}=__w_pdfjs_require__(25),{PDFFetchStream:o}=__w_pdfjs_require__(26);(0,i.setPDFNetworkStreamFactory)((i=>(0,r.isValidFetchUrl)(i.url)?new o(i):new t(i)))}})(),__webpack_exports__})()}))},963:function(t,r,i){!function webpackUniversalModuleDefinition(r,i){t.exports=i()}(0,(function(){return(()=>{"use strict";var t=[,(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultAnnotationLayerFactory=r.AnnotationLayerBuilder=void 0;var o=i(2),a=i(3),c=i(4);class AnnotationLayerBuilder{constructor({pageDiv:t,pdfPage:r,linkService:i,downloadManager:o,annotationStorage:c=null,imageResourcesPath:l="",renderInteractiveForms:u=!0,l10n:d=a.NullL10n,enableScripting:h=!1,hasJSActionsPromise:p=null,mouseState:g=null}){this.pageDiv=t,this.pdfPage=r,this.linkService=i,this.downloadManager=o,this.imageResourcesPath=l,this.renderInteractiveForms=u,this.l10n=d,this.annotationStorage=c,this.enableScripting=h,this._hasJSActionsPromise=p,this._mouseState=g,this.div=null,this._cancelled=!1}render(t,r="display"){return Promise.all([this.pdfPage.getAnnotations({intent:r}),this._hasJSActionsPromise]).then((([r,i=!1])=>{if(this._cancelled)return;if(0===r.length)return;const a={viewport:t.clone({dontFlip:!0}),div:this.div,annotations:r,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderInteractiveForms:this.renderInteractiveForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:i,mouseState:this._mouseState};this.div?o.AnnotationLayer.update(a):(this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.appendChild(this.div),a.div=this.div,o.AnnotationLayer.render(a),this.l10n.translate(this.div))}))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}r.AnnotationLayerBuilder=AnnotationLayerBuilder;r.DefaultAnnotationLayerFactory=class DefaultAnnotationLayerFactory{createAnnotationLayerBuilder(t,r,i=null,o="",l=!0,u=a.NullL10n,d=!1,h=null,p=null){return new AnnotationLayerBuilder({pageDiv:t,pdfPage:r,imageResourcesPath:o,renderInteractiveForms:l,linkService:new c.SimpleLinkService,l10n:u,annotationStorage:i,enableScripting:d,hasJSActionsPromise:h,mouseState:p})}}},t=>{let r;r="undefined"!=typeof window&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:i(299),t.exports=r},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fixupLangCode=function fixupLangCode(t){return o[t?.toLowerCase()]||t},r.getL10nFallback=getL10nFallback,r.NullL10n=void 0;const i={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading…",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts."};function getL10nFallback(t,r){switch(t){case"find_match_count":t=`find_match_count[${1===r.total?"one":"other"}]`;break;case"find_match_count_limit":t=`find_match_count_limit[${1===r.limit?"one":"other"}]`}return i[t]||""}const o={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};const a={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(t,r=null,i=getL10nFallback(t,r))=>function formatL10nValue(t,r){return r?t.replace(/\{\{\s*(\w+)\s*\}\}/g,((t,i)=>i in r?r[i]:"{{"+i+"}}")):t}(i,r),async translate(t){}};r.NullL10n=a},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SimpleLinkService=r.PDFLinkService=void 0;var o=i(5);r.PDFLinkService=class PDFLinkService{constructor({eventBus:t,externalLinkTarget:r=null,externalLinkRel:i=null,ignoreDestinationZoom:o=!1}={}){this.eventBus=t,this.externalLinkTarget=r,this.externalLinkRel=i,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=o,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null,this._pagesRefCache=null}setDocument(t,r=null){this.baseUrl=r,this.pdfDocument=t,this._pagesRefCache=Object.create(null)}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(t){this.pdfViewer.currentPageNumber=t}get rotation(){return this.pdfViewer.pagesRotation}set rotation(t){this.pdfViewer.pagesRotation=t}_goToDestinationHelper(t,r=null,i){const o=i[0];let a;if("object"==typeof o&&null!==o){if(a=this._cachedPageNumber(o),null===a)return void this.pdfDocument.getPageIndex(o).then((a=>{this.cachePageRef(a+1,o),this._goToDestinationHelper(t,r,i)})).catch((()=>{console.error(`PDFLinkService._goToDestinationHelper: "${o}" is not a valid page reference, for dest="${t}".`)}))}else{if(!Number.isInteger(o))return void console.error(`PDFLinkService._goToDestinationHelper: "${o}" is not a valid destination reference, for dest="${t}".`);a=o+1}!a||a<1||a>this.pagesCount?console.error(`PDFLinkService._goToDestinationHelper: "${a}" is not a valid page number, for dest="${t}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:r,explicitDest:i,pageNumber:a})),this.pdfViewer.scrollPageIntoView({pageNumber:a,destArray:i,ignoreDestinationZoom:this._ignoreDestinationZoom}))}async goToDestination(t){if(!this.pdfDocument)return;let r,i;"string"==typeof t?(r=t,i=await this.pdfDocument.getDestination(t)):(r=null,i=await t),Array.isArray(i)?this._goToDestinationHelper(t,r,i):console.error(`PDFLinkService.goToDestination: "${i}" is not a valid destination array, for dest="${t}".`)}goToPage(t){if(!this.pdfDocument)return;const r="string"==typeof t&&this.pdfViewer.pageLabelToPageNumber(t)||0|t;Number.isInteger(r)&&r>0&&r<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(r)),this.pdfViewer.scrollPageIntoView({pageNumber:r})):console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`)}getDestinationHash(t){if("string"==typeof t){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const r=JSON.stringify(t);if(r.length>0)return this.getAnchorUrl("#"+escape(r))}return this.getAnchorUrl("")}getAnchorUrl(t){return(this.baseUrl||"")+t}setHash(t){if(!this.pdfDocument)return;let r,i;if(t.includes("=")){const a=(0,o.parseQueryString)(t);if("search"in a&&this.eventBus.dispatch("findfromurlhash",{source:this,query:a.search.replace(/"/g,""),phraseSearch:"true"===a.phrase}),"page"in a&&(r=0|a.page||1),"zoom"in a){const t=a.zoom.split(","),r=t[0],o=parseFloat(r);r.includes("Fit")?"Fit"===r||"FitB"===r?i=[null,{name:r}]:"FitH"===r||"FitBH"===r||"FitV"===r||"FitBV"===r?i=[null,{name:r},t.length>1?0|t[1]:null]:"FitR"===r?5!==t.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):i=[null,{name:r},0|t[1],0|t[2],0|t[3],0|t[4]]:console.error(`PDFLinkService.setHash: "${r}" is not a valid zoom value.`):i=[null,{name:"XYZ"},t.length>1?0|t[1]:null,t.length>2?0|t[2]:null,o?o/100:r]}i?this.pdfViewer.scrollPageIntoView({pageNumber:r||this.page,destArray:i,allowNegativeOffset:!0}):r&&(this.page=r),"pagemode"in a&&this.eventBus.dispatch("pagemode",{source:this,mode:a.pagemode}),"nameddest"in a&&this.goToDestination(a.nameddest)}else{i=unescape(t);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch(t){}if("string"==typeof i||function isValidExplicitDestination(t){if(!Array.isArray(t))return!1;const r=t.length;if(r<2)return!1;const i=t[0];if(!("object"==typeof i&&Number.isInteger(i.num)&&Number.isInteger(i.gen)||Number.isInteger(i)&&i>=0))return!1;const o=t[1];if("object"!=typeof o||"string"!=typeof o.name)return!1;let a=!0;switch(o.name){case"XYZ":if(5!==r)return!1;break;case"Fit":case"FitB":return 2===r;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==r)return!1;break;case"FitR":if(6!==r)return!1;a=!1;break;default:return!1}for(let i=2;i<r;i++){const r=t[i];if(!("number"==typeof r||a&&null===r))return!1}return!0}(i))return void this.goToDestination(i);console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}}executeNamedAction(t){switch(t){case"GoBack":this.pdfHistory&&this.pdfHistory.back();break;case"GoForward":this.pdfHistory&&this.pdfHistory.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:t})}cachePageRef(t,r){if(!r)return;const i=0===r.gen?`${r.num}R`:`${r.num}R${r.gen}`;this._pagesRefCache[i]=t}_cachedPageNumber(t){const r=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this._pagesRefCache?.[r]||null}isPageVisible(t){return this.pdfViewer.isPageVisible(t)}isPageCached(t){return this.pdfViewer.isPageCached(t)}};r.SimpleLinkService=class SimpleLinkService{constructor(){this.externalLinkTarget=null,this.externalLinkRel=null,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=!1}get pagesCount(){return 0}get page(){return 0}set page(t){}get rotation(){return 0}set rotation(t){}async goToDestination(t){}goToPage(t){}getDestinationHash(t){return"#"}getAnchorUrl(t){return"#"}setHash(t){}executeNamedAction(t){}cachePageRef(t,r){}isPageVisible(t){return!0}isPageCached(t){return!0}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.apiPageLayoutToSpreadMode=function apiPageLayoutToSpreadMode(t){switch(t){case"SinglePage":case"OneColumn":return a.NONE;case"TwoColumnLeft":case"TwoPageLeft":return a.ODD;case"TwoColumnRight":case"TwoPageRight":return a.EVEN}return a.NONE},r.apiPageModeToSidebarView=function apiPageModeToSidebarView(t){switch(t){case"UseNone":return i.NONE;case"UseThumbs":return i.THUMBS;case"UseOutlines":return i.OUTLINE;case"UseAttachments":return i.ATTACHMENTS;case"UseOC":return i.LAYERS}return i.NONE},r.approximateFraction=function approximateFraction(t){if(Math.floor(t)===t)return[t,1];const r=1/t;if(r>8)return[1,8];if(Math.floor(r)===r)return[1,r];const i=t>1?r:t;let o,a=0,c=1,l=1,u=1;for(;;){const t=a+l,r=c+u;if(r>8)break;i<=t/r?(l=t,u=r):(a=t,c=r)}o=i-a/c<l/u-i?i===t?[a,c]:[c,a]:i===t?[l,u]:[u,l];return o},r.backtrackBeforeAllVisibleElements=backtrackBeforeAllVisibleElements,r.binarySearchFirstItem=binarySearchFirstItem,r.getActiveOrFocusedElement=function getActiveOrFocusedElement(){let t=document,r=t.activeElement||t.querySelector(":focus");for(;r?.shadowRoot;)t=r.shadowRoot,r=t.activeElement||t.querySelector(":focus");return r},r.getOutputScale=function getOutputScale(t){const r=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.backingStorePixelRatio||1,o=r/i;return{sx:o,sy:o,scaled:1!==o}},r.getPageSizeInches=function getPageSizeInches({view:t,userUnit:r,rotate:i}){const[o,a,c,l]=t,u=i%180!=0,d=(c-o)/72*r,h=(l-a)/72*r;return{width:u?h:d,height:u?d:h}},r.getVisibleElements=function getVisibleElements({scrollEl:t,views:r,sortByVisibility:i=!1,horizontal:o=!1,rtl:a=!1}){const c=t.scrollTop,l=c+t.clientHeight,u=t.scrollLeft,d=u+t.clientWidth;const h=[],p=r.length;let g=binarySearchFirstItem(r,o?function isElementNextAfterViewHorizontally(t){const r=t.div,i=r.offsetLeft+r.clientLeft,o=i+r.clientWidth;return a?i<d:o>u}:function isElementBottomAfterViewTop(t){const r=t.div;return r.offsetTop+r.clientTop+r.clientHeight>c});g>0&&g<p&&!o&&(g=backtrackBeforeAllVisibleElements(g,r,c));let m=o?d:-1;for(let t=g;t<p;t++){const i=r[t],a=i.div,p=a.offsetLeft+a.clientLeft,g=a.offsetTop+a.clientTop,y=a.clientWidth,v=a.clientHeight,_=p+y,A=g+v;if(-1===m)A>=l&&(m=A);else if((o?p:g)>m)break;if(A<=c||g>=l||_<=u||p>=d)continue;const b=Math.max(0,c-g)+Math.max(0,A-l),S=Math.max(0,u-p)+Math.max(0,_-d),C=(y-S)/y,w=(v-b)/v*C*100|0;h.push({id:i.id,x:p,y:g,view:i,percent:w,widthPercent:100*C|0})}const y=h[0],v=h[h.length-1];i&&h.sort((function(t,r){const i=t.percent-r.percent;return Math.abs(i)>.001?-i:t.id-r.id}));return{first:y,last:v,views:h}},r.isPortraitOrientation=function isPortraitOrientation(t){return t.width<=t.height},r.isValidRotation=function isValidRotation(t){return Number.isInteger(t)&&t%90==0},r.isValidScrollMode=function isValidScrollMode(t){return Number.isInteger(t)&&Object.values(o).includes(t)&&t!==o.UNKNOWN},r.isValidSpreadMode=function isValidSpreadMode(t){return Number.isInteger(t)&&Object.values(a).includes(t)&&t!==a.UNKNOWN},r.moveToEndOfArray=function moveToEndOfArray(t,r){const i=[],o=t.length;let a=0;for(let c=0;c<o;++c)r(t[c])?i.push(t[c]):(t[a]=t[c],++a);for(let r=0;a<o;++r,++a)t[a]=i[r]},r.noContextMenuHandler=function noContextMenuHandler(t){t.preventDefault()},r.normalizeWheelEventDelta=function normalizeWheelEventDelta(t){let r=normalizeWheelEventDirection(t);0===t.deltaMode?r/=900:1===t.deltaMode&&(r/=30);return r},r.normalizeWheelEventDirection=normalizeWheelEventDirection,r.parseQueryString=function parseQueryString(t){const r=t.split("&"),i=Object.create(null);for(let t=0,o=r.length;t<o;++t){const o=r[t].split("="),a=o[0].toLowerCase(),c=o.length>1?o[1]:null;i[decodeURIComponent(a)]=decodeURIComponent(c)}return i},r.roundToDivide=function roundToDivide(t,r){const i=t%r;return 0===i?t:Math.round(t-i+r)},r.scrollIntoView=function scrollIntoView(t,r,i=!1){let o=t.offsetParent;if(!o)return void console.error("offsetParent is not set -- cannot scroll");let a=t.offsetTop+t.clientTop,c=t.offsetLeft+t.clientLeft;for(;o.clientHeight===o.scrollHeight&&o.clientWidth===o.scrollWidth||i&&(o.classList.contains("markedContent")||"hidden"===getComputedStyle(o).overflow);)if(a+=o.offsetTop,c+=o.offsetLeft,o=o.offsetParent,!o)return;r&&(void 0!==r.top&&(a+=r.top),void 0!==r.left&&(c+=r.left,o.scrollLeft=c));o.scrollTop=a},r.waitOnEventOrTimeout=function waitOnEventOrTimeout({target:t,name:r,delay:i=0}){return new Promise((function(o,a){if("object"!=typeof t||!r||"string"!=typeof r||!(Number.isInteger(i)&&i>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function handler(i){t instanceof EventBus?t._off(r,l):t.removeEventListener(r,l),d&&clearTimeout(d),o(i)}const l=handler.bind(null,c.EVENT);t instanceof EventBus?t._on(r,l):t.addEventListener(r,l);const u=handler.bind(null,c.TIMEOUT),d=setTimeout(u,i)}))},r.watchScroll=function watchScroll(t,r){const debounceScroll=function(a){o||(o=window.requestAnimationFrame((function viewAreaElementScrolled(){o=null;const a=t.scrollLeft,c=i.lastX;a!==c&&(i.right=a>c),i.lastX=a;const l=t.scrollTop,u=i.lastY;l!==u&&(i.down=l>u),i.lastY=l,r(i)})))},i={right:!0,down:!0,lastX:t.scrollLeft,lastY:t.scrollTop,_eventHandler:debounceScroll};let o=null;return t.addEventListener("scroll",debounceScroll,!0),i},r.WaitOnType=r.VERTICAL_PADDING=r.UNKNOWN_SCALE=r.TextLayerMode=r.SpreadMode=r.SidebarView=r.ScrollMode=r.SCROLLBAR_PADDING=r.RendererType=r.ProgressBar=r.PresentationModeState=r.MIN_SCALE=r.MAX_SCALE=r.MAX_AUTO_SCALE=r.EventBus=r.DEFAULT_SCALE_VALUE=r.DEFAULT_SCALE=r.CSS_UNITS=r.AutoPrintRegExp=r.animationStarted=void 0;r.CSS_UNITS=96/72;r.DEFAULT_SCALE_VALUE="auto";r.DEFAULT_SCALE=1;r.MIN_SCALE=.1;r.MAX_SCALE=10;r.UNKNOWN_SCALE=0;r.MAX_AUTO_SCALE=1.25;r.SCROLLBAR_PADDING=40;r.VERTICAL_PADDING=5;r.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const i={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};r.SidebarView=i;r.RendererType={CANVAS:"canvas",SVG:"svg"};r.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};const o={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2};r.ScrollMode=o;const a={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};r.SpreadMode=a;function binarySearchFirstItem(t,r){let i=0,o=t.length-1;if(o<0||!r(t[o]))return t.length;if(r(t[i]))return i;for(;i<o;){const a=i+o>>1;r(t[a])?o=a:i=a+1}return i}function backtrackBeforeAllVisibleElements(t,r,i){if(t<2)return t;let o=r[t].div,a=o.offsetTop+o.clientTop;a>=i&&(o=r[t-1].div,a=o.offsetTop+o.clientTop);for(let i=t-2;i>=0&&(o=r[i].div,!(o.offsetTop+o.clientTop+o.clientHeight<=a));--i)t=i;return t}function normalizeWheelEventDirection(t){let r=Math.hypot(t.deltaX,t.deltaY);const i=Math.atan2(t.deltaY,t.deltaX);return-.25*Math.PI<i&&i<.75*Math.PI&&(r=-r),r}r.AutoPrintRegExp=/\bprint\s*\(/;const c={EVENT:"event",TIMEOUT:"timeout"};r.WaitOnType=c;const l=new Promise((function(t){window.requestAnimationFrame(t)}));r.animationStarted=l;class EventBus{constructor(t){this._listeners=Object.create(null)}on(t,r,i=null){this._on(t,r,{external:!0,once:i?.once})}off(t,r,i=null){this._off(t,r,{external:!0,once:i?.once})}dispatch(t){const r=this._listeners[t];if(!r||0===r.length)return;const i=Array.prototype.slice.call(arguments,1);let o;for(const{listener:a,external:c,once:l}of r.slice(0))l&&this._off(t,a),c?(o||(o=[])).push(a):a.apply(null,i);if(o){for(const t of o)t.apply(null,i);o=null}}_on(t,r,i=null){var o;((o=this._listeners)[t]||(o[t]=[])).push({listener:r,external:!0===i?.external,once:!0===i?.once})}_off(t,r,i=null){const o=this._listeners[t];if(o)for(let t=0,i=o.length;t<i;t++)if(o[t].listener===r)return void o.splice(t,1)}}r.EventBus=EventBus;r.ProgressBar=class ProgressBar{constructor(t,{height:r,width:i,units:o}={}){this.visible=!0,this.div=document.querySelector(t+" .progress"),this.bar=this.div.parentNode,this.height=r||100,this.width=i||100,this.units=o||"%",this.div.style.height=this.height+this.units,this.percent=0}_updateBar(){if(this._indeterminate)return this.div.classList.add("indeterminate"),void(this.div.style.width=this.width+this.units);this.div.classList.remove("indeterminate");const t=this.width*this._percent/100;this.div.style.width=t+this.units}get percent(){return this._percent}set percent(t){this._indeterminate=isNaN(t),this._percent=function clamp(t,r,i){return Math.min(Math.max(t,r),i)}(t,0,100),this._updateBar()}setWidth(t){if(!t)return;const r=t.parentNode.offsetWidth-t.offsetWidth;if(r>0){document.documentElement.style.setProperty("--loadingBar-end-offset",`${r}px`)}}hide(){this.visible&&(this.visible=!1,this.bar.classList.add("hidden"))}show(){this.visible||(this.visible=!0,this.bar.classList.remove("hidden"))}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerBuilder=r.DefaultTextLayerFactory=void 0;var o=i(2);class TextLayerBuilder{constructor({textLayerDiv:t,eventBus:r,pageIndex:i,viewport:o,findController:a=null,enhanceTextSelection:c=!1}){this.textLayerDiv=t,this.eventBus=r,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageIdx=i,this.pageNumber=this.pageIdx+1,this.matches=[],this.viewport=o,this.textDivs=[],this.findController=a,this.textLayerRenderTask=null,this.enhanceTextSelection=c,this._onUpdateTextLayerMatches=null,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const t=document.createElement("div");t.className="endOfContent",this.textLayerDiv.appendChild(t)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(t=0){if(!this.textContent&&!this.textContentStream||this.renderingDone)return;this.cancel(),this.textDivs=[];const r=document.createDocumentFragment();this.textLayerRenderTask=(0,o.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:r,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:t,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then((()=>{this.textLayerDiv.appendChild(r),this._finishRendering(),this._updateMatches()}),(function(t){})),this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=t=>{t.pageIndex!==this.pageIdx&&-1!==t.pageIndex||this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches))}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null)}setTextContentStream(t){this.cancel(),this.textContentStream=t}setTextContent(t){this.cancel(),this.textContent=t}_convertMatches(t,r){if(!t)return[];const{textContentItemsStr:i}=this;let o=0,a=0;const c=i.length-1,l=[];for(let u=0,d=t.length;u<d;u++){let d=t[u];for(;o!==c&&d>=a+i[o].length;)a+=i[o].length,o++;o===i.length&&console.error("Could not find a matching mapping");const h={begin:{divIdx:o,offset:d-a}};for(d+=r[u];o!==c&&d>a+i[o].length;)a+=i[o].length,o++;h.end={divIdx:o,offset:d-a},l.push(h)}return l}_renderMatches(t){if(0===t.length)return;const{findController:r,pageIdx:i,textContentItemsStr:o,textDivs:a}=this,c=i===r.selected.pageIdx,l=r.selected.matchIdx;let u=null;const d={divIdx:-1,offset:void 0};function beginText(t,r){const i=t.divIdx;return a[i].textContent="",appendTextToDiv(i,0,t.offset,r)}function appendTextToDiv(t,r,i,c){const l=a[t],u=o[t].substring(r,i),d=document.createTextNode(u);if(c){const t=document.createElement("span");return t.className=`${c} appended`,t.appendChild(d),l.appendChild(t),c.includes("selected")?t.offsetLeft:0}return l.appendChild(d),0}let h=l,p=h+1;if(r.state.highlightAll)h=0,p=t.length;else if(!c)return;for(let o=h;o<p;o++){const h=t[o],p=h.begin,g=h.end,m=c&&o===l,y=m?" selected":"";let v=0;if(u&&p.divIdx===u.divIdx?appendTextToDiv(u.divIdx,u.offset,p.offset):(null!==u&&appendTextToDiv(u.divIdx,u.offset,d.offset),beginText(p)),p.divIdx===g.divIdx)v=appendTextToDiv(p.divIdx,p.offset,g.offset,"highlight"+y);else{v=appendTextToDiv(p.divIdx,p.offset,d.offset,"highlight begin"+y);for(let t=p.divIdx+1,r=g.divIdx;t<r;t++)a[t].className="highlight middle"+y;beginText(g,"highlight end"+y)}u=g,m&&r.scrollMatchIntoView({element:a[p.divIdx],selectedLeft:v,pageIndex:i,matchIndex:l})}u&&appendTextToDiv(u.divIdx,u.offset,d.offset)}_updateMatches(){if(!this.renderingDone)return;const{findController:t,matches:r,pageIdx:i,textContentItemsStr:o,textDivs:a}=this;let c=-1;for(let t=0,i=r.length;t<i;t++){const i=r[t];for(let t=Math.max(c,i.begin.divIdx),r=i.end.divIdx;t<=r;t++){const r=a[t];r.textContent=o[t],r.className=""}c=i.end.divIdx+1}if(!t?.highlightMatches)return;const l=t.pageMatches[i]||null,u=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(l,u),this._renderMatches(this.matches)}_bindMouse(){const t=this.textLayerDiv;let r=null;t.addEventListener("mousedown",(i=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return this.textLayerRenderTask.expandTextDivs(!0),void(r&&(clearTimeout(r),r=null));const o=t.querySelector(".endOfContent");if(!o)return;let a=i.target!==t;if(a=a&&"none"!==window.getComputedStyle(o).getPropertyValue("-moz-user-select"),a){const r=t.getBoundingClientRect(),a=Math.max(0,(i.pageY-r.top)/r.height);o.style.top=(100*a).toFixed(2)+"%"}o.classList.add("active")})),t.addEventListener("mouseup",(()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return void(r=setTimeout((()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),r=null}),300));const i=t.querySelector(".endOfContent");i&&(i.style.top="",i.classList.remove("active"))}))}}r.TextLayerBuilder=TextLayerBuilder;r.DefaultTextLayerFactory=class DefaultTextLayerFactory{createTextLayerBuilder(t,r,i,o=!1,a){return new TextLayerBuilder({textLayerDiv:t,pageIndex:r,viewport:i,enhanceTextSelection:o,eventBus:a})}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DownloadManager=void 0;var o=i(2),a=i(8);function download(t,r){const i=document.createElement("a");if(!i.click)throw new Error('DownloadManager: "a.click()" is not supported.');i.href=t,i.target="_parent","download"in i&&(i.download=r),(document.body||document.documentElement).appendChild(i),i.click(),i.remove()}r.DownloadManager=class DownloadManager{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(t,r){(0,o.createValidAbsoluteUrl)(t,"http://example.com")&&download(t+"#pdfjs.action=download",r)}downloadData(t,r,i){download((0,o.createObjectURL)(t,i,a.viewerCompatibilityParams.disableCreateObjectURL),r)}openOrDownloadData(t,r,i){const c=(0,o.isPdfFile)(i),l=c?"application/pdf":"";if(c&&!a.viewerCompatibilityParams.disableCreateObjectURL){let o,a=this._openBlobUrls.get(t);a||(a=URL.createObjectURL(new Blob([r],{type:l})),this._openBlobUrls.set(t,a)),o="?file="+encodeURIComponent(a+"#"+i);try{return window.open(o),!0}catch(r){console.error(`openOrDownloadData: ${r}`),URL.revokeObjectURL(a),this._openBlobUrls.delete(t)}}return this.downloadData(r,i,l),!1}download(t,r,i,o="download"){if(a.viewerCompatibilityParams.disableCreateObjectURL)return void this.downloadUrl(r,i);download(URL.createObjectURL(t),i)}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.viewerCompatibilityParams=void 0;const i=Object.create(null);{const t="undefined"!=typeof navigator&&navigator.userAgent||"",r="undefined"!=typeof navigator&&navigator.platform||"",o="undefined"!=typeof navigator&&navigator.maxTouchPoints||1,a=/Android/.test(t),c=/\b(iPad|iPhone|iPod)(?=;)/.test(t)||"MacIntel"===r&&o>1,l=/CriOS/.test(t);!function checkOnBlobSupport(){l&&(i.disableCreateObjectURL=!0)}(),function checkCanvasSizeLimitation(){(c||a)&&(i.maxCanvasPixels=5242880)}()}const o=Object.freeze(i);r.viewerCompatibilityParams=o},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GenericL10n=void 0,i(10);var o=i(3);const a=document.webL10n;r.GenericL10n=class GenericL10n{constructor(t){this._lang=t,this._ready=new Promise(((r,i)=>{a.setLanguage((0,o.fixupLangCode)(t),(()=>{r(a)}))}))}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(t,r=null,i=(0,o.getL10nFallback)(t,r)){return(await this._ready).get(t,r,i)}async translate(t){return(await this._ready).translate(t)}}},()=>{document.webL10n=function(t,r,i){var o={},a="",c="textContent",l="",u={},d="loading";function xhrLoadText(t,r,i){r=r||function _onSuccess(t){},i=i||function _onFailure(){};var o=new XMLHttpRequest;o.open("GET",t,true),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=utf-8"),o.onreadystatechange=function(){4==o.readyState&&(200==o.status||0===o.status?r(o.responseText):i())},o.onerror=i,o.ontimeout=i;try{o.send(null)}catch(t){i()}}function parseResource(t,r,i,l){var u=t.replace(/[^\/]*$/,"")||"./";function evalString(t){return t.lastIndexOf("\\")<0?t:t.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}xhrLoadText(t,(function(t){a+=t,function parseProperties(t,i){var o={},a=/^\s*|\s*$/,c=/^\s*#|^\s*$/,l=/^\s*\[(.*)\]\s*$/,d=/^\s*@import\s+url\((.*)\)\s*$/i,h=/^([^=\s]*)\s*=\s*(.+)$/;function parseRawLines(t,i,p){var g=t.replace(a,"").split(/[\r\n]+/),m="*",y=r.split("-",1)[0],v=!1,_="";!function nextEntry(){for(;;){if(!g.length)return void p();var t=g.shift();if(!c.test(t)){if(i){if(_=l.exec(t)){m=_[1].toLowerCase(),v="*"!==m&&m!==r&&m!==y;continue}if(v)continue;if(_=d.exec(t))return void loadImport(u+_[1],nextEntry)}var a=t.match(h);a&&3==a.length&&(o[a[1]]=evalString(a[2]))}}}()}function loadImport(t,r){xhrLoadText(t,(function(t){parseRawLines(t,!1,r)}),(function(){console.warn(t+" not found."),r()}))}parseRawLines(t,!0,(function(){i(o)}))}(t,(function(t){for(var r in t){var a,l,u=r.lastIndexOf(".");u>0?(a=r.substring(0,u),l=r.substring(u+1)):(a=r,l=c),o[a]||(o[a]={}),o[a][l]=t[r]}i&&i()}))}),l)}function loadLocale(t,i){t&&(t=t.toLowerCase()),i=i||function _callback(){},function clear(){o={},a="",l=""}(),l=t;var c=function getL10nResourceLinks(){return r.querySelectorAll('link[type="application/l10n"]')}(),u=c.length;if(0!==u){var h,p=0;h=function(){++p>=u&&(i(),d="complete")};for(var g=0;g<u;g++){new L10nResourceLink(c[g]).load(t,h)}}else{var m=function getL10nDictionary(){var t=r.querySelector('script[type="application/l10n"]');return t?JSON.parse(t.innerHTML):null}();if(m&&m.locales&&m.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(o=m.locales[t])){var y=m.default_locale.toLowerCase();for(var v in m.locales){if((v=v.toLowerCase())===t){o=m.locales[t];break}v===y&&(o=m.locales[y])}}i()}else console.log("no resource to load, early way out");d="complete"}function L10nResourceLink(t){var r=t.href;this.load=function(t,i){parseResource(r,t,i,(function(){console.warn(r+" not found."),console.warn('"'+t+'" resource not found'),l="",i()}))}}}function getL10nData(t,r,i){var a=o[t];if(!a){if(console.warn("#"+t+" is undefined."),!i)return null;a=i}var c={};for(var l in a){var u=a[l];u=substArguments(u=substIndexes(u,r,t,l),r,t),c[l]=u}return c}function substIndexes(t,r,i,a){var c=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(t);if(!c||!c.length)return t;var l,d=c[1],h=c[2];(r&&h in r?l=r[h]:h in o&&(l=o[h]),d in u)&&(t=(0,u[d])(t,l,i,a));return t}function substArguments(t,r,i){return t.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(t,a){return r&&a in r?r[a]:a in o?o[a]:(console.log("argument {{"+a+"}} for #"+i+" is undefined."),t)}))}function translateElement(t){var i=function getL10nAttributes(t){if(!t)return{};var r=t.getAttribute("data-l10n-id"),i=t.getAttribute("data-l10n-args"),o={};if(i)try{o=JSON.parse(i)}catch(t){console.warn("could not parse arguments for #"+r)}return{id:r,args:o}}(t);if(i.id){var o=getL10nData(i.id,i.args);if(o){if(o[c]){if(0===function getChildElementCount(t){if(t.children)return t.children.length;if(void 0!==t.childElementCount)return t.childElementCount;for(var r=0,i=0;i<t.childNodes.length;i++)r+=1===t.nodeType?1:0;return r}(t))t[c]=o[c];else{for(var a=t.childNodes,l=!1,u=0,d=a.length;u<d;u++)3===a[u].nodeType&&/\S/.test(a[u].nodeValue)&&(l?a[u].nodeValue="":(a[u].nodeValue=o[c],l=!0));if(!l){var h=r.createTextNode(o[c]);t.insertBefore(h,t.firstChild)}}delete o[c]}for(var p in o)t[p]=o[p]}else console.warn("#"+i.id+" is undefined.")}}return u.plural=function(t,r,i,a){var d=parseFloat(r);if(isNaN(d))return t;if(a!=c)return t;u._pluralRules||(u._pluralRules=function getPluralRules(t){function isIn(t,r){return-1!==r.indexOf(t)}function isBetween(t,r,i){return r<=t&&t<=i}var r={0:function(t){return"other"},1:function(t){return isBetween(t%100,3,10)?"few":0===t?"zero":isBetween(t%100,11,99)?"many":2==t?"two":1==t?"one":"other"},2:function(t){return 0!==t&&t%10==0?"many":2==t?"two":1==t?"one":"other"},3:function(t){return 1==t?"one":"other"},4:function(t){return isBetween(t,0,1)?"one":"other"},5:function(t){return isBetween(t,0,2)&&2!=t?"one":"other"},6:function(t){return 0===t?"zero":t%10==1&&t%100!=11?"one":"other"},7:function(t){return 2==t?"two":1==t?"one":"other"},8:function(t){return isBetween(t,3,6)?"few":isBetween(t,7,10)?"many":2==t?"two":1==t?"one":"other"},9:function(t){return 0===t||1!=t&&isBetween(t%100,1,19)?"few":1==t?"one":"other"},10:function(t){return isBetween(t%10,2,9)&&!isBetween(t%100,11,19)?"few":t%10!=1||isBetween(t%100,11,19)?"other":"one"},11:function(t){return isBetween(t%10,2,4)&&!isBetween(t%100,12,14)?"few":t%10==0||isBetween(t%10,5,9)||isBetween(t%100,11,14)?"many":t%10==1&&t%100!=11?"one":"other"},12:function(t){return isBetween(t,2,4)?"few":1==t?"one":"other"},13:function(t){return isBetween(t%10,2,4)&&!isBetween(t%100,12,14)?"few":1!=t&&isBetween(t%10,0,1)||isBetween(t%10,5,9)||isBetween(t%100,12,14)?"many":1==t?"one":"other"},14:function(t){return isBetween(t%100,3,4)?"few":t%100==2?"two":t%100==1?"one":"other"},15:function(t){return 0===t||isBetween(t%100,2,10)?"few":isBetween(t%100,11,19)?"many":1==t?"one":"other"},16:function(t){return t%10==1&&11!=t?"one":"other"},17:function(t){return 3==t?"few":0===t?"zero":6==t?"many":2==t?"two":1==t?"one":"other"},18:function(t){return 0===t?"zero":isBetween(t,0,2)&&0!==t&&2!=t?"one":"other"},19:function(t){return isBetween(t,2,10)?"few":isBetween(t,0,1)?"one":"other"},20:function(t){return!isBetween(t%10,3,4)&&t%10!=9||isBetween(t%100,10,19)||isBetween(t%100,70,79)||isBetween(t%100,90,99)?t%1e6==0&&0!==t?"many":t%10!=2||isIn(t%100,[12,72,92])?t%10!=1||isIn(t%100,[11,71,91])?"other":"one":"two":"few"},21:function(t){return 0===t?"zero":1==t?"one":"other"},22:function(t){return isBetween(t,0,1)||isBetween(t,11,99)?"one":"other"},23:function(t){return isBetween(t%10,1,2)||t%20==0?"one":"other"},24:function(t){return isBetween(t,3,10)||isBetween(t,13,19)?"few":isIn(t,[2,12])?"two":isIn(t,[1,11])?"one":"other"}},i={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[t.replace(/-.*$/,"")];return i in r?r[i]:(console.warn("plural form unknown for ["+t+"]"),function(){return"other"})}(l));var h="["+u._pluralRules(d)+"]";return 0===d&&i+"[zero]"in o?t=o[i+"[zero]"][a]:1==d&&i+"[one]"in o?t=o[i+"[one]"][a]:2==d&&i+"[two]"in o?t=o[i+"[two]"][a]:i+h in o?t=o[i+h][a]:i+"[other]"in o&&(t=o[i+"[other]"][a]),t},{get:function(t,r,i){var o,a=t.lastIndexOf("."),l=c;a>0&&(l=t.substring(a+1),t=t.substring(0,a)),i&&((o={})[l]=i);var u=getL10nData(t,r,o);return u&&l in u?u[l]:"{{"+t+"}}"},getData:function(){return o},getText:function(){return a},getLanguage:function(){return l},setLanguage:function(t,r){loadLocale(t,(function(){r&&r()}))},getDirection:function(){var t=l.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(t)>=0?"rtl":"ltr"},translate:function translateFragment(t){for(var i=function getTranslatableChildren(t){return t?t.querySelectorAll("*[data-l10n-id]"):[]}(t=t||r.documentElement),o=i.length,a=0;a<o;a++)translateElement(i[a]);translateElement(t)},getReadyState:function(){return d},ready:function(i){i&&("complete"==d||"interactive"==d?t.setTimeout((function(){i()})):r.addEventListener&&r.addEventListener("localized",(function once(){r.removeEventListener("localized",once),i()})))}}}(window,document)},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFindController=r.FindState=void 0;var o=i(2),a=i(12),c=i(5);const l={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};r.FindState=l;const u={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"};let d=null;function normalize(t){if(!d){const t=Object.keys(u).join("");d=new RegExp(`[${t}]`,"g")}let r=null;return[t.replace(d,(function(t,i){const o=u[t],a=o.length-t.length;return 0!==a&&(r||(r=[])).push([i,a]),o})),r]}function getOriginalIndex(t,r=null){if(!r)return t;let i=0;for(const[o,a]of r){const r=o+i;if(r>=t)break;if(r+a>t){i+=t-r;break}i+=a}return t-i}r.PDFFindController=class PDFFindController{constructor({linkService:t,eventBus:r}){this._linkService=t,this._eventBus=r,this._reset(),r._on("findbarclose",this._onFindBarClose.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(t){this._pdfDocument&&this._reset(),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}executeCommand(t,r){if(!r)return;const i=this._pdfDocument;(null===this._state||this._shouldDirtyMatch(t,r))&&(this._dirtyMatch=!0),this._state=r,"findhighlightallchange"!==t&&this._updateUIState(l.PENDING),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||i&&this._pdfDocument!==i)return;this._extractText();const r=!this._highlightMatches,o=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),"find"===t?this._findTimeout=setTimeout((()=>{this._nextMatch(),this._findTimeout=null}),250):this._dirtyMatch?this._nextMatch():"findagain"===t?(this._nextMatch(),r&&this._state.highlightAll&&this._updateAllPages()):"findhighlightallchange"===t?(o?this._nextMatch():this._highlightMatches=!0,this._updateAllPages()):this._nextMatch()}))}scrollMatchIntoView({element:t=null,selectedLeft:r=0,pageIndex:i=-1,matchIndex:o=-1}){if(!this._scrollMatches||!t)return;if(-1===o||o!==this._selected.matchIdx)return;if(-1===i||i!==this._selected.pageIdx)return;this._scrollMatches=!1;const a={top:-50,left:r+-400};(0,c.scrollIntoView)(t,a,!0)}_reset(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,o.createPromiseCapability)()}get _query(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=normalize(this._state.query)),this._normalizedQuery}_shouldDirtyMatch(t,r){if(r.query!==this._state.query)return!0;switch(t){case"findagain":const t=this._selected.pageIdx+1,r=this._linkService;return t>=1&&t<=r.pagesCount&&t!==r.page&&!r.isPageVisible(t);case"findhighlightallchange":return!1}return!0}_prepareMatches(t,r,i){function isSubTerm(r){const i=t[r],o=t[r+1];if(r<t.length-1&&i.match===o.match)return i.skipped=!0,!0;for(let o=r-1;o>=0;o--){const r=t[o];if(!r.skipped){if(r.match+r.matchLength<i.match)break;if(r.match+r.matchLength>=i.match+i.matchLength)return i.skipped=!0,!0}}return!1}t.sort((function(t,r){return t.match===r.match?t.matchLength-r.matchLength:t.match-r.match}));for(let o=0,a=t.length;o<a;o++)isSubTerm(o)||(r.push(t[o].match),i.push(t[o].matchLength))}_isEntireWord(t,r,i){if(r>0){const i=t.charCodeAt(r),o=t.charCodeAt(r-1);if((0,a.getCharacterType)(i)===(0,a.getCharacterType)(o))return!1}const o=r+i-1;if(o<t.length-1){const r=t.charCodeAt(o),i=t.charCodeAt(o+1);if((0,a.getCharacterType)(r)===(0,a.getCharacterType)(i))return!1}return!0}_calculatePhraseMatch(t,r,i,o,a){const c=[],l=[],u=t.length;let d=-u;for(;d=i.indexOf(t,d+u),-1!==d;){if(a&&!this._isEntireWord(i,d,u))continue;const t=getOriginalIndex(d,o),r=getOriginalIndex(d+u-1,o)-t+1;c.push(t),l.push(r)}this._pageMatches[r]=c,this._pageMatchesLength[r]=l}_calculateWordMatch(t,r,i,o,a){const c=[],l=t.match(/\S+/g);for(let t=0,r=l.length;t<r;t++){const r=l[t],u=r.length;let d=-u;for(;d=i.indexOf(r,d+u),-1!==d;){if(a&&!this._isEntireWord(i,d,u))continue;const t=getOriginalIndex(d,o),r=getOriginalIndex(d+u-1,o)-t+1;c.push({match:t,matchLength:r,skipped:!1})}}this._pageMatchesLength[r]=[],this._pageMatches[r]=[],this._prepareMatches(c,this._pageMatches[r],this._pageMatchesLength[r])}_calculateMatch(t){let r=this._pageContents[t];const i=this._pageDiffs[t];let o=this._query;const{caseSensitive:a,entireWord:c,phraseSearch:l}=this._state;if(0===o.length)return;a||(r=r.toLowerCase(),o=o.toLowerCase()),l?this._calculatePhraseMatch(o,t,r,i,c):this._calculateWordMatch(o,t,r,i,c),this._state.highlightAll&&this._updatePage(t),this._resumePageIdx===t&&(this._resumePageIdx=null,this._nextPageMatch());const u=this._pageMatches[t].length;u>0&&(this._matchesCountTotal+=u,this._updateUIResultsCount())}_extractText(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();for(let r=0,i=this._linkService.pagesCount;r<i;r++){const i=(0,o.createPromiseCapability)();this._extractTextPromises[r]=i.promise,t=t.then((()=>this._pdfDocument.getPage(r+1).then((t=>t.getTextContent({normalizeWhitespace:!0}))).then((t=>{const o=t.items,a=[];for(let t=0,r=o.length;t<r;t++)a.push(o[t].str);[this._pageContents[r],this._pageDiffs[r]]=normalize(a.join("")),i.resolve(r)}),(t=>{console.error(`Unable to get text content for page ${r+1}`,t),this._pageContents[r]="",this._pageDiffs[r]=null,i.resolve(r)}))))}}_updatePage(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})}_updateAllPages(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}_nextMatch(){const t=this._state.findPrevious,r=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=r,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,this._updateAllPages();for(let t=0;t<i;t++)this._pendingFindMatches.has(t)||(this._pendingFindMatches.add(t),this._extractTextPromises[t].then((t=>{this._pendingFindMatches.delete(t),this._calculateMatch(t)})))}if(""===this._query)return void this._updateUIState(l.FOUND);if(this._resumePageIdx)return;const o=this._offset;if(this._pagesToSearch=i,null!==o.matchIdx){const r=this._pageMatches[o.pageIdx].length;if(!t&&o.matchIdx+1<r||t&&o.matchIdx>0)return o.matchIdx=t?o.matchIdx-1:o.matchIdx+1,void this._updateMatch(!0);this._advanceOffsetPage(t)}this._nextPageMatch()}_matchesReady(t){const r=this._offset,i=t.length,o=this._state.findPrevious;return i?(r.matchIdx=o?i-1:0,this._updateMatch(!0),!0):(this._advanceOffsetPage(o),!!(r.wrapped&&(r.matchIdx=null,this._pagesToSearch<0))&&(this._updateMatch(!1),!0))}_nextPageMatch(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let t=null;do{const r=this._offset.pageIdx;if(t=this._pageMatches[r],!t){this._resumePageIdx=r;break}}while(!this._matchesReady(t))}_advanceOffsetPage(t){const r=this._offset,i=this._linkService.pagesCount;r.pageIdx=t?r.pageIdx-1:r.pageIdx+1,r.matchIdx=null,this._pagesToSearch--,(r.pageIdx>=i||r.pageIdx<0)&&(r.pageIdx=t?i-1:0,r.wrapped=!0)}_updateMatch(t=!1){let r=l.NOT_FOUND;const i=this._offset.wrapped;if(this._offset.wrapped=!1,t){const t=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,r=i?l.WRAPPED:l.FOUND,-1!==t&&t!==this._selected.pageIdx&&this._updatePage(t)}this._updateUIState(r,this._state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this._updatePage(this._selected.pageIdx))}_onFindBarClose(t){const r=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||r&&this._pdfDocument!==r||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this._updateUIState(l.FOUND),this._highlightMatches=!1,this._updateAllPages())}))}_requestMatchesCount(){const{pageIdx:t,matchIdx:r}=this._selected;let i=0,o=this._matchesCountTotal;if(-1!==r){for(let r=0;r<t;r++)i+=this._pageMatches[r]?.length||0;i+=r+1}return(i<1||i>o)&&(i=o=0),{current:i,total:o}}_updateUIResultsCount(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this._requestMatchesCount()})}_updateUIState(t,r){this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:r,matchesCount:this._requestMatchesCount(),rawQuery:this._state?.query??null})}}},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getCharacterType=function getCharacterType(t){if(function isAlphabeticalScript(t){return t<11904}(t))return function isAscii(t){return 0==(65408&t)}(t)?function isAsciiSpace(t){return 32===t||9===t||13===t||10===t}(t)?i.SPACE:function isAsciiAlpha(t){return t>=97&&t<=122||t>=65&&t<=90}(t)||function isAsciiDigit(t){return t>=48&&t<=57}(t)||95===t?i.ALPHA_LETTER:i.PUNCT:function isThai(t){return 3584==(65408&t)}(t)?i.THAI_LETTER:160===t?i.SPACE:i.ALPHA_LETTER;if(function isHan(t){return t>=13312&&t<=40959||t>=63744&&t<=64255}(t))return i.HAN_LETTER;if(function isKatakana(t){return t>=12448&&t<=12543}(t))return i.KATAKANA_LETTER;if(function isHiragana(t){return t>=12352&&t<=12447}(t))return i.HIRAGANA_LETTER;if(function isHalfwidthKatakana(t){return t>=65376&&t<=65439}(t))return i.HALFWIDTH_KATAKANA_LETTER;return i.ALPHA_LETTER},r.CharacterType=void 0;const i={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};r.CharacterType=i},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isDestArraysEqual=isDestArraysEqual,r.isDestHashesEqual=isDestHashesEqual,r.PDFHistory=void 0;var o=i(5);function getCurrentHash(){return document.location.hash}function isDestHashesEqual(t,r){if("string"!=typeof t||"string"!=typeof r)return!1;if(t===r)return!0;const{nameddest:i}=(0,o.parseQueryString)(t);return i===r}function isDestArraysEqual(t,r){function isEntryEqual(t,r){if(typeof t!=typeof r)return!1;if(Array.isArray(t)||Array.isArray(r))return!1;if(null!==t&&"object"==typeof t&&null!==r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const i in t)if(!isEntryEqual(t[i],r[i]))return!1;return!0}return t===r||Number.isNaN(t)&&Number.isNaN(r)}if(!Array.isArray(t)||!Array.isArray(r))return!1;if(t.length!==r.length)return!1;for(let i=0,o=t.length;i<o;i++)if(!isEntryEqual(t[i],r[i]))return!1;return!0}r.PDFHistory=class PDFHistory{constructor({linkService:t,eventBus:r}){this.linkService=t,this.eventBus=r,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this._isViewerInPresentationMode=!1,this.eventBus._on("presentationmodechanged",(t=>{this._isViewerInPresentationMode=t.state!==o.PresentationModeState.NORMAL})),this.eventBus._on("pagesinit",(()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",(t=>{this._isPagesLoaded=!!t.pagesCount}),{once:!0})}))}initialize({fingerprint:t,resetHistory:r=!1,updateUrl:i=!1}){if(!t||"string"!=typeof t)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const o=""!==this._fingerprint&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=!0===i,this._initialized=!0,this._bindEvents();const a=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=getCurrentHash(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(a,!0)||r){const{hash:t,page:i,rotation:a}=this._parseCurrentHash(!0);return!t||o||r?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:t,page:i,rotation:a},!0)}const c=a.destination;this._updateInternalState(c,a.uid,!0),void 0!==c.rotation&&(this._initialRotation=c.rotation),c.dest?(this._initialBookmark=JSON.stringify(c.dest),this._destination.page=null):c.hash?this._initialBookmark=c.hash:c.page&&(this._initialBookmark=`page=${c.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:r,pageNumber:i}){if(!this._initialized)return;if(t&&"string"!=typeof t)return void console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);if(!Array.isArray(r))return void console.error(`PDFHistory.push: "${r}" is not a valid explicitDest parameter.`);if(!this._isValidPage(i)&&(null!==i||this._destination))return void console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);const o=t||JSON.stringify(r);if(!o)return;let a=!1;if(this._destination&&(isDestHashesEqual(this._destination.hash,o)||isDestArraysEqual(this._destination.dest,r))){if(this._destination.page)return;a=!0}this._popStateInProgress&&!a||(this._pushOrReplaceState({dest:r,hash:o,page:i,rotation:this.linkService.rotation},a),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))}pushPage(t){this._initialized&&(this._isValidPage(t)?this._destination?.page!==t&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))):console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this._isValidState(t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this._isValidState(t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(t,r=!1){const i=r||!this._destination,o={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:t};let a;if(this._updateInternalState(t,o.uid),this._updateUrl&&t?.hash){const r=document.location.href.split("#")[0];r.startsWith("file://")||(a=`${r}#${t.hash}`)}i?window.history.replaceState(o,"",a):window.history.pushState(o,"",a)}_tryPushCurrentPosition(t=!1){if(!this._position)return;let r=this._position;if(t&&(r=Object.assign(Object.create(null),this._position),r.temporary=!0),!this._destination)return void this._pushOrReplaceState(r);if(this._destination.temporary)return void this._pushOrReplaceState(r,!0);if(this._destination.hash===r.hash)return;if(!this._destination.page&&this._numPositionUpdates<=50)return;let i=!1;if(this._destination.page>=r.first&&this._destination.page<=r.page){if(void 0!==this._destination.dest||!this._destination.first)return;i=!0}this._pushOrReplaceState(r,i)}_isValidPage(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount}_isValidState(t,r=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint){if(!r)return!1;{if("string"!=typeof t.fingerprint||t.fingerprint.length!==this._fingerprint.length)return!1;const[r]=performance.getEntriesByType("navigation");if("reload"!==r?.type)return!1}}return!(!Number.isInteger(t.uid)||t.uid<0)&&(null!==t.destination&&"object"==typeof t.destination)}_updateInternalState(t,r,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=r,this._maxUid=Math.max(this._maxUid,r),this._numPositionUpdates=0}_parseCurrentHash(t=!1){const r=unescape(getCurrentHash()).substring(1),i=(0,o.parseQueryString)(r),a=i.nameddest||"";let c=0|i.page;return(!this._isValidPage(c)||t&&a.length>0)&&(c=null),{hash:r,page:c,rotation:this.linkService.rotation}}_updateViewarea({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:this._isViewerInPresentationMode?`page=${t.pageNumber}`:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout((()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null}),1e3))}_popState({state:t}){const r=getCurrentHash(),i=this._currentHash!==r;if(this._currentHash=r,!t){this._uid++;const{hash:t,page:r,rotation:i}=this._parseCurrentHash();return void this._pushOrReplaceState({hash:t,page:r,rotation:i},!0)}if(!this._isValidState(t))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,(0,o.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then((()=>{this._blockHashChange--})));const a=t.destination;this._updateInternalState(a,t.uid,!0),(0,o.isValidRotation)(a.rotation)&&(this.linkService.rotation=a.rotation),a.dest?this.linkService.goToDestination(a.dest):a.hash?this.linkService.setHash(a.hash):a.page&&(this.linkService.page=a.page),Promise.resolve().then((()=>{this._popStateInProgress=!1}))}_pageHide(){this._destination&&!this._destination.temporary||this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFPageView=void 0;var o=i(5),a=i(2),c=i(3),l=i(15),u=i(8);const d=u.viewerCompatibilityParams.maxCanvasPixels||16777216;r.PDFPageView=class PDFPageView{constructor(t){const r=t.container,i=t.defaultViewport;this.id=t.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||o.DEFAULT_SCALE,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=Number.isInteger(t.textLayerMode)?t.textLayerMode:o.TextLayerMode.ENABLE,this.imageResourcesPath=t.imageResourcesPath||"",this.renderInteractiveForms=!1!==t.renderInteractiveForms,this.useOnlyCssZoom=t.useOnlyCssZoom||!1,this.maxCanvasPixels=t.maxCanvasPixels||d,this.eventBus=t.eventBus,this.renderingQueue=t.renderingQueue,this.textLayerFactory=t.textLayerFactory,this.annotationLayerFactory=t.annotationLayerFactory,this.xfaLayerFactory=t.xfaLayerFactory,this.structTreeLayerFactory=t.structTreeLayerFactory,this.renderer=t.renderer||o.RendererType.CANVAS,this.l10n=t.l10n||c.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=l.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this.annotationLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const a=document.createElement("div");a.className="page",a.style.width=Math.floor(this.viewport.width)+"px",a.style.height=Math.floor(this.viewport.height)+"px",a.setAttribute("data-page-number",this.id),a.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then((t=>{a.setAttribute("aria-label",t)})),this.div=a,r.appendChild(a)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const r=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:this.scale*o.CSS_UNITS,rotation:r}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}async _renderAnnotationLayer(){let t=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(r){t=r}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:t})}}async _renderXfaLayer(){let t=null;try{await this.xfaLayer.render(this.viewport,"display")}catch(r){t=r}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:t})}}_resetZoomLayer(t=!1){if(!this.zoomLayer)return;const r=this.zoomLayer.firstChild;this.paintedViewportMap.delete(r),r.width=0,r.height=0,t&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:t=!1,keepAnnotationLayer:r=!1,keepXfaLayer:i=!1}={}){this.cancelRendering({keepAnnotationLayer:r,keepXfaLayer:i}),this.renderingState=l.RenderingStates.INITIAL;const o=this.div;o.style.width=Math.floor(this.viewport.width)+"px",o.style.height=Math.floor(this.viewport.height)+"px";const a=o.childNodes,c=t&&this.zoomLayer||null,u=r&&this.annotationLayer?.div||null,d=i&&this.xfaLayer?.div||null;for(let t=a.length-1;t>=0;t--){const r=a[t];switch(r){case c:case u:case d:continue}o.removeChild(r)}o.removeAttribute("data-loaded"),u&&this.annotationLayer.hide(),d&&this.xfaLayer.hide(),c||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon",this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then((t=>{this.loadingIconDiv?.setAttribute("aria-label",t)})),o.appendChild(this.loadingIconDiv)}update(t,r,i=null){this.scale=t||this.scale,void 0!==r&&(this.rotation=r),i instanceof Promise&&(this._optionalContentConfigPromise=i);const a=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*o.CSS_UNITS,rotation:a}),this.svg)return this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});let c=!1;if(this.canvas&&this.maxCanvasPixels>0){const t=this.outputScale;(Math.floor(this.viewport.width)*t.sx|0)*(Math.floor(this.viewport.height)*t.sy|0)>this.maxCanvasPixels&&(c=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&c)return this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer:t=!1,keepXfaLayer:r=!1}={}){this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),!this.annotationLayer||t&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null),!this.xfaLayer||r&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target:t,redrawAnnotationLayer:r=!1,redrawXfaLayer:i=!1}){const o=this.viewport.width,a=this.viewport.height,c=this.div;t.style.width=t.parentNode.style.width=c.style.width=Math.floor(o)+"px",t.style.height=t.parentNode.style.height=c.style.height=Math.floor(a)+"px";const l=this.viewport.rotation-this.paintedViewportMap.get(t).rotation,u=Math.abs(l);let d=1,h=1;if(90!==u&&270!==u||(d=a/o,h=o/a),t.style.transform=`rotate(${l}deg) scale(${d}, ${h})`,this.textLayer){const t=this.textLayer.viewport,r=this.viewport.rotation-t.rotation,i=Math.abs(r);let a=o/t.width;90!==i&&270!==i||(a=o/t.height);const c=this.textLayer.textLayerDiv;let l,u;switch(i){case 0:l=u=0;break;case 90:l=0,u="-"+c.style.height;break;case 180:l="-"+c.style.width,u="-"+c.style.height;break;case 270:l="-"+c.style.width,u=0;break;default:console.error("Bad rotation value.")}c.style.transform=`rotate(${i}deg) scale(${a}) translate(${l}, ${u})`,c.style.transformOrigin="0% 0%"}r&&this.annotationLayer&&this._renderAnnotationLayer(),i&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,r){return this.viewport.convertToPdfPoint(t,r)}draw(){this.renderingState!==l.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,pdfPage:r}=this;if(!r)return this.renderingState=l.RenderingStates.FINISHED,this.loadingIconDiv&&(t.removeChild(this.loadingIconDiv),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=l.RenderingStates.RUNNING;const i=document.createElement("div");i.style.width=t.style.width,i.style.height=t.style.height,i.classList.add("canvasWrapper"),this.annotationLayer?.div?t.insertBefore(i,this.annotationLayer.div):t.appendChild(i);let c=null;if(this.textLayerMode!==o.TextLayerMode.DISABLE&&this.textLayerFactory){const r=document.createElement("div");r.className="textLayer",r.style.width=i.style.width,r.style.height=i.style.height,this.annotationLayer?.div?t.insertBefore(r,this.annotationLayer.div):t.appendChild(r),c=this.textLayerFactory.createTextLayerBuilder(r,this.id-1,this.viewport,this.textLayerMode===o.TextLayerMode.ENABLE_ENHANCE,this.eventBus)}this.textLayer=c,this.xfaLayer?.div&&t.appendChild(this.xfaLayer.div);let u=null;this.renderingQueue&&(u=t=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=l.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=l.RenderingStates.RUNNING,t()});t()});const finishPaintTask=async(r=null)=>{if(d===this.paintTask&&(this.paintTask=null),r instanceof a.RenderingCancelledException)this._renderError=null;else if(this._renderError=r,this.renderingState=l.RenderingStates.FINISHED,this.loadingIconDiv&&(t.removeChild(this.loadingIconDiv),delete this.loadingIconDiv),this._resetZoomLayer(!0),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),r)throw r},d=this.renderer===o.RendererType.SVG?this.paintOnSvg(i):this.paintOnCanvas(i);d.onRenderContinue=u,this.paintTask=d;const h=d.promise.then((()=>finishPaintTask(null).then((()=>{if(c){const t=r.streamTextContent({normalizeWhitespace:!0,includeMarkedContent:!0});c.setTextContentStream(t),c.render()}}))),(function(t){return finishPaintTask(t)}));return this.annotationLayerFactory&&(this.annotationLayer||(this.annotationLayer=this.annotationLayerFactory.createAnnotationLayerBuilder(t,r,null,this.imageResourcesPath,this.renderInteractiveForms,this.l10n,null,null,null)),this._renderAnnotationLayer()),this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder(t,r,null)),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=t=>{t.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then((t=>{if(!t)return;if(!this.canvas)return;const r=this.structTreeLayer.render(t);r.classList.add("structTree"),this.canvas.appendChild(r)})))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder(r)),t.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),h}paintOnCanvas(t){const r=(0,a.createPromiseCapability)(),i={promise:r.promise,onRenderContinue(t){t()},cancel(){y.cancel()}},c=this.viewport,l=document.createElement("canvas");l.hidden=!0;let u=!0;const showCanvas=function(){u&&(l.hidden=!1,u=!1)};t.appendChild(l),this.canvas=l,l.mozOpaque=!0;const d=l.getContext("2d",{alpha:!1}),h=(0,o.getOutputScale)(d);if(this.outputScale=h,this.useOnlyCssZoom){const t=c.clone({scale:o.CSS_UNITS});h.sx*=t.width/c.width,h.sy*=t.height/c.height,h.scaled=!0}if(this.maxCanvasPixels>0){const t=c.width*c.height,r=Math.sqrt(this.maxCanvasPixels/t);h.sx>r||h.sy>r?(h.sx=r,h.sy=r,h.scaled=!0,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const p=(0,o.approximateFraction)(h.sx),g=(0,o.approximateFraction)(h.sy);l.width=(0,o.roundToDivide)(c.width*h.sx,p[0]),l.height=(0,o.roundToDivide)(c.height*h.sy,g[0]),l.style.width=(0,o.roundToDivide)(c.width,p[1])+"px",l.style.height=(0,o.roundToDivide)(c.height,g[1])+"px",this.paintedViewportMap.set(l,c);const m={canvasContext:d,transform:h.scaled?[h.sx,0,0,h.sy,0,0]:null,viewport:this.viewport,renderInteractiveForms:this.renderInteractiveForms,optionalContentConfigPromise:this._optionalContentConfigPromise},y=this.pdfPage.render(m);return y.onContinue=function(t){showCanvas(),i.onRenderContinue?i.onRenderContinue(t):t()},y.promise.then((function(){showCanvas(),r.resolve(void 0)}),(function(t){showCanvas(),r.reject(t)})),i}paintOnSvg(t){let r=!1;const ensureNotCancelled=()=>{if(r)throw new a.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},i=this.pdfPage,c=this.viewport.clone({scale:o.CSS_UNITS});return{promise:i.getOperatorList().then((r=>{ensureNotCancelled();return new a.SVGGraphics(i.commonObjs,i.objs,u.viewerCompatibilityParams.disableCreateObjectURL).getSVG(r,c).then((r=>{ensureNotCancelled(),this.svg=r,this.paintedViewportMap.set(r,c),r.style.width=t.style.width,r.style.height=t.style.height,this.renderingState=l.RenderingStates.FINISHED,t.appendChild(r)}))})),onRenderContinue(t){t()},cancel(){r=!0}}}setPageLabel(t){this.pageLabel="string"==typeof t?t:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.RenderingStates=r.PDFRenderingQueue=void 0;var o=i(2);const a={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};r.RenderingStates=a;r.PDFRenderingQueue=class PDFRenderingQueue{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(t)||this.pdfThumbnailViewer&&this.isThumbnailViewEnabled&&this.pdfThumbnailViewer.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(t,r,i){const o=t.views,a=o.length;if(0===a)return null;for(let t=0;t<a;++t){const r=o[t].view;if(!this.isViewFinished(r))return r}if(i){const i=t.last.id;if(r[i]&&!this.isViewFinished(r[i]))return r[i]}else{const i=t.first.id-2;if(r[i]&&!this.isViewFinished(r[i]))return r[i]}return null}isViewFinished(t){return t.renderingState===a.FINISHED}renderView(t){switch(t.renderingState){case a.FINISHED:return!1;case a.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case a.RUNNING:this.highestPriorityPage=t.renderingId;break;case a.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally((()=>{this.renderHighestPriority()})).catch((t=>{t instanceof o.RenderingCancelledException||console.error(`renderView: "${t}"`)}))}return!0}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFScriptingManager=void 0;var o=i(2),a=i(5),c=i(15);r.PDFScriptingManager=class PDFScriptingManager{constructor({eventBus:t,sandboxBundleSrc:r=null,scriptingFactory:i=null,docPropertiesLookup:o=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=t,this._sandboxBundleSrc=r,this._scriptingFactory=i,this._docPropertiesLookup=o,this._scriptingFactory||window.addEventListener("updatefromsandbox",(t=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}))}setViewer(t){this._pdfViewer=t}async setDocument(t){if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=t,!t)return;const[r,i,o]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(r||o){if(t===this._pdfDocument){try{this._scripting=this._createScripting()}catch(t){return console.error(`PDFScriptingManager.setDocument: "${t?.message}".`),void await this._destroyScripting()}this._internalEvents.set("updatefromsandbox",(t=>{t?.source===window&&this._updateFromSandbox(t.detail)})),this._internalEvents.set("dispatcheventinsandbox",(t=>{this._scripting?.dispatchEventInSandbox(t.detail)})),this._internalEvents.set("pagechanging",(({pageNumber:t,previous:r})=>{t!==r&&(this._dispatchPageClose(r),this._dispatchPageOpen(t))})),this._internalEvents.set("pagerendered",(({pageNumber:t})=>{this._pageOpenPending.has(t)&&t===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(t)})),this._internalEvents.set("pagesdestroy",(async t=>{await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"})),this._closeCapability?.resolve()})),this._domEvents.set("mousedown",(t=>{this._mouseState.isDown=!0})),this._domEvents.set("mouseup",(t=>{this._mouseState.isDown=!1}));for(const[t,r]of this._internalEvents)this._eventBus._on(t,r);for(const[t,r]of this._domEvents)window.addEventListener(t,r);try{const a=await this._getDocProperties();if(t!==this._pdfDocument)return;await this._scripting.createSandbox({objects:r,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...a,actions:o}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(t){return console.error(`PDFScriptingManager.setDocument: "${t?.message}".`),void await this._destroyScripting()}await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then((()=>{t===this._pdfDocument&&(this._ready=!0)}))}}else await this._destroyScripting()}async dispatchWillSave(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(t){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get mouseState(){return this._mouseState}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,o.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,o.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,o.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,o.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(t){const r=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:i,siblings:o,command:c,value:l}=t;if(!i){switch(c){case"clear":console.clear();break;case"error":console.error(l);break;case"layout":this._pdfViewer.spreadMode=(0,a.apiPageLayoutToSpreadMode)(l);break;case"page-num":this._pdfViewer.currentPageNumber=l+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(l);break;case"zoom":if(r)return;this._pdfViewer.currentScaleValue=l}return}if(r&&t.focus)return;delete t.id,delete t.siblings;const u=o?[i,...o]:[i];for(const r of u){const i=document.getElementById(r);i?i.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):this._pdfDocument?.annotationStorage.setValue(r,t)}}async _dispatchPageOpen(t,r=!1){const i=this._pdfDocument,a=this._visitedPages;if(r&&(this._closeCapability=(0,o.createPromiseCapability)()),!this._closeCapability)return;const l=this._pdfViewer.getPageView(t-1);if(l?.renderingState!==c.RenderingStates.FINISHED)return void this._pageOpenPending.add(t);this._pageOpenPending.delete(t);const u=(async()=>{const r=await(a.has(t)?null:l.pdfPage?.getJSActions());i===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:r}))})();a.set(t,u)}async _dispatchPageClose(t){const r=this._pdfDocument,i=this._visitedPages;if(!this._closeCapability)return;if(this._pageOpenPending.has(t))return;const o=i.get(t);o&&(i.set(t,null),await o,r===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:t}=i(17);return t(this._pdfDocument)}_createScripting(){if(this._destroyCapability=(0,o.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:t}=i(17);return new t(this._sandboxBundleSrc)}async _destroyScripting(){if(!this._scripting)return this._pdfDocument=null,void this._destroyCapability?.resolve();this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise((t=>{setTimeout(t,1e3)}))]).catch((t=>{})),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch(t){}for(const[t,r]of this._internalEvents)this._eventBus._off(t,r);this._internalEvents.clear();for(const[t,r]of this._domEvents)window.removeEventListener(t,r);this._domEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,delete this._mouseState.isDown,this._ready=!1,this._destroyCapability?.resolve()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.docPropertiesLookup=async function docPropertiesLookup(t){const r="".split("#")[0];let{info:i,metadata:a,contentDispositionFilename:c,contentLength:l}=await t.getMetadata();if(!l){const{length:r}=await t.getDownloadInfo();l=r}return{...i,baseURL:r,filesize:l,filename:c||(0,o.getPdfFilenameFromUrl)(""),metadata:a?.getRaw(),authors:a?.get("dc:creator"),numPages:t.numPages,URL:""}},r.GenericScripting=void 0;var o=i(2);r.GenericScripting=class GenericScripting{constructor(t){this._ready=(0,o.loadScript)(t,!0).then((()=>window.pdfjsSandbox.QuickJSSandbox()))}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){(await this._ready).dispatchEvent(t)}async destroySandbox(){(await this._ready).nukeSandbox()}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFSinglePageViewer=void 0;var o=i(19),a=i(2);class PDFSinglePageViewer extends o.BaseViewer{constructor(t){super(t),this.eventBus._on("pagesinit",(t=>{this._ensurePageViewVisible()}))}get _viewerElement(){return(0,a.shadow)(this,"_viewerElement",this._shadowViewer)}get _pageWidthScaleFactor(){return 1}_resetView(){super._resetView(),this._previousPageNumber=1,this._shadowViewer=document.createDocumentFragment(),this._updateScrollDown=null}_ensurePageViewVisible(){const t=this._pages[this._currentPageNumber-1],r=this._pages[this._previousPageNumber-1],i=this.viewer.childNodes;switch(i.length){case 0:this.viewer.appendChild(t.div);break;case 1:if(i[0]!==r.div)throw new Error("_ensurePageViewVisible: Unexpected previously visible page.");if(t===r)break;this._shadowViewer.appendChild(r.div),this.viewer.appendChild(t.div),this.container.scrollTop=0;break;default:throw new Error("_ensurePageViewVisible: Only one page should be visible at a time.")}this._previousPageNumber=this._currentPageNumber}_scrollUpdate(){this._updateScrollDown&&this._updateScrollDown(),super._scrollUpdate()}_scrollIntoView({pageDiv:t,pageSpot:r=null,pageNumber:i=null}){i&&this._setCurrentPageNumber(i);const o=this._currentPageNumber>=this._previousPageNumber;this._ensurePageViewVisible(),this.update(),super._scrollIntoView({pageDiv:t,pageSpot:r,pageNumber:i}),this._updateScrollDown=()=>{this.scroll.down=o,this._updateScrollDown=null}}_getVisiblePages(){return this._getCurrentVisiblePage()}_updateHelper(t){}get _isScrollModeHorizontal(){return(0,a.shadow)(this,"_isScrollModeHorizontal",!1)}_updateScrollMode(){}_updateSpreadMode(){}_getPageAdvance(){return 1}}r.PDFSinglePageViewer=PDFSinglePageViewer},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseViewer=void 0;var o=i(2),a=i(5),c=i(15),l=i(1),u=i(3),d=i(14),h=i(4),p=i(20),g=i(6),m=i(21);function PDFPageViewBuffer(t){const r=[];this.push=function(i){const o=r.indexOf(i);o>=0&&r.splice(o,1),r.push(i),r.length>t&&r.shift().destroy()},this.resize=function(i,o){if(t=i,o){const t=new Set;for(let r=0,i=o.length;r<i;++r)t.add(o[r].id);(0,a.moveToEndOfArray)(r,(function(r){return t.has(r.id)}))}for(;r.length>t;)r.shift().destroy()},this.has=function(t){return r.includes(t)}}class BaseViewer{constructor(t){if(this.constructor===BaseViewer)throw new Error("Cannot initialize BaseViewer.");const r="2.10.377";if(o.version!==r)throw new Error(`The API version "${o.version}" does not match the Viewer version "2.10.377".`);if(this._name=this.constructor.name,this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,"DIV"!==this.container?.tagName.toUpperCase()||"DIV"!==this.viewer?.tagName.toUpperCase())throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.eventBus=t.eventBus,this.linkService=t.linkService||new h.SimpleLinkService,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,this._scriptingManager=t.scriptingManager||null,this.removePageBorders=t.removePageBorders||!1,this.textLayerMode=Number.isInteger(t.textLayerMode)?t.textLayerMode:a.TextLayerMode.ENABLE,this.imageResourcesPath=t.imageResourcesPath||"",this.renderInteractiveForms=!1!==t.renderInteractiveForms,this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.renderer=t.renderer||a.RendererType.CANVAS,this.useOnlyCssZoom=t.useOnlyCssZoom||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.l10n=t.l10n||u.NullL10n,this.enableScripting=!0===t.enableScripting&&!!this._scriptingManager,this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new c.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue,this.scroll=(0,a.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=a.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),Promise.resolve().then((()=>{this.eventBus.dispatch("baseviewerinit",{source:this})}))}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}get pageViewsReady(){return!!this._pagesCapability.settled&&this._pages.every((function(t){return t?.pdfPage}))}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(t,!0)||console.error(`${this._name}.currentPageNumber: "${t}" is not a valid page.`))}_setCurrentPageNumber(t,r=!1){if(this._currentPageNumber===t)return r&&this._resetCurrentPageView(),!0;if(!(0<t&&t<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:i}),r&&this._resetCurrentPageView(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let r=0|t;if(this._pageLabels){const i=this._pageLabels.indexOf(t);i>=0&&(r=i+1)}this._setCurrentPageNumber(r,!0)||console.error(`${this._name}.currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return this._currentScale!==a.UNKNOWN_SCALE?this._currentScale:a.DEFAULT_SCALE}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(t,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&this._setScale(t,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!(0,a.isValidRotation)(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument)return;if((t%=360)<0&&(t+=360),this._pagesRotation===t)return;this._pagesRotation=t;const r=this._currentPageNumber;for(let r=0,i=this._pages.length;r<i;r++){const i=this._pages[r];i.update(i.scale,t)}this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:r}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _viewerElement(){throw new Error("Not implemented: _viewerElement")}_onePageRenderedOrForceFetch(){return this.container.offsetParent&&0!==this._getVisiblePages().views.length?this._onePageRenderedCapability.promise:Promise.resolve()}setDocument(t){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null)),this.pdfDocument=t,!t)return;const r=t.isPureXfa,i=t.numPages,o=t.getPage(1),c=t.getOptionalContentConfig();this._pagesCapability.promise.then((()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:i})})),this._onBeforeDraw=t=>{const r=this._pages[t.pageNumber-1];r&&this._buffer.push(r)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=t=>{t.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve(),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null)},this.eventBus._on("pagerendered",this._onAfterDraw),o.then((o=>{this._firstPageCapability.resolve(o),this._optionalContentConfigPromise=c;const l=this.currentScale,u=o.getViewport({scale:l*a.CSS_UNITS}),h=this.textLayerMode!==a.TextLayerMode.DISABLE?this:null,p=r?this:null;for(let t=1;t<=i;++t){const r=new d.PDFPageView({container:this._viewerElement,eventBus:this.eventBus,id:t,scale:l,defaultViewport:u.clone(),optionalContentConfigPromise:c,renderingQueue:this.renderingQueue,textLayerFactory:h,textLayerMode:this.textLayerMode,annotationLayerFactory:this,xfaLayerFactory:p,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderInteractiveForms:this.renderInteractiveForms,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,l10n:this.l10n});this._pages.push(r)}const g=this._pages[0];g&&(g.setPdfPage(o),this.linkService.cachePageRef(1,o.ref)),this._spreadMode!==a.SpreadMode.NONE&&this._updateSpreadMode(),this._onePageRenderedOrForceFetch().then((()=>{if(this.findController&&this.findController.setDocument(t),this.enableScripting&&this._scriptingManager.setDocument(t),t.loadingParams.disableAutoFetch||i>7500)return void this._pagesCapability.resolve();let r=i-1;if(r<=0)this._pagesCapability.resolve();else for(let o=2;o<=i;++o)t.getPage(o).then((t=>{const i=this._pages[o-1];i.pdfPage||i.setPdfPage(t),this.linkService.cachePageRef(o,t.ref),0==--r&&this._pagesCapability.resolve()}),(t=>{console.error(`Unable to get page ${o} to initialize viewer`,t),0==--r&&this._pagesCapability.resolve()}))})),this.eventBus.dispatch("pagesinit",{source:this}),this.defaultRenderingQueue&&this.update()})).catch((t=>{console.error("Unable to initialize viewer",t)}))}setPageLabels(t){if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error(`${this._name}.setPageLabels: Invalid page labels.`)):this._pageLabels=null;for(let t=0,r=this._pages.length;t<r;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=a.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this._buffer=new PDFPageViewBuffer(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._pagesRequests=new WeakMap,this._firstPageCapability=(0,o.createPromiseCapability)(),this._onePageRenderedCapability=(0,o.createPromiseCapability)(),this._pagesCapability=(0,o.createPromiseCapability)(),this._scrollMode=a.ScrollMode.VERTICAL,this._spreadMode=a.SpreadMode.NONE,this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.viewer.textContent="",this._updateScrollMode()}_scrollUpdate(){0!==this.pagesCount&&this.update()}_scrollIntoView({pageDiv:t,pageSpot:r=null,pageNumber:i=null}){(0,a.scrollIntoView)(t,r)}_setScaleUpdatePages(t,r,i=!1,o=!1){if(this._currentScaleValue=r.toString(),function isSameScale(t,r){return r===t||Math.abs(r-t)<1e-15}(this._currentScale,t))o&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:r});else{for(let r=0,i=this._pages.length;r<i;r++)this._pages[r].update(t);if(this._currentScale=t,!i){let t,r=this._currentPageNumber;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(r=this._location.pageNumber,t=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:r,destArray:t,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:o?r:void 0}),this.defaultRenderingQueue&&this.update()}}get _pageWidthScaleFactor(){return this._spreadMode===a.SpreadMode.NONE||this._scrollMode===a.ScrollMode.HORIZONTAL||this.isInPresentationMode?1:2}_setScale(t,r=!1){let i=parseFloat(t);if(i>0)this._setScaleUpdatePages(i,t,r,!1);else{const o=this._pages[this._currentPageNumber-1];if(!o)return;const c=this.isInPresentationMode||this.removePageBorders;let l=c?0:a.SCROLLBAR_PADDING,u=c?0:a.VERTICAL_PADDING;!c&&this._isScrollModeHorizontal&&([l,u]=[u,l]);const d=(this.container.clientWidth-l)/o.width*o.scale/this._pageWidthScaleFactor,h=(this.container.clientHeight-u)/o.height*o.scale;switch(t){case"page-actual":i=1;break;case"page-width":i=d;break;case"page-height":i=h;break;case"page-fit":i=Math.min(d,h);break;case"auto":const r=(0,a.isPortraitOrientation)(o)?d:Math.min(h,d);i=Math.min(a.MAX_AUTO_SCALE,r);break;default:return void console.error(`${this._name}._setScale: "${t}" is an unknown zoom value.`)}this._setScaleUpdatePages(i,t,r,!0)}}_resetCurrentPageView(){this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0);const t=this._pages[this._currentPageNumber-1];this._scrollIntoView({pageDiv:t.div})}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const r=this._pageLabels.indexOf(t);return r<0?null:r+1}scrollPageIntoView({pageNumber:t,destArray:r=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:o=!1}){if(!this.pdfDocument)return;const c=Number.isInteger(t)&&this._pages[t-1];if(!c)return void console.error(`${this._name}.scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!r)return void this._setCurrentPageNumber(t,!0);let l,u,d=0,h=0,p=0,g=0;const m=c.rotation%180!=0,y=(m?c.height:c.width)/c.scale/a.CSS_UNITS,v=(m?c.width:c.height)/c.scale/a.CSS_UNITS;let _=0;switch(r[1].name){case"XYZ":d=r[2],h=r[3],_=r[4],d=null!==d?d:0,h=null!==h?h:v;break;case"Fit":case"FitB":_="page-fit";break;case"FitH":case"FitBH":h=r[2],_="page-width",null===h&&this._location?(d=this._location.left,h=this._location.top):"number"!=typeof h&&(h=v);break;case"FitV":case"FitBV":d=r[2],p=y,g=v,_="page-height";break;case"FitR":d=r[2],h=r[3],p=r[4]-d,g=r[5]-h;const t=this.removePageBorders?0:a.SCROLLBAR_PADDING,i=this.removePageBorders?0:a.VERTICAL_PADDING;l=(this.container.clientWidth-t)/p/a.CSS_UNITS,u=(this.container.clientHeight-i)/g/a.CSS_UNITS,_=Math.min(Math.abs(l),Math.abs(u));break;default:return void console.error(`${this._name}.scrollPageIntoView: "${r[1].name}" is not a valid destination type.`)}if(o||(_&&_!==this._currentScale?this.currentScaleValue=_:this._currentScale===a.UNKNOWN_SCALE&&(this.currentScaleValue=a.DEFAULT_SCALE_VALUE)),"page-fit"===_&&!r[4])return void this._scrollIntoView({pageDiv:c.div,pageNumber:t});const A=[c.viewport.convertToViewportPoint(d,h),c.viewport.convertToViewportPoint(d+p,h+g)];let b=Math.min(A[0][0],A[1][0]),S=Math.min(A[0][1],A[1][1]);i||(b=Math.max(b,0),S=Math.max(S,0)),this._scrollIntoView({pageDiv:c.div,pageSpot:{left:b,top:S},pageNumber:t})}_updateLocation(t){const r=this._currentScale,i=this._currentScaleValue,o=parseFloat(i)===r?Math.round(1e4*r)/100:i,a=t.id;let c="#page="+a;c+="&zoom="+o;const l=this._pages[a-1],u=this.container,d=l.getPagePoint(u.scrollLeft-t.x,u.scrollTop-t.y),h=Math.round(d[0]),p=Math.round(d[1]);c+=","+h+","+p,this._location={pageNumber:a,scale:o,top:p,left:h,rotation:this._pagesRotation,pdfOpenParams:c}}_updateHelper(t){throw new Error("Not implemented: _updateHelper")}update(){const t=this._getVisiblePages(),r=t.views,i=r.length;if(0===i)return;const o=Math.max(10,2*i+1);this._buffer.resize(o,r),this.renderingQueue.renderHighestPriority(t),this._updateHelper(r),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isScrollModeHorizontal(){return!this.isInPresentationMode&&this._scrollMode===a.ScrollMode.HORIZONTAL}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===a.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===a.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getCurrentVisiblePage(){if(!this.pagesCount)return{views:[]};const t=this._pages[this._currentPageNumber-1],r=t.div,i={id:t.id,x:r.offsetLeft+r.clientLeft,y:r.offsetTop+r.clientTop,view:t};return{first:i,last:i,views:[i]}}_getVisiblePages(){return(0,a.getVisibleElements)({scrollEl:this.container,views:this._pages,sortByVisibility:!0,horizontal:this._isScrollModeHorizontal,rtl:this._isScrollModeHorizontal&&this._isContainerRtl})}isPageVisible(t){return!!this.pdfDocument&&(Number.isInteger(t)&&t>0&&t<=this.pagesCount?this._getVisiblePages().views.some((function(r){return r.id===t})):(console.error(`${this._name}.isPageVisible: "${t}" is not a valid page.`),!1))}isPageCached(t){if(!this.pdfDocument||!this._buffer)return!1;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount))return console.error(`${this._name}.isPageCached: "${t}" is not a valid page.`),!1;const r=this._pages[t-1];return!!r&&this._buffer.has(r)}cleanup(){for(let t=0,r=this._pages.length;t<r;t++)this._pages[t]&&this._pages[t].renderingState!==c.RenderingStates.FINISHED&&this._pages[t].reset()}_cancelRendering(){for(let t=0,r=this._pages.length;t<r;t++)this._pages[t]&&this._pages[t].cancelRendering()}_ensurePdfPageLoaded(t){if(t.pdfPage)return Promise.resolve(t.pdfPage);if(this._pagesRequests.has(t))return this._pagesRequests.get(t);const r=this.pdfDocument.getPage(t.id).then((r=>(t.pdfPage||t.setPdfPage(r),this._pagesRequests.delete(t),r))).catch((r=>{console.error("Unable to get page for page view",r),this._pagesRequests.delete(t)}));return this._pagesRequests.set(t,r),r}forceRendering(t){const r=t||this._getVisiblePages(),i=this._isScrollModeHorizontal?this.scroll.right:this.scroll.down,o=this.renderingQueue.getHighestPriority(r,this._pages,i);return!!o&&(this._ensurePdfPageLoaded(o).then((()=>{this.renderingQueue.renderView(o)})),!0)}createTextLayerBuilder(t,r,i,o=!1,a){return new g.TextLayerBuilder({textLayerDiv:t,eventBus:a,pageIndex:r,viewport:i,findController:this.isInPresentationMode?null:this.findController,enhanceTextSelection:!this.isInPresentationMode&&o})}createAnnotationLayerBuilder(t,r,i=null,o="",a=!1,c=u.NullL10n,d=null,h=null,p=null){return new l.AnnotationLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i||this.pdfDocument?.annotationStorage,imageResourcesPath:o,renderInteractiveForms:a,linkService:this.linkService,downloadManager:this.downloadManager,l10n:c,enableScripting:d??this.enableScripting,hasJSActionsPromise:h||this.pdfDocument?.hasJSActions(),mouseState:p||this._scriptingManager?.mouseState})}createXfaLayerBuilder(t,r,i=null){return new m.XfaLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i||this.pdfDocument?.annotationStorage})}createStructTreeLayerBuilder(t){return new p.StructTreeLayerBuilder({pdfPage:t})}get hasEqualPageSizes(){const t=this._pages[0];for(let r=1,i=this._pages.length;r<i;++r){const i=this._pages[r];if(i.width!==t.width||i.height!==t.height)return!1}return!0}getPagesOverview(){return this._pages.map((t=>{const r=t.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,a.isPortraitOrientation)(r)?{width:r.width,height:r.height,rotation:r.rotation}:{width:r.height,height:r.width,rotation:(r.rotation-90)%360}}))}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig():Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);if(this.pdfDocument&&this._optionalContentConfigPromise){this._optionalContentConfigPromise=t;for(const r of this._pages)r.update(r.scale,r.rotation,t);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t})}}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!(0,a.isValidScrollMode)(t))throw new Error(`Invalid scroll mode: ${t}`);this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber)}}_updateScrollMode(t=null){const r=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",r===a.ScrollMode.HORIZONTAL),i.classList.toggle("scrollWrapped",r===a.ScrollMode.WRAPPED),this.pdfDocument&&t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!(0,a.isValidSpreadMode)(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const r=this.viewer,i=this._pages;if(r.textContent="",this._spreadMode===a.SpreadMode.NONE)for(let t=0,o=i.length;t<o;++t)r.appendChild(i[t].div);else{const t=this._spreadMode-1;let o=null;for(let a=0,c=i.length;a<c;++a)null===o?(o=document.createElement("div"),o.className="spread",r.appendChild(o)):a%2===t&&(o=o.cloneNode(!1),r.appendChild(o)),o.appendChild(i[a].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,r=!1){if(this.isInPresentationMode)return 1;switch(this._scrollMode){case a.ScrollMode.WRAPPED:{const{views:i}=this._getVisiblePages(),o=new Map;for(const{id:t,y:r,percent:a,widthPercent:c}of i){if(0===a||c<100)continue;let i=o.get(r);i||o.set(r,i||(i=[])),i.push(t)}for(const i of o.values()){const o=i.indexOf(t);if(-1===o)continue;const a=i.length;if(1===a)break;if(r)for(let r=o-1,a=0;r>=a;r--){const o=i[r],a=i[r+1]-1;if(o<a)return t-a}else for(let r=o+1,c=a;r<c;r++){const o=i[r],a=i[r-1]+1;if(o>a)return a-t}if(r){const r=i[0];if(r<t)return t-r+1}else{const r=i[a-1];if(r>t)return r-t+1}break}break}case a.ScrollMode.HORIZONTAL:break;case a.ScrollMode.VERTICAL:{if(this._spreadMode===a.SpreadMode.NONE)break;const i=this._spreadMode-1;if(r&&t%2!==i)break;if(!r&&t%2===i)break;const{views:o}=this._getVisiblePages(),c=r?t-1:t+1;for(const{id:t,percent:r,widthPercent:i}of o)if(t===c){if(r>0&&100===i)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,r=this.pagesCount;if(t>=r)return!1;const i=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+i,r),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const r=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-r,1),!0}}r.BaseViewer=BaseViewer},(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StructTreeLayerBuilder=r.DefaultStructTreeLayerFactory=void 0;const i={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},o=/^H(\d+)$/;class StructTreeLayerBuilder{constructor({pdfPage:t}){this.pdfPage=t}render(t){return this._walk(t)}_setAttributes(t,r){void 0!==t.alt&&r.setAttribute("aria-label",t.alt),void 0!==t.id&&r.setAttribute("aria-owns",t.id)}_walk(t){if(!t)return null;const r=document.createElement("span");if("role"in t){const{role:a}=t,c=a.match(o);c?(r.setAttribute("role","heading"),r.setAttribute("aria-level",c[1])):i[a]&&r.setAttribute("role",i[a])}if(this._setAttributes(t,r),t.children)if(1===t.children.length&&"id"in t.children[0])this._setAttributes(t.children[0],r);else for(const i of t.children)r.appendChild(this._walk(i));return r}}r.StructTreeLayerBuilder=StructTreeLayerBuilder;r.DefaultStructTreeLayerFactory=class DefaultStructTreeLayerFactory{createStructTreeLayerBuilder(t){return new StructTreeLayerBuilder({pdfPage:t})}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayerBuilder=r.DefaultXfaLayerFactory=void 0;var o=i(2);class XfaLayerBuilder{constructor({pageDiv:t,pdfPage:r,xfaHtml:i,annotationStorage:o}){this.pageDiv=t,this.pdfPage=r,this.xfaHtml=i,this.annotationStorage=o,this.div=null,this._cancelled=!1}render(t,r="display"){if("print"===r){const i={viewport:t.clone({dontFlip:!0}),div:this.div,xfa:this.xfaHtml,page:null,annotationStorage:this.annotationStorage,intent:r},a=document.createElement("div");return this.pageDiv.appendChild(a),i.div=a,o.XfaLayer.render(i),Promise.resolve()}return this.pdfPage.getXfa().then((i=>{if(this._cancelled)return;const a={viewport:t.clone({dontFlip:!0}),div:this.div,xfa:i,page:this.pdfPage,annotationStorage:this.annotationStorage,intent:r};this.div?o.XfaLayer.update(a):(this.div=document.createElement("div"),this.pageDiv.appendChild(this.div),a.div=this.div,o.XfaLayer.render(a))})).catch((t=>{console.error(t)}))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}r.XfaLayerBuilder=XfaLayerBuilder;r.DefaultXfaLayerFactory=class DefaultXfaLayerFactory{createXfaLayerBuilder(t,r,i=null,o=null){return new XfaLayerBuilder({pageDiv:t,pdfPage:r,annotationStorage:i,xfaHtml:o})}}},(t,r,i)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFViewer=void 0;var o=i(5),a=i(19),c=i(2);class PDFViewer extends a.BaseViewer{get _viewerElement(){return(0,c.shadow)(this,"_viewerElement",this.viewer)}_scrollIntoView({pageDiv:t,pageSpot:r=null,pageNumber:i=null}){if(!r&&!this.isInPresentationMode){const i=t.offsetLeft+t.clientLeft,o=i+t.clientWidth,{scrollLeft:a,clientWidth:c}=this.container;(this._isScrollModeHorizontal||i<a||o>a+c)&&(r={left:0,top:0})}super._scrollIntoView({pageDiv:t,pageSpot:r,pageNumber:i})}_getVisiblePages(){return this.isInPresentationMode?this._getCurrentVisiblePage():super._getVisiblePages()}_updateHelper(t){if(this.isInPresentationMode)return;let r=this._currentPageNumber,i=!1;for(const a of t){if(a.percent<100)break;if(a.id===r&&this._scrollMode===o.ScrollMode.VERTICAL&&this._spreadMode===o.SpreadMode.NONE){i=!0;break}}i||(r=t[0].id),this._setCurrentPageNumber(r)}}r.PDFViewer=PDFViewer}],r={};function __w_pdfjs_require__(i){var o=r[i];if(void 0!==o)return o.exports;var a=r[i]={exports:{}};return t[i](a,a.exports,__w_pdfjs_require__),a.exports}var o={};return(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return r.AnnotationLayerBuilder}}),Object.defineProperty(t,"DefaultAnnotationLayerFactory",{enumerable:!0,get:function(){return r.DefaultAnnotationLayerFactory}}),Object.defineProperty(t,"DefaultTextLayerFactory",{enumerable:!0,get:function(){return i.DefaultTextLayerFactory}}),Object.defineProperty(t,"TextLayerBuilder",{enumerable:!0,get:function(){return i.TextLayerBuilder}}),Object.defineProperty(t,"EventBus",{enumerable:!0,get:function(){return a.EventBus}}),Object.defineProperty(t,"ProgressBar",{enumerable:!0,get:function(){return a.ProgressBar}}),Object.defineProperty(t,"PDFLinkService",{enumerable:!0,get:function(){return c.PDFLinkService}}),Object.defineProperty(t,"SimpleLinkService",{enumerable:!0,get:function(){return c.SimpleLinkService}}),Object.defineProperty(t,"DownloadManager",{enumerable:!0,get:function(){return l.DownloadManager}}),Object.defineProperty(t,"GenericL10n",{enumerable:!0,get:function(){return u.GenericL10n}}),Object.defineProperty(t,"NullL10n",{enumerable:!0,get:function(){return d.NullL10n}}),Object.defineProperty(t,"PDFFindController",{enumerable:!0,get:function(){return h.PDFFindController}}),Object.defineProperty(t,"PDFHistory",{enumerable:!0,get:function(){return p.PDFHistory}}),Object.defineProperty(t,"PDFPageView",{enumerable:!0,get:function(){return g.PDFPageView}}),Object.defineProperty(t,"PDFScriptingManager",{enumerable:!0,get:function(){return m.PDFScriptingManager}}),Object.defineProperty(t,"PDFSinglePageViewer",{enumerable:!0,get:function(){return y.PDFSinglePageViewer}}),Object.defineProperty(t,"PDFViewer",{enumerable:!0,get:function(){return v.PDFViewer}});var r=__w_pdfjs_require__(1),i=__w_pdfjs_require__(6),a=__w_pdfjs_require__(5),c=__w_pdfjs_require__(4),l=__w_pdfjs_require__(7),u=__w_pdfjs_require__(9),d=__w_pdfjs_require__(3),h=__w_pdfjs_require__(11),p=__w_pdfjs_require__(13),g=__w_pdfjs_require__(14),m=__w_pdfjs_require__(16),y=__w_pdfjs_require__(18),v=__w_pdfjs_require__(22)})(),o})()}))},666:t=>{var r=function(t){"use strict";var r,i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function(t,r,i){return t[r]=i}}function wrap(t,r,i,o){var a=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(a.prototype),l=new Context(o||[]);return c._invoke=function makeInvokeMethod(t,r,i){var o=d;return function invoke(a,c){if(o===p)throw new Error("Generator is already running");if(o===g){if("throw"===a)throw c;return doneResult()}for(i.method=a,i.arg=c;;){var l=i.delegate;if(l){var u=maybeInvokeDelegate(l,i);if(u){if(u===m)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(o===d)throw o=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o=p;var y=tryCatch(t,r,i);if("normal"===y.type){if(o=i.done?g:h,y.arg===m)continue;return{value:y.arg,done:i.done}}"throw"===y.type&&(o=g,i.method="throw",i.arg=y.arg)}}}(t,i,l),c}function tryCatch(t,r,i){try{return{type:"normal",arg:t.call(r,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var d="suspendedStart",h="suspendedYield",p="executing",g="completed",m={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,c,(function(){return this}));var v=Object.getPrototypeOf,_=v&&v(v(values([])));_&&_!==i&&o.call(_,c)&&(y=_);var A=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,l){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var d=u.arg,h=d.value;return h&&"object"==typeof h&&o.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,c,l)}),(function(t){invoke("throw",t,c,l)})):r.resolve(h).then((function(t){d.value=t,c(d)}),(function(t){return invoke("throw",t,c,l)}))}l(u.arg)}var i;this._invoke=function enqueue(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return i=i?i.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(t,i){var o=t.iterator[i.method];if(o===r){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=r,maybeInvokeDelegate(t,i),"throw"===i.method))return m;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=tryCatch(o,t.iterator,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,m;var c=a.arg;return c?c.done?(i[t.resultName]=c.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=r),i.delegate=null,m):c:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,m)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var i=t[c];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,l=function next(){for(;++a<t.length;)if(o.call(t,a))return next.value=t[a],next.done=!1,next;return next.value=r,next.done=!0,next};return l.next=l}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(A,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,l,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,i,o,a,c){void 0===c&&(c=Promise);var l=new AsyncIterator(wrap(r,i,o,a),c);return t.isGeneratorFunction(i)?l:l.next().then((function(t){return t.done?t.value:l.next()}))},defineIteratorMethods(A),define(A,u,"Generator"),define(A,c,(function(){return this})),define(A,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=[];for(var i in t)r.push(i);return r.reverse(),function next(){for(;r.length;){var i=r.pop();if(i in t)return next.value=i,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!t)for(var i in this)"t"===i.charAt(0)&&o.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function handle(o,a){return l.type="throw",l.arg=t,i.next=o,a&&(i.method="next",i.arg=r),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a],l=c.completion;if("root"===c.tryLoc)return handle("end");if(c.tryLoc<=this.prev){var u=o.call(c,"catchLoc"),d=o.call(c,"finallyLoc");if(u&&d){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0);if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return handle(c.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return handle(c.finallyLoc)}}}},abrupt:function(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var l=c?c.completion:{};return l.type=t,l.arg=r,c?(this.method="next",this.next=c.finallyLoc,m):this.complete(l)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var a=o.arg;resetTryEntry(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,o){return this.delegate={iterator:values(t),resultName:i,nextLoc:o},"next"===this.method&&(this.arg=r),m}},t}(t.exports);try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},539:t=>{"use strict";const r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(t){return t.trim().split("\n").map((t=>t.trim()))},r.splitSections=function(t){return t.split("\nm=").map(((t,r)=>(r>0?"m="+t:t).trim()+"\r\n"))},r.getDescription=function(t){const i=r.splitSections(t);return i&&i[0]},r.getMediaSections=function(t){const i=r.splitSections(t);return i.shift(),i},r.matchPrefix=function(t,i){return r.splitLines(t).filter((t=>0===t.indexOf(i)))},r.parseCandidate=function(t){let r;r=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let t=8;t<r.length;t+=2)switch(r[t]){case"raddr":i.relatedAddress=r[t+1];break;case"rport":i.relatedPort=parseInt(r[t+1],10);break;case"tcptype":i.tcpType=r[t+1];break;case"ufrag":i.ufrag=r[t+1],i.usernameFragment=r[t+1];break;default:void 0===i[r[t]]&&(i[r[t]]=r[t+1])}return i},r.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;"rtp"===i?r.push(1):"rtcp"===i?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),"host"!==o&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},r.parseIceOptions=function(t){return t.substr(14).split(" ")},r.parseRtpMap=function(t){let r=t.substr(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=3===r.length?parseInt(r[2],10):1,i.numChannels=i.channels,i},r.writeRtpMap=function(t){let r=t.payloadType;void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(1!==i?"/"+i:"")+"\r\n"},r.parseExtmap=function(t){const r=t.substr(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1]}},r.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},r.parseFmtp=function(t){const r={};let i;const o=t.substr(t.indexOf(" ")+1).split(";");for(let t=0;t<o.length;t++)i=o[t].trim().split("="),r[i[0].trim()]=i[1];return r},r.writeFmtp=function(t){let r="",i=t.payloadType;if(void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach((r=>{void 0!==t.parameters[r]?o.push(r+"="+t.parameters[r]):o.push(r)})),r+="a=fmtp:"+i+" "+o.join(";")+"\r\n"}return r},r.parseRtcpFb=function(t){const r=t.substr(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},r.writeRtcpFb=function(t){let r="",i=t.payloadType;return void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach((t=>{r+="a=rtcp-fb:"+i+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"})),r},r.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substr(7,r-7),10)},o=t.indexOf(":",r);return o>-1?(i.attribute=t.substr(r+1,o-r-1),i.value=t.substr(o+1)):i.attribute=t.substr(r+1),i},r.parseSsrcGroup=function(t){const r=t.substr(13).split(" ");return{semantics:r.shift(),ssrcs:r.map((t=>parseInt(t,10)))}},r.getMid=function(t){const i=r.matchPrefix(t,"a=mid:")[0];if(i)return i.substr(6)},r.parseFingerprint=function(t){const r=t.substr(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},r.getDtlsParameters=function(t,i){return{role:"auto",fingerprints:r.matchPrefix(t+i,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(t,r){let i="a=setup:"+r+"\r\n";return t.fingerprints.forEach((t=>{i+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"})),i},r.parseCryptoLine=function(t){const r=t.substr(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},r.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+("object"==typeof t.keyParams?r.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(t){if(0!==t.indexOf("inline:"))return null;const r=t.substr(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},r.getCryptoParameters=function(t,i){return r.matchPrefix(t+i,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(t,i){const o=r.matchPrefix(t+i,"a=ice-ufrag:")[0],a=r.matchPrefix(t+i,"a=ice-pwd:")[0];return o&&a?{usernameFragment:o.substr(12),password:a.substr(10)}:null},r.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n";return t.iceLite&&(r+="a=ice-lite\r\n"),r},r.parseRtpParameters=function(t){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=r.splitLines(t)[0].split(" ");for(let a=3;a<o.length;a++){const c=o[a],l=r.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(l){const o=r.parseRtpMap(l),a=r.matchPrefix(t,"a=fmtp:"+c+" ");switch(o.parameters=a.length?r.parseFmtp(a[0]):{},o.rtcpFeedback=r.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(r.parseRtcpFb),i.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(t,"a=extmap:").forEach((t=>{i.headerExtensions.push(r.parseExtmap(t))})),i},r.writeRtpDescription=function(t,i){let o="";o+="m="+t+" ",o+=i.codecs.length>0?"9":"0",o+=" UDP/TLS/RTP/SAVPF ",o+=i.codecs.map((t=>void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType)).join(" ")+"\r\n",o+="c=IN IP4 0.0.0.0\r\n",o+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((t=>{o+=r.writeRtpMap(t),o+=r.writeFmtp(t),o+=r.writeRtcpFb(t)}));let a=0;return i.codecs.forEach((t=>{t.maxptime>a&&(a=t.maxptime)})),a>0&&(o+="a=maxptime:"+a+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach((t=>{o+=r.writeExtmap(t)})),o},r.parseRtpEncodingParameters=function(t){const i=[],o=r.parseRtpParameters(t),a=-1!==o.fecMechanisms.indexOf("RED"),c=-1!==o.fecMechanisms.indexOf("ULPFEC"),l=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"cname"===t.attribute)),u=l.length>0&&l[0].ssrc;let d;const h=r.matchPrefix(t,"a=ssrc-group:FID").map((t=>t.substr(17).split(" ").map((t=>parseInt(t,10)))));h.length>0&&h[0].length>1&&h[0][0]===u&&(d=h[0][1]),o.codecs.forEach((t=>{if("RTX"===t.name.toUpperCase()&&t.parameters.apt){let r={ssrc:u,codecPayloadType:parseInt(t.parameters.apt,10)};u&&d&&(r.rtx={ssrc:d}),i.push(r),a&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:u,mechanism:c?"red+ulpfec":"red"},i.push(r))}})),0===i.length&&u&&i.push({ssrc:u});let p=r.matchPrefix(t,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,i.forEach((t=>{t.maxBitrate=p}))),i},r.parseRtcpParameters=function(t){const i={},o=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"cname"===t.attribute))[0];o&&(i.cname=o.value,i.ssrc=o.ssrc);const a=r.matchPrefix(t,"a=rtcp-rsize");i.reducedSize=a.length>0,i.compound=0===a.length;const c=r.matchPrefix(t,"a=rtcp-mux");return i.mux=c.length>0,i},r.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+="a=rtcp-rsize\r\n"),t.mux&&(r+="a=rtcp-mux\r\n"),void 0!==t.ssrc&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+"\r\n"),r},r.parseMsid=function(t){let i;const o=r.matchPrefix(t,"a=msid:");if(1===o.length)return i=o[0].substr(7).split(" "),{stream:i[0],track:i[1]};const a=r.matchPrefix(t,"a=ssrc:").map((t=>r.parseSsrcMedia(t))).filter((t=>"msid"===t.attribute));return a.length>0?(i=a[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},r.parseSctpDescription=function(t){const i=r.parseMLine(t),o=r.matchPrefix(t,"a=max-message-size:");let a;o.length>0&&(a=parseInt(o[0].substr(19),10)),isNaN(a)&&(a=65536);const c=r.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substr(12),10),protocol:i.fmt,maxMessageSize:a};const l=r.matchPrefix(t,"a=sctpmap:");if(l.length>0){const t=l[0].substr(10).split(" ");return{port:parseInt(t[0],10),protocol:t[1],maxMessageSize:a}}},r.writeSctpDescription=function(t,r){let i=[];return i="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+r.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+r.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+r.port+" "+r.protocol+" 65535\r\n"],void 0!==r.maxMessageSize&&i.push("a=max-message-size:"+r.maxMessageSize+"\r\n"),i.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(t,i,o){let a;const c=void 0!==i?i:2;a=t||r.generateSessionId();return"v=0\r\no="+(o||"thisisadapterortc")+" "+a+" "+c+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.getDirection=function(t,i){const o=r.splitLines(t);for(let t=0;t<o.length;t++)switch(o[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[t].substr(2)}return i?r.getDirection(i):"sendrecv"},r.getKind=function(t){return r.splitLines(t)[0].split(" ")[0].substr(2)},r.isRejected=function(t){return"0"===t.split(" ",2)[1]},r.parseMLine=function(t){const i=r.splitLines(t)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},r.parseOLine=function(t){const i=r.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},r.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;const i=r.splitLines(t);for(let t=0;t<i.length;t++)if(i[t].length<2||"="!==i[t].charAt(1))return!1;return!0},t.exports=r},379:(t,r,i)=>{"use strict";var o=function isOldIE(){var t;return function memorize(){return void 0===t&&(t=Boolean(window&&document&&document.all&&!window.atob)),t}}(),a=function getTarget(){var t={};return function memorize(r){if(void 0===t[r]){var i=document.querySelector(r);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[r]=i}return t[r]}}(),c=[];function getIndexByIdentifier(t){for(var r=-1,i=0;i<c.length;i++)if(c[i].identifier===t){r=i;break}return r}function modulesToDom(t,r){for(var i={},o=[],a=0;a<t.length;a++){var l=t[a],u=r.base?l[0]+r.base:l[0],d=i[u]||0,h="".concat(u," ").concat(d);i[u]=d+1;var p=getIndexByIdentifier(h),g={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(c[p].references++,c[p].updater(g)):c.push({identifier:h,updater:addStyle(g,r),references:1}),o.push(h)}return o}function insertStyleElement(t){var r=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var c=i.nc;c&&(o.nonce=c)}if(Object.keys(o).forEach((function(t){r.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(r);else{var l=a(t.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(r)}return r}var l=function replaceText(){var t=[];return function replace(r,i){return t[r]=i,t.filter(Boolean).join("\n")}}();function applyToSingletonTag(t,r,i,o){var a=i?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=l(r,a);else{var c=document.createTextNode(a),u=t.childNodes;u[r]&&t.removeChild(u[r]),u.length?t.insertBefore(c,u[r]):t.appendChild(c)}}function applyToTag(t,r,i){var o=i.css,a=i.media,c=i.sourceMap;if(a?t.setAttribute("media",a):t.removeAttribute("media"),c&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(c))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var u=null,d=0;function addStyle(t,r){var i,o,a;if(r.singleton){var c=d++;i=u||(u=insertStyleElement(r)),o=applyToSingletonTag.bind(null,i,c,!1),a=applyToSingletonTag.bind(null,i,c,!0)}else i=insertStyleElement(r),o=applyToTag.bind(null,i,r),a=function remove(){!function removeStyleElement(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return o(t),function updateStyle(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;o(t=r)}else a()}}t.exports=function(t,r){(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=o());var i=modulesToDom(t=t||[],r);return function update(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<i.length;o++){var a=getIndexByIdentifier(i[o]);c[a].references--}for(var l=modulesToDom(t,r),u=0;u<i.length;u++){var d=getIndexByIdentifier(i[u]);0===c[d].references&&(c[d].updater(),c.splice(d,1))}i=l}}}},835:(t,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>y});var o={};i.r(o),i.d(o,{fixNegotiationNeeded:()=>fixNegotiationNeeded,shimAddTrackRemoveTrack:()=>shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative:()=>shimAddTrackRemoveTrackWithNative,shimGetDisplayMedia:()=>shimGetDisplayMedia,shimGetSendersWithDtmf:()=>shimGetSendersWithDtmf,shimGetStats:()=>shimGetStats,shimGetUserMedia:()=>shimGetUserMedia,shimMediaStream:()=>shimMediaStream,shimOnTrack:()=>shimOnTrack,shimPeerConnection:()=>shimPeerConnection,shimSenderReceiverGetStats:()=>shimSenderReceiverGetStats});var a={};i.r(a),i.d(a,{shimAddTransceiver:()=>shimAddTransceiver,shimCreateAnswer:()=>shimCreateAnswer,shimCreateOffer:()=>shimCreateOffer,shimGetDisplayMedia:()=>getdisplaymedia_shimGetDisplayMedia,shimGetParameters:()=>shimGetParameters,shimGetUserMedia:()=>getusermedia_shimGetUserMedia,shimOnTrack:()=>firefox_shim_shimOnTrack,shimPeerConnection:()=>firefox_shim_shimPeerConnection,shimRTCDataChannel:()=>shimRTCDataChannel,shimReceiverGetStats:()=>shimReceiverGetStats,shimRemoveStream:()=>shimRemoveStream,shimSenderGetStats:()=>shimSenderGetStats});var c={};i.r(c),i.d(c,{shimAudioContext:()=>shimAudioContext,shimCallbacksAPI:()=>shimCallbacksAPI,shimConstraints:()=>shimConstraints,shimCreateOfferLegacy:()=>shimCreateOfferLegacy,shimGetUserMedia:()=>safari_shim_shimGetUserMedia,shimLocalStreamsAPI:()=>shimLocalStreamsAPI,shimRTCIceServerUrls:()=>shimRTCIceServerUrls,shimRemoteStreamsAPI:()=>shimRemoteStreamsAPI,shimTrackEventTransceiver:()=>shimTrackEventTransceiver});var l={};i.r(l),i.d(l,{removeExtmapAllowMixed:()=>removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty:()=>shimAddIceCandidateNullOrEmpty,shimConnectionState:()=>shimConnectionState,shimMaxMessageSize:()=>shimMaxMessageSize,shimRTCIceCandidate:()=>shimRTCIceCandidate,shimSendThrowTypeError:()=>shimSendThrowTypeError});let u=!0,d=!0;function extractVersion(t,r,i){const o=t.match(r);return o&&o.length>=i&&parseInt(o[i],10)}function wrapPeerConnectionEvent(t,r,i){if(!t.RTCPeerConnection)return;const o=t.RTCPeerConnection.prototype,a=o.addEventListener;o.addEventListener=function(t,o){if(t!==r)return a.apply(this,arguments);const wrappedCallback=t=>{const r=i(t);r&&(o.handleEvent?o.handleEvent(r):o(r))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(o,wrappedCallback),a.apply(this,[t,wrappedCallback])};const c=o.removeEventListener;o.removeEventListener=function(t,i){if(t!==r||!this._eventMap||!this._eventMap[r])return c.apply(this,arguments);if(!this._eventMap[r].has(i))return c.apply(this,arguments);const o=this._eventMap[r].get(i);return this._eventMap[r].delete(i),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,c.apply(this,[t,o])},Object.defineProperty(o,"on"+r,{get(){return this["_on"+r]},set(t){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),t&&this.addEventListener(r,this["_on"+r]=t)},enumerable:!0,configurable:!0})}function disableLog(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(u=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(d=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function log(){if("object"==typeof window){if(u)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function deprecated(t,r){d&&console.warn(t+" is deprecated, please use "+r+" instead.")}function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function compactObject(t){return isObject(t)?Object.keys(t).reduce((function(r,i){const o=isObject(t[i]),a=o?compactObject(t[i]):t[i],c=o&&!Object.keys(a).length;return void 0===a||c?r:Object.assign(r,{[i]:a})}),{}):t}function walkStats(t,r,i){r&&!i.has(r.id)&&(i.set(r.id,r),Object.keys(r).forEach((o=>{o.endsWith("Id")?walkStats(t,t.get(r[o]),i):o.endsWith("Ids")&&r[o].forEach((r=>{walkStats(t,t.get(r),i)}))})))}function filterStats(t,r,i){const o=i?"outbound-rtp":"inbound-rtp",a=new Map;if(null===r)return a;const c=[];return t.forEach((t=>{"track"===t.type&&t.trackIdentifier===r.id&&c.push(t)})),c.forEach((r=>{t.forEach((i=>{i.type===o&&i.trackId===r.id&&walkStats(t,i,a)}))})),a}const h=log;function shimGetUserMedia(t,r){const i=t&&t.navigator;if(!i.mediaDevices)return;const constraintsToChrome_=function(t){if("object"!=typeof t||t.mandatory||t.optional)return t;const r={};return Object.keys(t).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const o="object"==typeof t[i]?t[i]:{ideal:t[i]};void 0!==o.exact&&"number"==typeof o.exact&&(o.min=o.max=o.exact);const oldname_=function(t,r){return t?t+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==o.ideal){r.optional=r.optional||[];let t={};"number"==typeof o.ideal?(t[oldname_("min",i)]=o.ideal,r.optional.push(t),t={},t[oldname_("max",i)]=o.ideal,r.optional.push(t)):(t[oldname_("",i)]=o.ideal,r.optional.push(t))}void 0!==o.exact&&"number"!=typeof o.exact?(r.mandatory=r.mandatory||{},r.mandatory[oldname_("",i)]=o.exact):["min","max"].forEach((t=>{void 0!==o[t]&&(r.mandatory=r.mandatory||{},r.mandatory[oldname_(t,i)]=o[t])}))})),t.advanced&&(r.optional=(r.optional||[]).concat(t.advanced)),r},shimConstraints_=function(t,o){if(r.version>=61)return o(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"==typeof t.audio){const remap=function(t,r,i){r in t&&!(i in t)&&(t[i]=t[r],delete t[r])};remap((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),remap(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=constraintsToChrome_(t.audio)}if(t&&"object"==typeof t.video){let a=t.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const c=r.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||c)){let r;if(delete t.video.facingMode,"environment"===a.exact||"environment"===a.ideal?r=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(r=["front"]),r)return i.mediaDevices.enumerateDevices().then((i=>{let c=(i=i.filter((t=>"videoinput"===t.kind))).find((t=>r.some((r=>t.label.toLowerCase().includes(r)))));return!c&&i.length&&r.includes("back")&&(c=i[i.length-1]),c&&(t.video.deviceId=a.exact?{exact:c.deviceId}:{ideal:c.deviceId}),t.video=constraintsToChrome_(t.video),h("chrome: "+JSON.stringify(t)),o(t)}))}t.video=constraintsToChrome_(t.video)}return h("chrome: "+JSON.stringify(t)),o(t)},shimError_=function(t){return r.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(t,r,o){shimConstraints_(t,(t=>{i.webkitGetUserMedia(t,r,(t=>{o&&o(shimError_(t))}))}))}.bind(i),i.mediaDevices.getUserMedia){const t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(r){return shimConstraints_(r,(r=>t(r).then((t=>{if(r.audio&&!t.getAudioTracks().length||r.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((t=>{t.stop()})),new DOMException("","NotFoundError");return t}),(t=>Promise.reject(shimError_(t))))))}}}function shimGetDisplayMedia(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&("function"==typeof r?t.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){return r(i).then((r=>{const o=i.video&&i.video.width,a=i.video&&i.video.height,c=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:c||3}},o&&(i.video.mandatory.maxWidth=o),a&&(i.video.mandatory.maxHeight=a),t.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function shimMediaStream(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function shimOnTrack(t){if("object"==typeof t&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",(i=>{let o;o=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((t=>t.track&&t.track.id===i.track.id)):{track:i.track};const a=new Event("track");a.track=i.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)})),r.stream.getTracks().forEach((i=>{let o;o=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((t=>t.track&&t.track.id===i.id)):{track:i};const a=new Event("track");a.track=i,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else wrapPeerConnectionEvent(t,"track",(t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t)))}function shimGetSendersWithDtmf(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const shimSenderWithDtmf=function(t,r){return{track:r,get dtmf(){return void 0===this._dtmf&&("audio"===r.kind?this._dtmf=t.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function getSenders(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function addTrack(t,i){let o=r.apply(this,arguments);return o||(o=shimSenderWithDtmf(this,t),this._senders.push(o)),o};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){i.apply(this,arguments);const r=this._senders.indexOf(t);-1!==r&&this._senders.splice(r,1)}}const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._senders=this._senders||[],r.apply(this,[t]),t.getTracks().forEach((t=>{this._senders.push(shimSenderWithDtmf(this,t))}))};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._senders=this._senders||[],i.apply(this,[t]),t.getTracks().forEach((t=>{const r=this._senders.find((r=>r.track===t));r&&this._senders.splice(this._senders.indexOf(r),1)}))}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){const[t,i,o]=arguments;if(arguments.length>0&&"function"==typeof t)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof t))return r.apply(this,[]);const fixChromeStats_=function(t){const r={};return t.result().forEach((t=>{const i={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach((r=>{i[r]=t.stat(r)})),r[i.id]=i})),r},makeMapStats=function(t){return new Map(Object.keys(t).map((r=>[r,t[r]])))};if(arguments.length>=2){const successCallbackWrapper_=function(t){i(makeMapStats(fixChromeStats_(t)))};return r.apply(this,[successCallbackWrapper_,t])}return new Promise(((t,i)=>{r.apply(this,[function(r){t(makeMapStats(fixChromeStats_(r)))},i])})).then(i,o)}}function shimSenderReceiverGetStats(t){if(!("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function addTrack(){const t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function getStats(){const t=this;return this._pc.getStats().then((r=>filterStats(r,t.track,!0)))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t}),wrapPeerConnectionEvent(t,"track",(t=>(t.receiver._pc=t.srcElement,t))),t.RTCRtpReceiver.prototype.getStats=function getStats(){const t=this;return this._pc.getStats().then((r=>filterStats(r,t.track,!1)))}}if(!("getStats"in t.RTCRtpSender.prototype)||!("getStats"in t.RTCRtpReceiver.prototype))return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const t=arguments[0];let r,i,o;return this.getSenders().forEach((i=>{i.track===t&&(r?o=!0:r=i)})),this.getReceivers().forEach((r=>(r.track===t&&(i?o=!0:i=r),r.track===t))),o||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(t){t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((t=>this._shimmedLocalStreams[t][0]))};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function addTrack(t,i){if(!i)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const o=r.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(o)&&this._shimmedLocalStreams[i.id].push(o):this._shimmedLocalStreams[i.id]=[i,o],o};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach((t=>{if(this.getSenders().find((r=>r.track===t)))throw new DOMException("Track already exists.","InvalidAccessError")}));const r=this.getSenders();i.apply(this,arguments);const o=this.getSenders().filter((t=>-1===r.indexOf(t)));this._shimmedLocalStreams[t.id]=[t].concat(o)};const o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function removeStream(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],o.apply(this,arguments)};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach((r=>{const i=this._shimmedLocalStreams[r].indexOf(t);-1!==i&&this._shimmedLocalStreams[r].splice(i,1),1===this._shimmedLocalStreams[r].length&&delete this._shimmedLocalStreams[r]})),a.apply(this,arguments)}}function shimAddTrackRemoveTrack(t,r){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return shimAddTrackRemoveTrackWithNative(t);const i=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){const t=i.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((t=>this._reverseStreams[t.id]))};const o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function addStream(r){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.getTracks().forEach((t=>{if(this.getSenders().find((r=>r.track===t)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[r.id]){const i=new t.MediaStream(r.getTracks());this._streams[r.id]=i,this._reverseStreams[i.id]=r,r=i}o.apply(this,[r])};const a=t.RTCPeerConnection.prototype.removeStream;function replaceInternalStreamId(t,r){let i=r.sdp;return Object.keys(t._reverseStreams||[]).forEach((r=>{const o=t._reverseStreams[r],a=t._streams[o.id];i=i.replace(new RegExp(a.id,"g"),o.id)})),new RTCSessionDescription({type:r.type,sdp:i})}function replaceExternalStreamId(t,r){let i=r.sdp;return Object.keys(t._reverseStreams||[]).forEach((r=>{const o=t._reverseStreams[r],a=t._streams[o.id];i=i.replace(new RegExp(o.id,"g"),a.id)})),new RTCSessionDescription({type:r.type,sdp:i})}t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function addTrack(r,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((t=>t===r)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const a=this.getSenders().find((t=>t.track===r));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const c=this._streams[i.id];if(c)c.addTrack(r),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const o=new t.MediaStream([r]);this._streams[i.id]=o,this._reverseStreams[o.id]=i,this.addStream(o)}return this.getSenders().find((t=>t.track===r))},["createOffer","createAnswer"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){const t=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[r=>{const i=replaceInternalStreamId(this,r);t[0].apply(null,[i])},r=>{t[1]&&t[1].apply(null,r)},arguments[2]]):i.apply(this,arguments).then((t=>replaceInternalStreamId(this,t)))}};t.RTCPeerConnection.prototype[r]=o[r]}));const c=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){return arguments.length&&arguments[0].type?(arguments[0]=replaceExternalStreamId(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const t=l.get.apply(this);return""===t.type?t:replaceInternalStreamId(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function removeTrack(t){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let r;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((r=>t.track===r))&&(r=this._streams[i])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]}))}function fixNegotiationNeeded(t,r){wrapPeerConnectionEvent(t,"negotiationneeded",(t=>{const i=t.target;if(!(r.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return t}))}function getusermedia_shimGetUserMedia(t,r){const i=t&&t.navigator,o=t&&t.MediaStreamTrack;if(i.getUserMedia=function(t,r,o){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(t).then(r,o)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const remap=function(t,r,i){r in t&&!(i in t)&&(t[i]=t[r],delete t[r])},t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),remap(r.audio,"autoGainControl","mozAutoGainControl"),remap(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},o&&o.prototype.getSettings){const t=o.prototype.getSettings;o.prototype.getSettings=function(){const r=t.apply(this,arguments);return remap(r,"mozAutoGainControl","autoGainControl"),remap(r,"mozNoiseSuppression","noiseSuppression"),r}}if(o&&o.prototype.applyConstraints){const t=o.prototype.applyConstraints;o.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(JSON.stringify(r)),remap(r,"autoGainControl","mozAutoGainControl"),remap(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function getdisplaymedia_shimGetDisplayMedia(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(i){if(!i||!i.video){const t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}return!0===i.video?i.video={mediaSource:r}:i.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(i)})}function firefox_shim_shimOnTrack(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function firefox_shim_shimPeerConnection(t,r){if("object"!=typeof t||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(r){const i=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]}));const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function getStats(){const[t,a,c]=arguments;return o.apply(this,[t||null]).then((t=>{if(r.version<53&&!a)try{t.forEach((t=>{t.type=i[t.type]||t.type}))}catch(r){if("TypeError"!==r.name)throw r;t.forEach(((r,o)=>{t.set(o,Object.assign({},r,{type:i[r.type]||r.type}))}))}return t})).then(a,c)}}function shimSenderGetStats(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function getSenders(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function addTrack(){const t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function getStats(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender)return;if(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function getReceivers(){const t=r.apply(this,[]);return t.forEach((t=>t._pc=this)),t}),wrapPeerConnectionEvent(t,"track",(t=>(t.receiver._pc=t.srcElement,t))),t.RTCRtpReceiver.prototype.getStats=function getStats(){return this._pc.getStats(this.track)}}function shimRemoveStream(t){t.RTCPeerConnection&&!("removeStream"in t.RTCPeerConnection.prototype)&&(t.RTCPeerConnection.prototype.removeStream=function removeStream(t){deprecated("removeStream","removeTrack"),this.getSenders().forEach((r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)}))})}function shimRTCDataChannel(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function shimAddTransceiver(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function addTransceiver(){this.setParametersPromises=[];const t=arguments[1],i=t&&"sendEncodings"in t;i&&t.sendEncodings.forEach((t=>{if("rid"in t){if(!/^[a-z0-9]{0,16}$/i.test(t.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const o=r.apply(this,arguments);if(i){const{sender:r}=o,i=r.getParameters();(!("encodings"in i)||1===i.encodings.length&&0===Object.keys(i.encodings[0]).length)&&(i.encodings=t.sendEncodings,r.sendEncodings=t.sendEncodings,this.setParametersPromises.push(r.setParameters(i).then((()=>{delete r.sendEncodings})).catch((()=>{delete r.sendEncodings}))))}return o})}function shimGetParameters(t){if("object"!=typeof t||!t.RTCRtpSender)return;const r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function getParameters(){const t=r.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function shimCreateOffer(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function createOffer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>r.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):r.apply(this,arguments)}}function shimCreateAnswer(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function createAnswer(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>r.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):r.apply(this,arguments)}}function shimLocalStreamsAPI(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function addStream(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach((i=>r.call(this,i,t))),t.getVideoTracks().forEach((i=>r.call(this,i,t)))},t.RTCPeerConnection.prototype.addTrack=function addTrack(t,...i){return i&&i.forEach((t=>{this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]})),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function removeStream(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(-1===r)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach((t=>{i.includes(t.track)&&this.removeTrack(t)}))})}}function shimRemoteStreamsAPI(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function getRemoteStreams(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=t=>{t.streams.forEach((t=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(t))return;this._remoteStreams.push(t);const r=new Event("addstream");r.stream=t,this.dispatchEvent(r)}))})}});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach((r=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(r)>=0)return;t._remoteStreams.push(r);const i=new Event("addstream");i.stream=r,t.dispatchEvent(i)}))}),r.apply(t,arguments)}}}function shimCallbacksAPI(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.createOffer,o=r.createAnswer,a=r.setLocalDescription,c=r.setRemoteDescription,l=r.addIceCandidate;r.createOffer=function createOffer(t,r){const o=arguments.length>=2?arguments[2]:arguments[0],a=i.apply(this,[o]);return r?(a.then(t,r),Promise.resolve()):a},r.createAnswer=function createAnswer(t,r){const i=arguments.length>=2?arguments[2]:arguments[0],a=o.apply(this,[i]);return r?(a.then(t,r),Promise.resolve()):a};let withCallback=function(t,r,i){const o=a.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o};r.setLocalDescription=withCallback,withCallback=function(t,r,i){const o=c.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o},r.setRemoteDescription=withCallback,withCallback=function(t,r,i){const o=l.apply(this,[t]);return i?(o.then(r,i),Promise.resolve()):o},r.addIceCandidate=withCallback}function safari_shim_shimGetUserMedia(t){const r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const t=r.mediaDevices,i=t.getUserMedia.bind(t);r.mediaDevices.getUserMedia=t=>i(shimConstraints(t))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function getUserMedia(t,i,o){r.mediaDevices.getUserMedia(t).then(i,o)}.bind(r))}function shimConstraints(t){return t&&void 0!==t.video?Object.assign({},t,{video:compactObject(t.video)}):t}function shimRTCIceServerUrls(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection;t.RTCPeerConnection=function RTCPeerConnection(t,i){if(t&&t.iceServers){const r=[];for(let i=0;i<t.iceServers.length;i++){let o=t.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,r.push(o)):r.push(t.iceServers[i])}t.iceServers=r}return new r(t,i)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>r.generateCertificate})}function shimTrackEventTransceiver(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(t){const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function createOffer(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const r=this.getTransceivers().find((t=>"audio"===t.receiver.track.kind));!1===t.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==t.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const i=this.getTransceivers().find((t=>"video"===t.receiver.track.kind));!1===t.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==t.offerToReceiveVideo||i||this.addTransceiver("video")}return r.apply(this,arguments)}}function shimAudioContext(t){"object"!=typeof t||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var p=i(539),g=i.n(p);function shimRTCIceCandidate(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const r=t.RTCIceCandidate;t.RTCIceCandidate=function RTCIceCandidate(t){if("object"==typeof t&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){const i=new r(t),o=g().parseCandidate(t.candidate),a=Object.assign(i,o);return a.toJSON=function toJSON(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new r(t)},t.RTCIceCandidate.prototype=r.prototype,wrapPeerConnectionEvent(t,"icecandidate",(r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"}),r)))}function shimMaxMessageSize(t,r){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const sctpInDescription=function(t){if(!t||!t.sdp)return!1;const r=g().splitSections(t.sdp);return r.shift(),r.some((t=>{const r=g().parseMLine(t);return r&&"application"===r.kind&&-1!==r.protocol.indexOf("SCTP")}))},getRemoteFirefoxVersion=function(t){const r=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===r||r.length<2)return-1;const i=parseInt(r[1],10);return i!=i?-1:i},getCanSendMaxMessageSize=function(t){let i=65536;return"firefox"===r.browser&&(i=r.version<57?-1===t?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),i},getMaxMessageSize=function(t,i){let o=65536;"firefox"===r.browser&&57===r.version&&(o=65535);const a=g().matchPrefix(t.sdp,"a=max-message-size:");return a.length>0?o=parseInt(a[0].substr(19),10):"firefox"===r.browser&&-1!==i&&(o=2147483637),o},i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){if(this._sctp=null,"chrome"===r.browser&&r.version>=76){const{sdpSemantics:t}=this.getConfiguration();"plan-b"===t&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(sctpInDescription(arguments[0])){const t=getRemoteFirefoxVersion(arguments[0]),r=getCanSendMaxMessageSize(t),i=getMaxMessageSize(arguments[0],t);let o;o=0===r&&0===i?Number.POSITIVE_INFINITY:0===r||0===i?Math.max(r,i):Math.min(r,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this._sctp=a}return i.apply(this,arguments)}}function shimSendThrowTypeError(t){if(!t.RTCPeerConnection||!("createDataChannel"in t.RTCPeerConnection.prototype))return;function wrapDcSend(t,r){const i=t.send;t.send=function send(){const o=arguments[0],a=o.length||o.size||o.byteLength;if("open"===t.readyState&&r.sctp&&a>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return i.apply(t,arguments)}}const r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function createDataChannel(){const t=r.apply(this,arguments);return wrapDcSend(t,this),t},wrapPeerConnectionEvent(t,"datachannel",(t=>(wrapDcSend(t.channel,t.target),t)))}function shimConnectionState(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((t=>{const i=r[t];r[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=t=>{const r=t.target;if(r._lastConnectionState!==r.connectionState){r._lastConnectionState=r.connectionState;const i=new Event("connectionstatechange",t);r.dispatchEvent(i)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function removeExtmapAllowMixed(t,r){if(!t.RTCPeerConnection)return;if("chrome"===r.browser&&r.version>=71)return;if("safari"===r.browser&&r.version>=605)return;const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(r){if(r&&r.sdp&&-1!==r.sdp.indexOf("\na=extmap-allow-mixed")){const i=r.sdp.split("\n").filter((t=>"a=extmap-allow-mixed"!==t.trim())).join("\n");t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:i}):r.sdp=i}return i.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(t,r){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const i=t.RTCPeerConnection.prototype.addIceCandidate;i&&0!==i.length&&(t.RTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(){return arguments[0]?("chrome"===r.browser&&r.version<78||"firefox"===r.browser&&r.version<68||"safari"===r.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const m=function adapterFactory({window:t}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=log,u=function detectBrowser(t){const r={browser:null,version:null};if(void 0===t||!t.navigator)return r.browser="Not a browser.",r;const{navigator:i}=t;if(i.mozGetUserMedia)r.browser="firefox",r.version=extractVersion(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection&&!t.RTCIceGatherer)r.browser="chrome",r.version=extractVersion(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!t.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=extractVersion(i.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return r}(t),d={browserDetails:u,commonShim:l,extractVersion,disableLog,disableWarnings,sdp:p};switch(u.browser){case"chrome":if(!o||!shimPeerConnection||!r.shimChrome)return i("Chrome shim is not included in this adapter release."),d;if(null===u.version)return i("Chrome shim can not determine version, not shimming."),d;i("adapter.js shimming chrome."),d.browserShim=o,shimAddIceCandidateNullOrEmpty(t,u),shimGetUserMedia(t,u),shimMediaStream(t),shimPeerConnection(t,u),shimOnTrack(t),shimAddTrackRemoveTrack(t,u),shimGetSendersWithDtmf(t),shimGetStats(t),shimSenderReceiverGetStats(t),fixNegotiationNeeded(t,u),shimRTCIceCandidate(t),shimConnectionState(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,u);break;case"firefox":if(!a||!firefox_shim_shimPeerConnection||!r.shimFirefox)return i("Firefox shim is not included in this adapter release."),d;i("adapter.js shimming firefox."),d.browserShim=a,shimAddIceCandidateNullOrEmpty(t,u),getusermedia_shimGetUserMedia(t,u),firefox_shim_shimPeerConnection(t,u),firefox_shim_shimOnTrack(t),shimRemoveStream(t),shimSenderGetStats(t),shimReceiverGetStats(t),shimRTCDataChannel(t),shimAddTransceiver(t),shimGetParameters(t),shimCreateOffer(t),shimCreateAnswer(t),shimRTCIceCandidate(t),shimConnectionState(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t);break;case"safari":if(!c||!r.shimSafari)return i("Safari shim is not included in this adapter release."),d;i("adapter.js shimming safari."),d.browserShim=c,shimAddIceCandidateNullOrEmpty(t,u),shimRTCIceServerUrls(t),shimCreateOfferLegacy(t),shimCallbacksAPI(t),shimLocalStreamsAPI(t),shimRemoteStreamsAPI(t),shimTrackEventTransceiver(t),safari_shim_shimGetUserMedia(t),shimAudioContext(t),shimRTCIceCandidate(t),shimMaxMessageSize(t,u),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,u);break;default:i("Unsupported browser!")}return d}({window:"undefined"==typeof window?void 0:window}),y=m},67:t=>{"use strict";t.exports="data:font/ttf;base64,AAEAAAALAIAAAwAwT1MvMg8SDCIAAAC8AAAAYGNtYXCkzqBtAAABHAAAAJxnYXNwAAAAEAAAAbgAAAAIZ2x5ZidmXZ0AAAHAAAAPbGhlYWQb4iunAAARLAAAADZoaGVhB8ID2gAAEWQAAAAkaG10eFoAB1AAABGIAAAAZGxvY2ErdjCEAAAR7AAAADRtYXhwADoAywAAEiAAAAAgbmFtZUEbxNgAABJAAAABwnBvc3QAAwAAAAAUBAAAACAAAwPpAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADvDwPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAgAAAABwAEAADAAwAAQAg6Qjs+e0W7UPtT+1s7XLtf+477w///f//AAAAAAAg6QDs+e0W7UPtT+1s7XLtf+477wz//f//AAH/4xcEExQS+BLMEsESpRKgEpQR2REJAAMAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAAbAAD/qwQAA6sAAwAHAAsADwATABcAGwAfACMAJwArAC8AMwA3ADsAPwBDAEcASwBPAFMAVwBbAF8AYwBnAGsAABMhESEhMzUjBTM1IwczNSMHMzUjFzM1IwUzNSMRMzUjETM1IxEzNSM1MzUjETM1IxUzNSMVMzUjERUzNQczNSMHMzUjBzM1IwczNSMHMzUjETM1IzUzNSMRMzUjETM1IxEzNSM1MzUjETM1IwABLf7TAaY8PAGzNTVrNTXXNjZsNTUBQTw8PDw8PDw8PDw8PDw8PDw8pzU1azU1azU1bDY2cTw8PDw8PDw8PDw8PDw8PDwDq/wAPDw8PDw8PDw8PDwDDzz88TwBpjw8Pf7TPLU8tDwC0z09PT09PT09PT09Pfx4PD08AS08/tM8AS09PDz+WzwAAAAgAAD/qwQAA6sAAwAHAAsADwAUABgAHQAiACYAKgAuADIANgA6AD4AQgBGAEsAUABUAFgAXABgAGUAaQBtAHEAdQB5AH0AgQCFAAAXMxUjITM1IwczNSMHMzUjBzM1IxUjMzUjBzM1IxU7ATUjFSEzNSMRMzUjFTM1IxEzNSMRMzUjNTM1IzUzNSMRMzUjERUzNQUzNSMVIzM1IxUhMzUjBzM1IwczNSMFMzUjBTM1IxUhMzUjETM1IxUzNSM1MzUjETM1IxEzNSMRMzUjETM1IwA8PANLPT14PDx5PT14PDx5PT3xPT15PDwC0zw8PDw8PDw8PDw8PDw8PDw8/PE8PHk9PQJbPDx5PT3xPT0B4j09/pc8PP4ePDw8PDw8PDw8PDw8PDw8PBk8PDw8PDw8PDw8PDw8PDw8AS08tDwBpT3+0zw8PLU8/PE8A0w9PT09PT09PT09PT09PT09PT388Ty1PLU8AS09/tM8AS08/tM8AAAbAAD/qwQAA6sAAwAHAAsAEAAUABgAHAAgACQAKAAsADAANAA4ADwAQABEAEkATgBSAFYAWgBeAGIAZgBqAG4AAAERIREDMzUjBzM1IwUzNSMVOwE1IxczNSMFMzUjETM1IxEzNSMRMzUjNTM1IxEzNSMVMzUjETM1IzUzNSMhIxUzJyMVMycjFTM1MyMVMzUFMzUjETM1IzUzNSM1MzUjFTM1IxEzNSMVMzUjNTM1IwQA/tO1PDxrNjb+vzU1azU1azY2/rg8PDw8PDw8PDw8PDw8PDw8PDwB6TY2bDU11jU1azU1AQw8PDw8PDw8PDw8PDw8PDw8A6v8AAQA/AA8PDw8PDw8PDw8PAGmPAEtPP3iPLU8/ls8tTwCHj20PT09PT09PT09PT38eDw9PLU8tTwBLT21PLU8AAAAAQDiAQ0DHgJJABMAABMBFjI3ATY0JyYiDwEnJiIHBhQX4gEADCQMAQANDQwkDOLiDCQMDQ0CDf8ADQ0BAAwjDQwM4uIMDA0jDAAAAAEA4gENAx4CSQATAAAJASYiBwEGFBcWMj8BFxYyNzY0JwMe/wAMJAz/AA0NDCQM4uIMJAwNDQFJAQAMDP8ADSMMDQ3h4Q0NDCMNAAAEAFUAAAOrA1UAHAA4AFQAcQAAASMiBgcOAR0BFBYzMjY9ATQ2Nz4BOwEyNjU0JiMBNTQmJy4BKwEiBhUUFjsBMhYXHgEdARQWMzI2ATMyNjc+AT0BNCYjIgYdARQGBw4BKwEiBhUUFgEVFBYXHgE7ATI2NTQmKwEiJicuAT0BNCYjIgYVAVWAGi8RERUZEhIZBgYGEAiAEhkZEgJWFBIRLxqAEhkZEoAIEAYGBhkSEhn/AIAaLxERFRkSEhkGBgYQCIASGRn9vBQSES8agBIZGRKACBAGBgYZEhIZA1UUERIuG4ARGRkRgAkQBQYHGRIRGf8AgBsvEREUGRESGQcGBRAJgBEZGf28FBIRLxqAEhkZEoAJDwYGBxkREhkBAIAaLxESFBkSERkHBgYPCYASGRkSAAQAVQAAA6sDVQAcADkAVQBxAAABFRQGBw4BKwEiBhUUFjsBMjY3PgE9ATQmIyIGFQUjIiYnLgE9ATQmIyIGHQEUFhceATsBMjY1NCYjAzU0Njc+ATsBMjY1NCYrASIGBw4BHQEUFjMyNiUzMhYXHgEdARQWMzI2PQE0JicuASsBIgYVFBYBKwcGBg8JgBIZGRKAGi8REhQZEhEZAlWACQ8GBgcZERIZFBIRLxqAEhkZEqsHBgYPCYASGRkSgBovERIUGRIRGf2rgAkPBgYHGRESGRQSES8agBIZGQMrgAkQBQYHGRIRGRQREi4bgBEZGRGrBwYFEAmAERkZEYAbLxERFBkREhn9q4AIEAYGBhkSEhkUEhEvGoASGRm8BgYGEAiAEhkZEoAaLxERFRkSEhkAAAAAAQDiAI0DHgLJACAAABMXBwYUFxYyPwEXFjI3NjQvATc2NCcmIg8BJyYiBwYUF+Li4g0NDCQM4uIMJAwNDeLiDQ0MJAzi4gwkDA0NAo3i4g0jDA0N4eENDQwjDeLiDCMNDAzi4gwMDSMMAAAAAgCAACsDdwMrACYAPwAAJSc+ATU0Jy4BJyYjIgcOAQcGFRQXHgEXFjMyNjcXHgEzMjY3NjQnJSImJy4BNTQ2Nz4BMzIWFx4BFRQGBw4BIwN31iAjGBhTODdAPzg4UxgYGBhTODg/N2Mn1AUNBgYMBQoJ/jswWCIiJCQiIlgwMFgiIiUlIiJYMGLYJ2I2Pzg4UxgYGBhTODg/QDc4UxgYJCDWBQUEBQkbCqYlIiJYMDBYISMkJCMiVzAwWCIiJQAAAwAAACsDdwMrAAcADQAZAAABMxEjJyMRMzcHIxEzFwEXBycHJzcnNxc3FwFSLi3Ak5Kukm5tkwGtiSyKiS2IiCyKiS0DK/0AwAGAUpL/AJMBE4otiYktioktiYktAAAAAwCAACsDgAMrAAMABgAJAAABMxEjIREBAREBA0BAQP1AAiD+IAFxAyv9AAMA/oABBP33AQUAAAACAED/qwOAA6sAAgAIAAABIzUBESERIREDbe0BAPzAAgACq+3+0/1ABAD+wAAAAAACAUAAKwLAAysAAwAHAAABMxEjAREjEQFAQEABgEADK/0AAwD9AAMAAAAAAAIBAP/rA4ADawACAAUAAAkBERMJAQOA/YBAAdD+MAGr/kADgPz7AUUBRQAAAwAA/6sEAAOrAFoAXQBgAAABFAcGBwYHBgczFSERMxU2NzY3Njc2NTQnJicmJyYnJicmIyIHBgcGBwYHBgcGFRQXFhcWFxYXByYnJicmJyYnJicmNTQ3Njc2NzY3Njc2MzIXFhcWFxYXFhcWDQEREzcnBAASEyIjMTE9if8AQDowLyEhExIQEB0dKSkyMjk5Pj06OTIxKSkeHRAQGBgrLDw9SBA3MjEqKSIhGBcMDRISIiEvLzk4QkFHRkJBOTkvLiIhExL/AP6AQMDAAatGQkI6OjEwIUABAJMbKis0NTw9QT05OjEyKSkdHhAQEBAeHSkpMjE6OT1LRkU5OSoqFD0PGxokIywsMjE3NjpGQkE5OS4vIiESExMSISIvLjk5QUJG3gG7/rRvbwAAAwCAACsDgAMrAAMABgAJAAA3ETMREwERJxEBgECgAiBA/o8rAwD9AAGAAYD9AHsCCf78AAYAAP/rA8ADqwAvAF8AgACQAKAAyAAAATIXFhcWFxYXFhcWFRQHBgcGBwYHBgcGIyInJicmJyYnJicmNTQ3Njc2NzY3Njc2EzI3Njc2NzY3Njc2NTQnJicmJyYnJicmIyIHBgcGBwYHBgcGFRQXFhcWFxYXFhcWExYVFAcGBwYHBiMiJyYnJicmNTQ3Njc2NzYzMhcxNxcHBzI3NjU0JyYjIgcGFRQXFiUWFxYVFAcGByc2NzY1NCcnJiMiBwYHBgcGBwYHBhUUFxYXByYnJjU0NzY3Njc2NzY3NjMyFxYXAeBCPT02NSwsHx8SERERIB8sKzY1Pj1CQj09NjUsLB8fEhERESAfLCs2NT49Qjk1NS8uJiYbGw8PDw8bGyYmLi41NTo5NTUvLiYmGxsPDw8PGxsmJi4uNTWQCgcIDQ0REhQUERINDQcIBwgNDRESFBYUty23Vw0JCgkKDQ0JCgkKAU0PCAgaGjItKBYWGpA5PigkJSAgGhoTEgsKFhYoLTIaGwwNFxcgICcnLS0xJSUkIgOrEhEfHywsNTY9PUJCPj01NiwrIB8RERERHyArLDY1PT5CQj09NjUsLB8fERL8gA8PGxsmJi4uNTU6OTU1Li8mJhsbDw8PDxsbJiYvLjU1OTo1NS4uJiYbGw8PAcoUFhQSEQ0NCAcHCA0NERIUFBESDQ0HCAq4LbhJCQoNDQkKCgkNDQoJsCIlJCVGQUExLSk0NDk+OpAaCwoTExoaICAlJSc6NTQpLTJAQEcwLS0nJyAgFxcMDQgIDwAAAAACAAAAKwGAAysABwANAAABMxEjJyMRMxMRByMRMwFSLi3Ak5Kukm5tAyv9AMABgP4tAiWS/wAAAAMAAAArAoADKwARABkAHwAAARYXFhUUBwYHJzY3NjU0JyYnJzMRIycjETM3ByMRMxcCNSQUExMTJS0bDg8ODxu1LS3Ak5Kukm5tkwJgJS4vMzQuLyQtGyMjJyYjJBv4/QDAAYBSkv8AkwAAAAQAAAArA0ADKwARACMAKwAxAAABFhcWFRQHBgcnNjc2NTQnJicHFhcWFRQHBgcnNjc2NTQnJicnMxEjJyMRMzcHIxEzFwK9PyIiIiI/LTYdHR0dNlskFBMTEyUtGw4PDg8btS0twJOSrpJubZMC6EBSUVpaUlFALTdGRk1NRkY2WiUuLzM0Li8kLRsjIycmIyQb+P0AwAGAUpL/AJMAAAAFAAD/5gQAA28AIQAzAEUATQBTAAABFhcWFxYXFhUUBwYHBgcGByc2NzY3Njc2NTQnJicmJyYnExQHBgcnNjc2NTQnJic3FhcWJRYXFhUUBwYHJzY3NjU0JyYnJzMRIycjETM3ByMRMxcDRC0jIxgYDA0MDRgXIyMtLiggHxYVCwsKCxYVIB8pKSIiPy02HR0dHTYtPyIi/vUkFBMTEyUtGw4PDg8btS0twJOSrpJubZMDby00NTk6Pj4/QD4+OTo0NS0uKC8wMzQ4Nzo5ODc0NC8vKf5pWlJRQC03RkZNTUZGNi5AUlFbJS4vMzQuLyQtGyMjJyYjJBv4/QDAAYBSkv8AkwAAAAABAAAAAQAAssE0J18PPPUACwQAAAAAANxhc6oAAAAA3GFzqgAA/6sEAAOrAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAQAAAEAAAAAAAAAAAAAAAAAAAAZBAAAAAAAAAAAAAAAAgAAAAQAAAAEAAAABAAAAAQAAOIEAADiBAAAVQQAAFUEAADiBAAAgAQAAAAEAACABAAAQAQAAUAEAAEABAAAAAQAAIAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAACgAUAB4AugF0AhICOAJeAvgDkgPIBCgEWAR0BIwEogS4BU4FaAaQBqwG4gcyB7YAAQAAABkAyQAgAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAwAAAABAAAAAAACAAcAjQABAAAAAAADAAwARQABAAAAAAAEAAwAogABAAAAAAAFAAsAJAABAAAAAAAGAAwAaQABAAAAAAAKABoAxgADAAEECQABABgADAADAAEECQACAA4AlAADAAEECQADABgAUQADAAEECQAEABgArgADAAEECQAFABYALwADAAEECQAGABgAdQADAAEECQAKADQA4HBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMHBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac3BsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcnBsYXllci1pY29ucwBwAGwAYQB5AGUAcgAtAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},424:t=>{"use strict";t.exports='#controlContainer {\n\t--seek-before-width: 0%;\n\t--volume-before-width: 100%;\n\t--buffered-width: 0%;\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: row;\n\n\tbackground-color: rgba(233, 236, 239, 0.8);\n\tborder-radius: 0.333em;\n\tpadding: 0;\n\tmargin: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n}\n#controlContainer::before {\n\tposition: absolute;\n\tcontent: \'\';\n\tz-index: -1;\n}\n#controlContainer path {\n    stroke: #007db5;\n}\n\n#controlContainer button {\n    padding: 0;\n    border: 0;\n    background: transparent;\n\tborder-radius: 0.333em;\n    cursor: pointer;\n    outline: none;\n\tmin-width: 40px;\n    width: 40px;\n\tmin-height: 40px;\n    height: 40px;\n\tfont-size: 18px;\n}\n#controlContainer button:hover {\n\tcolor: rgba(0, 125, 181, 1);\n\tbackground-color: rgba(222, 226, 230, 0.9);\n}\n#controlContainer button.selected {\n\tbackground-color: rgba(0, 125, 181, 1);\n}\n#controlContainer button.selected:hover {\n\tbackground-color: rgba(0, 125, 181, 0.8);\n}\n#controlContainer button.selected path {\n\tcolor: #F9FAFB;\n\tstroke: #F9FAFB;\n}\n#controlContainer button.active {\n\tbackground-color: rgba(25, 135, 84, 1);\n}\n#controlContainer button.active:hover {\n\tbackground-color: rgba(255, 193, 7, 1);\n}\n#controlContainer button.active path {\n\tstroke: #F9FAFB;\n}\n#controlContainer button svg {\n\twidth: 23px;\n\theight: 23px;\n\tvertical-align: text-bottom;\n}\n#controlContainer #settingsButton path {\n\tstroke: #212529;\n}\n#controlContainer #playMediaButton {\n\tbackground-color: #FECACA;\n}\n#controlContainer #playMediaButton:hover {\n\tbackground-color: #FEE2E2;\n}\n\n#controlContainer .control-bar {\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tpadding: 0;\n\tmargin: 0;\n}\n#controlContainer .control-bar .col {\n\tflex: 1;\n\tdisplay: flex;\n\talign-items: center;\n}\n#controlContainer .control-bar .nav-left {\n\tflex: 1;\n\tjustify-content: flex-start;\n}\n#controlContainer .control-bar .nav-center {\n\tflex: 1;\n\tjustify-content: center;\n}\n#controlContainer .control-bar .nav-right {\n\tflex: 1;\n\tjustify-content: flex-end;\n}\n\n#controlContainer #volumeSlider {\n    margin: 10px 2.5%;\n    width: 150px;\n}\n#controlContainer #volumeSlider::-webkit-slider-runnable-track {\n    background: rgba(0, 125, 181, 0.6);\n}\n#controlContainer #volumeSlider::-moz-range-track {\n    background: rgba(0, 125, 181, 0.6);\n}\n#controlContainer #volumeSlider::-ms-fill-upper {\n    background: rgba(0, 125, 181, 0.6);\n}\n#controlContainer #volumeSlider::before {\n    width: var(--volume-before-width);\n}\n#controlContainer #volumeIndicator {\n    margin: 0 0;\n}\n#controlContainer input[type="range"] {\n    position: relative;\n    -webkit-appearance: none;\n    width: 48%;\n    margin: 0;\n    padding: 0;\n    height: 19px;\n    margin: 30px 2.5% 20px 2.5%;\n    float: left;\n    outline: none;\n\tbackground: transparent;\n}\n#controlContainer input[type="range"]::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 3px;\n    cursor: pointer;\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\n}\n#controlContainer input[type="range"]::before {\n    position: absolute;\n    content: "";\n    top: 8px;\n    left: 0;\n    width: var(--seek-before-width);\n    height: 3px;\n    background-color: #007db5;\n    cursor: pointer;\n}\n#controlContainer input[type="range"]::-webkit-slider-thumb {\n    position: relative;\n    -webkit-appearance: none;\n    box-sizing: content-box;\n    border: 1px solid #007db5;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background-color: #fff;\n    cursor: pointer;\n    margin: -7px 0 0 0;\n}\n#controlContainer input[type="range"]:active::-webkit-slider-thumb {\n    transform: scale(1.2);\n    background: #007db5;\n}\n#controlContainer input[type="range"]::-moz-range-track {\n    width: 100%;\n    height: 3px;\n    cursor: pointer;\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\n}\n#controlContainer input[type="range"]::-moz-range-progress {\n    background-color: #007db5;\n}\n#controlContainer input[type="range"]::-moz-focus-outer {\n    border: 0;\n}\n#controlContainer input[type="range"]::-moz-range-thumb {\n    box-sizing: content-box;\n    border: 1px solid #007db5;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background-color: #fff;\n    cursor: pointer;\n}\n#controlContainer input[type="range"]:active::-moz-range-thumb {\n    transform: scale(1.2);\n    background: #007db5;\n}\n#controlContainer input[type="range"]::-ms-track {\n    width: 100%;\n    height: 3px;\n    cursor: pointer;\n    background: transparent;\n    border: solid transparent;\n    color: transparent;\n}\n#controlContainer input[type="range"]::-ms-fill-lower {\n    background-color: #007db5;\n}\n#controlContainer input[type="range"]::-ms-fill-upper {\n    background: linear-gradient(to right, rgba(0, 125, 181, 0.6) var(--buffered-width), rgba(0, 125, 181, 0.2) var(--buffered-width));\n}\n#controlContainer input[type="range"]::-ms-thumb {\n    box-sizing: content-box;\n    border: 1px solid #007db5;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background-color: #fff;\n    cursor: pointer;\n}\n#controlContainer input[type="range"]:active::-ms-thumb {\n    transform: scale(1.2);\n    background: #007db5;\n}'},151:t=>{"use strict";t.exports='<div id="controlContainer">\n\t<div class="control-bar">\n\t\t<div class="col nav-left">\n\t\t\t<button id="volumeIndicator"></button>\n\t\t\t<input type="range" id="volumeSlider" max="100" value="100">\n\t\t\t<span id="duration"></span>\n\t\t</div>\n\t\t<div class="col nav-center" id="toolbar">\n\t\t\t<button id="raiseHandButton">\n\t\t\t\t<svg viewBox="0 0 512 512">\n\t\t\t\t\t<path d="M80 320V144a32 32 0 0132-32h0a32 32 0 0132 32v112M144 256V80a32 32 0 0132-32h0a32 32 0 0132 32v160M272 241V96a32 32 0 0132-32h0a32 32 0 0132 32v224M208 240V48a32 32 0 0132-32h0a32 32 0 0132 32v192" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>\n\t\t\t\t\t<path d="M80 320c0 117.4 64 176 152 176s123.71-39.6 144-88l52.71-144c6.66-18.05 3.64-34.79-11.87-43.6h0c-15.52-8.82-35.91-4.28-44.31 11.68L336 320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t\t<button class="invisible" id="showQuizButton">\n\t\t\t\t<svg stroke-width="0.1" fill="currentColor" stroke="currentColor" viewBox="0 0 16 16">\n\t\t\t\t\t<path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" fill="currentColor" stroke="currentColor"/>\n\t\t\t\t\t<path d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0zM7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z" fill="currentColor" stroke="currentColor"/>\n\t\t\t\t  </svg>\n\t\t\t</button>\n\n\t\t\t<button class="invisible" id="playMediaButton">\n\t\t\t\t<svg viewBox="0 0 512 512">\n\t\t\t\t\t<path d="M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="col nav-right">\n\t\t\t<button id="settingsButton">\n\t\t\t\t<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n\t\t\t\t\t<circle cx="12" cy="12" r="3"></circle>\n\t\t\t\t\t<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t\t<button id="fullscreenButton"></button>\n\t\t</div>\n\t</div>\n</div>'},77:t=>{"use strict";t.exports="player-view {\n\tbackground-color: #f8f9fa;\n\tdisplay: flex;\n\tflex-grow: 1;\n\tflex-direction: column;\n}\nplayer-view > .player-container,\nplayer-view .slide-container {\n\tdisplay: flex;\n\tflex-grow: 1;\n\tflex-direction: row;\n}\nplayer-view .slide-container {\n\tflex-direction: column;\n}\nplayer-view .feed-container {\n\tflex-grow: 0;\n\tflex-direction: column;\n}\nplayer-view .right-container {\n\tbackground-color: rgba(233, 236, 239, 0.8);\n\tborder-radius: .25rem;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tpadding: 0.5em 0.5em;\n\tmargin-left: 0.5em;\n}\nplayer-view slide-view {\n\tflex-grow: 1;\n}\nplayer-view .feed-container video {\n\tbackground-color: #6c757d;\n\tborder-radius: .25rem;\n\tpadding: .25rem;\n\tmax-width: 15em;\n}\nplayer-view .invisible {\n\tdisplay: none;\n}"},628:t=>{"use strict";t.exports='<div class="player-container">\n\t<div class="slide-container">\n\t\t<slide-view id="slideView"></slide-view>\n\t\t<player-controls id="playerControls"></player-controls>\n\t</div>\n\t<div class="right-container" id="rightContainer">\n\t\t<div class="feed-container invisible" id="videoFeedContainer">\n\t\t\t<div class="invisible" id="mainVideoFeedContainer">\n\t\t\t\t<video id="videoFeed" autoplay playsinline></video>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="feed-container invisible" id="localVideoFeedContainer">\n\t\t\t<video id="localVideoFeed" autoplay playsinline muted></video>\n\t\t</div>\n\t\t<div id="containerA"></div>\n\t</div>\n</div>'},486:t=>{"use strict";t.exports=".slide-view {\n\twidth: 100%;\n\theight: 100%;\n\tmin-height: 100px;\n\tpadding: 0;\n\tmargin: 0;\n\toverflow: hidden;\n\tposition: relative;\n\ttext-align: center;\n\tbox-sizing: border-box;\n}\n.slide-view > canvas {\n\tposition: absolute;\n\ttransform: translate(-50%, 0);\n\tleft: 50%;\n}\n.slide-view .slide-canvas {\n\tvisibility: hidden;\n\tz-index: 0;\n}\n.slide-view .action-canvas {\n\tz-index: 1;\n}\n.slide-view .volatile-canvas {\n\tz-index: 2;\n}\n\n.text-layer {\n\tposition: absolute;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\topacity: 0.2;\n\tline-height: 1;\n\tmargin: 0 auto;\n\tz-index: 3;\n}\n.text-layer > span {\n\tcolor: transparent;\n\tposition: absolute;\n\twhite-space: pre;\n\tcursor: text;\n\ttransform-origin: 0% 0%;\n}\n.text-layer .highlight {\n\tmargin: -1px;\n\tpadding: 1px;\n\tbackground-color: rgba(180, 0, 170, 1);\n\tborder-radius: 4px;\n}\n.text-layer .highlight.begin {\n\tborder-radius: 4px 0 0 4px;\n}\n.text-layer .highlight.end {\n\tborder-radius: 0 4px 4px 0;\n}\n.text-layer .highlight.middle {\n\tborder-radius: 0;\n}\n.text-layer .highlight.selected {\n\tbackground-color: rgba(0, 100, 0, 1);\n}\n.text-layer ::-moz-selection {\n\tbackground: rgba(0, 0, 255, 1);\n}\n.text-layer ::selection {\n\tbackground: rgba(0, 0, 255, 1);\n}\n.text-layer .endOfContent {\n\tdisplay: block;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 100%;\n\tright: 0;\n\tbottom: 0;\n\tz-index: -1;\n\tcursor: default;\n\t-webkit-user-select: none;\n\t   -moz-user-select: none;\n\t\t-ms-user-select: none;\n\t\t\tuser-select: none;\n}\n.text-layer .endOfContent.active {\n\ttop: 0;\n}\n\n.annotationLayer section {\n\tposition: absolute;\n\tz-index: 4;\n}\n.annotationLayer .linkAnnotation > a {\n\tposition: absolute;\n\tfont-size: 1em;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tcursor: pointer;\n}\n.annotationLayer .linkAnnotation > a:hover {\n\tbackground: #ff0;\n}"},225:t=>{"use strict";t.exports='<div class="slide-view">\n\t<canvas class="slide-canvas"></canvas>\n\t<canvas class="action-canvas" scale="full"></canvas>\n\t<canvas class="volatile-canvas" scale="full"></canvas>\n\t<div class="text-layer"></div>\n</div>'},414:()=>{},172:()=>{},1:()=>{},779:()=>{},558:()=>{},258:()=>{}},__webpack_module_cache__={};function __webpack_require__(t){var r=__webpack_module_cache__[t];if(void 0!==r)return r.exports;var i=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(t,r)=>{for(var i in r)__webpack_require__.o(r,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},__webpack_require__.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,r,i){return r&&_defineProperties(t.prototype,r),i&&_defineProperties(t,i),t}function _defineProperty(t,r,i){return r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LecturePlayer:()=>$n,PlayerView:()=>te,WebPlayerControls:()=>J,WebSlideView:()=>Z});var t=__webpack_require__(379),r=__webpack_require__.n(t),i=__webpack_require__(576),o={insert:"head",singleton:!1};r()(i.Z,o);i.Z.locals;Array.prototype.equals&&console.warn("Overriding existing Array.prototype.equals."),Array.prototype.equals=function(t){if(!t)return!1;if(this===t)return!0;if(this.length!=t.length)return!1;for(var r=0,i=this.length;r<i;r++)if(this[r]instanceof Array&&t[r]instanceof Array){if(!this[r].equals(t[r]))return!1}else if(this[r]!=t[r])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1});var a=function(){function Point(t,r){_classCallCheck(this,Point),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),this.x=t,this.y=r}return _createClass(Point,[{key:"set",value:function set(t,r){return this.x=t,this.y=r,this}},{key:"distance",value:function distance(t){var r=t.x-this.x,i=t.y-this.y;return Math.sqrt(r*r+i*i)}},{key:"add",value:function add(t){return this.x+=t.x,this.y+=t.y,this}},{key:"subtract",value:function subtract(t){return this.x-=t.x,this.y-=t.y,this}},{key:"multiply",value:function multiply(t){return this.x*=t,this.y*=t,this}},{key:"normalize",value:function normalize(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return this.x/=t,this.y/=t,this}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y)}}]),Point}(),c=function(){function Transform(t){_classCallCheck(this,Transform),_defineProperty(this,"m",void 0),this.m=t?t.slice(0,6):[1,0,0,1,0,0]}return _createClass(Transform,[{key:"getScaleX",value:function getScaleX(){return this.m[0]}},{key:"getScaleY",value:function getScaleY(){return this.m[3]}},{key:"getShearX",value:function getShearX(){return this.m[1]}},{key:"getShearY",value:function getShearY(){return this.m[2]}},{key:"getTranslateX",value:function getTranslateX(){return this.m[4]}},{key:"getTranslateY",value:function getTranslateY(){return this.m[5]}},{key:"clone",value:function clone(){return new Transform(this.m)}},{key:"reset",value:function reset(){this.setValues(1,0,0,1,0,0)}},{key:"setTransform",value:function setTransform(t){this.m[0]=t.getScaleX(),this.m[1]=t.getShearX(),this.m[2]=t.getShearY(),this.m[3]=t.getScaleY(),this.m[4]=t.getTranslateX(),this.m[5]=t.getTranslateY()}},{key:"setValues",value:function setValues(t,r,i,o,a,c){this.m[0]=t,this.m[1]=r,this.m[2]=i,this.m[3]=o,this.m[4]=a,this.m[5]=c}},{key:"invert",value:function invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);this.m[0]=this.m[3]*t,this.m[1]=-this.m[1]*t,this.m[2]=-this.m[2]*t,this.m[3]=this.m[0]*t,this.m[4]=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),this.m[5]=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5])}},{key:"multiply",value:function multiply(t){this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=this.m[1]*t.m[0]+this.m[3]*t.m[1],this.m[2]=this.m[0]*t.m[2]+this.m[2]*t.m[3],this.m[3]=this.m[1]*t.m[2]+this.m[3]*t.m[3],this.m[4]=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],this.m[5]=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5]}},{key:"rotate",value:function rotate(t){var r=Math.cos(t),i=Math.sin(t);this.m[0]=this.m[0]*r+this.m[1]*i,this.m[1]=this.m[0]*-i+this.m[1]*r,this.m[2]=this.m[2]*r+this.m[3]*i,this.m[3]=this.m[2]*-i+this.m[3]*r}},{key:"scale",value:function scale(t,r){this.m[0]*=t,this.m[1]*=t,this.m[2]*=r,this.m[3]*=r}},{key:"translate",value:function translate(t,r){this.m[4]+=this.m[0]*t+this.m[2]*r,this.m[5]+=this.m[1]*t+this.m[3]*r}},{key:"transformPoint",value:function transformPoint(t,r){var i=t,o=r;return t=i*this.m[0]+o*this.m[2]+this.m[4],r=i*this.m[1]+o*this.m[3]+this.m[5],new a(t,r)}},{key:"equals",value:function equals(t){return!!t&&this.m.equals(t.m)}},{key:"toString",value:function toString(){return"["+this.m.join(", ")+"]"}}]),Transform}(),l=CanvasRenderingContext2D.prototype.getTransform;if(CanvasRenderingContext2D.prototype.getTransformExt=function(){if(l){var t=l.apply(this,Array.from(arguments));this._transform_ext||(this._transform_ext=new c),this._transform_ext.setValues(t.a,t.b,t.c,t.d,t.e,t.f)}return this._transform_ext},!l){var u=CanvasRenderingContext2D.prototype.resetTransform,d=CanvasRenderingContext2D.prototype.rotate,h=CanvasRenderingContext2D.prototype.scale,p=CanvasRenderingContext2D.prototype.setTransform,g=CanvasRenderingContext2D.prototype.transform,m=CanvasRenderingContext2D.prototype.translate,y=CanvasRenderingContext2D.prototype.save,v=CanvasRenderingContext2D.prototype.restore;CanvasRenderingContext2D.prototype.resetTransform=function(){u&&u.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.reset()},CanvasRenderingContext2D.prototype.rotate=function(t){d&&d.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.rotate(t)},CanvasRenderingContext2D.prototype.scale=function(t,r){h&&h.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.scale(t,r)},CanvasRenderingContext2D.prototype.setTransform=function(t,r,i,o,a,l){if(p&&p.apply(this,Array.from(arguments)),r)t=t;else{var u=t;t=u.a,r=u.b,i=u.c,o=u.d,a=u.e,l=u.f}this._transform_ext||(this._transform_ext=new c),this._transform_ext.setValues(t,r,i,o,a,l)},CanvasRenderingContext2D.prototype.transform=function(t,r,i,o,a,l){g&&g.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.multiply(new c([t,r,i,o,a,l]))},CanvasRenderingContext2D.prototype.translate=function(t,r){m&&m.apply(this,Array.from(arguments)),this._transform_ext||(this._transform_ext=new c),this._transform_ext.translate(t,r)},CanvasRenderingContext2D.prototype.save=function(){y&&y.apply(this,Array.from(arguments)),this._transform_ext_stack||(this._transform_ext_stack=[]),this._transform_ext||(this._transform_ext=new c),this._transform_ext_stack.push(this._transform_ext.clone())},CanvasRenderingContext2D.prototype.restore=function(){v&&v.apply(this,Array.from(arguments)),this._transform_ext_stack||(this._transform_ext_stack=[]),this._transform_ext=this._transform_ext_stack.pop(),this._transform_ext||(this._transform_ext=new c)}}for(var _={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},A=Object.keys(_),b=null,S=0,C=[A,["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"]];S<C.length;S++){var w=C[S];if(w[_.fullscreenEnabled]in document){b=w;break}}if(b){var P=Element.prototype;P.requestFullscreen=P[b[_.requestFullscreen]],(P=Document.prototype).exitFullscreen=P[b[_.exitFullscreen]];var x=A[_.fullscreenElement],k=A[_.fullscreenEnabled];if(x in document||(Object.defineProperty(document,x,{get:function get(){return document[b[_.fullscreenElement]]}}),Object.defineProperty(document,k,{get:function get(){return document[b[_.fullscreenEnabled]]}})),A!==b){var T=function proxyListener(t){var r,i=t.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?r=new Event(i,t):(r=document.createEvent("Event")).initEvent(i,t.bubbles,t.cancelable),t.target.dispatchEvent(r)};document.addEventListener(b[_.fullscreenchange],T),document.addEventListener(b[_.fullscreenerror],T)}}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}String.format=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=-1;function callback(t,r,o,c,l,u){if("%%"==t)return"%";if(void 0!==i[++a]){t=c?parseInt(c.substr(1)):void 0;var d,h=l?parseInt(l.substr(1)):void 0;switch(u){case"s":d=i[a];break;case"c":d=i[a][0];break;case"f":d=parseFloat(i[a]).toFixed(t);break;case"p":d=parseFloat(i[a]).toPrecision(t);break;case"e":d=parseFloat(i[a]).toExponential(t);break;case"x":d=parseInt(i[a]).toString(h||16);break;case"d":d=parseFloat(parseInt(i[a],h||10).toPrecision(t)).toFixed(0)}d="object"==_typeof(d)?JSON.stringify(d):d.toString(h);for(var p=parseInt(o),g=o&&"0"==o[0]?"0":" ";d.length<p;)d=void 0!==r?d+g:g+d;return d}}var c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(c,callback)};var R=function ViewElement(t){return function(r){!function validateSelector(t){if(t.indexOf("-")<=0)throw new Error("At least one dash is required in the custom element name!")}(t.selector);var i="";t.styles&&(i+="<style>\n".concat(t.styles,"\n</style>")),t.template&&(i+="\n".concat(t.template));var o=document.createElement("template");o.innerHTML=i;var a=r.prototype.connectedCallback||function(){},c=r.prototype.initialized||function(){return!1};r.prototype.connectedCallback=function(){if(!c.call(this)){this.template=t.template;var r=document.importNode(o.content,!0);t.useShadow?this.attachShadow({mode:"open"}).appendChild(r):this.appendChild(r);var i,l=t.useShadow?this.shadowRoot:this,u=_createForOfIteratorHelper(Reflect.ownKeys(this));try{for(u.s();!(i=u.n()).done;){var d=i.value.toString(),h=l.querySelector("#"+d);h&&(this[d]=h)}}catch(t){u.e(t)}finally{u.f()}a.call(this)}},customElements.define(t.selector,r)}};function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _construct(t,r,i){return _construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(t,r,i){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(t,o));return i&&_setPrototypeOf(a,i.prototype),a},_construct.apply(null,arguments)}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,Wrapper)}function Wrapper(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,t)},_wrapNativeSuper(t)}var E,I=__webpack_require__(466),D=__webpack_require__.n(I);var M="undefined"==typeof document?void 0:document,L=!!M&&"content"in M.createElement("template"),O=!!M&&M.createRange&&"createContextualFragment"in M.createRange();function toElement(t){return t=t.trim(),L?function createFragmentFromTemplate(t){var r=M.createElement("template");return r.innerHTML=t,r.content.childNodes[0]}(t):O?function createFragmentFromRange(t){return E||(E=M.createRange()).selectNode(M.body),E.createContextualFragment(t).childNodes[0]}(t):function createFragmentFromWrap(t){var r=M.createElement("body");return r.innerHTML=t,r.childNodes[0]}(t)}function compareNodeNames(t,r){var i,o,a=t.nodeName,c=r.nodeName;return a===c||(i=a.charCodeAt(0),o=c.charCodeAt(0),i<=90&&o>=97?a===c.toUpperCase():o<=90&&i>=97&&c===a.toUpperCase())}function syncBooleanAttrProp(t,r,i){t[i]!==r[i]&&(t[i]=r[i],t[i]?t.setAttribute(i,""):t.removeAttribute(i))}var N={OPTION:function(t,r){var i=t.parentNode;if(i){var o=i.nodeName.toUpperCase();"OPTGROUP"===o&&(o=(i=i.parentNode)&&i.nodeName.toUpperCase()),"SELECT"!==o||i.hasAttribute("multiple")||(t.hasAttribute("selected")&&!r.selected&&(t.setAttribute("selected","selected"),t.removeAttribute("selected")),i.selectedIndex=-1)}syncBooleanAttrProp(t,r,"selected")},INPUT:function(t,r){syncBooleanAttrProp(t,r,"checked"),syncBooleanAttrProp(t,r,"disabled"),t.value!==r.value&&(t.value=r.value),r.hasAttribute("value")||t.removeAttribute("value")},TEXTAREA:function(t,r){var i=r.value;t.value!==i&&(t.value=i);var o=t.firstChild;if(o){var a=o.nodeValue;if(a==i||!i&&a==t.placeholder)return;o.nodeValue=i}},SELECT:function(t,r){if(!r.hasAttribute("multiple")){for(var i,o,a=-1,c=0,l=t.firstChild;l;)if("OPTGROUP"===(o=l.nodeName&&l.nodeName.toUpperCase()))l=(i=l).firstChild;else{if("OPTION"===o){if(l.hasAttribute("selected")){a=c;break}c++}!(l=l.nextSibling)&&i&&(l=i.nextSibling,i=null)}t.selectedIndex=a}}};function noop(){}function defaultGetNodeKey(t){if(t)return t.getAttribute&&t.getAttribute("id")||t.id}var B=function morphdomFactory(t){return function morphdom(r,i,o){if(o||(o={}),"string"==typeof i)if("#document"===r.nodeName||"HTML"===r.nodeName||"BODY"===r.nodeName){var a=i;(i=M.createElement("html")).innerHTML=a}else i=toElement(i);var c=o.getNodeKey||defaultGetNodeKey,l=o.onBeforeNodeAdded||noop,u=o.onNodeAdded||noop,d=o.onBeforeElUpdated||noop,h=o.onElUpdated||noop,p=o.onBeforeNodeDiscarded||noop,g=o.onNodeDiscarded||noop,m=o.onBeforeElChildrenUpdated||noop,y=!0===o.childrenOnly,v=Object.create(null),_=[];function addKeyedRemoval(t){_.push(t)}function walkDiscardedChildNodes(t,r){if(1===t.nodeType)for(var i=t.firstChild;i;){var o=void 0;r&&(o=c(i))?addKeyedRemoval(o):(g(i),i.firstChild&&walkDiscardedChildNodes(i,r)),i=i.nextSibling}}function removeNode(t,r,i){!1!==p(t)&&(r&&r.removeChild(t),g(t),walkDiscardedChildNodes(t,i))}function handleNodeAdded(t){u(t);for(var r=t.firstChild;r;){var i=r.nextSibling,o=c(r);if(o){var a=v[o];a&&compareNodeNames(r,a)?(r.parentNode.replaceChild(a,r),morphEl(a,r)):handleNodeAdded(r)}else handleNodeAdded(r);r=i}}function morphEl(r,i,o){var a=c(i);if(a&&delete v[a],!o){if(!1===d(r,i))return;if(t(r,i),h(r),!1===m(r,i))return}"TEXTAREA"!==r.nodeName?function morphChildren(t,r){var i,o,a,u,d,h=r.firstChild,p=t.firstChild;e:for(;h;){for(u=h.nextSibling,i=c(h);p;){if(a=p.nextSibling,h.isSameNode&&h.isSameNode(p)){h=u,p=a;continue e}o=c(p);var g=p.nodeType,m=void 0;if(g===h.nodeType&&(1===g?(i?i!==o&&((d=v[i])?a===d?m=!1:(t.insertBefore(d,p),o?addKeyedRemoval(o):removeNode(p,t,!0),p=d):m=!1):o&&(m=!1),(m=!1!==m&&compareNodeNames(p,h))&&morphEl(p,h)):3!==g&&8!=g||(m=!0,p.nodeValue!==h.nodeValue&&(p.nodeValue=h.nodeValue))),m){h=u,p=a;continue e}o?addKeyedRemoval(o):removeNode(p,t,!0),p=a}if(i&&(d=v[i])&&compareNodeNames(d,h))t.appendChild(d),morphEl(d,h);else{var y=l(h);!1!==y&&(y&&(h=y),h.actualize&&(h=h.actualize(t.ownerDocument||M)),t.appendChild(h),handleNodeAdded(h))}h=u,p=a}!function cleanupFromEl(t,r,i){for(;r;){var o=r.nextSibling;(i=c(r))?addKeyedRemoval(i):removeNode(r,t,!0),r=o}}(t,p,o);var _=N[t.nodeName];_&&_(t,r)}(r,i):N.TEXTAREA(r,i)}!function indexTree(t){if(1===t.nodeType||11===t.nodeType)for(var r=t.firstChild;r;){var i=c(r);i&&(v[i]=r),indexTree(r),r=r.nextSibling}}(r);var A=r,b=A.nodeType,S=i.nodeType;if(!y)if(1===b)1===S?compareNodeNames(r,i)||(g(r),A=function moveChildren(t,r){for(var i=t.firstChild;i;){var o=i.nextSibling;r.appendChild(i),i=o}return r}(r,function createElementNS(t,r){return r&&"http://www.w3.org/1999/xhtml"!==r?M.createElementNS(r,t):M.createElement(t)}(i.nodeName,i.namespaceURI))):A=i;else if(3===b||8===b){if(S===b)return A.nodeValue!==i.nodeValue&&(A.nodeValue=i.nodeValue),A;A=i}if(A===i)g(r);else{if(i.isSameNode&&i.isSameNode(A))return;if(morphEl(A,i,y),_)for(var C=0,w=_.length;C<w;C++){var P=v[_[C]];P&&removeNode(P,P.parentNode,!1)}}return!y&&A!==r&&r.parentNode&&(A.actualize&&(A=A.actualize(r.ownerDocument||M)),r.parentNode.replaceChild(A,r)),A}}((function morphAttrs(t,r){var i,o,a,c,l=r.attributes;if(11!==r.nodeType&&11!==t.nodeType){for(var u=l.length-1;u>=0;u--)o=(i=l[u]).name,a=i.namespaceURI,c=i.value,a?(o=i.localName||o,t.getAttributeNS(a,o)!==c&&("xmlns"===i.prefix&&(o=i.name),t.setAttributeNS(a,o,c))):t.getAttribute(o)!==c&&t.setAttribute(o,c);for(var d=t.attributes,h=d.length-1;h>=0;h--)o=(i=d[h]).name,(a=i.namespaceURI)?(o=i.localName||o,r.hasAttributeNS(a,o)||t.removeAttributeNS(a,o)):r.hasAttribute(o)||t.removeAttribute(o)}}));const j=B;function _createSuper(t){var r=function web_view_element_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var V,U=function(t){_inherits(WebViewElement,t);var r=_createSuper(WebViewElement);function WebViewElement(){var t;_classCallCheck(this,WebViewElement);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"template",void 0),t}return _createClass(WebViewElement,[{key:"initialized",value:function initialized(){return!1}},{key:"render",value:function render(){if(this.template){var t=D().render(this.template,this);j(this.lastElementChild,t)}}}]),WebViewElement}(_wrapNativeSuper(HTMLElement));function player_controls_createSuper(t){var r=function player_controls_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var J=R({selector:"player-controls",template:__webpack_require__(151),styles:[__webpack_require__(424)]})(V=function(t){_inherits(WebPlayerControls,t);var r=player_controls_createSuper(WebPlayerControls);function WebPlayerControls(){var t;return _classCallCheck(this,WebPlayerControls),_defineProperty(_assertThisInitialized(t=r.call(this)),"controlContainer",void 0),_defineProperty(_assertThisInitialized(t),"fullscreenButton",void 0),_defineProperty(_assertThisInitialized(t),"playMediaButton",void 0),_defineProperty(_assertThisInitialized(t),"settingsButton",void 0),_defineProperty(_assertThisInitialized(t),"raiseHandButton",void 0),_defineProperty(_assertThisInitialized(t),"showQuizButton",void 0),_defineProperty(_assertThisInitialized(t),"volumeSlider",void 0),_defineProperty(_assertThisInitialized(t),"volumeIndicator",void 0),_defineProperty(_assertThisInitialized(t),"duration",void 0),_defineProperty(_assertThisInitialized(t),"toolbar",void 0),_defineProperty(_assertThisInitialized(t),"muteObserver",void 0),t}return _createClass(WebPlayerControls,[{key:"connectedCallback",value:function connectedCallback(){var t=this;this.updateVolumeIndicator(parseFloat(this.volumeSlider.value)/100),this.setFullscreen(!1),this.volumeIndicator.addEventListener("click",(function(){t.setMuted(!t.volumeIndicator.classList.contains("icon-mute"))})),this.volumeSlider.addEventListener("input",(function(){var r=t.volumeSlider;t.controlContainer.style.setProperty("--volume-before-width",r.value/r.max*100+"%")})),this.fullscreenButton.addEventListener("click",(function(){t.setFullscreen(t.fullscreenButton.classList.contains("icon-expand"))})),this.raiseHandButton.addEventListener("click",(function(){t.setSelected(t.raiseHandButton,!t.raiseHandButton.classList.contains("selected"))})),this.showQuizButton.addEventListener("click",(function(){t.setSelected(t.showQuizButton,!t.showQuizButton.classList.contains("selected"))}))}},{key:"visible",get:function get(){return this.hasAttribute("visible")},set:function set(t){t?this.setAttribute("visible",""):this.removeAttribute("visible")}},{key:"show",value:function show(){this.visible=!0}},{key:"hide",value:function hide(){this.visible=!1}},{key:"setDuration",value:function setDuration(t){var r=new Date(t),i=r.getUTCHours(),o="0"+r.getUTCMinutes(),a="0"+r.getUTCSeconds(),c=i+":"+o.substr(-2)+":"+a.substr(-2);this.duration.innerText=c}},{key:"setVolume",value:function setVolume(t){this.volumeSlider.value=(100*t).toString(),this.updateVolumeIndicator(t)}},{key:"setMuted",value:function setMuted(t){t?this.setVolumeIndicator("icon-mute"):this.updateVolumeIndicator(parseFloat(this.volumeSlider.value)/100),this.muteObserver&&this.muteObserver(t)}},{key:"setFullscreen",value:function setFullscreen(t){t?this.setFullscreenIndicator("icon-contract"):this.setFullscreenIndicator("icon-expand")}},{key:"setSelected",value:function setSelected(t,r){var i=t.classList;r?i.add("selected"):i.remove("selected")}},{key:"setActive",value:function setActive(t,r){var i=t.classList;r?i.add("active"):i.remove("active")}},{key:"setVisible",value:function setVisible(t,r){r?t.classList.remove("invisible"):t.classList.add("invisible")}},{key:"setPlayMediaVisible",value:function setPlayMediaVisible(t){this.setVisible(this.playMediaButton,t)}},{key:"setOnPlayMedia",value:function setOnPlayMedia(t){this.playMediaButton.addEventListener("click",(function(){event.stopPropagation(),t()}),!1)}},{key:"setOnVolume",value:function setOnVolume(t){var r=this;this.volumeSlider.addEventListener("input",(function(){var i=parseFloat(r.volumeSlider.value)/100;r.updateVolumeIndicator(i),t(i)}))}},{key:"setOnMute",value:function setOnMute(t){this.muteObserver=t}},{key:"setOnSettings",value:function setOnSettings(t){this.settingsButton.addEventListener("click",(function(){event.stopPropagation(),t(!0)}),!1)}},{key:"setOnFullscreen",value:function setOnFullscreen(t){var r=this;this.fullscreenButton.addEventListener("click",(function(){event.stopPropagation(),t(!r.fullscreenButton.classList.contains("icon-expand"))}),!1)}},{key:"setOnRaiseHand",value:function setOnRaiseHand(t){var r=this;t.subscribe((function(t){r.setSelected(r.raiseHandButton,t)})),this.raiseHandButton.addEventListener("click",(function(){event.stopPropagation(),t.value=r.raiseHandButton.classList.contains("selected")}),!1)}},{key:"setOnRaiseHandActive",value:function setOnRaiseHandActive(t){var r=this;t.subscribe((function(t){r.setActive(r.raiseHandButton,t)}))}},{key:"setOnShowQuiz",value:function setOnShowQuiz(t){var r=this;t.subscribe((function(t){r.setSelected(r.showQuizButton,t)})),this.showQuizButton.addEventListener("click",(function(){event.stopPropagation(),t.value=r.showQuizButton.classList.contains("selected")}),!1)}},{key:"setOnShowQuizActive",value:function setOnShowQuizActive(t){var r=this;this.setVisible(this.showQuizButton,t.value),t.subscribe((function(t){r.setVisible(r.showQuizButton,t)}))}},{key:"addToolbarElement",value:function addToolbarElement(t){this.toolbar.appendChild(t)}},{key:"updateVolumeIndicator",value:function updateVolumeIndicator(t){0===t?this.setVolumeIndicator("icon-volume0"):t<.33?this.setVolumeIndicator("icon-volume1"):t>.33&&t<.66?this.setVolumeIndicator("icon-volume2"):t>.66&&this.setVolumeIndicator("icon-volume3")}},{key:"setFullscreenIndicator",value:function setFullscreenIndicator(t){var r=this.fullscreenButton.classList;r.remove("icon-expand","icon-contract"),r.add(t)}},{key:"setVolumeIndicator",value:function setVolumeIndicator(t){var r=this.volumeIndicator.classList;r.remove("icon-mute");for(var i=0;i<4;i++)r.remove("icon-volume"+i);r.add(t)}}]),WebPlayerControls}(U))||V,z=function(){function Dimension(t,r){_classCallCheck(this,Dimension),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),this.width=t,this.height=r}return _createClass(Dimension,[{key:"equals",value:function equals(t){return!!t&&(this.width===t.height&&this.height===t.height)}},{key:"toString",value:function toString(){return"[".concat(this.height,", ").concat(this.width,"]")}}]),Dimension}(),H=function(){function SizeEvent(t){_classCallCheck(this,SizeEvent),_defineProperty(this,"_size",void 0),this._size=t}return _createClass(SizeEvent,[{key:"size",get:function get(){return this._size}}]),SizeEvent}(),G=function(){function TypedEvent(){_classCallCheck(this,TypedEvent),_defineProperty(this,"listeners",[]),_defineProperty(this,"listenersOncer",[])}return _createClass(TypedEvent,[{key:"subscribe",value:function subscribe(t){var r=this;return this.listeners.push(t),{dispose:function dispose(){return r.unsubscribe(t)}}}},{key:"subscribeOnce",value:function subscribeOnce(t){this.listenersOncer.push(t)}},{key:"unsubscribe",value:function unsubscribe(t){var r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}},{key:"publish",value:function publish(t){this.listeners.forEach((function(r){return r(t)})),this.listenersOncer.forEach((function(r){return r(t)})),this.listenersOncer=[]}},{key:"pipe",value:function pipe(t){return this.subscribe((function(r){return t.publish(r)}))}}]),TypedEvent}();function render_surface_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function render_surface_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return render_surface_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return render_surface_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function render_surface_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var q=function(){function RenderSurface(t){_classCallCheck(this,RenderSurface),_defineProperty(this,"canvas",void 0),_defineProperty(this,"canvasContext",void 0),_defineProperty(this,"renderers",void 0),_defineProperty(this,"sizeEvent",new G),_defineProperty(this,"transform",void 0),_defineProperty(this,"size",void 0),this.canvas=t,this.canvasContext=t.getContext("2d"),this.renderers=new Map,this.transform=new c}return _createClass(RenderSurface,[{key:"clear",value:function clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"registerRenderer",value:function registerRenderer(t,r){this.renderers.set(t,r)}},{key:"renderImageSource",value:function renderImageSource(t){this.canvasContext.drawImage(t,0,0)}},{key:"renderSurface",value:function renderSurface(t){this.canvasContext.drawImage(t.canvas,0,0)}},{key:"renderShapes",value:function renderShapes(t){var r,i=render_surface_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.renderShape(o,null)}}catch(t){i.e(t)}finally{i.f()}}},{key:"renderShape",value:function renderShape(t,r){var i=this.renderers.get(t.constructor.name);if(i){var o=this.canvas.width*this.transform.getScaleX(),a=this.transform.getTranslateX(),c=this.transform.getTranslateY();this.canvasContext.save(),this.canvasContext.scale(o,o),this.canvasContext.translate(-a,-c),i.render(this.canvasContext,t,r),this.canvasContext.restore()}}},{key:"getSize",value:function getSize(){return this.size}},{key:"setSize",value:function setSize(t,r){if(!(t<1||r<1)){var i=window.devicePixelRatio||1;this.size=new z(t*i,r*i),this.resizeCanvas(t,r,i),this.fireSizeEvent(new H(this.size))}}},{key:"setTransform",value:function setTransform(t){this.transform.setTransform(t)}},{key:"addSizeListener",value:function addSizeListener(t){return this.sizeEvent.subscribe(t)}},{key:"removeSizeListener",value:function removeSizeListener(t){this.sizeEvent.unsubscribe(t)}},{key:"fireSizeEvent",value:function fireSizeEvent(t){this.sizeEvent.publish(t)}},{key:"resizeCanvas",value:function resizeCanvas(t,r,i){var o=this.canvas.getAttribute("scale");o&&"full"===o&&(this.canvas.width=t*i,this.canvas.height=r*i),this.canvas.style.width=t+"px",this.canvas.style.height=r+"px"}}]),RenderSurface}();function slide_render_surface_createSuper(t){var r=function slide_render_surface_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var W=function(t){_inherits(SlideRenderSurface,t);var r=slide_render_surface_createSuper(SlideRenderSurface);function SlideRenderSurface(){return _classCallCheck(this,SlideRenderSurface),r.apply(this,arguments)}return _createClass(SlideRenderSurface,[{key:"renderSlideShape",value:function renderSlideShape(t,r){var i=this.renderers.get(t.constructor.name),o=null;if(i){var a=t.bounds,c=this.canvas.width/a.width;this.canvasContext.save(),this.canvasContext.scale(c,c),o=i.render(this.canvasContext,t,r),this.canvasContext.restore()}return o}}]),SlideRenderSurface}(q);function asyncGeneratorStep(t,r,i,o,a,c,l){try{var u=t[c](l),d=u.value}catch(t){return void i(t)}u.done?r(d):Promise.resolve(d).then(o,a)}function _asyncToGenerator(t){return function(){var r=this,i=arguments;return new Promise((function(o,a){var c=t.apply(r,i);function _next(t){asyncGeneratorStep(c,o,a,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(c,o,a,_next,_throw,"throw",t)}_next(void 0)}))}}var Q,Y=__webpack_require__(757),X=__webpack_require__.n(Y),$=function(){function TextLayerSurface(t){_classCallCheck(this,TextLayerSurface),_defineProperty(this,"root",void 0),_defineProperty(this,"size",void 0),this.root=t}var t;return _createClass(TextLayerSurface,[{key:"clear",value:function clear(){for(;this.root.firstChild;)this.root.removeChild(this.root.firstChild)}},{key:"render",value:(t=_asyncToGenerator(X().mark((function _callee(t){return X().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:this.clear(),t.renderText(this.root,this.size);case 2:case"end":return r.stop()}}),_callee,this)}))),function render(r){return t.apply(this,arguments)})},{key:"getSize",value:function getSize(){return this.size}},{key:"setSize",value:function setSize(t,r){this.size=new z(t,r),this.root.style.width=t+"px",this.root.style.height=r+"px"}}]),TextLayerSurface}();function web_slide_view_createSuper(t){var r=function web_slide_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var K,Z=R({selector:"slide-view",template:__webpack_require__(225),styles:[__webpack_require__(486)]})(Q=function(t){_inherits(WebSlideView,t);var r=web_slide_view_createSuper(WebSlideView);function WebSlideView(){var t;return _classCallCheck(this,WebSlideView),_defineProperty(_assertThisInitialized(t=r.call(this)),"slideRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"actionRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"volatileRenderSurface",void 0),_defineProperty(_assertThisInitialized(t),"textLayerSurface",void 0),_defineProperty(_assertThisInitialized(t),"playerControls",void 0),t}return _createClass(WebSlideView,[{key:"connectedCallback",value:function connectedCallback(){var t=this.querySelector(".slide-canvas"),r=this.querySelector(".action-canvas"),i=this.querySelector(".volatile-canvas"),o=this.querySelector(".text-layer");this.slideRenderSurface=new W(t),this.actionRenderSurface=new q(r),this.volatileRenderSurface=new q(i),this.textLayerSurface=new $(o),this.resize(),window.addEventListener("resize",this.resize.bind(this),!1)}},{key:"getActionRenderSurface",value:function getActionRenderSurface(){return this.actionRenderSurface}},{key:"getSlideRenderSurface",value:function getSlideRenderSurface(){return this.slideRenderSurface}},{key:"getVolatileRenderSurface",value:function getVolatileRenderSurface(){return this.volatileRenderSurface}},{key:"getTextLayerSurface",value:function getTextLayerSurface(){return this.textLayerSurface}},{key:"repaint",value:function repaint(){this.resize()}},{key:"resize",value:function resize(){this.querySelector(".slide-view");var t=4/3,r=this.clientWidth,i=this.clientHeight;r/i>t?r=i*t:i=r/t,this.slideRenderSurface.setSize(r,i),this.actionRenderSurface.setSize(r,i),this.volatileRenderSurface.setSize(r,i),this.textLayerSurface.setSize(r,i)}}]),WebSlideView}(U))||Q;function player_view_createSuper(t){var r=function player_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ee,te=R({selector:"player-view",template:__webpack_require__(628),styles:[__webpack_require__(77)]})(K=function(t){_inherits(PlayerView,t);var r=player_view_createSuper(PlayerView);function PlayerView(t){var i;return _classCallCheck(this,PlayerView),_defineProperty(_assertThisInitialized(i=r.call(this)),"playbackModel",void 0),_defineProperty(_assertThisInitialized(i),"slideView",void 0),_defineProperty(_assertThisInitialized(i),"playerControls",void 0),_defineProperty(_assertThisInitialized(i),"videoFeed",void 0),_defineProperty(_assertThisInitialized(i),"videoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"mainVideoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"localVideoFeedContainer",void 0),_defineProperty(_assertThisInitialized(i),"containerA",void 0),_defineProperty(_assertThisInitialized(i),"rightContainer",void 0),i.playbackModel=t,i}return _createClass(PlayerView,[{key:"connectedCallback",value:function connectedCallback(){var t=this,r=this.playbackModel.elementAProperty.value;r&&this.setElementA(r),this.videoFeed.addEventListener("canplay",(function(){t.videoFeed.play().catch((function(r){"NotAllowedError"==r.name&&t.cannotPlay()}))})),this.videoFeed.addEventListener("play",(function(){window.dispatchEvent(new Event("resize"))})),this.playbackModel.elementAProperty.subscribe(this.setElementA.bind(this)),this.playbackModel.videoAvailableProperty.subscribe(this.setVideoAvailable.bind(this)),this.playbackModel.mainVideoAvailableProperty.subscribe(this.setMainVideoAvailable.bind(this)),this.playbackModel.localVideoAvailableProperty.subscribe(this.setLocalVideoAvailable.bind(this)),this.playerControls.setOnRaiseHand(this.playbackModel.raisedHandProperty),this.playerControls.setOnRaiseHandActive(this.playbackModel.webrtcPublisherConnectedProperty),this.playerControls.setOnShowQuiz(this.playbackModel.showQuizProperty),this.playerControls.setOnShowQuizActive(this.playbackModel.showQuizActiveProperty),this.playerControls.setOnFullscreen((function(r){t.setFullscreen(r)})),this.playerControls.setOnPlayMedia((function(){t.videoFeed.play().then((function(){t.playerControls.setPlayMediaVisible(!1)})).catch((function(t){console.error(t)}))})),this.slideView.repaint(),window.dispatchEvent(new Event("resize"))}},{key:"getSlideView",value:function getSlideView(){return this.slideView}},{key:"getMediaElement",value:function getMediaElement(){return this.videoFeed}},{key:"setDuration",value:function setDuration(t){this.playerControls.setDuration(t)}},{key:"setVolume",value:function setVolume(t){this.playerControls.setVolume(t)}},{key:"setMuted",value:function setMuted(t){this.playerControls.setMuted(t)}},{key:"setFullscreen",value:function setFullscreen(t){t?this.classList.add("fullscreen"):this.classList.remove("fullscreen"),window.dispatchEvent(new Event("resize"))}},{key:"setOnVolume",value:function setOnVolume(t){this.playerControls.setOnVolume(t)}},{key:"setOnMute",value:function setOnMute(t){this.playerControls.setOnMute(t)}},{key:"setOnFullscreen",value:function setOnFullscreen(t){this.playerControls.setOnFullscreen(t)}},{key:"setOnSettings",value:function setOnSettings(t){this.playerControls.setOnSettings(t)}},{key:"addToolbarElement",value:function addToolbarElement(t){this.playerControls.addToolbarElement(t)}},{key:"cannotPlay",value:function cannotPlay(){this.playerControls.setPlayMediaVisible(!0),window.dispatchEvent(new Event("resize"))}},{key:"setElementA",value:function setElementA(t){if(t)this.containerA.appendChild(t);else for(;this.containerA.firstChild;)this.containerA.removeChild(this.containerA.firstChild);this.updateRightContainer()}},{key:"setElementVisible",value:function setElementVisible(t,r){r?t.classList.remove("invisible"):t.classList.add("invisible")}},{key:"setVideoAvailable",value:function setVideoAvailable(t){this.setElementVisible(this.videoFeedContainer,t),this.updateRightContainer()}},{key:"setMainVideoAvailable",value:function setMainVideoAvailable(t){this.setElementVisible(this.mainVideoFeedContainer,t),this.updateRightContainer()}},{key:"setLocalVideoAvailable",value:function setLocalVideoAvailable(t){this.setElementVisible(this.localVideoFeedContainer,t),this.updateRightContainer()}},{key:"updateRightContainer",value:function updateRightContainer(){this.setElementVisible(this.rightContainer,this.playbackModel.videoAvailable||this.playbackModel.localVideoAvailable||this.containerA.hasChildNodes()),window.dispatchEvent(new Event("resize"))}}]),PlayerView}(U))||K,ne=function(){function ProgressiveDataView(t,r,i){_classCallCheck(this,ProgressiveDataView),_defineProperty(this,"dataView",void 0),_defineProperty(this,"offset",void 0),this.dataView=new DataView(t,r,i),this.offset=r||0}return _createClass(ProgressiveDataView,[{key:"byteOffset",get:function get(){return this.offset}},{key:"skip",value:function skip(t){if(this.offset+t>=this.dataView.byteLength)throw new Error("Out of bounds ".concat(this.offset+t," exceeds length ").concat(this.dataView.byteLength));this.offset+=t}},{key:"getString",value:function getString(t){for(var r="",i=-1,o=0;o<t&&0!=(i=this.getUint8());o++)r+=String.fromCharCode(i);return r}},{key:"getFloat32",value:function getFloat32(t){var r=this.dataView.getFloat32(this.offset,t);return this.offset+=4,r}},{key:"getFloat64",value:function getFloat64(t){var r=this.dataView.getFloat64(this.offset,t);return this.offset+=8,r}},{key:"getInt8",value:function getInt8(){var t=this.dataView.getInt8(this.offset);return this.offset+=1,t}},{key:"getInt16",value:function getInt16(t){var r=this.dataView.getInt16(this.offset,t);return this.offset+=2,r}},{key:"getInt32",value:function getInt32(t){var r=this.dataView.getInt32(this.offset,t);return this.offset+=4,r}},{key:"getInt64",value:function getInt64(t){var r=this.dataView.getBigInt64(this.offset,t);return this.offset+=8,r}},{key:"getUint8",value:function getUint8(){var t=this.dataView.getUint8(this.offset);return this.offset+=1,t}},{key:"getUint16",value:function getUint16(t){var r=this.dataView.getUint16(this.offset,t);return this.offset+=2,r}},{key:"getUint32",value:function getUint32(t){var r=this.dataView.getUint32(this.offset,t);return this.offset+=4,r}}]),ProgressiveDataView}();function pen_point_createSuper(t){var r=function pen_point_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}!function(t){t[t.TOOL_BEGIN=0]="TOOL_BEGIN",t[t.TOOL_EXECUTE=1]="TOOL_EXECUTE",t[t.TOOL_END=2]="TOOL_END",t[t.PEN=3]="PEN",t[t.HIGHLIGHTER=4]="HIGHLIGHTER",t[t.POINTER=5]="POINTER",t[t.ARROW=6]="ARROW",t[t.LINE=7]="LINE",t[t.RECTANGLE=8]="RECTANGLE",t[t.ELLIPSE=9]="ELLIPSE",t[t.TEXT=10]="TEXT",t[t.TEXT_CHANGE=11]="TEXT_CHANGE",t[t.TEXT_FONT_CHANGE=12]="TEXT_FONT_CHANGE",t[t.TEXT_LOCATION_CHANGE=13]="TEXT_LOCATION_CHANGE",t[t.TEXT_REMOVE=14]="TEXT_REMOVE",t[t.TEXT_SELECTION=15]="TEXT_SELECTION",t[t.LATEX=16]="LATEX",t[t.LATEX_FONT_CHANGE=17]="LATEX_FONT_CHANGE",t[t.UNDO=18]="UNDO",t[t.REDO=19]="REDO",t[t.CLONE=20]="CLONE",t[t.SELECT=21]="SELECT",t[t.SELECT_GROUP=22]="SELECT_GROUP",t[t.RUBBER=23]="RUBBER",t[t.CLEAR_SHAPES=24]="CLEAR_SHAPES",t[t.PANNING=25]="PANNING",t[t.EXTEND_VIEW=26]="EXTEND_VIEW",t[t.ZOOM=27]="ZOOM",t[t.ZOOM_OUT=28]="ZOOM_OUT",t[t.NEXT_PAGE=29]="NEXT_PAGE",t[t.KEY=30]="KEY",t[t.STATIC=31]="STATIC",t[t.PAGE=32]="PAGE",t[t.RUBBER_EXT=33]="RUBBER_EXT",t[t.TEXT_SELECTION_EXT=34]="TEXT_SELECTION_EXT"}(ee||(ee={}));var re=function(t){_inherits(PenPoint,t);var r=pen_point_createSuper(PenPoint);function PenPoint(t,i,o){var a;return _classCallCheck(this,PenPoint),_defineProperty(_assertThisInitialized(a=r.call(this,t,i)),"p",void 0),a.p=o,a}return _createClass(PenPoint,[{key:"clone",value:function clone(){return new PenPoint(this.x,this.y,this.p)}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y&&this.p===t.p)}}],[{key:"createZero",value:function createZero(){return new PenPoint(0,0,0)}}]),PenPoint}(a),ie=function Action(){_classCallCheck(this,Action),_defineProperty(this,"keyEvent",void 0),_defineProperty(this,"timestamp",void 0)};function brush_action_createSuper(t){var r=function brush_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var oe=function(t){_inherits(BrushAction,t);var r=brush_action_createSuper(BrushAction);function BrushAction(t,i){var o;return _classCallCheck(this,BrushAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"shapeHandle",void 0),_defineProperty(_assertThisInitialized(o),"brush",void 0),o.shapeHandle=t,o.brush=i,o}return BrushAction}(ie),ae=function(){function PaintTool(){_classCallCheck(this,PaintTool),_defineProperty(this,"shapeHandle",void 0),_defineProperty(this,"brush",void 0)}return _createClass(PaintTool,[{key:"begin",value:function begin(t,r){}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),PaintTool}(),se=function ShapeAction(t){_classCallCheck(this,ShapeAction),_defineProperty(this,"shapes",void 0),this.shapes=t};function add_shape_action_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function add_shape_action_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return add_shape_action_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return add_shape_action_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function add_shape_action_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function add_shape_action_createSuper(t){var r=function add_shape_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ce=function(t){_inherits(AddShapeAction,t);var r=add_shape_action_createSuper(AddShapeAction);function AddShapeAction(t){return _classCallCheck(this,AddShapeAction),r.call(this,t)}return _createClass(AddShapeAction,[{key:"execute",value:function execute(t){var r,i=add_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.addShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"undo",value:function undo(t){var r,i=add_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.removeShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"redo",value:function redo(t){this.execute(t)}}]),AddShapeAction}(se);function _get(t,r,i){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,i){var o=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(o){var a=Object.getOwnPropertyDescriptor(o,r);return a.get?a.get.call(i):a.value}},_get(t,r,i||t)}var le=function(){function ShapeEvent(t,r){_classCallCheck(this,ShapeEvent),_defineProperty(this,"_shape",void 0),_defineProperty(this,"_dirtyRegion",void 0),this._shape=t,this._dirtyRegion=r}return _createClass(ShapeEvent,[{key:"shape",get:function get(){return this._shape}},{key:"dirtyRegion",get:function get(){return this._dirtyRegion}}]),ShapeEvent}(),ue=function(){function Rectangle(t,r,i,o){_classCallCheck(this,Rectangle),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),this.set(t,r,i,o)}return _createClass(Rectangle,[{key:"set",value:function set(t,r,i,o){this.x=t,this.y=r,this.width=i,this.height=o}},{key:"isEmpty",value:function isEmpty(){return this.width<=0||this.height<=0}},{key:"containsPoint",value:function containsPoint(t){var r=t.x,i=t.y;return r>=this.x&&i>=this.y&&r<this.x+this.width&&i<this.y+this.height}},{key:"containsRect",value:function containsRect(t){if(this.isEmpty()||t.isEmpty())return!1;var r=t.x,i=t.y,o=t.width,a=t.height,c=this.x,l=this.y;return r>=c&&i>=l&&r+o<=c+this.width&&i+a<=l+this.height}},{key:"intersectsLine",value:function intersectsLine(t,r,i,o){for(var a=this.x,c=this.x+this.width,l=this.y,u=this.y+this.height,d=this.computeCode(t,r,a,c,l,u),h=this.computeCode(i,o,a,c,l,u);;){if(!(d|h))return!0;if(d&h)return!1;var p=d||h,g=void 0,m=void 0;8&p?(g=t+(i-t)*(u-r)/(o-r),m=u):4&p?(g=t+(i-t)*(l-r)/(o-r),m=l):2&p?(m=r+(o-r)*(c-t)/(i-t),g=c):1&p&&(m=r+(o-r)*(a-t)/(i-t),g=a),p==d?(t=g,r=m,d=this.computeCode(t,r,a,c,l,u)):(i=g,o=m,h=this.computeCode(i,o,a,c,l,u))}}},{key:"intersection",value:function intersection(t){var r=Math.max(this.x,t.x),i=Math.max(this.y,t.y),o=Math.min(this.x+this.width,t.x+t.width)-r,a=Math.min(this.y+this.height,t.y+t.height)-i;return o<=0||a<=0?null:new Rectangle(r,i,o,a)}},{key:"union",value:function union(t){var r=Math.min(this.x,t.x),i=Math.min(this.y,t.y),o=Math.max(this.x+this.width,t.x+t.width),a=Math.max(this.y+this.height,t.y+t.height);this.set(r,i,o-r,a-i)}},{key:"equals",value:function equals(t){return!!t&&(this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height)}},{key:"toString",value:function toString(){return"[".concat(this.x,", ").concat(this.y,", ").concat(this.height,", ").concat(this.width,"]")}},{key:"computeCode",value:function computeCode(t,r,i,o,a,c){var l=0;return t<i?l|=1:t>o&&(l|=2),r<a?l|=4:r>c&&(l|=8),l}}],[{key:"empty",value:function empty(){return new Rectangle(0,0,0,0)}}]),Rectangle}();function shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var de=function(){function Shape(t){_classCallCheck(this,Shape),_defineProperty(this,"_handle",void 0),_defineProperty(this,"_points",[]),_defineProperty(this,"_bounds",ue.empty()),_defineProperty(this,"changeEvent",new G),_defineProperty(this,"selected",void 0),_defineProperty(this,"keyEvent",void 0),this._handle=t}return _createClass(Shape,[{key:"handle",get:function get(){return this._handle}},{key:"addPoint",value:function addPoint(t){var r=this._points.length,i=null;return r>0&&(i=this._points[r-1]),!t.equals(i)&&(this._points.push(t),!0)}},{key:"points",get:function get(){return this._points}},{key:"contains",value:function contains(t){return this._bounds.containsPoint(t)}},{key:"intersects",value:function intersects(t){return null!=this._bounds.intersection(t)}},{key:"bounds",get:function get(){return this._bounds}},{key:"getKeyEvent",value:function getKeyEvent(){return this.keyEvent}},{key:"setKeyEvent",value:function setKeyEvent(t){this.keyEvent=t}},{key:"isSelected",value:function isSelected(){return this.selected}},{key:"setSelected",value:function setSelected(t){this.selected!=t&&(this.selected=t,this.fireShapeEvent(new le(this,this.bounds)))}},{key:"moveByDelta",value:function moveByDelta(t){var r,i=shape_createForOfIteratorHelper(this._points);try{for(i.s();!(r=i.n()).done;){r.value.subtract(t)}}catch(t){i.e(t)}finally{i.f()}this.updateBoundsByDelta(t),this.fireShapeEvent(new le(this,this.bounds))}},{key:"clone",value:function clone(){return Object.create(this)}},{key:"addChangeListener",value:function addChangeListener(t){return this.changeEvent.subscribe(t)}},{key:"removeChangeListener",value:function removeChangeListener(t){this.changeEvent.unsubscribe(t)}},{key:"updateBoundsByDelta",value:function updateBoundsByDelta(t){this.bounds.x-=t.x,this.bounds.y-=t.y}},{key:"fireShapeEvent",value:function fireShapeEvent(t){this.changeEvent.publish(t)}}]),Shape}(),he=function(){function Line(t,r,i,o){_classCallCheck(this,Line),_defineProperty(this,"x1",void 0),_defineProperty(this,"y1",void 0),_defineProperty(this,"x2",void 0),_defineProperty(this,"y2",void 0),this.set(t,r,i,o)}return _createClass(Line,[{key:"set",value:function set(t,r,i,o){this.x1=t,this.y1=r,this.x2=i,this.y2=o}},{key:"getStartPoint",value:function getStartPoint(){return new a(this.x1,this.y1)}},{key:"getEndPoint",value:function getEndPoint(){return new a(this.x2,this.y2)}},{key:"distance",value:function distance(t,r){var i=this.x2-this.x1,o=this.y2-this.y1,a=Math.sqrt(i*i+o*o);return Math.abs(((this.y1-this.y2)*t+i*r+(this.x1*this.y2-this.x2*this.y1))/a)}},{key:"intersects",value:function intersects(t){return Line.intersects(this.x1,this.y1,this.x2,this.y2,t.x1,t.y1,t.x2,t.y2)}},{key:"getIntersectionPoint",value:function getIntersectionPoint(t,r,i,o){var c=(o-r)*(this.x2-this.x1)-(i-t)*(this.y2-this.y1);if(Math.abs(c)<.01)return null;var l=((i-t)*(this.y1-r)-(o-r)*(this.x1-t))/c,u=((this.x2-this.x1)*(this.y1-r)-(this.y2-this.y1)*(this.x1-t))/c;if(l>=0&&l<=1&&u>=0&&u<=1){var d=this.y2-this.y1,h=this.x1-this.x2,p=d*this.x1+h*this.y1,g=o-r,m=t-i,y=g*t+m*r;return new a((m*p-h*y)/c,(d*y-g*p)/c)}return null}}],[{key:"intersects",value:function intersects(t,r,i,o,a,c,l,u){var d=(u-c)*(i-t)-(l-a)*(o-r);if(0==d)return!1;var h=((l-a)*(r-c)-(u-c)*(t-a))/d,p=((i-t)*(r-c)-(o-r)*(t-a))/d;return h>=0&&h<=1&&p>=0&&p<=1}}]),Line}();function stroke_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function stroke_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return stroke_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return stroke_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function stroke_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function stroke_shape_createSuper(t){var r=function stroke_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pe=function(t){_inherits(StrokeShape,t);var r=stroke_shape_createSuper(StrokeShape);function StrokeShape(t,i){var o;return _classCallCheck(this,StrokeShape),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"_brush",void 0),_defineProperty(_assertThisInitialized(o),"minPoint",new a(0,0)),_defineProperty(_assertThisInitialized(o),"maxPoint",new a(0,0)),o._brush=i,o}return _createClass(StrokeShape,[{key:"brush",get:function get(){return this._brush}},{key:"addPoint",value:function addPoint(t){var r=_get(_getPrototypeOf(StrokeShape.prototype),"addPoint",this).call(this,t);return r&&(this.minPoint.x=Math.min(this.minPoint.x,t.x),this.minPoint.y=Math.min(this.minPoint.y,t.y),this.maxPoint.x=Math.max(this.maxPoint.x,t.x),this.maxPoint.y=Math.max(this.maxPoint.y,t.y),this.updateBounds(),this.fireShapeEvent(new le(this,this.bounds))),r}},{key:"contains",value:function contains(t){var r=this.brush.width/2;if(0===this.points.length)return!1;if(1===this.points.length)return this.points[0].distance(t)<=r;for(var i=new he(t.x+r,t.y+r,t.x-r,t.y-r),o=new he(t.x-r,t.y+r,t.x+r,t.y-r),a=0,c=this.points[a++],l=null,u=null;a<this.points.length;){if(l=this.points[a++],(u=new he(c.x,c.y,l.x,l.y)).intersects(i))return!0;if(u.intersects(o))return!0;c=l}return!1}},{key:"intersects",value:function intersects(t){if(0===this.points.length)return!1;if(1===this.points.length)return t.containsPoint(this.points[0]);for(var r=0,i=this.points[r++],o=null;r<this.points.length;){if(o=this.points[r++],t.intersectsLine(i.x,i.y,o.x,o.y))return!0;i=o}return!1}},{key:"updateBounds",value:function updateBounds(){var t=this.minPoint.x,r=this.minPoint.y,i=this.maxPoint.x-this.minPoint.x,o=this.maxPoint.y-this.minPoint.y;this.bounds.set(t,r,i,o)}},{key:"clone",value:function clone(){var t=new StrokeShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=stroke_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),StrokeShape}(de);function arrayLikeToArray_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function unsupportedIterableToArray_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return arrayLikeToArray_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?arrayLikeToArray_arrayLikeToArray(t,r):void 0}}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return arrayLikeToArray_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||unsupportedIterableToArray_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pen_stroke_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function pen_stroke_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return pen_stroke_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pen_stroke_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function pen_stroke_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var fe=function(){function PenStroke(t){_classCallCheck(this,PenStroke),_defineProperty(this,"vector",new a(0,0)),_defineProperty(this,"normal",new a(0,0)),_defineProperty(this,"miter",new a(0,0)),_defineProperty(this,"offsetA",new a(0,0)),_defineProperty(this,"offsetB",new a(0,0)),_defineProperty(this,"lastLineTop",new he(0,0,0,0)),_defineProperty(this,"lastLineBottom",new he(0,0,0,0)),_defineProperty(this,"A",new Array),_defineProperty(this,"B",new Array),_defineProperty(this,"points",new Array),_defineProperty(this,"strokeWidth",void 0),this.strokeWidth=t}return _createClass(PenStroke,[{key:"getStrokeList",value:function getStrokeList(){if(0===this.points.length)return null;var t=new Array;return 1==this.points.length?(this.capOnePoint(t,this.points[0],this.strokeWidth),t):(t.push.apply(t,_toConsumableArray(this.A)),this.capEndpoint(t,this.points[1],this.points[0],!1),t.push.apply(t,_toConsumableArray(this.B)),t)}},{key:"addPoint",value:function addPoint(t){this.points.push(t.clone());var r=this.points.length;if(r>1){r>2&&this.points.shift();var i=this.points[0];0===this.A.length||0===this.B.length?(this.capEndpoint(this.A,i,t,!1),this.beginPath(i,t)):this.advance(i,t)}}},{key:"intersects",value:function intersects(t){return 0!==this.points.length&&(1===this.points.length?t.containsPoint(this.points[0]):!!this.intersectsRect(this.A,t)||!!this.intersectsRect(this.B,t))}},{key:"moveByDelta",value:function moveByDelta(t){var r,i=pen_stroke_createForOfIteratorHelper(this.A);try{for(i.s();!(r=i.n()).done;){r.value.subtract(t)}}catch(t){i.e(t)}finally{i.f()}var o,a=pen_stroke_createForOfIteratorHelper(this.B);try{for(a.s();!(o=a.n()).done;){o.value.subtract(t)}}catch(t){a.e(t)}finally{a.f()}var c,l=pen_stroke_createForOfIteratorHelper(this.points);try{for(l.s();!(c=l.n()).done;){c.value.subtract(t)}}catch(t){l.e(t)}finally{l.f()}}},{key:"clone",value:function clone(){var t,r=new PenStroke(this.strokeWidth),i=pen_stroke_createForOfIteratorHelper(this.A);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.A.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}var a,c=pen_stroke_createForOfIteratorHelper(this.B);try{for(c.s();!(a=c.n()).done;){var l=a.value;r.B.push(l.clone())}}catch(t){c.e(t)}finally{c.f()}var u,d=pen_stroke_createForOfIteratorHelper(this.points);try{for(d.s();!(u=d.n()).done;){var h=u.value;r.points.push(h.clone())}}catch(t){d.e(t)}finally{d.f()}return r}},{key:"advance",value:function advance(t,r){this.advancePath(this.A,t,r,!1),this.advancePath(this.B,t,r,!0)}},{key:"advancePath",value:function advancePath(t,r,i,o){this.vector.set(i.x,i.y).subtract(r).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetA.set(r.x,r.y),this.offset(this.offsetA,this.miter,o),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(i)/2),this.offsetB.set(i.x,i.y),this.offset(this.offsetB,this.miter,o);var a=new he(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y),c=o?this.lastLineTop:this.lastLineBottom,l=c.getIntersectionPoint(a.x1,a.y1,a.x2,a.y2);if(null!=l)this.intersect(t,l,o);else{var u=c.getEndPoint(),d=a.getStartPoint(),h=this.toDegrees(u,r),p=this.toDegrees(d,r);Math.abs(h-p)>180&&(h%=360,p%=360),this.cap(t,r,h,p,this.strokeWidth*this.toPressure(r)/2,2,o)}c.set(a.x1,a.y1,a.x2,a.y2)}},{key:"beginPath",value:function beginPath(t,r){this.vector.set(r.x,r.y).subtract(t).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(t)/2),this.offsetA.set(t.x,t.y).add(this.miter),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetB.set(r.x,r.y).add(this.miter),this.addPathPoint(this.A,this.offsetB.x,this.offsetB.y,!1),this.lastLineBottom.set(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(t)/2),this.offsetA.set(t.x,t.y).subtract(this.miter),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetB.set(r.x,r.y).subtract(this.miter),this.addPathPoint(this.B,this.offsetA.x,this.offsetA.y,!0),this.addPathPoint(this.B,this.offsetB.x,this.offsetB.y,!0),this.lastLineTop.set(this.offsetA.x,this.offsetA.y,this.offsetB.x,this.offsetB.y)}},{key:"cap",value:function cap(t,r,i,o,a,c,l){if(i>o)for(var u=i;u>=o;u-=c){var d=Math.PI*u/180,h=r.x+a*Math.cos(d),p=r.y+a*Math.sin(d);this.addPathPoint(t,h,p,l)}else for(var g=i;g<=o;g+=c){var m=Math.PI*g/180,y=r.x+a*Math.cos(m),v=r.y+a*Math.sin(m);this.addPathPoint(t,y,v,l)}}},{key:"capOnePoint",value:function capOnePoint(t,r,i){this.addPathPoint(t,r.x+i*this.toPressure(r)/2,r.y,!1),this.cap(t,r,0,360,i*this.toPressure(r)/2,2,!1)}},{key:"capEndpoint",value:function capEndpoint(t,r,i,o){this.vector.set(i.x,i.y).subtract(r).normalize(),this.normal.set(-this.vector.y,this.vector.x).normalize(),this.miter.set(this.normal.x,this.normal.y).multiply(this.strokeWidth*this.toPressure(r)/2),this.offsetA.set(r.x,r.y).add(this.miter),this.offsetB.set(r.x,r.y).subtract(this.miter),this.addPathPoint(t,this.offsetB.x,this.offsetB.y,o);var a=this.toDegrees(this.offsetB,this.offsetA),c=a-180;this.cap(t,r,a,c,this.strokeWidth*this.toPressure(r)/2,2,o)}},{key:"addPathPoint",value:function addPathPoint(t,r,i,o){o?t.unshift(new re(r,i,1)):t.push(new re(r,i,1))}},{key:"intersect",value:function intersect(t,r,i){i?t[0].set(r.x,r.y):t[t.length-1].set(r.x,r.y)}},{key:"offset",value:function offset(t,r,i){i?t.subtract(r):t.add(r)}},{key:"toPressure",value:function toPressure(t){return Math.min(1,Math.sqrt(t.p+.1))}},{key:"toDegrees",value:function toDegrees(t,r){var i=Math.atan2(t.y-r.y,t.x-r.x);return 180*(2*Math.PI+i)/Math.PI}},{key:"intersectsRect",value:function intersectsRect(t,r){for(var i=0,o=t[i++],a=null;i<t.length;){if(a=t[i++],r.intersectsLine(o.x,o.y,a.x,a.y))return!0;o=a}return!1}}]),PenStroke}();function pen_shape_createSuper(t){var r=function pen_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ge=function(t){_inherits(PenShape,t);var r=pen_shape_createSuper(PenShape);function PenShape(t,i){var o;return _classCallCheck(this,PenShape),_defineProperty(_assertThisInitialized(o=r.call(this,t,i)),"stroke",void 0),o.stroke=new fe(i.width),o}return _createClass(PenShape,[{key:"addPoint",value:function addPoint(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return this.stroke.addPoint(t),this.updateBounds(),this.fireShapeEvent(new le(this,this.bounds)),!0}},{key:"contains",value:function contains(t){return this.stroke.intersects(new ue(t.x,t.y,t.x,t.y))}},{key:"intersects",value:function intersects(t){return this.stroke.intersects(t)}},{key:"getPenStroke",value:function getPenStroke(){return this.stroke}},{key:"moveByDelta",value:function moveByDelta(t){this.stroke.moveByDelta(t),this.updateBoundsByDelta(t),this.fireShapeEvent(new le(this,this.bounds))}},{key:"clone",value:function clone(){var t=new PenShape(this.handle,this.brush.clone());return t.stroke=this.stroke.clone(),t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected()),t}}]),PenShape}(pe);function pen_tool_createSuper(t){var r=function pen_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var me=function(t){_inherits(PenTool,t);var r=pen_tool_createSuper(PenTool);function PenTool(){var t;_classCallCheck(this,PenTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),t}return _createClass(PenTool,[{key:"begin",value:function begin(t,r){this.shape=new ge(this.shapeHandle,this.brush),this.shape.addPoint(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}},{key:"end",value:function end(t){}}]),PenTool}(ae);function pen_action_createSuper(t){var r=function pen_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ye=function(t){_inherits(PenAction,t);var r=pen_action_createSuper(PenAction);function PenAction(){return _classCallCheck(this,PenAction),r.apply(this,arguments)}return _createClass(PenAction,[{key:"execute",value:function execute(t){var r=new me;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setTool(r)}}]),PenAction}(oe);function brush_createSuper(t){var r=function brush_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ve=function(t){_inherits(Brush,t);var r=brush_createSuper(Brush);function Brush(t,i){var o;return _classCallCheck(this,Brush),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"width",void 0),o.width=i,o}return _createClass(Brush,[{key:"clone",value:function clone(){return new Brush(this.color,this.width)}}]),Brush}((function Paint(t){_classCallCheck(this,Paint),_defineProperty(this,"color",void 0),this.color=t})),_e=/\((\d+),\s*(\d+),\s*(\d+)(,\s*(\d*.\d*))?\)/,Ae=function(){function Color(t,r,i,o){_classCallCheck(this,Color),_defineProperty(this,"r",void 0),_defineProperty(this,"g",void 0),_defineProperty(this,"b",void 0),_defineProperty(this,"a",void 0),this.r=t,this.g=r,this.b=i,this.a=o||1}return _createClass(Color,[{key:"toHex",value:function toHex(){return"#"+this.r.toString(16)+this.g.toString(16)+this.b.toString(16)}},{key:"toRgb",value:function toRgb(){return"rgb(".concat(this.r,", ").concat(this.g,", ").concat(this.b,")")}},{key:"toRgba",value:function toRgba(){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(this.a,")")}},{key:"toAlpha",value:function toAlpha(t){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(t,")")}},{key:"equals",value:function equals(t){return this.a===t.a&&this.r===t.r&&this.g===t.g&&this.b===t.b}}],[{key:"fromHex",value:function fromHex(t){var r=t.trim();if(0!==r.indexOf("#"))throw new Error("Not a hex color representation");return r=r.substr(r.indexOf("#")+1),new Color(parseInt(r.substr(0,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(4,2),16))}},{key:"fromRGBString",value:function fromRGBString(t){var r=t.trim();if(0!==r.indexOf("rgb"))throw new Error("Not a rgb color representation");var i=_e.exec(r);return new Color(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),i[5]?parseFloat(i[5]):1)}},{key:"fromRGBNumber",value:function fromRGBNumber(t){return new Color(t>>16&255,t>>8&255,255&t,(t>>24&255)/255)}}]),Color}();function highlighter_tool_createSuper(t){var r=function highlighter_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var be=function(t){_inherits(HighlighterTool,t);var r=highlighter_tool_createSuper(HighlighterTool);function HighlighterTool(){var t;_classCallCheck(this,HighlighterTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),t}return _createClass(HighlighterTool,[{key:"begin",value:function begin(t,r){this.shape=new pe(this.shapeHandle,this.brush),this.shape.addPoint(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}}]),HighlighterTool}(ae);function highlighter_action_createSuper(t){var r=function highlighter_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Se=function(t){_inherits(HighlighterAction,t);var r=highlighter_action_createSuper(HighlighterAction);function HighlighterAction(){return _classCallCheck(this,HighlighterAction),r.apply(this,arguments)}return _createClass(HighlighterAction,[{key:"execute",value:function execute(t){var r=new be;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setTool(r)}}]),HighlighterAction}(oe);function pointer_shape_createSuper(t){var r=function pointer_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ce=function(t){_inherits(PointerShape,t);var r=pointer_shape_createSuper(PointerShape);function PointerShape(){return _classCallCheck(this,PointerShape),r.apply(this,arguments)}return _createClass(PointerShape,[{key:"addPoint",value:function addPoint(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return this.updateBounds(),this.fireShapeEvent(new le(this,this.bounds)),!0}},{key:"updateBounds",value:function updateBounds(){var t=this.points[0],r=this.brush.width;this.bounds.set(t.x-r,t.y-r,t.x+2*r,t.y+2*r)}}]),PointerShape}(pe);function pointer_tool_createSuper(t){var r=function pointer_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var we=function(t){_inherits(PointerTool,t);var r=pointer_tool_createSuper(PointerTool);function PointerTool(){var t;_classCallCheck(this,PointerTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"page",void 0),t}return _createClass(PointerTool,[{key:"begin",value:function begin(t,r){this.page=r.page,this.shape=new Ce(this.shapeHandle,this.brush),this.shape.addPoint(t),this.page.addShape(this.shape)}},{key:"execute",value:function execute(t){this.shape.addPoint(t)}},{key:"end",value:function end(t){this.page.removeShape(this.shape)}}]),PointerTool}(ae);function pointer_action_createSuper(t){var r=function pointer_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Pe=function(t){_inherits(PointerAction,t);var r=pointer_action_createSuper(PointerAction);function PointerAction(){return _classCallCheck(this,PointerAction),r.apply(this,arguments)}return _createClass(PointerAction,[{key:"execute",value:function execute(t){var r=new we;r.brush=this.brush,t.setTool(r)}}]),PointerAction}(oe);function form_shape_createSuper(t){var r=function form_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var xe=function(t){_inherits(FormShape,t);var r=form_shape_createSuper(FormShape);function FormShape(){return _classCallCheck(this,FormShape),r.apply(this,arguments)}return _createClass(FormShape,[{key:"setP0",value:function setP0(t){if(this.points.length>0){var r=this.points[0];if(t.equals(r))return!1;this.points[0]=t}else this.points.push(t);return!0}},{key:"setP1",value:function setP1(t){if(this.points.length>1){var r=this.points[1];if(t.equals(r))return!1;this.points[1]=t}else this.points.push(t);return this.updateBounds(),this.fireShapeEvent(new le(this,this.bounds)),!0}},{key:"updateBounds",value:function updateBounds(){if(!(this.points.length<2)){var t=this.points[0],r=this.points[1];r.x<t.x?(this.bounds.x=r.x,this.bounds.width=t.x-r.x):(this.bounds.x=t.x,this.bounds.width=r.x-t.x),r.y<t.y?(this.bounds.y=r.y,this.bounds.height=t.y-r.y):(this.bounds.y=t.y,this.bounds.height=r.y-t.y)}}},{key:"fill",value:function fill(){var t=this.getKeyEvent();return null!=t&&t.altKey}}]),FormShape}(pe);function arrow_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function arrow_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return arrow_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return arrow_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function arrow_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function arrow_shape_createSuper(t){var r=function arrow_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ke=function(t){_inherits(ArrowShape,t);var r=arrow_shape_createSuper(ArrowShape);function ArrowShape(){return _classCallCheck(this,ArrowShape),r.apply(this,arguments)}return _createClass(ArrowShape,[{key:"clone",value:function clone(){var t=new ArrowShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=arrow_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),ArrowShape}(xe);function arrow_tool_createSuper(t){var r=function arrow_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Te=function(t){_inherits(ArrowTool,t);var r=arrow_tool_createSuper(ArrowTool);function ArrowTool(){var t;_classCallCheck(this,ArrowTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(ArrowTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new ke(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),ArrowTool}(ae);function arrow_action_createSuper(t){var r=function arrow_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Re=function(t){_inherits(ArrowAction,t);var r=arrow_action_createSuper(ArrowAction);function ArrowAction(){return _classCallCheck(this,ArrowAction),r.apply(this,arguments)}return _createClass(ArrowAction,[{key:"execute",value:function execute(t){var r=new Te;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),ArrowAction}(oe);function line_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function line_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return line_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return line_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function line_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function line_shape_createSuper(t){var r=function line_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ee=function(t){_inherits(LineShape,t);var r=line_shape_createSuper(LineShape);function LineShape(){return _classCallCheck(this,LineShape),r.apply(this,arguments)}return _createClass(LineShape,[{key:"clone",value:function clone(){var t=new LineShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=line_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),LineShape}(xe);function line_tool_createSuper(t){var r=function line_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ie=function(t){_inherits(LineTool,t);var r=line_tool_createSuper(LineTool);function LineTool(){var t;_classCallCheck(this,LineTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(LineTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Ee(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),LineTool}(ae);function line_action_createSuper(t){var r=function line_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var De=function(t){_inherits(LineAction,t);var r=line_action_createSuper(LineAction);function LineAction(){return _classCallCheck(this,LineAction),r.apply(this,arguments)}return _createClass(LineAction,[{key:"execute",value:function execute(t){var r=new Ie;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),LineAction}(oe);function rectangle_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function rectangle_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return rectangle_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rectangle_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function rectangle_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function rectangle_shape_createSuper(t){var r=function rectangle_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Me=function(t){_inherits(RectangleShape,t);var r=rectangle_shape_createSuper(RectangleShape);function RectangleShape(){return _classCallCheck(this,RectangleShape),r.apply(this,arguments)}return _createClass(RectangleShape,[{key:"contains",value:function contains(t){if(this.points.length<2)return!1;if(this.fill())return this.bounds.containsPoint(t);var r=this.brush.width,i=this.bounds.x,o=this.bounds.y,a=this.bounds.x+this.bounds.width,c=this.bounds.y;return!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x+this.bounds.width,o=this.bounds.y,a=this.bounds.x+this.bounds.width,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x+this.bounds.width,o=this.bounds.y+this.bounds.height,a=this.bounds.x,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t)||(i=this.bounds.x,o=this.bounds.y,a=this.bounds.x,c=this.bounds.y+this.bounds.height,!!this.intersectsSegment(r,i,o,a,c,t))))}},{key:"intersects",value:function intersects(t){return null!=this.bounds.intersection(t)}},{key:"clone",value:function clone(){var t=new RectangleShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=rectangle_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}},{key:"intersectsSegment",value:function intersectsSegment(t,r,i,o,a,c){var l=c.x+t,u=c.y+t,d=c.x-t,h=c.y-t;return!!he.intersects(r,i,o,a,l,u,d,h)||(l=c.x-t,u=c.y+t,d=c.x+t,h=c.y-t,!!he.intersects(r,i,o,a,l,u,d,h))}}]),RectangleShape}(xe);function rectangle_tool_createSuper(t){var r=function rectangle_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Le=function(t){_inherits(RectangleTool,t);var r=rectangle_tool_createSuper(RectangleTool);function RectangleTool(){var t;_classCallCheck(this,RectangleTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(RectangleTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Me(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),RectangleTool}(ae);function rectangle_action_createSuper(t){var r=function rectangle_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Oe=function(t){_inherits(RectangleAction,t);var r=rectangle_action_createSuper(RectangleAction);function RectangleAction(){return _classCallCheck(this,RectangleAction),r.apply(this,arguments)}return _createClass(RectangleAction,[{key:"execute",value:function execute(t){var r=new Le;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),RectangleAction}(oe),Fe=function(){function Ellipse(t,r,i,o){_classCallCheck(this,Ellipse),_defineProperty(this,"x",void 0),_defineProperty(this,"y",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),_defineProperty(this,"radiusX",void 0),_defineProperty(this,"radiusY",void 0),_defineProperty(this,"centerX",void 0),_defineProperty(this,"centerY",void 0),this.x=t,this.y=r,this.width=i,this.height=o,this.radiusX=.5*i,this.radiusY=.5*o,this.centerX=t+this.radiusX,this.centerY=r+this.radiusY}return _createClass(Ellipse,[{key:"containsPoint",value:function containsPoint(t,r){var i=this.width;if(i<=0)return!1;var o=this.height;if(o<=0)return!1;var a=(t-this.x)/i-.5,c=(r-this.y)/o-.5;return a*a+c*c<.25}},{key:"containsRect",value:function containsRect(t,r,i,o){return this.containsPoint(t,r)&&this.containsPoint(t+i,r)&&this.containsPoint(t,r+o)&&this.containsPoint(t+i,r+o)}},{key:"intersectsRect",value:function intersectsRect(t,r,i,o){return!(i<=0||o<=0)&&(!(this.width<=0||this.height<=0)&&(this.centerX>=t&&this.centerY>=r&&this.centerX<=t+i&&this.centerY<=r+o||(this.intersectsLine(t,r,t+i,r)||this.intersectsLine(t,r+o,t+i,r+o)||this.intersectsLine(t,r,t,r+o)||this.intersectsLine(t+i,r,t+i,r+o))))}},{key:"intersectsLine",value:function intersectsLine(t,r,i,o){if(this.width<=0||this.height<=0)return!1;t-=this.centerX,i-=this.centerX,r-=this.centerY,o-=this.centerY;var a=this.radiusX*this.radiusX,c=this.radiusY*this.radiusY,l=Math.pow(i-t,2)/a+Math.pow(o-r,2)/c,u=2*t*(i-t)/a+2*r*(o-r)/c,d=u*u-4*l*(t*t/a+r*r/c-1);if(0===d){var h=-u/2/l;return h>=0&&h<=1}if(d>0){var p=Math.sqrt(d),g=(-u+p)/2/l,m=(-u-p)/2/l;return g>=0&&g<=1||m>=0&&m<=1}return!1}}]),Ellipse}();function ellipse_shape_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function ellipse_shape_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return ellipse_shape_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ellipse_shape_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function ellipse_shape_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function ellipse_shape_createSuper(t){var r=function ellipse_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ne=function(t){_inherits(EllipseShape,t);var r=ellipse_shape_createSuper(EllipseShape);function EllipseShape(){return _classCallCheck(this,EllipseShape),r.apply(this,arguments)}return _createClass(EllipseShape,[{key:"contains",value:function contains(t){if(this.points.length<2)return!1;var r=new Fe(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);return this.fill()?r.containsPoint(t.x,t.y):r.intersectsLine(t.x,t.y,t.x+this.brush.width,t.y+this.brush.width)}},{key:"intersects",value:function intersects(t){return!(this.points.length<2)&&new Fe(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height).intersectsRect(t.x,t.y,t.width,t.height)}},{key:"clone",value:function clone(){var t=new EllipseShape(this.handle,this.brush.clone());t.bounds.set(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.setKeyEvent(this.getKeyEvent()),t.setSelected(this.isSelected());var r,i=ellipse_shape_createForOfIteratorHelper(this.points);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.points.push(o.clone())}}catch(t){i.e(t)}finally{i.f()}return t}}]),EllipseShape}(xe);function ellipse_tool_createSuper(t){var r=function ellipse_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Be=function(t){_inherits(EllipseTool,t);var r=ellipse_tool_createSuper(EllipseTool);function EllipseTool(){var t;_classCallCheck(this,EllipseTool);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"shape",void 0),_defineProperty(_assertThisInitialized(t),"context",void 0),t}return _createClass(EllipseTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Ne(this.shapeHandle,this.brush),this.shape.setP0(t),r.page.addAction(new ce([this.shape]))}},{key:"execute",value:function execute(t){this.shape.setKeyEvent(this.context.keyEvent),this.shape.setP1(t)}}]),EllipseTool}(ae);function ellipse_action_createSuper(t){var r=function ellipse_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var je=function(t){_inherits(EllipseAction,t);var r=ellipse_action_createSuper(EllipseAction);function EllipseAction(){return _classCallCheck(this,EllipseAction),r.apply(this,arguments)}return _createClass(EllipseAction,[{key:"execute",value:function execute(t){var r=new Be;r.shapeHandle=this.shapeHandle,r.brush=this.brush,t.setKeyEvent(this.keyEvent),t.setTool(r)}}]),EllipseAction}(oe);function tool_action_createSuper(t){var r=function tool_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ve=function(t){_inherits(ToolAction,t);var r=tool_action_createSuper(ToolAction);function ToolAction(t){var i;return _classCallCheck(this,ToolAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"point",void 0),i.point=t,i}return ToolAction}(ie);function tool_begin_action_createSuper(t){var r=function tool_begin_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ue=function(t){_inherits(ToolBeginAction,t);var r=tool_begin_action_createSuper(ToolBeginAction);function ToolBeginAction(){return _classCallCheck(this,ToolBeginAction),r.apply(this,arguments)}return _createClass(ToolBeginAction,[{key:"execute",value:function execute(t){t.beginTool(this.point)}}]),ToolBeginAction}(Ve);function tool_execute_action_createSuper(t){var r=function tool_execute_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Je=function(t){_inherits(ToolExecuteAction,t);var r=tool_execute_action_createSuper(ToolExecuteAction);function ToolExecuteAction(){return _classCallCheck(this,ToolExecuteAction),r.apply(this,arguments)}return _createClass(ToolExecuteAction,[{key:"execute",value:function execute(t){t.executeTool(this.point)}}]),ToolExecuteAction}(Ve);function tool_end_action_createSuper(t){var r=function tool_end_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ze=function(t){_inherits(ToolEndAction,t);var r=tool_end_action_createSuper(ToolEndAction);function ToolEndAction(){return _classCallCheck(this,ToolEndAction),r.apply(this,arguments)}return _createClass(ToolEndAction,[{key:"execute",value:function execute(t){t.endTool(this.point)}}]),ToolEndAction}(Ve),He=function(){function AtomicTool(){_classCallCheck(this,AtomicTool)}return _createClass(AtomicTool,[{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),AtomicTool}();function undo_tool_createSuper(t){var r=function undo_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ge=function(t){_inherits(UndoTool,t);var r=undo_tool_createSuper(UndoTool);function UndoTool(){return _classCallCheck(this,UndoTool),r.apply(this,arguments)}return _createClass(UndoTool,[{key:"begin",value:function begin(t,r){r.page.undo()}}]),UndoTool}(He);function undo_action_createSuper(t){var r=function undo_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var qe=function(t){_inherits(UndoAction,t);var r=undo_action_createSuper(UndoAction);function UndoAction(){return _classCallCheck(this,UndoAction),r.apply(this,arguments)}return _createClass(UndoAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Ge)}}]),UndoAction}(ie);function redo_tool_createSuper(t){var r=function redo_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var We=function(t){_inherits(RedoTool,t);var r=redo_tool_createSuper(RedoTool);function RedoTool(){return _classCallCheck(this,RedoTool),r.apply(this,arguments)}return _createClass(RedoTool,[{key:"begin",value:function begin(t,r){r.page.redo()}}]),RedoTool}(He);function redo_action_createSuper(t){var r=function redo_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Qe=function(t){_inherits(RedoAction,t);var r=redo_action_createSuper(RedoAction);function RedoAction(){return _classCallCheck(this,RedoAction),r.apply(this,arguments)}return _createClass(RedoAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new We)}}]),RedoAction}(ie);function remove_shape_action_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function remove_shape_action_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return remove_shape_action_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return remove_shape_action_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function remove_shape_action_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function remove_shape_action_createSuper(t){var r=function remove_shape_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ye=function(t){_inherits(RemoveShapeAction,t);var r=remove_shape_action_createSuper(RemoveShapeAction);function RemoveShapeAction(t){return _classCallCheck(this,RemoveShapeAction),r.call(this,t)}return _createClass(RemoveShapeAction,[{key:"execute",value:function execute(t){var r,i=remove_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.removeShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"undo",value:function undo(t){var r,i=remove_shape_action_createForOfIteratorHelper(this.shapes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.addShape(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"redo",value:function redo(t){this.execute(t)}}]),RemoveShapeAction}(se);function clear_shapes_tool_createSuper(t){var r=function clear_shapes_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Xe=function(t){_inherits(ClearShapesTool,t);var r=clear_shapes_tool_createSuper(ClearShapesTool);function ClearShapesTool(){return _classCallCheck(this,ClearShapesTool),r.apply(this,arguments)}return _createClass(ClearShapesTool,[{key:"begin",value:function begin(t,r){var i=Object.assign([],r.page.getShapes());r.page.addAction(new Ye(i))}}]),ClearShapesTool}(He);function clear_shapes_action_createSuper(t){var r=function clear_shapes_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var $e=function(t){_inherits(ClearShapesAction,t);var r=clear_shapes_action_createSuper(ClearShapesAction);function ClearShapesAction(){return _classCallCheck(this,ClearShapesAction),r.apply(this,arguments)}return _createClass(ClearShapesAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Xe)}}]),ClearShapesAction}(ie);function key_action_createSuper(t){var r=function key_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ke=function(t){_inherits(KeyAction,t);var r=key_action_createSuper(KeyAction);function KeyAction(){return _classCallCheck(this,KeyAction),r.apply(this,arguments)}return _createClass(KeyAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent)}}]),KeyAction}(ie);function clone_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function clone_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return clone_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return clone_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function clone_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Ze=function(){function CloneTool(){_classCallCheck(this,CloneTool),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"selectedShapes",void 0)}return _createClass(CloneTool,[{key:"begin",value:function begin(t,r){if(this.sourcePoint=t.clone(),this.context=r,this.getSelectedShapes(),this.hasSelectedShapes())if(this.hitSelected(t)){var i,o=new Array,a=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(a.s();!(i=a.n()).done;){var c=i.value.clone();o.push(c)}}catch(t){a.e(t)}finally{a.f()}r.page.addAction(new ce(o))}else this.removeSelection();else{var l=this.getTopLevelShape(t);if(null!=l){var u=l.clone();r.page.addAction(new ce([u])),this.addSelection(u)}}}},{key:"execute",value:function execute(t){this.sourcePoint.subtract(t),this.moveShapes(t,this.sourcePoint),this.sourcePoint=t.clone()}},{key:"end",value:function end(t){}},{key:"getTopLevelShape",value:function getTopLevelShape(t){var r,i=null,o=clone_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(o.s();!(r=o.n()).done;){var a=r.value;a.contains(t)&&(i=a)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"getSelectedShapes",value:function getSelectedShapes(){this.selectedShapes=new Array;var t,r=clone_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&this.selectedShapes.push(i)}}catch(t){r.e(t)}finally{r.f()}}},{key:"moveShapes",value:function moveShapes(t,r){if(this.hasSelectedShapes()){this.context.beginBulkRender();var i,o=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(o.s();!(i=o.n()).done;){i.value.moveByDelta(r)}}catch(t){o.e(t)}finally{o.f()}this.context.endBulkRender()}}},{key:"hasSelectedShapes",value:function hasSelectedShapes(){return 0!=this.selectedShapes.length}},{key:"addSelection",value:function addSelection(t){t.setSelected(!0),this.selectedShapes.push(t)}},{key:"removeSelection",value:function removeSelection(){this.context.beginBulkRender();var t,r=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(r.s();!(t=r.n()).done;){t.value.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.selectedShapes.length=0,this.context.endBulkRender()}},{key:"hitSelected",value:function hitSelected(t){var r,i=clone_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){if(r.value.contains(t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}}]),CloneTool}();function clone_action_createSuper(t){var r=function clone_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var et=function(t){_inherits(CloneAction,t);var r=clone_action_createSuper(CloneAction);function CloneAction(){return _classCallCheck(this,CloneAction),r.apply(this,arguments)}return _createClass(CloneAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Ze)}}]),CloneAction}(ie);function select_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function select_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return select_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return select_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function select_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var tt=function(){function SelectTool(){_classCallCheck(this,SelectTool),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"selectedShape",void 0)}return _createClass(SelectTool,[{key:"begin",value:function begin(t,r){this.sourcePoint=t.clone(),this.context=r,this.selectedShape=this.getTopLevelShape(t),this.removeSelection(),null!=this.selectedShape&&this.selectedShape.setSelected(!0)}},{key:"execute",value:function execute(t){null!=this.selectedShape&&(this.sourcePoint.subtract(t),this.context.beginBulkRender(),this.selectedShape.moveByDelta(this.sourcePoint),this.context.endBulkRender(),this.sourcePoint=t.clone())}},{key:"end",value:function end(t){null!=this.selectedShape&&(this.context.beginBulkRender(),this.selectedShape.setSelected(!1),this.context.endBulkRender())}},{key:"getTopLevelShape",value:function getTopLevelShape(t){var r,i=null,o=select_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(o.s();!(r=o.n()).done;){var a=r.value;a.contains(t)&&(i=a)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"removeSelection",value:function removeSelection(){this.context.beginBulkRender();var t,r=select_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&i.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.context.endBulkRender()}}]),SelectTool}();function select_action_createSuper(t){var r=function select_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var nt=function(t){_inherits(SelectAction,t);var r=select_action_createSuper(SelectAction);function SelectAction(){return _classCallCheck(this,SelectAction),r.apply(this,arguments)}return _createClass(SelectAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new tt)}}]),SelectAction}(ie);function select_shape_createSuper(t){var r=function select_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var rt,it=function(t){_inherits(SelectShape,t);var r=select_shape_createSuper(SelectShape);function SelectShape(){return _classCallCheck(this,SelectShape),r.call(this,0,null)}return SelectShape}(xe);function select_group_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function select_group_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return select_group_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return select_group_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function select_group_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}!function(t){t[t.Select=0]="Select",t[t.Move=1]="Move"}(rt||(rt={}));var ot=function(){function SelectGroupTool(){_classCallCheck(this,SelectGroupTool),_defineProperty(this,"mode",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"selectedShapes",void 0),_defineProperty(this,"sourcePoint",void 0),_defineProperty(this,"initialized",void 0)}return _createClass(SelectGroupTool,[{key:"begin",value:function begin(t,r){this.sourcePoint=t.clone(),this.context=r,this.initialized=!1,this.shape=new it,this.context.page.addShape(this.shape),this.getSelectedShapes(),this.hasSelectedShapes()?this.hitSelected(t)?this.mode=rt.Move:(this.context.beginBulkRender(),this.removeSelection(),this.context.endBulkRender(),this.mode=rt.Select):this.mode=rt.Select}},{key:"execute",value:function execute(t){this.mode==rt.Select?(this.initialized||(this.shape.setP0(t),this.initialized=!0),this.shape.addPoint(t.clone()),this.shape.setP1(t),this.selectGroup(this.shape.bounds)):this.mode==rt.Move&&(this.sourcePoint.subtract(t),this.moveShapes(this.sourcePoint),this.sourcePoint=t.clone())}},{key:"end",value:function end(t){this.context.page.removeShape(this.shape),this.initialized=!1}},{key:"selectGroup",value:function selectGroup(t){this.context.beginBulkRender(),this.removeSelection();var r,i=select_group_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(i.s();!(r=i.n()).done;){var o=r.value;o!==this.shape&&(o.intersects(t)&&this.addSelection(o))}}catch(t){i.e(t)}finally{i.f()}this.context.endBulkRender()}},{key:"addSelection",value:function addSelection(t){t.setSelected(!0),this.selectedShapes.push(t)}},{key:"getSelectedShapes",value:function getSelectedShapes(){this.selectedShapes=new Array;var t,r=select_group_tool_createForOfIteratorHelper(this.context.page.getShapes());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.isSelected()&&this.selectedShapes.push(i)}}catch(t){r.e(t)}finally{r.f()}}},{key:"hasSelectedShapes",value:function hasSelectedShapes(){return 0!=this.selectedShapes.length}},{key:"hitSelected",value:function hitSelected(t){var r,i=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){if(r.value.contains(t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}},{key:"removeSelection",value:function removeSelection(){var t,r=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(r.s();!(t=r.n()).done;){t.value.setSelected(!1)}}catch(t){r.e(t)}finally{r.f()}this.selectedShapes.length=0}},{key:"moveShapes",value:function moveShapes(t){if(this.hasSelectedShapes()){this.context.beginBulkRender();var r,i=select_group_tool_createForOfIteratorHelper(this.selectedShapes);try{for(i.s();!(r=i.n()).done;){r.value.moveByDelta(t)}}catch(t){i.e(t)}finally{i.f()}this.context.endBulkRender()}}}]),SelectGroupTool}();function select_group_action_createSuper(t){var r=function select_group_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var at=function(t){_inherits(SelectGroupAction,t);var r=select_group_action_createSuper(SelectGroupAction);function SelectGroupAction(){return _classCallCheck(this,SelectGroupAction),r.apply(this,arguments)}return _createClass(SelectGroupAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new ot)}}]),SelectGroupAction}(ie),st=function(){function PanTool(){_classCallCheck(this,PanTool),_defineProperty(this,"context",void 0),_defineProperty(this,"lastPoint",void 0)}return _createClass(PanTool,[{key:"begin",value:function begin(t,r){this.context=r,this.lastPoint=t}},{key:"execute",value:function execute(t){var r=this.context.page.getSlideShape(),i=r.bounds,o=i.x+(this.lastPoint.x-t.x),a=i.y+(this.lastPoint.y-t.y);r.setPageRect(new ue(o,a,i.width,i.height)),this.lastPoint=t}},{key:"end",value:function end(t){}}]),PanTool}();function pan_action_createSuper(t){var r=function pan_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ct=function(t){_inherits(PanAction,t);var r=pan_action_createSuper(PanAction);function PanAction(){return _classCallCheck(this,PanAction),r.apply(this,arguments)}return _createClass(PanAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new st)}}]),PanAction}(ie);function extend_view_tool_createSuper(t){var r=function extend_view_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var lt=function(t){_inherits(ExtendViewTool,t);var r=extend_view_tool_createSuper(ExtendViewTool);function ExtendViewTool(t){var i;return _classCallCheck(this,ExtendViewTool),_defineProperty(_assertThisInitialized(i=r.call(this)),"rect",void 0),i.rect=t,i}return _createClass(ExtendViewTool,[{key:"begin",value:function begin(t,r){r.page.getSlideShape().setPageRect(this.rect)}}]),ExtendViewTool}(He);function extend_view_action_createSuper(t){var r=function extend_view_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ut=function(t){_inherits(ExtendViewAction,t);var r=extend_view_action_createSuper(ExtendViewAction);function ExtendViewAction(t){var i;return _classCallCheck(this,ExtendViewAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"rect",void 0),i.rect=t,i}return _createClass(ExtendViewAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.selectAndExecuteTool(new lt(this.rect))}}]),ExtendViewAction}(ie);function zoom_shape_createSuper(t){var r=function zoom_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var dt=function(t){_inherits(ZoomShape,t);var r=zoom_shape_createSuper(ZoomShape);function ZoomShape(){return _classCallCheck(this,ZoomShape),r.call(this,0,null)}return _createClass(ZoomShape,[{key:"updateBounds",value:function updateBounds(){_get(_getPrototypeOf(ZoomShape.prototype),"updateBounds",this).call(this);var t=this.bounds.width,r=Math.abs(3*t/4)*Math.sign(this.bounds.height);this.bounds.height=r}}]),ZoomShape}(xe),ht=function(){function ZoomTool(){_classCallCheck(this,ZoomTool),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),_defineProperty(this,"initialized",void 0)}return _createClass(ZoomTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new dt,this.context.page.addShape(this.shape)}},{key:"execute",value:function execute(t){this.initialized||(this.shape.setP0(t),this.initialized=!0),this.shape.setP1(t)}},{key:"end",value:function end(t){this.initialized=!1,this.context.page.removeShape(this.shape),this.context.page.getSlideShape().setPageRect(this.shape.bounds)}}]),ZoomTool}();function zoom_action_createSuper(t){var r=function zoom_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pt=function(t){_inherits(ZoomAction,t);var r=zoom_action_createSuper(ZoomAction);function ZoomAction(t,i){return _classCallCheck(this,ZoomAction),r.call(this,0,i)}return _createClass(ZoomAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new ht)}}]),ZoomAction}(oe);function zoom_out_tool_createSuper(t){var r=function zoom_out_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var ft=function(t){_inherits(ZoomOutTool,t);var r=zoom_out_tool_createSuper(ZoomOutTool);function ZoomOutTool(){return _classCallCheck(this,ZoomOutTool),r.apply(this,arguments)}return _createClass(ZoomOutTool,[{key:"begin",value:function begin(t,r){r.page.getSlideShape().setPageRect(new ue(0,0,1,1))}}]),ZoomOutTool}(He);function zoom_out_action_createSuper(t){var r=function zoom_out_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var gt=function(t){_inherits(ZoomOutAction,t);var r=zoom_out_action_createSuper(ZoomOutAction);function ZoomOutAction(){return _classCallCheck(this,ZoomOutAction),r.apply(this,arguments)}return _createClass(ZoomOutAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.selectAndExecuteTool(new ft)}}]),ZoomOutAction}(ie);function delete_shape_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function delete_shape_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return delete_shape_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return delete_shape_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function delete_shape_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var mt=function(){function DeleteShapeTool(t){_classCallCheck(this,DeleteShapeTool),_defineProperty(this,"shapeHandle",void 0),this.shapeHandle=t}return _createClass(DeleteShapeTool,[{key:"begin",value:function begin(t,r){var i,o=delete_shape_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.handle===this.shapeHandle){r.page.addAction(new Ye(new Array(a)));break}}}catch(t){o.e(t)}finally{o.f()}}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),DeleteShapeTool}();function rubber_action_createSuper(t){var r=function rubber_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var yt=function(t){_inherits(RubberAction,t);var r=rubber_action_createSuper(RubberAction);function RubberAction(t){var i;return _classCallCheck(this,RubberAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"shapeHandle",void 0),i.shapeHandle=t,i}return _createClass(RubberAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new mt(this.shapeHandle)),t.beginTool(new re(0,0,0))}}]),RubberAction}(ie);function typesetting_shape_createSuper(t){var r=function typesetting_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var vt=function(t){_inherits(TypesettingShape,t);var r=typesetting_shape_createSuper(TypesettingShape);function TypesettingShape(){var t;_classCallCheck(this,TypesettingShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"textAttributes",void 0),_defineProperty(_assertThisInitialized(t),"textColor",void 0),_defineProperty(_assertThisInitialized(t),"text",void 0),t}return _createClass(TypesettingShape,[{key:"setText",value:function setText(t){this.text!==t&&(this.text=t,this.fireShapeEvent(new le(this,this.bounds)))}},{key:"getText",value:function getText(){return this.text}},{key:"setTextColor",value:function setTextColor(t){this.textColor&&this.textColor.equals(t)||(this.textColor=t,this.fireShapeEvent(new le(this,this.bounds)))}},{key:"getTextColor",value:function getTextColor(){return this.textColor}},{key:"setTextAttributes",value:function setTextAttributes(t){this.textAttributes=new Map(t),this.fireShapeEvent(new le(this,this.bounds))}},{key:"getTextAttributes",value:function getTextAttributes(){return this.textAttributes}},{key:"isUnderline",value:function isUnderline(){return this.textAttributes.get("underline")}},{key:"isStrikethrough",value:function isStrikethrough(){return this.textAttributes.get("strikethrough")}},{key:"setLocation",value:function setLocation(t){return(this.bounds.x!==t.x||this.bounds.y!==t.y)&&(this.bounds.x=t.x,this.bounds.y=t.y,this.fireShapeEvent(new le(this,this.bounds)),!0)}},{key:"updateBounds",value:function updateBounds(){}}]),TypesettingShape}(de);function text_shape_createSuper(t){var r=function text_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var _t=function(t){_inherits(TextShape,t);var r=text_shape_createSuper(TextShape);function TextShape(){var t;_classCallCheck(this,TextShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"font",void 0),t}return _createClass(TextShape,[{key:"setFont",value:function setFont(t){this.font&&this.font.equals(t)||(this.font=t,this.fireShapeEvent(new le(this,this.bounds)))}},{key:"getFont",value:function getFont(){return this.font}},{key:"clone",value:function clone(){var t=new TextShape(this.handle);return t.setLocation(new a(this.bounds.x,this.bounds.y)),t.setFont(this.font),t.setTextColor(this.getTextColor()),t.setTextAttributes(new Map(this.getTextAttributes())),t}}]),TextShape}(vt),At=function(){function TextTool(t){_classCallCheck(this,TextTool),_defineProperty(this,"handle",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),this.handle=t}return _createClass(TextTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new _t(this.handle)}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){this.shape.setLocation(t),this.context.page.addShape(this.shape)}}]),TextTool}();function text_action_createSuper(t){var r=function text_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var bt=function(t){_inherits(TextAction,t);var r=text_action_createSuper(TextAction);function TextAction(t){var i;return _classCallCheck(this,TextAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new At(this.handle))}}]),TextAction}(ie);function text_font_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_font_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_font_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_font_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_font_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_font_tool_createSuper(t){var r=function text_font_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var St=function(t){_inherits(TextFontTool,t);var r=text_font_tool_createSuper(TextFontTool);function TextFontTool(t,i,o,a){var c;return _classCallCheck(this,TextFontTool),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(TextFontTool,[{key:"begin",value:function begin(t,r){var i,o=text_font_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof _t&&a.handle===this.handle){a.setFont(this.font),a.setTextColor(this.textColor),a.setTextAttributes(this.textAttributes);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextFontTool}(He);function text_font_action_createSuper(t){var r=function text_font_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ct=function(t){_inherits(TextFontAction,t);var r=text_font_action_createSuper(TextFontAction);function TextFontAction(t,i,o,a){var c;return _classCallCheck(this,TextFontAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(TextFontAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new St(this.handle,this.font,this.textColor,this.textAttributes))}}]),TextFontAction}(ie);function text_change_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_change_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_change_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_change_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_change_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_change_tool_createSuper(t){var r=function text_change_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var wt=function(t){_inherits(TextChangeTool,t);var r=text_change_tool_createSuper(TextChangeTool);function TextChangeTool(t,i){var o;return _classCallCheck(this,TextChangeTool),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"text",void 0),o.handle=t,o.text=i,o}return _createClass(TextChangeTool,[{key:"begin",value:function begin(t,r){var i,o=text_change_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof vt&&a.handle===this.handle){a.setText(this.text);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextChangeTool}(He);function text_change_action_createSuper(t){var r=function text_change_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Pt=function(t){_inherits(TextChangeAction,t);var r=text_change_action_createSuper(TextChangeAction);function TextChangeAction(t,i){var o;return _classCallCheck(this,TextChangeAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"text",void 0),o.handle=t,o.text=i,o}return _createClass(TextChangeAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new wt(this.handle,this.text))}}]),TextChangeAction}(ie);function text_move_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_move_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_move_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_move_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_move_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_move_tool_createSuper(t){var r=function text_move_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var xt=function(t){_inherits(TextMoveTool,t);var r=text_move_tool_createSuper(TextMoveTool);function TextMoveTool(t,i){var o;return _classCallCheck(this,TextMoveTool),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"point",void 0),o.handle=t,o.point=i,o}return _createClass(TextMoveTool,[{key:"begin",value:function begin(t,r){var i,o=text_move_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof vt&&a.handle===this.handle){r.beginBulkRender(),a.setLocation(this.point),r.endBulkRender();break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextMoveTool}(He);function text_move_action_createSuper(t){var r=function text_move_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var kt=function(t){_inherits(TextMoveAction,t);var r=text_move_action_createSuper(TextMoveAction);function TextMoveAction(t,i){var o;return _classCallCheck(this,TextMoveAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(o),"point",void 0),o.handle=t,o.point=i,o}return _createClass(TextMoveAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new xt(this.handle,this.point))}}]),TextMoveAction}(ie);function text_remove_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_remove_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_remove_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_remove_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_remove_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function text_remove_tool_createSuper(t){var r=function text_remove_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Tt=function(t){_inherits(TextRemoveTool,t);var r=text_remove_tool_createSuper(TextRemoveTool);function TextRemoveTool(t){var i;return _classCallCheck(this,TextRemoveTool),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextRemoveTool,[{key:"begin",value:function begin(t,r){var i,o=text_remove_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof vt&&a.handle===this.handle){r.page.removeShape(a);break}}}catch(t){o.e(t)}finally{o.f()}}}]),TextRemoveTool}(He);function text_remove_action_createSuper(t){var r=function text_remove_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Rt=function(t){_inherits(TextRemoveAction,t);var r=text_remove_action_createSuper(TextRemoveAction);function TextRemoveAction(t){var i;return _classCallCheck(this,TextRemoveAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(TextRemoveAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Tt(this.handle))}}]),TextRemoveAction}(ie),Et=function(){function Font(t,r,i,o){_classCallCheck(this,Font),_defineProperty(this,"family",void 0),_defineProperty(this,"size",void 0),_defineProperty(this,"style",void 0),_defineProperty(this,"weight",void 0),this.family=t,this.size=r,this.style=i,this.weight=o}return _createClass(Font,[{key:"equals",value:function equals(t){return!!t&&(this===t||this.family===t.family&&this.size===t.size&&this.style===t.style&&this.weight===t.weight)}},{key:"toString",value:function toString(){var t=this.size+"px "+this.family;return this.weight&&(t=this.weight+" "+t),this.style&&(t=this.style+" "+t),t}}]),Font}();function text_highlight_shape_createSuper(t){var r=function text_highlight_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var It=function(t){_inherits(TextHighlightShape,t);var r=text_highlight_shape_createSuper(TextHighlightShape);function TextHighlightShape(t,i){var o;return _classCallCheck(this,TextHighlightShape),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"color",void 0),o.color=i,o}return _createClass(TextHighlightShape,[{key:"addTextBounds",value:function addTextBounds(t){this.bounds.isEmpty()?this.bounds.set(t.x,t.y,t.width,t.height):this.bounds.union(t),this.fireShapeEvent(new le(this,this.bounds))}},{key:"getColor",value:function getColor(){return this.color}},{key:"contains",value:function contains(t){return this.bounds.containsPoint(t)}},{key:"intersects",value:function intersects(t){return null!=this.bounds.intersection(t)}},{key:"clone",value:function clone(){var t=new TextHighlightShape(this.handle,this.color);return t.setKeyEvent(this.getKeyEvent()),t}},{key:"updateBounds",value:function updateBounds(){}}]),TextHighlightShape}(de);function text_highlight_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function text_highlight_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return text_highlight_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return text_highlight_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function text_highlight_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Dt=function(){function TextHighlightTool(t,r,i){_classCallCheck(this,TextHighlightTool),_defineProperty(this,"shapeHandle",void 0),_defineProperty(this,"color",void 0),_defineProperty(this,"textBounds",void 0),this.shapeHandle=t,this.color=r,this.textBounds=i}return _createClass(TextHighlightTool,[{key:"begin",value:function begin(t,r){if(!(this.textBounds.length<1)){var i,o=null,a=text_highlight_tool_createForOfIteratorHelper(r.page.getShapes());try{for(a.s();!(i=a.n()).done;){var c=i.value;if(c.handle===this.shapeHandle){o=c;break}}}catch(t){a.e(t)}finally{a.f()}o||(o=new It(this.shapeHandle,this.color),r.page.addAction(new ce([o])));var l,u=text_highlight_tool_createForOfIteratorHelper(this.textBounds);try{for(u.s();!(l=u.n()).done;){var d=l.value;o.addTextBounds(d)}}catch(t){u.e(t)}finally{u.f()}}}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){}}]),TextHighlightTool}();function text_highlight_action_createSuper(t){var r=function text_highlight_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Mt=function(t){_inherits(TextHighlightAction,t);var r=text_highlight_action_createSuper(TextHighlightAction);function TextHighlightAction(t,i,o){var a;return _classCallCheck(this,TextHighlightAction),_defineProperty(_assertThisInitialized(a=r.call(this)),"shapeHandle",void 0),_defineProperty(_assertThisInitialized(a),"color",void 0),_defineProperty(_assertThisInitialized(a),"textBounds",void 0),a.shapeHandle=t,a.color=i,a.textBounds=o,a}return _createClass(TextHighlightAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Dt(this.shapeHandle,this.color,this.textBounds)),t.beginTool(new re(0,0,0))}}]),TextHighlightAction}(ie);function latex_shape_createSuper(t){var r=function latex_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Lt=function(t){_inherits(LatexShape,t);var r=latex_shape_createSuper(LatexShape);function LatexShape(){var t;_classCallCheck(this,LatexShape);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _defineProperty(_assertThisInitialized(t=r.call.apply(r,[this].concat(o))),"font",void 0),t}return _createClass(LatexShape,[{key:"setFont",value:function setFont(t){this.font&&this.font.equals(t)||(this.font=t,this.fireShapeEvent(new le(this,this.bounds)))}},{key:"getFont",value:function getFont(){return this.font}},{key:"clone",value:function clone(){var t=new LatexShape(this.handle);return t.setLocation(new a(this.bounds.x,this.bounds.y)),t.setFont(this.font),t.setTextColor(this.getTextColor()),t.setTextAttributes(new Map(this.getTextAttributes())),t}}]),LatexShape}(vt),Ot=function(){function LatexTool(t){_classCallCheck(this,LatexTool),_defineProperty(this,"handle",void 0),_defineProperty(this,"shape",void 0),_defineProperty(this,"context",void 0),this.handle=t}return _createClass(LatexTool,[{key:"begin",value:function begin(t,r){this.context=r,this.shape=new Lt(this.handle)}},{key:"execute",value:function execute(t){}},{key:"end",value:function end(t){this.shape.setLocation(t),this.context.page.addShape(this.shape)}}]),LatexTool}();function latex_action_createSuper(t){var r=function latex_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Ft=function(t){_inherits(LatexAction,t);var r=latex_action_createSuper(LatexAction);function LatexAction(t){var i;return _classCallCheck(this,LatexAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"handle",void 0),i.handle=t,i}return _createClass(LatexAction,[{key:"execute",value:function execute(t){t.setKeyEvent(this.keyEvent),t.setTool(new Ot(this.handle))}}]),LatexAction}(ie);function latex_font_tool_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function latex_font_tool_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return latex_font_tool_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return latex_font_tool_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function latex_font_tool_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function latex_font_tool_createSuper(t){var r=function latex_font_tool_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Nt=function(t){_inherits(LatexFontTool,t);var r=latex_font_tool_createSuper(LatexFontTool);function LatexFontTool(t,i,o,a){var c;return _classCallCheck(this,LatexFontTool),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(LatexFontTool,[{key:"begin",value:function begin(t,r){var i,o=latex_font_tool_createForOfIteratorHelper(r.page.getShapes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a instanceof Lt&&a.handle===this.handle){a.setFont(this.font),a.setTextColor(this.textColor),a.setTextAttributes(this.textAttributes);break}}}catch(t){o.e(t)}finally{o.f()}}}]),LatexFontTool}(He);function latex_font_action_createSuper(t){var r=function latex_font_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Bt=function(t){_inherits(LatexFontAction,t);var r=latex_font_action_createSuper(LatexFontAction);function LatexFontAction(t,i,o,a){var c;return _classCallCheck(this,LatexFontAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"handle",void 0),_defineProperty(_assertThisInitialized(c),"font",void 0),_defineProperty(_assertThisInitialized(c),"textColor",void 0),_defineProperty(_assertThisInitialized(c),"textAttributes",void 0),c.handle=t,c.font=i,c.textColor=o,c.textAttributes=a,c}return _createClass(LatexFontAction,[{key:"execute",value:function execute(t){t.selectAndExecuteTool(new Nt(this.handle,this.font,this.textColor,this.textAttributes))}}]),LatexFontAction}(ie),jt=function(){function ActionParser(){_classCallCheck(this,ActionParser)}return _createClass(ActionParser,null,[{key:"parse",value:function parse(t,r,i){var o=null,a=this.parseActionHeader(t);switch(i-=13,r){case ee.CLEAR_SHAPES:o=this.atomicAction(t,$e);break;case ee.UNDO:o=this.atomicAction(t,qe);break;case ee.REDO:o=this.atomicAction(t,Qe);break;case ee.KEY:o=this.atomicAction(t,Ke);break;case ee.PEN:o=this.toolBrushAction(t,ye);break;case ee.HIGHLIGHTER:o=this.toolBrushAction(t,Se);break;case ee.POINTER:o=this.toolBrushAction(t,Pe);break;case ee.ARROW:o=this.toolBrushAction(t,Re);break;case ee.LINE:o=this.toolBrushAction(t,De);break;case ee.RECTANGLE:o=this.toolBrushAction(t,Oe);break;case ee.ELLIPSE:o=this.toolBrushAction(t,je);break;case ee.CLONE:o=this.atomicAction(t,et);break;case ee.SELECT:o=this.atomicAction(t,nt);break;case ee.SELECT_GROUP:o=this.atomicAction(t,at);break;case ee.LATEX:o=this.textAction(t,Ft);break;case ee.LATEX_FONT_CHANGE:o=this.latexFontAction(t);break;case ee.TEXT:o=this.textAction(t,bt);break;case ee.TEXT_CHANGE:o=this.textChangeAction(t);break;case ee.TEXT_FONT_CHANGE:o=this.textFontAction(t);break;case ee.TEXT_LOCATION_CHANGE:o=this.textMoveAction(t);break;case ee.TEXT_REMOVE:o=this.textRemoveAction(t);break;case ee.TEXT_SELECTION_EXT:o=this.textHighlightAction(t);break;case ee.TOOL_BEGIN:o=this.toolDragAction(t,Ue);break;case ee.TOOL_EXECUTE:o=this.toolDragAction(t,Je);break;case ee.TOOL_END:o=this.toolDragAction(t,ze);break;case ee.PANNING:o=this.atomicAction(t,ct);break;case ee.EXTEND_VIEW:o=this.extendViewAction(t);break;case ee.ZOOM:o=i<1?this.atomicAction(t,pt):this.toolBrushAction(t,pt);break;case ee.ZOOM_OUT:o=this.atomicAction(t,gt);break;case ee.RUBBER_EXT:o=this.rubberAction(t)}return o&&(o.keyEvent=a),o}},{key:"parseActionHeader",value:function parseActionHeader(t){var r=null;return(t.getInt32()&this.KEY_EVENT_MASK)==this.KEY_EVENT_MASK&&(r=this.parseKeyEvent(t)),r}},{key:"parseKeyEvent",value:function parseKeyEvent(t){t.getInt32();var r,i=t.getInt32();switch(t.getInt8()){case 0:r="keydown";break;case 1:r="keyup";break;case 2:r="keypress";break;default:throw new Error("Unknown key event type")}return new KeyboardEvent(r,{shiftKey:0!=(2&i),ctrlKey:0!=(4&i),altKey:0!=(8&i)})}},{key:"atomicAction",value:function atomicAction(t,r){return new r}},{key:"toolBrushAction",value:function toolBrushAction(t,r){var i=t.getInt32(),o=t.getInt32(),a=(t.getInt8(),t.getFloat64()),c=Ae.fromRGBNumber(o);return new r(i,new ve(c,a))}},{key:"rubberAction",value:function rubberAction(t){var r=t.getInt32();return new yt(r)}},{key:"toolDragAction",value:function toolDragAction(t,r){return new r(new re(t.getFloat32(),t.getFloat32(),t.getFloat32()))}},{key:"extendViewAction",value:function extendViewAction(t){var r=t.getFloat64(),i=t.getFloat64(),o=t.getFloat64(),a=t.getFloat64();return new ut(new ue(r,i,o,a))}},{key:"textAction",value:function textAction(t,r){return new r(t.getInt32())}},{key:"textChangeAction",value:function textChangeAction(t){var r=t.getInt32(),i=t.getInt32(),o=t.getString(i);return new Pt(r,o)}},{key:"textMoveAction",value:function textMoveAction(t){var r=t.getInt32(),i=new a(t.getFloat64(),t.getFloat64());return new kt(r,i)}},{key:"textRemoveAction",value:function textRemoveAction(t){var r=t.getInt32();return new Rt(r)}},{key:"textHighlightAction",value:function textHighlightAction(t){for(var r=t.getInt32(),i=t.getInt32(),o=t.getInt32(),a=Ae.fromRGBNumber(i),c=new Array,l=0;l<o;l++){var u=t.getFloat64(),d=t.getFloat64(),h=t.getFloat64(),p=t.getFloat64();c.push(new ue(u,d,h,p))}return new Mt(r,a,c)}},{key:"textFontAction",value:function textFontAction(t){var r,i=t.getInt32(),o=t.getInt32(),a=t.getInt32(),c=t.getString(a),l=t.getFloat64(),u=t.getInt8(),d=t.getInt8(),h=t.getInt8()>0,p=t.getInt8()>0,g=100*(d+1);switch(u){case 0:r="normal";break;case 1:r="italic";break;default:console.error("Unsupported font style")}var m=Ae.fromRGBNumber(o),y=new Et(c,l,r,g.toString()),v=new Map;return v.set("strikethrough",h),v.set("underline",p),new Ct(i,y,m,v)}},{key:"latexFontAction",value:function latexFontAction(t){var r=t.getInt32(),i=(t.getInt32(),t.getFloat32()),o=t.getInt32(),a=Ae.fromRGBNumber(o),c=new Et("Arial",i),l=new Map;return new Bt(r,c,a,l)}}]),ActionParser}();_defineProperty(jt,"KEY_EVENT_MASK",1);var Vt,Ut=function RecordedPage(){_classCallCheck(this,RecordedPage),_defineProperty(this,"staticActions",[]),_defineProperty(this,"playbackActions",[]),_defineProperty(this,"pageNumber",void 0),_defineProperty(this,"timestamp",void 0)},Jt=function(){function RecordedPageParser(){_classCallCheck(this,RecordedPageParser)}return _createClass(RecordedPageParser,[{key:"parse",value:function parse(t){var r=new Ut,i=t.getInt32(),o=t.getInt32();r.pageNumber=i,r.timestamp=o;var a=t.getInt32();if(a>0)for(var c=t.byteOffset+a;t.byteOffset<c;){var l=t.getInt32(),u=t.getInt8(),d=t.getInt32(),h=jt.parse(t,u,l);h.timestamp=d,h&&r.staticActions.push(h)}var p=t.getInt32();if(p>0)for(var g=t.byteOffset+p;t.byteOffset<g;){var m=t.getInt32(),y=t.getInt8(),v=t.getInt32(),_=jt.parse(t,y,m);_.timestamp=v,_&&r.playbackActions.push(_)}return r}}]),RecordedPageParser}(),zt=function(){function ToolContext(t){_classCallCheck(this,ToolContext),_defineProperty(this,"renderController",void 0),_defineProperty(this,"page",void 0),_defineProperty(this,"keyEvent",void 0),this.renderController=t}return _createClass(ToolContext,[{key:"beginBulkRender",value:function beginBulkRender(){this.renderController.beginBulkRender()}},{key:"endBulkRender",value:function endBulkRender(){this.renderController.endBulkRender()}}]),ToolContext}(),Ht=function(){function SimpleActionExecutor(t){_classCallCheck(this,SimpleActionExecutor),_defineProperty(this,"document",void 0),_defineProperty(this,"toolContext",void 0),_defineProperty(this,"tool",void 0),_defineProperty(this,"previousTool",void 0),_defineProperty(this,"pageNumber",void 0),this.document=t,this.toolContext=new zt(null)}return _createClass(SimpleActionExecutor,[{key:"setOnSelectPageIndex",value:function setOnSelectPageIndex(t){}},{key:"setSeek",value:function setSeek(t){}},{key:"setKeyEvent",value:function setKeyEvent(t){this.toolContext.keyEvent=t}},{key:"setDocument",value:function setDocument(t){}},{key:"setPageNumber",value:function setPageNumber(t){if(this.pageNumber!==t){var r=this.document.getPage(t);this.pageNumber=t,this.toolContext.page=r}}},{key:"setTool",value:function setTool(t){if(!t)throw new Error("Tool must not be null");(this.tool||this.tool!==t)&&(this.setPreviousTool(this.tool),this.tool=t)}},{key:"selectAndExecuteTool",value:function selectAndExecuteTool(t){var r=re.createZero();this.setTool(t),this.beginTool(r),this.executeTool(r),this.endTool(r),this.setPreviousTool(this.previousTool)}},{key:"beginTool",value:function beginTool(t){this.tool.begin(t.clone(),this.toolContext)}},{key:"executeTool",value:function executeTool(t){this.tool.execute(t.clone())}},{key:"endTool",value:function endTool(t){this.tool.end(t.clone())}},{key:"setPreviousTool",value:function setPreviousTool(t){t&&(t instanceof He||(this.previousTool=t))}}]),SimpleActionExecutor}(),Gt=function(){function PageEvent(t,r,i,o){_classCallCheck(this,PageEvent),_defineProperty(this,"_changeType",void 0),_defineProperty(this,"_page",void 0),_defineProperty(this,"_shape",void 0),_defineProperty(this,"_dirtyRegion",void 0),this._page=t,this._changeType=r,this._shape=i,this._dirtyRegion=o}return _createClass(PageEvent,[{key:"changeType",get:function get(){return this._changeType}},{key:"page",get:function get(){return this._page}},{key:"shape",get:function get(){return this._shape}},{key:"dirtyRegion",get:function get(){return this._dirtyRegion}}]),PageEvent}();!function(t){t.Clear="Clear",t.ShapeAdded="ShapeAdded",t.ShapeRemoved="ShapeRemoved",t.ShapeModified="ShapeModified",t.PageTransform="PageTransform"}(Vt||(Vt={}));var qt=function(){function ActionHandler(t){_classCallCheck(this,ActionHandler),_defineProperty(this,"undoActions",[]),_defineProperty(this,"redoActions",[]),_defineProperty(this,"model",void 0),this.model=t}return _createClass(ActionHandler,[{key:"executeAction",value:function executeAction(t){this.undoActions.push(t),this.redoActions.length=0,t.execute(this.model)}},{key:"undo",value:function undo(){if(!(this.undoActions.length<1)){var t=this.undoActions.pop();this.redoActions.push(t),t.undo(this.model)}}},{key:"redo",value:function redo(){if(!(this.redoActions.length<1)){var t=this.redoActions.pop();this.undoActions.push(t),t.redo(this.model)}}},{key:"clear",value:function clear(){this.undoActions.length=0,this.redoActions.length=0}}]),ActionHandler}();function slide_shape_createSuper(t){var r=function slide_shape_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Wt=function(t){_inherits(SlideShape,t);var r=slide_shape_createSuper(SlideShape);function SlideShape(t){var i;return _classCallCheck(this,SlideShape),_defineProperty(_assertThisInitialized(i=r.call(this,0)),"page",void 0),i.page=t,i.updateBounds(),i}return _createClass(SlideShape,[{key:"getPage",value:function getPage(){return this.page}},{key:"setPageRect",value:function setPageRect(t){this.bounds.equals(t)||(this.bounds.set(t.x,t.y,t.width,t.height),this.fireShapeEvent(new le(this,this.bounds)))}},{key:"updateBounds",value:function updateBounds(){this.bounds.set(0,0,1,1)}}]),SlideShape}(de),Qt=function(){function Page(t,r){_classCallCheck(this,Page),_defineProperty(this,"shapeChangeListener",void 0),_defineProperty(this,"actionHandler",new qt(this)),_defineProperty(this,"changeEvent",new G),_defineProperty(this,"shapes",[]),_defineProperty(this,"slideShape",void 0),_defineProperty(this,"document",void 0),_defineProperty(this,"pageNumber",void 0),this.document=t,this.pageNumber=r,this.slideShape=new Wt(this),this.slideShape.addChangeListener(this.onSlideTransform.bind(this)),this.shapeChangeListener=this.onShapeModified.bind(this)}return _createClass(Page,[{key:"render",value:function render(t,r,i){return this.document.renderPage(this.pageNumber,t,r,i)}},{key:"renderText",value:function renderText(t,r){this.document.renderPageText(this.pageNumber,t,r,this.getSlideShape().bounds)}},{key:"addChangeListener",value:function addChangeListener(t){return this.changeEvent.subscribe(t)}},{key:"removeChangeListener",value:function removeChangeListener(t){this.changeEvent.unsubscribe(t)}},{key:"addShape",value:function addShape(t){var r=this.shapes.length;this.shapes.push(t)>r&&(t.addChangeListener(this.shapeChangeListener),this.firePageEvent(new Gt(this,Vt.ShapeAdded,t)))}},{key:"removeShape",value:function removeShape(t){var r=this.shapes.indexOf(t);r>-1&&(this.shapes.splice(r,1).length>0&&(t.removeChangeListener(this.shapeChangeListener),this.firePageEvent(new Gt(this,Vt.ShapeRemoved,t))))}},{key:"getSlideShape",value:function getSlideShape(){return this.slideShape}},{key:"getShapes",value:function getShapes(){return this.shapes}},{key:"hasShapes",value:function hasShapes(){return this.shapes.length>0}},{key:"addAction",value:function addAction(t){this.actionHandler.executeAction(t)}},{key:"undo",value:function undo(){this.actionHandler.undo()}},{key:"redo",value:function redo(){this.actionHandler.redo()}},{key:"clear",value:function clear(){this.actionHandler.clear(),this.shapes.length=0,this.firePageEvent(new Gt(this,Vt.Clear,null))}},{key:"onSlideTransform",value:function onSlideTransform(t){this.firePageEvent(new Gt(this,Vt.PageTransform,t.shape,t.dirtyRegion))}},{key:"onShapeModified",value:function onShapeModified(t){this.firePageEvent(new Gt(this,Vt.ShapeModified,t.shape,t.dirtyRegion))}},{key:"firePageEvent",value:function firePageEvent(t){this.changeEvent.publish(t)}}]),Page}(),Yt=function(){function SlideDocument(){_classCallCheck(this,SlideDocument),_defineProperty(this,"pages",void 0),_defineProperty(this,"documentId",void 0)}return _createClass(SlideDocument,[{key:"getDocumentId",value:function getDocumentId(){return this.documentId}},{key:"setDocumentId",value:function setDocumentId(t){this.documentId=t}},{key:"getPageCount",value:function getPageCount(){return this.pages.length}},{key:"getPage",value:function getPage(t){if(t<0||t>this.pages.length-1)throw new Error("Page number ".concat(t," out of bounds."));return this.pages[t]}}]),SlideDocument}(),Xt=function(){function WhiteboardRenderer(){_classCallCheck(this,WhiteboardRenderer)}var t;return _createClass(WhiteboardRenderer,[{key:"render",value:(t=_asyncToGenerator(X().mark((function _callee(t,r,i){return X().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){t.canvas.width=i.width,t.canvas.height=i.height,t.fillStyle="white",t.fillRect(i.x,i.y,i.width,i.height),r(t.canvas)})));case 1:case"end":return r.stop()}}),_callee)}))),function render(r,i,o){return t.apply(this,arguments)})}]),WhiteboardRenderer}();function whiteboard_document_createSuper(t){var r=function whiteboard_document_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var $t=function(t){_inherits(WhiteboardDocument,t);var r,i=whiteboard_document_createSuper(WhiteboardDocument);function WhiteboardDocument(){var t;return _classCallCheck(this,WhiteboardDocument),_defineProperty(_assertThisInitialized(t=i.call(this)),"renderer",void 0),t.renderer=new Xt,t.loadPages(),t}return _createClass(WhiteboardDocument,[{key:"getPageText",value:(r=_asyncToGenerator(X().mark((function _callee(t){return X().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve(""));case 1:case"end":return t.stop()}}),_callee)}))),function getPageText(t){return r.apply(this,arguments)})},{key:"renderPage",value:function renderPage(t,r,i,o){return this.renderer.render(r,i,o)}},{key:"renderPageText",value:function renderPageText(t,r,i,o){}},{key:"loadPages",value:function loadPages(){this.pages=[];for(var t=0;t<300;t++)this.pages.push(new Qt(this,t))}}]),WhiteboardDocument}(Yt);function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o,a,c=[],l=!0,u=!1;try{for(i=i.call(t);!(l=(o=i.next()).done)&&(c.push(o.value),!r||c.length!==r);l=!0);}catch(t){u=!0,a=t}finally{try{l||null==i.return||i.return()}finally{if(u)throw a}}return c}}(t,r)||unsupportedIterableToArray_unsupportedIterableToArray(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function http_request_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function http_request_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return http_request_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return http_request_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function http_request_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Kt=function(){function HttpRequest(t){_classCallCheck(this,HttpRequest),_defineProperty(this,"requestOptions",void 0),_defineProperty(this,"onProgress",void 0),this.requestOptions=t||{returnType:"body",responseType:"json",withCredentials:!1,timeout:0}}return _createClass(HttpRequest,[{key:"setHttpParams",value:function setHttpParams(t){return this.requestOptions.params=t,this}},{key:"setHttpHeaders",value:function setHttpHeaders(t){return this.requestOptions.headers=t,this}},{key:"setReturnType",value:function setReturnType(t){return this.requestOptions.returnType=t,this}},{key:"setResponseType",value:function setResponseType(t){return this.requestOptions.responseType=t,this}},{key:"setWithCredentials",value:function setWithCredentials(t){return this.requestOptions.withCredentials=t,this}},{key:"setTimeout",value:function setTimeout(t){return this.requestOptions.timeout=t,this}},{key:"setOptions",value:function setOptions(t){return this.requestOptions=t,this}},{key:"setOnProgress",value:function setOnProgress(t){return this.onProgress=t,this}},{key:"delete",value:function _delete(t){return this.request("DELETE",t)}},{key:"get",value:function get(t){return this.request("GET",t)}},{key:"head",value:function head(t){return this.request("HEAD",t)}},{key:"options",value:function options(t){return this.request("OPTIONS",t)}},{key:"patch",value:function patch(t,r){return this.request("PATCH",t,r)}},{key:"post",value:function post(t,r){return this.request("POST",t,r)}},{key:"put",value:function put(t,r){return this.request("PUT",t,r)}},{key:"request",value:function request(t,r,i){var o=this,request=new XMLHttpRequest;return request.open(t,this.composeUrl(r),!0),request.responseType=this.requestOptions.responseType,request.timeout=this.requestOptions.timeout,request.withCredentials=this.requestOptions.withCredentials,this.setHeaders(i,request),new Promise((function(t,r){var a=function errorHandler(){r(o.getResponse(request))};request.onload=function(){if(request.status>=200&&request.status<400){var r=null;r="response"===o.requestOptions.returnType?o.getResponse(request):o.decodeBody(request),t(r)}else a()},request.ontimeout=a,request.onerror=a,o.onProgress&&(i&&request.upload?request.upload.onprogress=o.onProgress:request.onprogress=o.onProgress),request.send(o.encodeBody(i))}))}},{key:"getResponse",value:function getResponse(t){return{body:this.decodeBody(t),headers:this.getHeaders(t),status:t.status,statusText:t.statusText}}},{key:"composeUrl",value:function composeUrl(t){var r=this.requestOptions.params;if(!r)return t;var i=r?r.toString():"";if(i){var o=t.indexOf("?");t=t+(-1===o?"?":o<t.length-1?"&":"")+i}return t}},{key:"getContentType",value:function getContentType(t){return null==t?null:t instanceof Blob?t.type:t instanceof FormData?null:"string"==typeof t?"text/plain":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=UTF-8":"object"===_typeof(t)||"number"==typeof t||Array.isArray(t)?"application/json":null}},{key:"encodeBody",value:function encodeBody(t){return null==t?null:t instanceof ArrayBuffer||t instanceof Blob||t instanceof FormData||"string"==typeof t?t:"object"===_typeof(t)||"boolean"==typeof t||Array.isArray(t)?JSON.stringify(t):t.toString()}},{key:"decodeBody",value:function decodeBody(t){var r=t.response||null,i=t.responseType;if(!i){i=t.getResponseHeader("Content-Type");var o=new RegExp("^\\w+/(\\w+);?").exec(i);o&&(i=o[1])}return"json"===i&&"string"==typeof r&&(r=""!==r?JSON.parse(r):null),r}},{key:"setHeaders",value:function setHeaders(t,r){var i=this.requestOptions.headers;if(i){var o,a=http_request_createForOfIteratorHelper(i);try{for(a.s();!(o=a.n()).done;){var c=_slicedToArray(o.value,2),l=c[0],u=c[1];if(Array.isArray(u)){var d,h=http_request_createForOfIteratorHelper(u);try{for(h.s();!(d=h.n()).done;){var p=d.value;r.setRequestHeader(l,p)}}catch(t){h.e(t)}finally{h.f()}}else r.setRequestHeader(l,u)}}catch(t){a.e(t)}finally{a.f()}}if(!i||!i.has("Content-Type")){var g=this.getContentType(t);g&&r.setRequestHeader("Content-Type",g)}i&&i.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*")}},{key:"getHeaders",value:function getHeaders(t){var r=new Map,i=t.getAllResponseHeaders();if(i){var o,a=http_request_createForOfIteratorHelper(i.trim().split(/[\r\n]+/));try{for(a.s();!(o=a.n()).done;){var c=o.value,l=c.indexOf(":");if(l>0){var u=c.slice(0,l),d=c.slice(l+1).trim(),h=u.toLowerCase(),p=r.get(h);p?("string"==typeof p?[p]:p).push(d):r.set(h,d)}}}catch(t){a.e(t)}finally{a.f()}}return r}}]),HttpRequest}(),Zt=__webpack_require__(299),en=function(){function PdfRenderer(){_classCallCheck(this,PdfRenderer),_defineProperty(this,"backCanvas",document.createElement("canvas")),_defineProperty(this,"renderTask",void 0)}var t;return _createClass(PdfRenderer,[{key:"render",value:(t=_asyncToGenerator(X().mark((function _callee(t,r,i,o){var a,c,l,u,d,h,p,g=this;return X().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(!this.renderTask){m.next=2;break}return m.abrupt("return",null);case 2:return a=1/i.width,c=o.width*a,l=i.x*c,u=i.y*c,d=t.view[2]-t.view[0],h=a*(o.width/d),(p=t.getViewport({scale:h,dontFlip:!1})).transform[4]-=l,p.transform[5]-=u,this.backCanvas.width=o.width,this.backCanvas.height=o.height,this.renderTask=t.render({canvasContext:this.backCanvas.getContext("2d"),viewport:p}),m.abrupt("return",this.renderTask.promise.then((function(){return r.canvas.width=g.backCanvas.width,r.canvas.height=g.backCanvas.height,r.drawImage(g.backCanvas,0,0),g.renderTask=null,g.backCanvas}),(function(t){})));case 15:case"end":return m.stop()}}),_callee,this)}))),function render(r,i,o,a){return t.apply(this,arguments)})}]),PdfRenderer}(),tn=__webpack_require__(963),nn=function(){function PdfTextRenderer(){_classCallCheck(this,PdfTextRenderer)}var t;return _createClass(PdfTextRenderer,[{key:"render",value:(t=_asyncToGenerator(X().mark((function _callee(t,r,i,o){var a,c,l,u,d,h,p,g,m;return X().wrap((function _callee$(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,t.getTextContent();case 2:a=y.sent,c=1/o.width,l=i.width*c,u=o.x*l,d=o.y*l,h=t.view[2]-t.view[0],p=c*(i.width/h),(g=t.getViewport({scale:p,dontFlip:!1})).transform[4]-=u,g.transform[5]-=d,(0,Zt.renderTextLayer)({textContent:a,container:r,viewport:g,enhanceTextSelection:!0,textDivs:[]}).promise.catch((function(t){console.error(t)})),(m=new tn.SimpleLinkService).externalLinkTarget=2,new tn.AnnotationLayerBuilder({pageDiv:r,pdfPage:t,linkService:m}).render(g);case 17:case"end":return y.stop()}}),_callee)}))),function render(r,i,o,a){return t.apply(this,arguments)})}]),PdfTextRenderer}();function pdf_js_document_createSuper(t){var r=function pdf_js_document_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var rn=function(t){_inherits(PdfJsDocument,t);var r,i,o,a=pdf_js_document_createSuper(PdfJsDocument);function PdfJsDocument(t){var r;return _classCallCheck(this,PdfJsDocument),_defineProperty(_assertThisInitialized(r=a.call(this)),"document",void 0),_defineProperty(_assertThisInitialized(r),"renderer",void 0),_defineProperty(_assertThisInitialized(r),"textRenderer",void 0),r.document=t,r.renderer=new en,r.textRenderer=new nn,r.loadPages(t),r}return _createClass(PdfJsDocument,[{key:"getPageText",value:(o=_asyncToGenerator(X().mark((function _callee(t){var r,i;return X().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.document.getPage(t+1);case 2:return r=o.sent,o.next=5,r.getTextContent();case 5:return i=o.sent,o.abrupt("return",i.items.map((function(t){return t.str})).join(" "));case 7:case"end":return o.stop()}}),_callee,this)}))),function getPageText(t){return o.apply(this,arguments)})},{key:"renderPage",value:(i=_asyncToGenerator(X().mark((function _callee2(t,r,i,o){var a;return X().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getPdfPage(t);case 2:return a=c.sent,c.abrupt("return",this.renderer.render(a,r,i,o));case 4:case"end":return c.stop()}}),_callee2,this)}))),function renderPage(t,r,o,a){return i.apply(this,arguments)})},{key:"renderPageText",value:(r=_asyncToGenerator(X().mark((function _callee3(t,r,i,o){var a;return X().wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getPdfPage(t);case 2:a=c.sent,this.textRenderer.render(a,r,i,o);case 4:case"end":return c.stop()}}),_callee3,this)}))),function renderPageText(t,i,o,a){return r.apply(this,arguments)})},{key:"getPdfPage",value:function getPdfPage(t){return this.document.getPage(t+1)}},{key:"loadPages",value:function loadPages(t){this.pages=[];for(var r=0;r<t.numPages;r++)this.pages.push(new Qt(this,r))}}]),PdfJsDocument}(Yt),on=function(){function DocumentService(){_classCallCheck(this,DocumentService)}return _createClass(DocumentService,[{key:"loadDocument",value:function loadDocument(t){return new Promise((function(r,i){(0,Zt.getDocument)(t).promise.then((function(t){r(new rn(t))}),(function(t){i(t)}))}))}}]),DocumentService}();function course_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function course_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return course_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return course_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function course_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var an=function(){function CourseStateService(t){_classCallCheck(this,CourseStateService),_defineProperty(this,"apiPath","/course/state"),_defineProperty(this,"host",void 0),this.host=t}return _createClass(CourseStateService,[{key:"getCourseState",value:function getCourseState(t){return(new Kt).get(this.getFullPath("/"+t))}},{key:"getStateDocument",value:function getStateDocument(t,r){var i=this;return r.documentFile?new Promise((function(o,a){(new Kt).setResponseType("arraybuffer").get(r.documentFile).then((function(t){if(!t)throw new Error("Received empty course document");var r=new Uint8Array(t);return(new on).loadDocument(r)})).then((function(c){c.setDocumentId(r.documentId),i.preloadSlideDocument(t,r,c).then((function(){o(c)})).catch((function(t){a(t)}))})).catch((function(t){a(t)}))})):new Promise((function(o,a){var c=new $t;c.setDocumentId(r.documentId),i.preloadSlideDocument(t,r,c).then((function(){o(c)})).catch((function(t){a(t)}))}))}},{key:"getStateDocumentActions",value:function getStateDocumentActions(t,r){var i=this;return new Promise((function(o,a){return(new Kt).setResponseType("arraybuffer").get(i.getFullPath("/"+t+"/pages/"+r.documentId)).then((function(t){if(t){for(var r=new ne(t),i=t.byteLength,c=[];r.byteOffset<i;){r.getInt32();var l=(new Jt).parse(r);l&&c.push(l)}o(c)}else a("Received empty course document")})).catch((function(t){a(t)}))}))}},{key:"preloadSlideDocument",value:function preloadSlideDocument(t,r,i){var o=this;return this.getStateDocumentActions(t,r).then((function(t){var r,a=new Ht(i),c=course_service_createForOfIteratorHelper(t);try{for(c.s();!(r=c.n()).done;){var l=r.value;o.loadActions(a,l)}}catch(t){c.e(t)}finally{c.f()}}))}},{key:"loadActions",value:function loadActions(t,r){var i=r.playbackActions;if(!(i.length<1)){t.setPageNumber(r.pageNumber);var o,a=course_service_createForOfIteratorHelper(i);try{for(a.s();!(o=a.n()).done;){var c=o.value;try{c.execute(t)}catch(t){console.error(t)}}}catch(t){a.e(t)}finally{a.f()}}}},{key:"getFullPath",value:function getFullPath(t){return this.host+this.apiPath+t}}]),CourseStateService}(),sn=__webpack_require__(835).default;Janus.sessions={},Janus.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var t=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),r=33;return window.navigator.userAgent.match("Linux")&&(r=35),t>=26&&t<=r||Janus.extension.isInstalled()}return!0};var cn={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(t){var r=window.setTimeout((function(){var r=new Error("NavigatorUserMediaError");return r.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',t(r)}),1e3);this.cache[r]=t,window.postMessage({type:"janusGetScreen",id:r},"*")},init:function(){var t={};this.cache=t,window.addEventListener("message",(function(r){if(r.origin==window.location.origin)if("janusGotScreen"==r.data.type&&t[r.data.id]){var i=t[r.data.id];if(delete t[r.data.id],""===r.data.sourceId){var o=new Error("NavigatorUserMediaError");o.name="You cancelled the request for permission, giving up...",i(o)}else i(null,r.data.sourceId)}else"janusGetScreenPending"==r.data.type&&(console.log("clearing ",r.data.id),window.clearTimeout(r.data.id))}))}};function Janus(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.destroyed="function"==typeof t.destroyed?t.destroyed:Janus.noop,!Janus.initDone)return t.error("Library not initialized"),{};if(!Janus.isWebrtcSupported())return t.error("WebRTC not supported by this browser"),{};if(Janus.log("Library initialized: "+Janus.initDone),!t.server)return t.error("Invalid server url"),{};var r=!1,i=null,o={},a=null,c=null,l=0,u=t.server;Janus.isArray(u)?(Janus.log("Multiple servers provided ("+u.length+"), will use the first that works"),u=null,c=t.server,Janus.debug(c)):0===u.indexOf("ws")?(r=!0,Janus.log("Using WebSockets to contact Janus: "+u)):(r=!1,Janus.log("Using REST API to contact Janus: "+u));var d=t.iceServers||[{urls:"stun:stun.l.google.com:19302"}],h=t.iceTransportPolicy,p=t.bundlePolicy,g=!0===t.ipv6,m=!1;void 0!==t.withCredentials&&null!==t.withCredentials&&(m=!0===t.withCredentials);var y=10;void 0!==t.max_poll_events&&null!==t.max_poll_events&&(y=t.max_poll_events),y<1&&(y=1);var v=null;void 0!==t.token&&null!==t.token&&(v=t.token);var _=null;void 0!==t.apisecret&&null!==t.apisecret&&(_=t.apisecret),this.destroyOnUnload=!0,void 0!==t.destroyOnUnload&&null!==t.destroyOnUnload&&(this.destroyOnUnload=!0===t.destroyOnUnload);var A=25e3;void 0!==t.keepAlivePeriod&&null!==t.keepAlivePeriod&&(A=t.keepAlivePeriod),isNaN(A)&&(A=25e3);var b=6e4;function getMaxBitrates(t){var r={high:9e5,medium:3e5,low:1e5};return null!=t&&(t.high&&(r.high=t.high),t.medium&&(r.medium=t.medium),t.low&&(r.low=t.low)),r}void 0!==t.longPollTimeout&&null!==t.longPollTimeout&&(b=t.longPollTimeout),isNaN(b)&&(b=6e4);var S=!1,C=null,w={},P=this,x=0,k={};function eventHandler(){if(null!=C)if(Janus.debug("Long poll..."),S){var r=u+"/"+C+"?rid="+(new Date).getTime();y&&(r=r+"&maxev="+y),v&&(r=r+"&token="+encodeURIComponent(v)),_&&(r=r+"&apisecret="+encodeURIComponent(_)),Janus.httpAPICall(r,{verb:"GET",withCredentials:m,success:handleEvent,timeout:b,error:function(r,i){if(Janus.error(r+":",i),++x>3)return S=!1,void t.error("Lost connection to the server (is it down?)");eventHandler()}})}else Janus.warn("Is the server down? (connected=false)")}function handleEvent(t,o){if(x=0,r||null==C||!0===o||eventHandler(),r||!Janus.isArray(t))if("keepalive"!==t.janus)if("server_info"!==t.janus)if("ack"!==t.janus)if("success"!==t.janus)if("trickle"===t.janus){const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];if(!i)return void Janus.debug("This handle is not attached to this session");var a=t.candidate;Janus.debug("Got a trickled candidate on session "+C),Janus.debug(a);var c=i.webrtcStuff;c.pc&&c.remoteSdp?(Janus.debug("Adding remote candidate:",a),a&&!0!==a.completed?c.pc.addIceCandidate(a):c.pc.addIceCandidate(Janus.endOfCandidates)):(Janus.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),c.candidates||(c.candidates=[]),c.candidates.push(a),Janus.debug(c.candidates))}else{if("webrtcup"===t.janus){Janus.debug("Got a webrtcup event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];return i?void i.webrtcState(!0):void Janus.debug("This handle is not attached to this session")}if("hangup"===t.janus){Janus.debug("Got a hangup event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.webrtcState(!1,t.reason),i.hangup()}else if("detached"===t.janus){Janus.debug("Got a detached event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];if(!i)return;i.ondetached(),i.detach()}else if("media"===t.janus){Janus.debug("Got a media event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.mediaState(t.type,t.receiving)}else if("slowlink"===t.janus){Janus.debug("Got a slowlink event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");const i=w[r];if(!i)return void Janus.debug("This handle is not attached to this session");i.slowLink(t.uplink,t.lost)}else{if("error"===t.janus){Janus.error("Ooops: "+t.error.code+" "+t.error.reason),Janus.debug(t);var l=t.transaction;if(l){var u=k[l];u&&u(t),delete k[l]}return}if("event"===t.janus){Janus.debug("Got a plugin event on session "+C),Janus.debug(t);const r=t.sender;if(!r)return void Janus.warn("Missing sender...");var d=t.plugindata;if(!d)return void Janus.warn("Missing plugindata...");Janus.debug("  -- Event is coming from "+r+" ("+d.plugin+")");var h=d.data;Janus.debug(h);const i=w[r];if(!i)return void Janus.warn("This handle is not attached to this session");var p=t.jsep;p&&(Janus.debug("Handling SDP as well..."),Janus.debug(p));var g=i.onmessage;g?(Janus.debug("Notifying application..."),g(h,p)):Janus.debug("No provided notification callback")}else{if("timeout"===t.janus)return Janus.error("Timeout on session "+C),Janus.debug(t),void(r&&i.close(3504,"Gateway timeout"));Janus.warn("Unknown message/event  '"+t.janus+"' on session "+C),Janus.debug(t)}}}else{Janus.debug("Got a success on session "+C),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else{Janus.debug("Got an ack on session "+C),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else{Janus.debug("Got info on the Janus instance"),Janus.debug(t);const r=t.transaction;if(r){const i=k[r];i&&i(t),delete k[r]}}else Janus.vdebug("Got a keepalive on session "+C);else for(var m=0;m<t.length;m++)handleEvent(t[m],!0)}function keepAlive(){if(u&&r&&S){a=setTimeout(keepAlive,A);var t={janus:"keepalive",session_id:C,transaction:Janus.randomString(12)};v&&(t.token=v),_&&(t.apisecret=_),i.send(JSON.stringify(t))}}function createSession(d){var h=Janus.randomString(12),p={janus:"create",transaction:h};if(d.reconnect&&(S=!1,p.janus="claim",p.session_id=C,i&&(i.onopen=null,i.onerror=null,i.onclose=null,a&&(clearTimeout(a),a=null))),v&&(p.token=v),_&&(p.apisecret=_),!u&&Janus.isArray(c)&&(0===(u=c[l]).indexOf("ws")?(r=!0,Janus.log("Server #"+(l+1)+": trying WebSockets to contact Janus ("+u+")")):(r=!1,Janus.log("Server #"+(l+1)+": trying REST API to contact Janus ("+u+")"))),r)for(var g in i=Janus.newWebSocket(u,"janus-protocol"),o={error:function(){if(Janus.error("Error connecting to the Janus WebSockets server... "+u),Janus.isArray(c)&&!d.reconnect)return++l===c.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(u=null,void setTimeout((function(){createSession(d)}),200));d.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){k[h]=function(t){if(Janus.debug(t),"success"!==t.janus)return Janus.error("Ooops: "+t.error.code+" "+t.error.reason),void d.error(t.error.reason);a=setTimeout(keepAlive,A),S=!0,C=t.session_id?t.session_id:t.data.id,d.reconnect?Janus.log("Claimed session: "+C):Janus.log("Created session: "+C),Janus.sessions[C]=P,d.success()},i.send(JSON.stringify(p))},message:function(t){handleEvent(JSON.parse(t.data))},close:function(){u&&S&&(S=!1,t.error("Lost connection to the server (is it down?)"))}})i.addEventListener(g,o[g]);else Janus.httpAPICall(u,{verb:"POST",withCredentials:m,body:p,success:function(t){if(Janus.debug(t),"success"!==t.janus)return Janus.error("Ooops: "+t.error.code+" "+t.error.reason),void d.error(t.error.reason);S=!0,C=t.session_id?t.session_id:t.data.id,d.reconnect?Janus.log("Claimed session: "+C):Janus.log("Created session: "+C),Janus.sessions[C]=P,eventHandler(),d.success()},error:function(t,r){if(Janus.error(t+":",r),Janus.isArray(c)&&!d.reconnect)return++l===c.length?void d.error("Error connecting to any of the provided Janus servers: Is the server down?"):(u=null,void setTimeout((function(){createSession(d)}),200));""===r?d.error(t+": Is the server down?"):d.error(t+": "+r)}})}function sendMessage(t,o){if((o=o||{}).success="function"==typeof o.success?o.success:Janus.noop,o.error="function"==typeof o.error?o.error:Janus.noop,!S)return Janus.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var a=w[t];if(!a||!a.webrtcStuff)return Janus.warn("Invalid handle"),void o.error("Invalid handle");var c=o.message,l=o.jsep,d=Janus.randomString(12),h={janus:"message",body:c,transaction:d};if(a.token&&(h.token=a.token),_&&(h.apisecret=_),l&&(h.jsep={type:l.type,sdp:l.sdp},l.e2ee&&(h.jsep.e2ee=!0),"hml"!==l.rid_order&&"lmh"!==l.rid_order||(h.jsep.rid_order=l.rid_order),l.force_relay&&(h.jsep.force_relay=!0)),Janus.debug("Sending message to plugin (handle="+t+"):"),Janus.debug(h),r)return h.session_id=C,h.handle_id=t,k[d]=function(t){if(Janus.debug("Message sent!"),Janus.debug(t),"success"===t.janus){var r=t.plugindata;if(!r)return Janus.warn("Request succeeded, but missing plugindata..."),void o.success();Janus.log("Synchronous transaction successful ("+r.plugin+")");var i=r.data;return Janus.debug(i),void o.success(i)}"ack"===t.janus?o.success():t.error?(Janus.error("Ooops: "+t.error.code+" "+t.error.reason),o.error(t.error.code+" "+t.error.reason)):(Janus.error("Unknown error"),o.error("Unknown error"))},void i.send(JSON.stringify(h));Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:h,success:function(t){if(Janus.debug("Message sent!"),Janus.debug(t),"success"===t.janus){var r=t.plugindata;if(!r)return Janus.warn("Request succeeded, but missing plugindata..."),void o.success();Janus.log("Synchronous transaction successful ("+r.plugin+")");var i=r.data;return Janus.debug(i),void o.success(i)}"ack"===t.janus?o.success():t.error?(Janus.error("Ooops: "+t.error.code+" "+t.error.reason),o.error(t.error.code+" "+t.error.reason)):(Janus.error("Unknown error"),o.error("Unknown error"))},error:function(t,r){Janus.error(t+":",r),o.error(t+": "+r)}})}function sendTrickleCandidate(t,o){if(S){var a=w[t];if(a&&a.webrtcStuff){var c={janus:"trickle",candidate:o,transaction:Janus.randomString(12)};if(a.token&&(c.token=a.token),_&&(c.apisecret=_),Janus.vdebug("Sending trickle candidate (handle="+t+"):"),Janus.vdebug(c),r)return c.session_id=C,c.handle_id=t,void i.send(JSON.stringify(c));Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:c,success:function(t){Janus.vdebug("Candidate sent!"),Janus.vdebug(t),"ack"===t.janus||Janus.error("Ooops: "+t.error.code+" "+t.error.reason)},error:function(t,r){Janus.error(t+":",r)}})}else Janus.warn("Invalid handle")}else Janus.warn("Is the server down? (connected=false)")}function createDataChannel(t,r,i,o,a){var c=w[t];if(c&&c.webrtcStuff){var l=c.webrtcStuff;if(l.pc){var onDataChannelStateChange=function(t){Janus.log("Received state change on data channel:",t);var r=t.target.label,i=t.target.protocol,o=l.dataChannel[r]?l.dataChannel[r].readyState:"null";if(Janus.log("State change on <"+r+"> data channel: "+o),"open"===o){if(l.dataChannel[r].pending&&l.dataChannel[r].pending.length>0){for(var a of(Janus.log("Sending pending messages on <"+r+">:",l.dataChannel[r].pending.length),l.dataChannel[r].pending))Janus.log("Sending data on data channel <"+r+">"),Janus.debug(a),l.dataChannel[r].send(a);l.dataChannel[r].pending=[]}c.ondataopen(r,i)}};if(o)l.dataChannel[r]=o;else{var u={ordered:!0};i&&(u.protocol=i),l.dataChannel[r]=l.pc.createDataChannel(r,u)}l.dataChannel[r].onmessage=function(t){Janus.log("Received message on data channel:",t);var r=t.target.label;c.ondata(t.data,r)},l.dataChannel[r].onopen=onDataChannelStateChange,l.dataChannel[r].onclose=onDataChannelStateChange,l.dataChannel[r].onerror=function(t){Janus.error("Got error on data channel:",t)},l.dataChannel[r].pending=[],a&&l.dataChannel[r].pending.push(a)}else Janus.warn("Invalid PeerConnection")}else Janus.warn("Invalid handle")}function sendData(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=w[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff,a=r.text||r.data;if(!a)return Janus.warn("Invalid data"),void r.error("Invalid data");var c=r.label?r.label:Janus.dataChanDefaultLabel;return o.dataChannel[c]?"open"!==o.dataChannel[c].readyState?(o.dataChannel[c].pending.push(a),void r.success()):(Janus.log("Sending data on data channel <"+c+">"),Janus.debug(a),o.dataChannel[c].send(a),void r.success()):(createDataChannel(t,c,r.protocol,!1,a,r.protocol),void r.success())}function sendDtmf(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=w[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff;if(!o.dtmfSender){if(o.pc){var a=o.pc.getSenders().find((function(t){return t.track&&"audio"===t.track.kind}));if(!a)return Janus.warn("Invalid DTMF configuration (no audio track)"),void r.error("Invalid DTMF configuration (no audio track)");o.dtmfSender=a.dtmf,o.dtmfSender&&(Janus.log("Created DTMF Sender"),o.dtmfSender.ontonechange=function(t){Janus.debug("Sent DTMF tone: "+t.tone)})}if(!o.dtmfSender)return Janus.warn("Invalid DTMF configuration"),void r.error("Invalid DTMF configuration")}var c=r.dtmf;if(!c)return Janus.warn("Invalid DTMF parameters"),void r.error("Invalid DTMF parameters");var l=c.tones;if(!l)return Janus.warn("Invalid DTMF string"),void r.error("Invalid DTMF string");var u="number"==typeof c.duration?c.duration:500,d="number"==typeof c.gap?c.gap:50;Janus.debug("Sending DTMF string "+l+" (duration "+u+"ms, gap "+d+"ms)"),o.dtmfSender.insertDTMF(l,u,d),r.success()}function destroyHandle(t,o){(o=o||{}).success="function"==typeof o.success?o.success:Janus.noop,o.error="function"==typeof o.error?o.error:Janus.noop;var a=!0===o.noRequest;Janus.log("Destroying handle "+t+" (only-locally="+a+")"),cleanupWebrtc(t);var c=w[t];if(!c||c.detached)return delete w[t],void o.success();if(c.detached=!0,a)return delete w[t],void o.success();if(!S)return Janus.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var l={janus:"detach",transaction:Janus.randomString(12)};if(c.token&&(l.token=c.token),_&&(l.apisecret=_),r)return l.session_id=C,l.handle_id=t,i.send(JSON.stringify(l)),delete w[t],void o.success();Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:l,success:function(r){Janus.log("Destroyed handle:"),Janus.debug(r),"success"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),delete w[t],o.success()},error:function(r,i){Janus.error(r+":",i),delete w[t],o.success()}})}function streamsDone(t,r,i,o,a){var c=w[t];if(!c||!c.webrtcStuff)return Janus.warn("Invalid handle"),o.stream||Janus.stopAllTracks(a),void o.error("Invalid handle");var l=c.webrtcStuff;Janus.debug("streamsDone:",a),a&&(Janus.debug("  -- Audio tracks:",a.getAudioTracks()),Janus.debug("  -- Video tracks:",a.getVideoTracks()));var u=!1;if(l.myStream&&i.update&&(!l.streamExternal||i.replaceAudio||i.replaceVideo)){if((!i.update&&isAudioSendEnabled(i)||i.update&&(i.addAudio||i.replaceAudio))&&a.getAudioTracks()&&a.getAudioTracks().length)if(l.myStream.addTrack(a.getAudioTracks()[0]),Janus.unifiedPlan){Janus.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]);var m=null;const t=l.pc.getTransceivers();if(t&&t.length>0)for(const r of t)if(r.sender&&r.sender.track&&"audio"===r.sender.track.kind||r.receiver&&r.receiver.track&&"audio"===r.receiver.track.kind){m=r;break}m&&m.sender?m.sender.replaceTrack(a.getAudioTracks()[0]):l.pc.addTrack(a.getAudioTracks()[0],a)}else Janus.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",a.getAudioTracks()[0]),l.pc.addTrack(a.getAudioTracks()[0],a);if((!i.update&&isVideoSendEnabled(i)||i.update&&(i.addVideo||i.replaceVideo))&&a.getVideoTracks()&&a.getVideoTracks().length)if(l.myStream.addTrack(a.getVideoTracks()[0]),Janus.unifiedPlan){Janus.log((i.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]);var y=null;const t=l.pc.getTransceivers();if(t&&t.length>0)for(const r of t)if(r.sender&&r.sender.track&&"video"===r.sender.track.kind||r.receiver&&r.receiver.track&&"video"===r.receiver.track.kind){y=r;break}y&&y.sender?y.sender.replaceTrack(a.getVideoTracks()[0]):l.pc.addTrack(a.getVideoTracks()[0],a)}else Janus.log((i.replaceVideo?"Replacing":"Adding")+" video track:",a.getVideoTracks()[0]),l.pc.addTrack(a.getVideoTracks()[0],a)}else l.myStream=a,u=!0;if(!l.pc){var v={iceServers:d,iceTransportPolicy:h,bundlePolicy:p};"chrome"===Janus.webRTCAdapter.browserDetails.browser&&(v.sdpSemantics=Janus.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var _={optional:[{DtlsSrtpKeyAgreement:!0}]};if(g&&_.optional.push({googIPv6:!0}),o.rtcConstraints&&"object"==typeof o.rtcConstraints)for(var A in Janus.debug("Adding custom PeerConnection constraints:",o.rtcConstraints),o.rtcConstraints)_.optional.push(o.rtcConstraints[A]);"edge"===Janus.webRTCAdapter.browserDetails.browser&&(v.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(o.senderTransforms||o.receiverTransforms)&&(l.senderTransforms=o.senderTransforms,l.receiverTransforms=o.receiverTransforms,v.forceEncodedAudioInsertableStreams=!0,v.forceEncodedVideoInsertableStreams=!0,v.encodedInsertableStreams=!0),Janus.log("Creating PeerConnection"),Janus.debug(_),l.pc=new RTCPeerConnection(v,_),Janus.debug(l.pc),l.pc.getStats&&(l.volume={},l.bitrate.value="0 kbits/sec"),Janus.log("Preparing local SDP and gathering candidates (trickle="+l.trickle+")"),l.pc.oniceconnectionstatechange=function(){l.pc&&c.iceState(l.pc.iceConnectionState)},l.pc.onicecandidate=function(r){if(!r.candidate||"edge"===Janus.webRTCAdapter.browserDetails.browser&&r.candidate.candidate.indexOf("endOfCandidates")>0)Janus.log("End of candidates."),l.iceDone=!0,!0===l.trickle?sendTrickleCandidate(t,{completed:!0}):function sendSDP(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:Janus.noop;var i=w[t];if(!i||!i.webrtcStuff)return void Janus.warn("Invalid handle, not sending anything");var o=i.webrtcStuff;if(Janus.log("Sending offer/answer SDP..."),!o.mySdp)return void Janus.warn("Local SDP instance is invalid, not sending anything...");o.mySdp={type:o.pc.localDescription.type,sdp:o.pc.localDescription.sdp},!1===o.trickle&&(o.mySdp.trickle=!1);Janus.debug(r),o.sdpSent=!0,r.success(o.mySdp)}(t,o);else{var i={candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex};!0===l.trickle&&sendTrickleCandidate(t,i)}},l.pc.ontrack=function(t){if(Janus.log("Handling Remote Track"),Janus.debug(t),t.streams&&(l.remoteStream=t.streams[0],c.onremotestream(l.remoteStream),!t.track.onended)){if(l.receiverTransforms){var r=null;RTCRtpSender.prototype.createEncodedStreams?r=t.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&l.receiverTransforms.audio?r=t.receiver.createEncodedAudioStreams():"video"===t.track.kind&&l.receiverTransforms.video&&(r=t.receiver.createEncodedVideoStreams())),r&&(console.log(r),r.readableStream&&r.writableStream?r.readableStream.pipeThrough(l.receiverTransforms[t.track.kind]).pipeTo(r.writableStream):r.readable&&r.writable&&r.readable.pipeThrough(l.receiverTransforms[t.track.kind]).pipeTo(r.writable))}var i=null;Janus.log("Adding onended callback to track:",t.track),t.track.onended=function(t){Janus.log("Remote track removed:",t),l.remoteStream&&(clearTimeout(i),l.remoteStream.removeTrack(t.target),c.onremotestream(l.remoteStream))},t.track.onmute=function(t){Janus.log("Remote track muted:",t),l.remoteStream&&null==i&&(i=setTimeout((function(){Janus.log("Removing remote track"),l.remoteStream&&(l.remoteStream.removeTrack(t.target),c.onremotestream(l.remoteStream)),i=null}),2520))},t.track.onunmute=function(t){if(Janus.log("Remote track flowing again:",t),null!=i)clearTimeout(i),i=null;else try{l.remoteStream.addTrack(t.target),c.onremotestream(l.remoteStream)}catch(t){Janus.error(t)}}}}}if(u&&a){Janus.log("Adding local stream");var b=!0===o.simulcast2;a.getTracks().forEach((function(t){Janus.log("Adding local track:",t);var r=null;if(b&&"audio"!==t.kind){Janus.log("Enabling rid-based simulcasting:",t);var i=getMaxBitrates(o.simulcastMaxBitrates),c=l.pc.addTransceiver(t,{direction:"sendrecv",streams:[a],sendEncodings:o.sendEncodings||[{rid:"h",active:!0,maxBitrate:i.high},{rid:"m",active:!0,maxBitrate:i.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:i.low,scaleResolutionDownBy:4}]});c&&(r=c.sender)}else r=l.pc.addTrack(t,a);if(r&&l.senderTransforms){var u=null;RTCRtpSender.prototype.createEncodedStreams?u=r.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===r.track.kind&&l.senderTransforms.audio?u=r.createEncodedAudioStreams():"video"===r.track.kind&&l.senderTransforms.video&&(u=r.createEncodedVideoStreams())),u&&(console.log(u),u.readableStream&&u.writableStream?u.readableStream.pipeThrough(l.senderTransforms[r.track.kind]).pipeTo(u.writableStream):u.readable&&u.writable&&u.readable.pipeThrough(l.senderTransforms[r.track.kind]).pipeTo(u.writable))}}))}(function isDataEnabled(t){if(Janus.debug("isDataEnabled:",t),"edge"===Janus.webRTCAdapter.browserDetails.browser)return Janus.warn("Edge doesn't support data channels yet"),!1;return null!=t&&!0===t.data})(i)&&!l.dataChannel[Janus.dataChanDefaultLabel]&&(Janus.log("Creating default data channel"),createDataChannel(t,Janus.dataChanDefaultLabel,null,!1),l.pc.ondatachannel=function(r){Janus.log("Data channel created by Janus:",r),createDataChannel(t,r.channel.label,r.channel.protocol,r.channel)}),l.myStream&&c.onlocalstream(l.myStream),r?l.pc.setRemoteDescription(r).then((function(){if(Janus.log("Remote description accepted!"),l.remoteSdp=r.sdp,l.candidates&&l.candidates.length>0){for(var a=0;a<l.candidates.length;a++){var c=l.candidates[a];Janus.debug("Adding remote candidate:",c),c&&!0!==c.completed?l.pc.addIceCandidate(c):l.pc.addIceCandidate(Janus.endOfCandidates)}l.candidates=[]}!function createAnswer(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:Janus.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Janus.noop;var o=w[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var a=o.webrtcStuff,c=!0===i.simulcast;c?Janus.log("Creating answer (iceDone="+a.iceDone+", simulcast="+c+")"):Janus.log("Creating answer (iceDone="+a.iceDone+")");var l=null;if(Janus.unifiedPlan){l={};var u=null,d=null,h=a.pc.getTransceivers();if(h&&h.length>0)for(var p of h)p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?u||(u=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(d||(d=p));var g=isAudioSendEnabled(r),m=isAudioRecvEnabled(r);if(g||m){if(g&&m){if(u)try{u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",Janus.log("Setting audio transceiver to sendrecv:",u)}catch(t){Janus.error(t)}}else if(g&&!m)try{u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",Janus.log("Setting audio transceiver to sendonly:",u))}catch(t){Janus.error(t)}else if(!g&&m)if(u)try{u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",Janus.log("Setting audio transceiver to recvonly:",u)}catch(t){Janus.error(t)}else u=a.pc.addTransceiver("audio",{direction:"recvonly"}),Janus.log("Adding recvonly audio transceiver:",u)}else if(r.removeAudio&&u)try{u.setDirection?u.setDirection("inactive"):u.direction="inactive",Janus.log("Setting audio transceiver to inactive:",u)}catch(t){Janus.error(t)}var y=isVideoSendEnabled(r),v=isVideoRecvEnabled(r);if(y||v){if(y&&v){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Janus.log("Setting video transceiver to sendrecv:",d)}catch(t){Janus.error(t)}}else if(y&&!v){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Janus.log("Setting video transceiver to sendonly:",d)}catch(t){Janus.error(t)}}else if(!y&&v)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Janus.log("Setting video transceiver to recvonly:",d)}catch(t){Janus.error(t)}else d=a.pc.addTransceiver("video",{direction:"recvonly"}),Janus.log("Adding recvonly video transceiver:",d)}else if(r.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",Janus.log("Setting video transceiver to inactive:",d)}catch(t){Janus.error(t)}}else l="firefox"===Janus.webRTCAdapter.browserDetails.browser||"edge"===Janus.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:isAudioRecvEnabled(r),offerToReceiveVideo:isVideoRecvEnabled(r)}:{mandatory:{OfferToReceiveAudio:isAudioRecvEnabled(r),OfferToReceiveVideo:isVideoRecvEnabled(r)}};Janus.debug(l);var _=isVideoSendEnabled(r);if(_&&c&&"firefox"===Janus.webRTCAdapter.browserDetails.browser){Janus.log("Enabling Simulcasting for Firefox (RID)");var A=a.pc.getSenders()[1];Janus.log(A);var b=A.getParameters();Janus.log(b);var S=getMaxBitrates(i.simulcastMaxBitrates);A.setParameters({encodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:S.high},{rid:"m",active:!0,maxBitrate:S.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:S.low,scaleResolutionDownBy:4}]})}a.pc.createAnswer(l).then((function(t){Janus.debug(t);var r={type:t.type,sdp:t.sdp};i.customizeSdp(r),t.sdp=r.sdp,Janus.log("Setting local description"),_&&c&&("chrome"===Janus.webRTCAdapter.browserDetails.browser?Janus.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==Janus.webRTCAdapter.browserDetails.browser&&Janus.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),a.mySdp={type:"answer",sdp:t.sdp},a.pc.setLocalDescription(t).catch(i.error),a.mediaConstraints=l,a.iceDone||a.trickle?((a.senderTransforms||a.receiverTransforms)&&(t.e2ee=!0),i.success(t)):Janus.log("Waiting for all candidates...")}),i.error)}(t,i,o)}),o.error):function createOffer(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:Janus.noop,i.customizeSdp="function"==typeof i.customizeSdp?i.customizeSdp:Janus.noop;var o=w[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var a=o.webrtcStuff,c=!0===i.simulcast;c?Janus.log("Creating offer (iceDone="+a.iceDone+", simulcast="+c+")"):Janus.log("Creating offer (iceDone="+a.iceDone+")");var l={};if(Janus.unifiedPlan){var u=null,d=null,h=a.pc.getTransceivers();if(h&&h.length>0)for(var p of h)p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?u||(u=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(d||(d=p));var g=isAudioSendEnabled(r),m=isAudioRecvEnabled(r);g||m?g&&m?u&&(u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",Janus.log("Setting audio transceiver to sendrecv:",u)):g&&!m?u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",Janus.log("Setting audio transceiver to sendonly:",u)):!g&&m&&(u?(u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",Janus.log("Setting audio transceiver to recvonly:",u)):(u=a.pc.addTransceiver("audio",{direction:"recvonly"}),Janus.log("Adding recvonly audio transceiver:",u))):r.removeAudio&&u&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive",Janus.log("Setting audio transceiver to inactive:",u));var y=isVideoSendEnabled(r),v=isVideoRecvEnabled(r);y||v?y&&v?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",Janus.log("Setting video transceiver to sendrecv:",d)):y&&!v?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",Janus.log("Setting video transceiver to sendonly:",d)):!y&&v&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",Janus.log("Setting video transceiver to recvonly:",d)):(d=a.pc.addTransceiver("video",{direction:"recvonly"}),Janus.log("Adding recvonly video transceiver:",d))):r.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",Janus.log("Setting video transceiver to inactive:",d))}else l.offerToReceiveAudio=isAudioRecvEnabled(r),l.offerToReceiveVideo=isVideoRecvEnabled(r);!0===i.iceRestart&&(l.iceRestart=!0);Janus.debug(l);var _=isVideoSendEnabled(r);if(_&&c&&"firefox"===Janus.webRTCAdapter.browserDetails.browser){Janus.log("Enabling Simulcasting for Firefox (RID)");var A=a.pc.getSenders().find((function(t){return t.track&&"video"===t.track.kind}));if(A){var b=A.getParameters();b||(b={});var S=getMaxBitrates(i.simulcastMaxBitrates);b.encodings=i.sendEncodings||[{rid:"h",active:!0,maxBitrate:S.high},{rid:"m",active:!0,maxBitrate:S.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:S.low,scaleResolutionDownBy:4}],A.setParameters(b)}}a.pc.createOffer(l).then((function(t){Janus.debug(t);var r={type:t.type,sdp:t.sdp};i.customizeSdp(r),t.sdp=r.sdp,Janus.log("Setting local description"),_&&c&&("chrome"===Janus.webRTCAdapter.browserDetails.browser||"safari"===Janus.webRTCAdapter.browserDetails.browser?(Janus.log("Enabling Simulcasting for Chrome (SDP munging)"),t.sdp=function mungeSdpForSimulcasting(t){var r=t.split("\r\n"),i=!1,o=[-1],a=[-1],c=null,l=null,u=null,d=null,h=-1;for(let y=0;y<r.length;y++){const v=r[y].match(/m=(\w+) */);if(v){if("video"===v[1]){if(!(o[0]<0)){h=y;break}i=!0}else if(o[0]>-1){h=y;break}}else if(i){var p=r[y].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/);if(p)return Janus.warn("The SDP already contains a SIM attribute, munging will be skipped"),t;var g=r[y].match(/a=ssrc-group:FID (\d+) (\d+)/);if(g)o[0]=g[1],a[0]=g[2],r.splice(y,1),y--;else{if(o[0]){var m=r[y].match("a=ssrc:"+o[0]+" cname:(.+)");if(m&&(c=m[1]),m=r[y].match("a=ssrc:"+o[0]+" msid:(.+)"),m&&(l=m[1]),m=r[y].match("a=ssrc:"+o[0]+" mslabel:(.+)"),m&&(u=m[1]),m=r[y].match("a=ssrc:"+o[0]+" label:(.+)"),m&&(d=m[1]),0===r[y].indexOf("a=ssrc:"+a[0])){r.splice(y,1),y--;continue}if(0===r[y].indexOf("a=ssrc:"+o[0])){r.splice(y,1),y--;continue}}0!=r[y].length||(r.splice(y,1),y--)}}}if(o[0]<0){h=-1,i=!1;for(let t=0;t<r.length;t++){const p=r[t].match(/m=(\w+) */);if(p){if("video"===p[1]){if(!(o[0]<0)){h=t;break}i=!0}else if(o[0]>-1){h=t;break}}else if(i){if(o[0]<0){var y=r[t].match(/a=ssrc:(\d+)/);if(y){o[0]=y[1],r.splice(t,1),t--;continue}}else{let i=r[t].match("a=ssrc:"+o[0]+" cname:(.+)");if(i&&(c=i[1]),i=r[t].match("a=ssrc:"+o[0]+" msid:(.+)"),i&&(l=i[1]),i=r[t].match("a=ssrc:"+o[0]+" mslabel:(.+)"),i&&(u=i[1]),i=r[t].match("a=ssrc:"+o[0]+" label:(.+)"),i&&(d=i[1]),0===r[t].indexOf("a=ssrc:"+a[0])){r.splice(t,1),t--;continue}if(0===r[t].indexOf("a=ssrc:"+o[0])){r.splice(t,1),t--;continue}}0!==r[t].length||(r.splice(t,1),t--)}}}if(o[0]<0)return Janus.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),t;h<0&&(h=r.length);o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random()),a[1]=Math.floor(4294967295*Math.random()),a[2]=Math.floor(4294967295*Math.random());for(var v=0;v<o.length;v++)c&&(r.splice(h,0,"a=ssrc:"+o[v]+" cname:"+c),h++),l&&(r.splice(h,0,"a=ssrc:"+o[v]+" msid:"+l),h++),u&&(r.splice(h,0,"a=ssrc:"+o[v]+" mslabel:"+u),h++),d&&(r.splice(h,0,"a=ssrc:"+o[v]+" label:"+d),h++),c&&(r.splice(h,0,"a=ssrc:"+a[v]+" cname:"+c),h++),l&&(r.splice(h,0,"a=ssrc:"+a[v]+" msid:"+l),h++),u&&(r.splice(h,0,"a=ssrc:"+a[v]+" mslabel:"+u),h++),d&&(r.splice(h,0,"a=ssrc:"+a[v]+" label:"+d),h++);r.splice(h,0,"a=ssrc-group:FID "+o[2]+" "+a[2]),r.splice(h,0,"a=ssrc-group:FID "+o[1]+" "+a[1]),r.splice(h,0,"a=ssrc-group:FID "+o[0]+" "+a[0]),r.splice(h,0,"a=ssrc-group:SIM "+o[0]+" "+o[1]+" "+o[2]),(t=r.join("\r\n")).endsWith("\r\n")||(t+="\r\n");return t}(t.sdp)):"firefox"!==Janus.webRTCAdapter.browserDetails.browser&&Janus.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),a.mySdp={type:"offer",sdp:t.sdp},a.pc.setLocalDescription(t).catch(i.error),a.mediaConstraints=l,a.iceDone||a.trickle?((a.senderTransforms||a.receiverTransforms)&&(t.e2ee=!0),i.success(t)):Janus.log("Waiting for all candidates...")}),i.error)}(t,i,o)}function prepareWebrtc(t,r,i){(i=i||{}).success="function"==typeof i.success?i.success:Janus.noop,i.error="function"==typeof i.error?i.error:webrtcError;var o=i.jsep;if(r&&o)return Janus.error("Provided a JSEP to a createOffer"),void i.error("Provided a JSEP to a createOffer");if(!(r||o&&o.type&&o.sdp))return Janus.error("A valid JSEP is required for createAnswer"),void i.error("A valid JSEP is required for createAnswer");i.media="object"==typeof i.media&&i.media?i.media:{audio:!0,video:!0};var a=i.media,c=w[t];if(!c||!c.webrtcStuff)return Janus.warn("Invalid handle"),void i.error("Invalid handle");var l=c.webrtcStuff;if(l.trickle=function isTrickleEnabled(t){return Janus.debug("isTrickleEnabled:",t),!1!==t}(i.trickle),l.pc){if(Janus.log("Updating existing media session"),a.update=!0,i.stream)i.stream!==l.myStream&&Janus.log("Renegotiation involves a new external stream");else{if(a.addAudio){if(a.keepAudio=!1,a.replaceAudio=!1,a.removeAudio=!1,a.audioSend=!0,l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length)return Janus.error("Can't add audio stream, there already is one"),void i.error("Can't add audio stream, there already is one")}else a.removeAudio?(a.keepAudio=!1,a.replaceAudio=!1,a.addAudio=!1,a.audioSend=!1):a.replaceAudio&&(a.keepAudio=!1,a.addAudio=!1,a.removeAudio=!1,a.audioSend=!0);if(l.myStream&&l.myStream.getAudioTracks()&&0!==l.myStream.getAudioTracks().length?!isAudioSendEnabled(a)||a.removeAudio||a.replaceAudio||(a.keepAudio=!0):(a.replaceAudio&&(a.keepAudio=!1,a.replaceAudio=!1,a.addAudio=!0,a.audioSend=!0),isAudioSendEnabled(a)&&(a.keepAudio=!1,a.addAudio=!0)),a.addVideo){if(a.keepVideo=!1,a.replaceVideo=!1,a.removeVideo=!1,a.videoSend=!0,l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length)return Janus.error("Can't add video stream, there already is one"),void i.error("Can't add video stream, there already is one")}else a.removeVideo?(a.keepVideo=!1,a.replaceVideo=!1,a.addVideo=!1,a.videoSend=!1):a.replaceVideo&&(a.keepVideo=!1,a.addVideo=!1,a.removeVideo=!1,a.videoSend=!0);l.myStream&&l.myStream.getVideoTracks()&&0!==l.myStream.getVideoTracks().length?!isVideoSendEnabled(a)||a.removeVideo||a.replaceVideo||(a.keepVideo=!0):(a.replaceVideo&&(a.keepVideo=!1,a.replaceVideo=!1,a.addVideo=!0,a.videoSend=!0),isVideoSendEnabled(a)&&(a.keepVideo=!1,a.addVideo=!0)),a.addData&&(a.data=!0)}if(isAudioSendEnabled(a)&&a.keepAudio&&isVideoSendEnabled(a)&&a.keepVideo)return c.consentDialog(!1),void streamsDone(t,o,a,i,l.myStream)}else a.update=!1,a.keepAudio=!1,a.keepVideo=!1;if(a.update&&(!l.streamExternal||l.streamExternal&&(a.replaceAudio||a.replaceVideo))){if(a.removeAudio||a.replaceAudio){if(l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length){var u=l.myStream.getAudioTracks()[0];Janus.log("Removing audio track:",u),l.myStream.removeTrack(u);try{u.stop()}catch(t){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var d=!0;if(a.replaceAudio&&Janus.unifiedPlan&&(d=!1),d)for(var h of l.pc.getSenders())h&&h.track&&"audio"===h.track.kind&&(Janus.log("Removing audio sender:",h),l.pc.removeTrack(h))}}if(a.removeVideo||a.replaceVideo){if(l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length){var p=l.myStream.getVideoTracks()[0];Janus.log("Removing video track:",p),l.myStream.removeTrack(p);try{p.stop()}catch(t){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var g=!0;if(a.replaceVideo&&Janus.unifiedPlan&&(g=!1),g)for(var m of l.pc.getSenders())m&&m.track&&"video"===m.track.kind&&(Janus.log("Removing video sender:",m),l.pc.removeTrack(m))}}}if(i.stream){var y=i.stream;return Janus.log("MediaStream provided by the application"),Janus.debug(y),!a.update||!l.myStream||l.myStream===i.stream||l.streamExternal||a.replaceAudio||a.replaceVideo||(Janus.stopAllTracks(l.myStream),l.myStream=null),l.streamExternal=!0,c.consentDialog(!1),void streamsDone(t,o,a,i,y)}if(isAudioSendEnabled(a)||isVideoSendEnabled(a)){if(!Janus.isGetUserMediaAvailable())return void i.error("getUserMedia not available");var v={mandatory:{},optional:[]};c.consentDialog(!0);var _=isAudioSendEnabled(a);_&&a&&"object"==typeof a.audio&&(_=a.audio);var A=isVideoSendEnabled(a);if(A&&a){var b=!0===i.simulcast,S=!0===i.simulcast2;if(!b&&!S||o||a.video||(a.video="hires"),a.video&&"screen"!=a.video&&"window"!=a.video)if("object"==typeof a.video)A=a.video;else{var C=0,P=0;"lowres"===a.video?(P=240,C=320):"lowres-16:9"===a.video?(P=180,C=320):"hires"===a.video||"hires-16:9"===a.video||"hdres"===a.video?(P=720,C=1280):"fhdres"===a.video?(P=1080,C=1920):"4kres"===a.video?(P=2160,C=3840):"stdres"===a.video?(P=480,C=640):"stdres-16:9"===a.video?(P=360,C=640):(Janus.log("Default video setting is stdres 4:3"),P=480,C=640),Janus.log("Adding media constraint:",a.video),A={height:{ideal:P},width:{ideal:C}},Janus.log("Adding video constraint:",A)}else if("screen"===a.video||"window"===a.video){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return v.video={},a.screenshareFrameRate&&(v.video.frameRate=a.screenshareFrameRate),a.screenshareHeight&&(v.video.height=a.screenshareHeight),a.screenshareWidth&&(v.video.width=a.screenshareWidth),v.audio=a.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(v).then((function(r){c.consentDialog(!1),isAudioSendEnabled(a)&&!a.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(c){r.addTrack(c.getAudioTracks()[0]),streamsDone(t,o,a,i,r)})):streamsDone(t,o,a,i,r)}),(function(t){c.consentDialog(!1),i.error(t)}));const callbackUserMedia=function(r,l){c.consentDialog(!1),r?i.error(r):streamsDone(t,o,a,i,l)},getScreenMedia=function(t,r,i){Janus.log("Adding media constraint (screen capture)"),Janus.debug(t),navigator.mediaDevices.getUserMedia(t).then((function(t){i?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(i){t.addTrack(i.getAudioTracks()[0]),r(null,t)})):r(null,t)})).catch((function(t){c.consentDialog(!1),r(t)}))};if("chrome"===Janus.webRTCAdapter.browserDetails.browser){var x=Janus.webRTCAdapter.browserDetails.version,k=33;window.navigator.userAgent.match("Linux")&&(k=35),x>=26&&x<=k?(v={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:a.screenshareFrameRate,maxFrameRate:a.screenshareFrameRate,chromeMediaSource:"screen"}},audio:isAudioSendEnabled(a)&&!a.keepAudio},getScreenMedia(v,callbackUserMedia)):Janus.extension.getScreen((function(t,r){if(t)return c.consentDialog(!1),i.error(t);(v={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:a.screenshareFrameRate,maxFrameRate:a.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=r,getScreenMedia(v,callbackUserMedia,isAudioSendEnabled(a)&&!a.keepAudio)}))}else if("firefox"===Janus.webRTCAdapter.browserDetails.browser){if(!(Janus.webRTCAdapter.browserDetails.version>=33)){var T=new Error("NavigatorUserMediaError");return T.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",c.consentDialog(!1),void i.error(T)}v={video:{mozMediaSource:a.video,mediaSource:a.video},audio:isAudioSendEnabled(a)&&!a.keepAudio},getScreenMedia(v,(function(t,r){if(callbackUserMedia(t,r),!t)var i=r.currentTime,o=window.setInterval((function(){r||window.clearInterval(o),r.currentTime==i&&(window.clearInterval(o),r.onended&&r.onended()),i=r.currentTime}),500)}))}return}}a&&"screen"===a.video||navigator.mediaDevices.enumerateDevices().then((function(r){var l=r.some((function(t){return"audioinput"===t.kind})),u=function isScreenSendEnabled(t){if(Janus.debug("isScreenSendEnabled:",t),!t)return!1;if("object"!=typeof t.video||"object"!=typeof t.video.mandatory)return!1;var r=t.video.mandatory;if(r.chromeMediaSource)return"desktop"===r.chromeMediaSource||"screen"===r.chromeMediaSource;if(r.mozMediaSource)return"window"===r.mozMediaSource||"screen"===r.mozMediaSource;if(r.mediaSource)return"window"===r.mediaSource||"screen"===r.mediaSource;return!1}(a)||r.some((function(t){return"videoinput"===t.kind})),d=isAudioSendEnabled(a),h=isVideoSendEnabled(a),p=function isAudioSendRequired(t){return Janus.debug("isAudioSendRequired:",t),!!t&&(!1!==t.audio&&!1!==t.audioSend&&(void 0!==t.failIfNoAudio&&null!==t.failIfNoAudio&&!0===t.failIfNoAudio))}(a),g=function isVideoSendRequired(t){return Janus.debug("isVideoSendRequired:",t),!!t&&(!1!==t.video&&!1!==t.videoSend&&(void 0!==t.failIfNoVideo&&null!==t.failIfNoVideo&&!0===t.failIfNoVideo))}(a);if(d||h||p||g){var m=!!d&&l,v=!!h&&u;if(!m&&!v)return c.consentDialog(!1),i.error("No capture device found"),!1;if(!m&&p)return c.consentDialog(!1),i.error("Audio capture is required, but no capture device found"),!1;if(!v&&g)return c.consentDialog(!1),i.error("Video capture is required, but no capture device found"),!1}var b={audio:!(!l||a.keepAudio)&&_,video:!(!u||a.keepVideo)&&A};Janus.debug("getUserMedia constraints",b),b.audio||b.video?navigator.mediaDevices.getUserMedia(b).then((function(r){c.consentDialog(!1),streamsDone(t,o,a,i,r)})).catch((function(t){c.consentDialog(!1),i.error({code:t.code,name:t.name,message:t.message})})):(c.consentDialog(!1),streamsDone(t,o,a,i,y))})).catch((function(t){c.consentDialog(!1),i.error(t)}))}else streamsDone(t,o,a,i)}function prepareWebrtcPeer(t,r){(r=r||{}).success="function"==typeof r.success?r.success:Janus.noop,r.error="function"==typeof r.error?r.error:webrtcError,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:Janus.noop;var i=r.jsep,o=w[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),void r.error("Invalid handle");var a=o.webrtcStuff;if(i){if(!a.pc)return Janus.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void r.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");r.customizeSdp(i),a.pc.setRemoteDescription(i).then((function(){if(Janus.log("Remote description accepted!"),a.remoteSdp=i.sdp,a.candidates&&a.candidates.length>0){for(var t=0;t<a.candidates.length;t++){var o=a.candidates[t];Janus.debug("Adding remote candidate:",o),o&&!0!==o.completed?a.pc.addIceCandidate(o):a.pc.addIceCandidate(Janus.endOfCandidates)}a.candidates=[]}r.success()}),r.error)}else r.error("Invalid JSEP")}function getVolume(t,r){var i=w[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),0;var o=r?"remote":"local",a=i.webrtcStuff;return a.volume[o]||(a.volume[o]={value:0}),!a.pc.getStats||"chrome"!==Janus.webRTCAdapter.browserDetails.browser&&"safari"!==Janus.webRTCAdapter.browserDetails.browser?(Janus.warn("Getting the "+o+" volume unsupported by browser"),0):r&&!a.remoteStream?(Janus.warn("Remote stream unavailable"),0):r||a.myStream?a.volume[o].timer?a.volume[o].value:(Janus.log("Starting "+o+" volume monitor"),a.volume[o].timer=setInterval((function(){a.pc.getStats().then((function(t){t.forEach((function(t){t&&"audio"===t.kind&&(r&&!t.remoteSource||!r&&"media-source"!==t.type||(a.volume[o].value=t.audioLevel?t.audioLevel:0))}))}))}),200),0):(Janus.warn("Local stream unavailable"),0)}function isMuted(t,r){var i=w[t];if(!i||!i.webrtcStuff)return Janus.warn("Invalid handle"),!0;var o=i.webrtcStuff;return o.pc?o.myStream?r?o.myStream.getVideoTracks()&&0!==o.myStream.getVideoTracks().length?!o.myStream.getVideoTracks()[0].enabled:(Janus.warn("No video track"),!0):o.myStream.getAudioTracks()&&0!==o.myStream.getAudioTracks().length?!o.myStream.getAudioTracks()[0].enabled:(Janus.warn("No audio track"),!0):(Janus.warn("Invalid local MediaStream"),!0):(Janus.warn("Invalid PeerConnection"),!0)}function mute(t,r,i){var o=w[t];if(!o||!o.webrtcStuff)return Janus.warn("Invalid handle"),!1;var a=o.webrtcStuff;return a.pc?a.myStream?r?a.myStream.getVideoTracks()&&0!==a.myStream.getVideoTracks().length?(a.myStream.getVideoTracks()[0].enabled=!i,!0):(Janus.warn("No video track"),!1):a.myStream.getAudioTracks()&&0!==a.myStream.getAudioTracks().length?(a.myStream.getAudioTracks()[0].enabled=!i,!0):(Janus.warn("No audio track"),!1):(Janus.warn("Invalid local MediaStream"),!1):(Janus.warn("Invalid PeerConnection"),!1)}function getBitrate(t){var r=w[t];if(!r||!r.webrtcStuff)return Janus.warn("Invalid handle"),"Invalid handle";var i=r.webrtcStuff;return i.pc?i.pc.getStats?i.bitrate.timer?i.bitrate.value:(Janus.log("Starting bitrate timer (via getStats)"),i.bitrate.timer=setInterval((function(){i.pc.getStats().then((function(t){t.forEach((function(t){if(t){var r=!1;if(("video"===t.mediaType||t.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===t.type&&t.id.indexOf("rtcp")<0?r=!0:"ssrc"!=t.type||!t.bytesReceived||"VP8"!==t.googCodecName&&""!==t.googCodecName||(r=!0),r)if(i.bitrate.bsnow=t.bytesReceived,i.bitrate.tsnow=t.timestamp,null===i.bitrate.bsbefore||null===i.bitrate.tsbefore)i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow;else{var o=i.bitrate.tsnow-i.bitrate.tsbefore;"safari"===Janus.webRTCAdapter.browserDetails.browser&&(o/=1e3);var a=Math.round(8*(i.bitrate.bsnow-i.bitrate.bsbefore)/o);"safari"===Janus.webRTCAdapter.browserDetails.browser&&(a=parseInt(a/1e3)),i.bitrate.value=a+" kbits/sec",i.bitrate.bsbefore=i.bitrate.bsnow,i.bitrate.tsbefore=i.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(Janus.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function webrtcError(t){Janus.error("WebRTC error:",t)}function cleanupWebrtc(t,o){Janus.log("Cleaning WebRTC stuff");var a=w[t];if(a){var c=a.webrtcStuff;if(c){if(!0===o){var l={janus:"hangup",transaction:Janus.randomString(12)};a.token&&(l.token=a.token),_&&(l.apisecret=_),Janus.debug("Sending hangup request (handle="+t+"):"),Janus.debug(l),r?(l.session_id=C,l.handle_id=t,i.send(JSON.stringify(l))):Janus.httpAPICall(u+"/"+C+"/"+t,{verb:"POST",withCredentials:m,body:l})}c.remoteStream=null,c.volume&&(c.volume.local&&c.volume.local.timer&&clearInterval(c.volume.local.timer),c.volume.remote&&c.volume.remote.timer&&clearInterval(c.volume.remote.timer)),c.volume={},c.bitrate.timer&&clearInterval(c.bitrate.timer),c.bitrate.timer=null,c.bitrate.bsnow=null,c.bitrate.bsbefore=null,c.bitrate.tsnow=null,c.bitrate.tsbefore=null,c.bitrate.value=null,!c.streamExternal&&c.myStream&&(Janus.log("Stopping local stream tracks"),Janus.stopAllTracks(c.myStream)),c.streamExternal=!1,c.myStream=null;try{c.pc.close()}catch(t){}c.pc=null,c.candidates=null,c.mySdp=null,c.remoteSdp=null,c.iceDone=!1,c.dataChannel={},c.dtmfSender=null,c.senderTransforms=null,c.receiverTransforms=null}a.oncleanup()}}function isAudioSendEnabled(t){return Janus.debug("isAudioSendEnabled:",t),!t||!1!==t.audio&&(void 0===t.audioSend||null===t.audioSend||!0===t.audioSend)}function isAudioRecvEnabled(t){return Janus.debug("isAudioRecvEnabled:",t),!t||!1!==t.audio&&(void 0===t.audioRecv||null===t.audioRecv||!0===t.audioRecv)}function isVideoSendEnabled(t){return Janus.debug("isVideoSendEnabled:",t),!t||!1!==t.video&&(void 0===t.videoSend||null===t.videoSend||!0===t.videoSend)}function isVideoRecvEnabled(t){return Janus.debug("isVideoRecvEnabled:",t),!t||!1!==t.video&&(void 0===t.videoRecv||null===t.videoRecv||!0===t.videoRecv)}createSession(t),this.getServer=function(){return u},this.isConnected=function(){return S},this.reconnect=function(t){(t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.reconnect=!0,createSession(t)},this.getSessionId=function(){return C},this.getInfo=function(t){!function getInfo(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,Janus.log("Getting info on Janus instance"),!S)return Janus.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=Janus.randomString(12),a={janus:"info",transaction:o};v&&(a.token=v);_&&(a.apisecret=_);if(r)return k[o]=function(r){Janus.log("Server info:"),Janus.debug(r),"server_info"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),t.success(r)},void i.send(JSON.stringify(a));Janus.httpAPICall(u,{verb:"POST",withCredentials:m,body:a,success:function(r){Janus.log("Server info:"),Janus.debug(r),"server_info"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),t.success(r)},error:function(r,i){Janus.error(r+":",i),""===i?t.error(r+": Is the server down?"):t.error(r+": "+i)}})}(t)},this.destroy=function(c){!function destroySession(c){(c=c||{}).success="function"==typeof c.success?c.success:Janus.noop,c.error="function"==typeof c.error?c.error:Janus.noop;var l=!0===c.unload,d=!0;void 0!==c.notifyDestroyed&&null!==c.notifyDestroyed&&(d=!0===c.notifyDestroyed);var h=!0===c.cleanupHandles;if(Janus.log("Destroying session "+C+" (unload="+l+")"),!C)return Janus.warn("No session to destroy"),c.success(),void(d&&t.destroyed());if(h)for(var p in w)destroyHandle(p,{noRequest:!0});if(!S)return Janus.warn("Is the server down? (connected=false)"),C=null,void c.success();var g={janus:"destroy",transaction:Janus.randomString(12)};v&&(g.token=v);_&&(g.apisecret=_);if(l)return r?(i.onclose=null,i.close(),i=null):navigator.sendBeacon(u+"/"+C,JSON.stringify(g)),Janus.log("Destroyed session:"),C=null,S=!1,c.success(),void(d&&t.destroyed());if(r){g.session_id=C;var unbindWebSocket=function(){for(var t in o)i.removeEventListener(t,o[t]);i.removeEventListener("message",onUnbindMessage),i.removeEventListener("error",onUnbindError),a&&clearTimeout(a),i.close()},onUnbindMessage=function(r){var i=JSON.parse(r.data);i.session_id==g.session_id&&i.transaction==g.transaction&&(unbindWebSocket(),c.success(),d&&t.destroyed())},onUnbindError=function(){unbindWebSocket(),c.error("Failed to destroy the server: Is the server down?"),d&&t.destroyed()};return i.addEventListener("message",onUnbindMessage),i.addEventListener("error",onUnbindError),void(1===i.readyState?i.send(JSON.stringify(g)):onUnbindError())}Janus.httpAPICall(u+"/"+C,{verb:"POST",withCredentials:m,body:g,success:function(r){Janus.log("Destroyed session:"),Janus.debug(r),C=null,S=!1,"success"!==r.janus&&Janus.error("Ooops: "+r.error.code+" "+r.error.reason),c.success(),d&&t.destroyed()},error:function(r,i){Janus.error(r+":",i),C=null,S=!1,c.success(),d&&t.destroyed()}})}(c)},this.attach=function(t){!function createHandle(t){if((t=t||{}).success="function"==typeof t.success?t.success:Janus.noop,t.error="function"==typeof t.error?t.error:Janus.noop,t.consentDialog="function"==typeof t.consentDialog?t.consentDialog:Janus.noop,t.iceState="function"==typeof t.iceState?t.iceState:Janus.noop,t.mediaState="function"==typeof t.mediaState?t.mediaState:Janus.noop,t.webrtcState="function"==typeof t.webrtcState?t.webrtcState:Janus.noop,t.slowLink="function"==typeof t.slowLink?t.slowLink:Janus.noop,t.onmessage="function"==typeof t.onmessage?t.onmessage:Janus.noop,t.onlocalstream="function"==typeof t.onlocalstream?t.onlocalstream:Janus.noop,t.onremotestream="function"==typeof t.onremotestream?t.onremotestream:Janus.noop,t.ondata="function"==typeof t.ondata?t.ondata:Janus.noop,t.ondataopen="function"==typeof t.ondataopen?t.ondataopen:Janus.noop,t.oncleanup="function"==typeof t.oncleanup?t.oncleanup:Janus.noop,t.ondetached="function"==typeof t.ondetached?t.ondetached:Janus.noop,!S)return Janus.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=t.plugin;if(!o)return Janus.error("Invalid plugin"),void t.error("Invalid plugin");var a=t.opaqueId,c=t.loopIndex,l=t.token?t.token:v,d=Janus.randomString(12),h={janus:"attach",plugin:o,opaque_id:a,loop_index:c,transaction:d};l&&(h.token=l);_&&(h.apisecret=_);if(r)return k[d]=function(r){if(Janus.debug(r),"success"!==r.janus)return Janus.error("Ooops: "+r.error.code+" "+r.error.reason),void t.error("Ooops: "+r.error.code+" "+r.error.reason);var i=r.data.id;Janus.log("Created handle: "+i);var a={session:P,plugin:o,id:i,token:l,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return o},getVolume:function(){return getVolume(i,!0)},getRemoteVolume:function(){return getVolume(i,!0)},getLocalVolume:function(){return getVolume(i,!1)},isAudioMuted:function(){return isMuted(i,!1)},muteAudio:function(){return mute(i,!1,!0)},unmuteAudio:function(){return mute(i,!1,!1)},isVideoMuted:function(){return isMuted(i,!0)},muteVideo:function(){return mute(i,!0,!0)},unmuteVideo:function(){return mute(i,!0,!1)},getBitrate:function(){return getBitrate(i)},send:function(t){sendMessage(i,t)},data:function(t){sendData(i,t)},dtmf:function(t){sendDtmf(i,t)},consentDialog:t.consentDialog,iceState:t.iceState,mediaState:t.mediaState,webrtcState:t.webrtcState,slowLink:t.slowLink,onmessage:t.onmessage,createOffer:function(t){prepareWebrtc(i,!0,t)},createAnswer:function(t){prepareWebrtc(i,!1,t)},handleRemoteJsep:function(t){prepareWebrtcPeer(i,t)},onlocalstream:t.onlocalstream,onremotestream:t.onremotestream,ondata:t.ondata,ondataopen:t.ondataopen,oncleanup:t.oncleanup,ondetached:t.ondetached,hangup:function(t){cleanupWebrtc(i,!0===t)},detach:function(t){destroyHandle(i,t)}};w[i]=a,t.success(a)},h.session_id=C,void i.send(JSON.stringify(h));Janus.httpAPICall(u+"/"+C,{verb:"POST",withCredentials:m,body:h,success:function(r){if(Janus.debug(r),"success"!==r.janus)return Janus.error("Ooops: "+r.error.code+" "+r.error.reason),void t.error("Ooops: "+r.error.code+" "+r.error.reason);var i=r.data.id;Janus.log("Created handle: "+i);var a={session:P,plugin:o,id:i,token:l,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return o},getVolume:function(){return getVolume(i,!0)},getRemoteVolume:function(){return getVolume(i,!0)},getLocalVolume:function(){return getVolume(i,!1)},isAudioMuted:function(){return isMuted(i,!1)},muteAudio:function(){return mute(i,!1,!0)},unmuteAudio:function(){return mute(i,!1,!1)},isVideoMuted:function(){return isMuted(i,!0)},muteVideo:function(){return mute(i,!0,!0)},unmuteVideo:function(){return mute(i,!0,!1)},getBitrate:function(){return getBitrate(i)},send:function(t){sendMessage(i,t)},data:function(t){sendData(i,t)},dtmf:function(t){sendDtmf(i,t)},consentDialog:t.consentDialog,iceState:t.iceState,mediaState:t.mediaState,webrtcState:t.webrtcState,slowLink:t.slowLink,onmessage:t.onmessage,createOffer:function(t){prepareWebrtc(i,!0,t)},createAnswer:function(t){prepareWebrtc(i,!1,t)},handleRemoteJsep:function(t){prepareWebrtcPeer(i,t)},onlocalstream:t.onlocalstream,onremotestream:t.onremotestream,ondata:t.ondata,ondataopen:t.ondataopen,oncleanup:t.oncleanup,ondetached:t.ondetached,hangup:function(t){cleanupWebrtc(i,!0===t)},detach:function(t){destroyHandle(i,t)}};w[i]=a,t.success(a)},error:function(r,i){Janus.error(r+":",i),""===i?t.error(r+": Is the server down?"):t.error(r+": "+i)}})}(t)}}Janus.useDefaultDependencies=function(t){var r=t&&t.fetch||fetch,i=t&&t.Promise||Promise,o=t&&t.WebSocket||WebSocket;return{newWebSocket:function(t,r){return new o(t,r)},extension:t&&t.extension||cn,isArray:function(t){return Array.isArray(t)},webRTCAdapter:t&&t.adapter||sn,httpAPICall:function(t,o){var a={method:o.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===o.verb&&(a.headers["Content-Type"]="application/json"),void 0!==o.withCredentials&&(a.credentials=!0===o.withCredentials?"include":o.withCredentials?o.withCredentials:"omit"),o.body&&(a.body=JSON.stringify(o.body));var c=r(t,a).catch((function(t){return i.reject({message:"Probably a network error, is the server down?",error:t})}));if(o.timeout){var l=new i((function(t,r){var i=setTimeout((function(){return clearTimeout(i),r({message:"Request timed out",timeout:o.timeout})}),o.timeout)}));c=i.race([c,l])}return c.then((function(t){return t.ok?typeof o.success==typeof Janus.noop?t.json().then((function(t){try{o.success(t)}catch(t){Janus.error("Unhandled httpAPICall success callback error",t)}}),(function(r){return i.reject({message:"Failed to parse response body",error:r,response:t})})):void 0:i.reject({message:"API call failed",response:t})})).catch((function(t){typeof o.error==typeof Janus.noop&&o.error(t.message||"<< internal error >>",t)})),c}}},Janus.useOldDependencies=function(t){var r=t&&t.jQuery||jQuery,i=t&&t.WebSocket||WebSocket;return{newWebSocket:function(t,r){return new i(t,r)},isArray:function(t){return r.isArray(t)},extension:t&&t.extension||cn,webRTCAdapter:t&&t.adapter||sn,httpAPICall:function(t,i){var o=void 0!==i.body?{contentType:"application/json",data:JSON.stringify(i.body)}:{},a=void 0!==i.withCredentials?{xhrFields:{withCredentials:i.withCredentials}}:{};return r.ajax(r.extend(o,a,{url:t,type:i.verb,cache:!1,dataType:"json",async:i.async,timeout:i.timeout,success:function(t){typeof i.success==typeof Janus.noop&&i.success(t)},error:function(t,r,o){typeof i.error==typeof Janus.noop&&i.error(r,o)}}))}}},Janus.noop=function(){},Janus.dataChanDefaultLabel="JanusDataChannel",Janus.endOfCandidates=null,Janus.stopAllTracks=function(t){try{var r=t.getTracks();for(var i of r)Janus.log(i),i&&i.stop()}catch(t){}},Janus.init=function(t){if((t=t||{}).callback="function"==typeof t.callback?t.callback:Janus.noop,Janus.initDone)t.callback();else{if(void 0===console.log&&(console.log=function(){}),Janus.trace=Janus.noop,Janus.debug=Janus.noop,Janus.vdebug=Janus.noop,Janus.log=Janus.noop,Janus.warn=Janus.noop,Janus.error=Janus.noop,!0===t.debug||"all"===t.debug)Janus.trace=console.trace.bind(console),Janus.debug=console.debug.bind(console),Janus.vdebug=console.debug.bind(console),Janus.log=console.log.bind(console),Janus.warn=console.warn.bind(console),Janus.error=console.error.bind(console);else if(Array.isArray(t.debug))for(var r of t.debug)switch(r){case"trace":Janus.trace=console.trace.bind(console);break;case"debug":Janus.debug=console.debug.bind(console);break;case"vdebug":Janus.vdebug=console.debug.bind(console);break;case"log":Janus.log=console.log.bind(console);break;case"warn":Janus.warn=console.warn.bind(console);break;case"error":Janus.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+r+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}Janus.log("Initializing library");var i=t.dependencies||Janus.useDefaultDependencies();Janus.isArray=i.isArray,Janus.webRTCAdapter=i.webRTCAdapter,Janus.httpAPICall=i.httpAPICall,Janus.newWebSocket=i.newWebSocket,Janus.extension=i.extension,Janus.extension.init(),Janus.listDevices=function(t,r){t="function"==typeof t?t:Janus.noop,null==r&&(r={audio:!0,video:!0}),Janus.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(r).then((function(r){navigator.mediaDevices.enumerateDevices().then((function(i){Janus.debug(i),t(i),Janus.stopAllTracks(r)}))})).catch((function(r){Janus.error(r),t([])})):(Janus.warn("navigator.mediaDevices unavailable"),t([]))},Janus.attachMediaStream=function(t,r){try{t.srcObject=r}catch(i){try{t.src=URL.createObjectURL(r)}catch(t){Janus.error("Error attaching stream to element")}}},Janus.reattachMediaStream=function(t,r){try{t.srcObject=r.srcObject}catch(i){try{t.src=r.src}catch(t){Janus.error("Error reattaching stream to element")}}};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",a=window["on"+o];if(window.addEventListener(o,(function(){for(var t in Janus.log("Closing window"),Janus.sessions)Janus.sessions[t]&&Janus.sessions[t].destroyOnUnload&&(Janus.log("Destroying session "+t),Janus.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));a&&"function"==typeof a&&a()})),Janus.safariVp8=!1,"safari"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var c of RTCRtpSender.getCapabilities("video").codecs)if(c&&c.mimeType&&"video/vp8"===c.mimeType.toLowerCase()){Janus.safariVp8=!0;break}Janus.safariVp8?Janus.log("This version of Safari supports VP8"):Janus.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var l=new RTCPeerConnection({});l.createOffer({offerToReceiveVideo:!0}).then((function(t){Janus.safariVp8=-1!==t.sdp.indexOf("VP8"),Janus.safariVp8?Janus.log("This version of Safari supports VP8"):Janus.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),l.close(),l=null}))}if(Janus.unifiedPlan=!1,"firefox"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=59)Janus.unifiedPlan=!0;else if("chrome"===Janus.webRTCAdapter.browserDetails.browser&&Janus.webRTCAdapter.browserDetails.version>=72)Janus.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var u=new RTCPeerConnection;try{u.addTransceiver("audio"),Janus.unifiedPlan=!0}catch(t){}u.close()}else Janus.unifiedPlan=!1;Janus.initDone=!0,t.callback()}},Janus.isWebrtcSupported=function(){return!!window.RTCPeerConnection},Janus.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},Janus.randomString=function(t){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",o=0;o<t;o++){var a=Math.floor(Math.random()*r.length);i+=r.substring(a,a+1)}return i};var ln=function(){function Utils(){_classCallCheck(this,Utils)}return _createClass(Utils,null,[{key:"isFunction",value:function isFunction(t){return"function"==typeof t}},{key:"checkFunction",value:function checkFunction(t){this.isFunction(t)||console.error("Consumer is not a function")}}]),Utils}();function janus_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function janus_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return janus_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return janus_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function janus_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var un,dn=function(){function JanusService(t,r){_classCallCheck(this,JanusService),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"serverUrl",void 0),_defineProperty(this,"playerView",void 0),_defineProperty(this,"janus",void 0),_defineProperty(this,"publisherLocalStream",void 0),_defineProperty(this,"publisherHandle",void 0),_defineProperty(this,"publisherId",void 0),_defineProperty(this,"remoteFeeds",void 0),_defineProperty(this,"myroom",void 0),_defineProperty(this,"opaqueId",void 0),_defineProperty(this,"deviceConstraints",void 0),_defineProperty(this,"myusername",void 0),_defineProperty(this,"dataCallback",void 0),this.serverUrl=t,this.playbackModel=r,this.janus=null,this.publisherHandle=null,this.publisherId=null,this.publisherLocalStream=null,this.dataCallback=null,this.remoteFeeds=[],this.opaqueId="course-"+Janus.randomString(12),this.myusername=Janus.randomString(12)}return _createClass(JanusService,[{key:"setPlayerView",value:function setPlayerView(t){this.playerView=t}},{key:"setDeviceConstraints",value:function setDeviceConstraints(t){this.deviceConstraints=t}},{key:"setUserId",value:function setUserId(t){this.opaqueId=t}},{key:"setRoomId",value:function setRoomId(t){this.myroom=t}},{key:"setOnData",value:function setOnData(t){ln.checkFunction(t),this.dataCallback=t}},{key:"start",value:function start(){var t=this;Janus.init({callback:function callback(){Janus.isWebrtcSupported()?t.createSession():console.error("No WebRTC support...")}})}},{key:"addPeer",value:function addPeer(t){var r=Number(t);this.publisherId!==r&&this.attachToPublisher({id:r},!1)}},{key:"startSpeech",value:function startSpeech(t){var r=this;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(t){Janus.log("Plugin attached! ("+t.getPlugin()+", id="+t.getId()+")"),r.publisherHandle=t,r.joinAsPublisher(r.publisherHandle)},error:function error(t){Janus.error("  -- Error attaching plugin...",t)},consentDialog:function consentDialog(t){},iceState:function iceState(t){Janus.log("ICE state changed to "+t)},mediaState:function mediaState(t,r,i){Janus.log("Janus "+(r?"started":"stopped")+" receiving our "+t)},webrtcState:function webrtcState(t){Janus.log("Janus says our WebRTC PeerConnection is "+(t?"up":"down")+" now"),r.playbackModel.webrtcPublisherConnected=t,t||(r.playbackModel.localVideoAvailable=!1,r.playbackModel.raisedHand=!1)},onmessage:function onmessage(i,o){var a=i.videoroom;if(i.error)Janus.error(i.error);else if(a&&"joined"===a&&(r.publisherId=i.id,r.publishOwnFeed(r.publisherHandle,t)),o){r.publisherHandle.handleRemoteJsep({jsep:o});var c=i.audio_codec,l=i.video_codec;r.publisherLocalStream&&r.publisherLocalStream.getAudioTracks()&&r.publisherLocalStream.getAudioTracks().length>0&&!c&&console.log("Our audio stream has been rejected, viewers won't hear us"),r.publisherLocalStream&&r.publisherLocalStream.getVideoTracks()&&r.publisherLocalStream.getVideoTracks().length>0&&!l&&console.log("Our video stream has been rejected, viewers won't see us")}},onlocalstream:function onlocalstream(t){r.publisherLocalStream=t;var i=r.getElementById("localVideoFeed");Janus.attachMediaStream(i,t),i.muted=!0;var o,a=!1,c=janus_service_createForOfIteratorHelper(t.getVideoTracks());try{for(c.s();!(o=c.n()).done;){if(0==o.value.muted){a=!0;break}}}catch(t){c.e(t)}finally{c.f()}r.playbackModel.localVideoAvailable=a},onremotestream:function onremotestream(t){},oncleanup:function oncleanup(){},detached:function detached(){}})}},{key:"stopSpeech",value:function stopSpeech(){if(this.publisherId=null,this.publisherHandle){this.publisherHandle.send({message:{request:"unpublish"}}),this.playbackModel.localVideoAvailable=!1}}},{key:"createSession",value:function createSession(){var t=this;this.janus=new Janus({server:this.serverUrl,success:function success(){t.attach()},error:function error(t){Janus.error(t),console.log(t)},destroyed:function destroyed(){Janus.log("Janus destroyed")}})}},{key:"attach",value:function attach(){var t=this;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(r){Janus.log("Plugin attached! ("+r.getPlugin()+", id="+r.getId()+")"),t.getParticipants(r)},onmessage:function onmessage(t,r){console.log("init handler",t)},error:function error(t){console.error("  -- Error attaching plugin...",t)},detached:function detached(){console.log("detached main...")}})}},{key:"getParticipants",value:function getParticipants(t){var r=this,i={request:"listparticipants",room:this.myroom};t.send({message:i,success:function success(i){if(i.participants&&i.participants.length>0)for(var o in i.participants){var a=i.participants[o];r.attachToPublisher(a,!a.display)}else Janus.error("Requested feed is not available anymore");t.detach()}})}},{key:"attachToPublisher",value:function attachToPublisher(t,r){var i=this,o=null;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function success(a){(o=a).isPrimary=r,o.hasVideo=!1;var c={request:"join",room:i.myroom,ptype:"subscriber",feed:t.id};o.send({message:c})},error:function error(t){Janus.error("  -- Error attaching plugin...",t),o.isPrimary&&i.stopSpeech()},iceState:function iceState(t){Janus.log("ICE state changed to "+t)},mediaState:function mediaState(t,r,i){Janus.log("Janus "+(r?"started":"stopped")+" receiving our "+t)},webrtcState:function webrtcState(t){Janus.log("Janus says our WebRTC PeerConnection is "+(t?"up":"down")+" now"),o.isPrimary&&(i.playbackModel.webrtcConnected=t,t||i.stopSpeech())},onmessage:function onmessage(t,r){var a=t.videoroom;t.error?console.error(t.error):(a&&"attached"===a&&(Janus.log("Successfully attached to feed "+t.id+" ("+t.display+") in room "+t.room),o.rfid=t.id,i.remoteFeeds.push(o)),r&&i.createAnswer(o,r,o.isPrimary))},onremotestream:function onremotestream(r){var a,c=!1,l=janus_service_createForOfIteratorHelper(r.getVideoTracks());try{for(l.s();!(a=l.n()).done;){if(0==a.value.muted)if("break"===(r.addEventListener("removetrack",(function removeListener(t){i.onVideoTrackRemoved(o,t.track),r.removeEventListener("removetrack",removeListener)})),c=!0,"break"))break}}catch(t){l.e(t)}finally{l.f()}if(o.hasVideo=c,o.isPrimary){var u=i.playerView.getMediaElement();Janus.attachMediaStream(u,r),i.setAudioSink(u,i.deviceConstraints.audioOutput),i.playbackModel.mainVideoAvailable=c}else{var d=i.getElementById("videoFeed-"+t.id);if(!d){(d=document.createElement("video")).id="videoFeed-"+t.id,d.autoplay=!0,d.playsInline=!0;var h=document.createElement("div");h.id="videoFeedDiv-"+t.id,h.classList.add("invisible"),h.appendChild(d),i.getElementById("videoFeedContainer").appendChild(h)}if(c)i.getElementById("videoFeedDiv-"+t.id).classList.remove("invisible");Janus.attachMediaStream(d,r),i.setAudioSink(d,i.deviceConstraints.audioOutput)}i.checkVideoCount()},ondataopen:function ondataopen(t,r){Janus.log("The DataChannel is available! - "+t+" - "+r)},ondata:function ondata(t){o.isPrimary&&i.dataCallback(t)},oncleanup:function oncleanup(){if(!o.isPrimary){var r=i.getElementById("videoFeedContainer"),a=i.getElementById("videoFeedDiv-"+t.id);r.removeChild(a)}i.remoteFeeds=i.remoteFeeds.filter((function(t){return t!==o})),o.isPrimary&&i.stopSpeech(),i.checkVideoCount(),o.isPrimary&&i.janus.destroy()},detached:function detached(){Janus.log("detached...")}})}},{key:"setAudioSink",value:function setAudioSink(t,r){"sinkId"in HTMLMediaElement.prototype&&t.setSinkId(r).catch((function(t){console.error(t)}))}},{key:"onVideoTrackRemoved",value:function onVideoTrackRemoved(t,r){this.playbackModel.mainVideoAvailable=!1,t.hasVideo=!1,this.checkVideoCount()}},{key:"checkVideoCount",value:function checkVideoCount(){var t,r=!1,i=janus_service_createForOfIteratorHelper(this.remoteFeeds);try{for(i.s();!(t=i.n()).done;){if(!0===t.value.hasVideo){r=!0;break}}}catch(t){i.e(t)}finally{i.f()}this.playbackModel.videoAvailable=r}},{key:"joinAsPublisher",value:function joinAsPublisher(t){var r={request:"join",room:this.myroom,ptype:"publisher",display:this.myusername};t.send({message:r})}},{key:"createAnswer",value:function createAnswer(t,r,i){var o=this;t.createAnswer({jsep:r,media:{audioSend:!1,videoSend:!1,data:i},success:function success(r){var i={request:"start",room:o.myroom};t.send({message:i,jsep:r})},error:function error(t){Janus.error("WebRTC error: ",t)}})}},{key:"publishOwnFeed",value:function publishOwnFeed(t,r){var i=null!=r.videoDeviceId;t.createOffer({media:{audioRecv:!1,videoRecv:!1,audioSend:!0,audio:{deviceId:r.audioDeviceId,echoCancellation:!0},videoSend:i,video:{deviceId:r.videoDeviceId,width:1280,height:720},failIfNoAudio:!0,failIfNoVideo:!1},success:function success(r){Janus.debug("Got publisher SDP!",r);var o={request:"configure",audio:!0,video:i};t.send({message:o,jsep:r})},error:function error(i){Janus.error("WebRTC error:",i),console.error("WebRTC error:",i),r.videoDeviceId=null,this.publishOwnFeed(t,r)}})}},{key:"getElementById",value:function getElementById(t){return document.getElementById(t)}}]),JanusService}();!function(t){t[t.STREAM_INIT=0]="STREAM_INIT",t[t.STREAM_START=1]="STREAM_START",t[t.STREAM_PAGE_ACTION=2]="STREAM_PAGE_ACTION",t[t.STREAM_PAGE_ACTIONS=3]="STREAM_PAGE_ACTIONS",t[t.STREAM_PAGE_CREATED=4]="STREAM_PAGE_CREATED",t[t.STREAM_PAGE_DELETED=5]="STREAM_PAGE_DELETED",t[t.STREAM_PAGE_SELECTED=6]="STREAM_PAGE_SELECTED",t[t.STREAM_DOCUMENT_CREATED=7]="STREAM_DOCUMENT_CREATED",t[t.STREAM_DOCUMENT_CLOSED=8]="STREAM_DOCUMENT_CLOSED",t[t.STREAM_DOCUMENT_SELECTED=9]="STREAM_DOCUMENT_SELECTED",t[t.STREAM_SPEECH_PUBLISHED=10]="STREAM_SPEECH_PUBLISHED"}(un||(un={}));var hn=function StreamAction(){_classCallCheck(this,StreamAction)};function stream_document_action_createSuper(t){var r=function stream_document_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var pn=function(t){_inherits(StreamDocumentAction,t);var r=stream_document_action_createSuper(StreamDocumentAction);function StreamDocumentAction(t,i,o,a){var c;return _classCallCheck(this,StreamDocumentAction),_defineProperty(_assertThisInitialized(c=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(c),"documentType",void 0),_defineProperty(_assertThisInitialized(c),"documentTitle",void 0),_defineProperty(_assertThisInitialized(c),"documentFile",void 0),c.documentId=t,c.documentType=i,c.documentTitle=o,c.documentFile=a,c}return StreamDocumentAction}(hn);function stream_document_closed_action_createSuper(t){var r=function stream_document_closed_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var fn=function(t){_inherits(StreamDocumentClosedAction,t);var r=stream_document_closed_action_createSuper(StreamDocumentClosedAction);function StreamDocumentClosedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentClosedAction),r.call(this,t,i,o,a)}return StreamDocumentClosedAction}(pn);function stream_document_created_action_createSuper(t){var r=function stream_document_created_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var gn=function(t){_inherits(StreamDocumentCreatedAction,t);var r=stream_document_created_action_createSuper(StreamDocumentCreatedAction);function StreamDocumentCreatedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentCreatedAction),r.call(this,t,i,o,a)}return StreamDocumentCreatedAction}(pn);function stream_document_selected_action_createSuper(t){var r=function stream_document_selected_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var mn=function(t){_inherits(StreamDocumentSelectedAction,t);var r=stream_document_selected_action_createSuper(StreamDocumentSelectedAction);function StreamDocumentSelectedAction(t,i,o,a){return _classCallCheck(this,StreamDocumentSelectedAction),r.call(this,t,i,o,a)}return StreamDocumentSelectedAction}(pn);function stream_page_action_createSuper(t){var r=function stream_page_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var yn=function(t){_inherits(StreamPageAction,t);var r=stream_page_action_createSuper(StreamPageAction);function StreamPageAction(t,i){var o;return _classCallCheck(this,StreamPageAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(o),"pageNumber",void 0),o.documentId=t,o.pageNumber=i,o}return StreamPageAction}(hn);function stream_page_created_action_createSuper(t){var r=function stream_page_created_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var vn=function(t){_inherits(StreamPageCreatedAction,t);var r=stream_page_created_action_createSuper(StreamPageCreatedAction);function StreamPageCreatedAction(t,i){return _classCallCheck(this,StreamPageCreatedAction),r.call(this,t,i)}return StreamPageCreatedAction}(yn);function stream_page_deleted_action_createSuper(t){var r=function stream_page_deleted_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var _n=function(t){_inherits(StreamPageDeletedAction,t);var r=stream_page_deleted_action_createSuper(StreamPageDeletedAction);function StreamPageDeletedAction(t,i){return _classCallCheck(this,StreamPageDeletedAction),r.call(this,t,i)}return StreamPageDeletedAction}(yn);function stream_page_selected_action_createSuper(t){var r=function stream_page_selected_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var An=function(t){_inherits(StreamPageSelectedAction,t);var r=stream_page_selected_action_createSuper(StreamPageSelectedAction);function StreamPageSelectedAction(t,i){return _classCallCheck(this,StreamPageSelectedAction),r.call(this,t,i)}return StreamPageSelectedAction}(yn);function stream_playback_action_createSuper(t){var r=function stream_playback_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var bn=function(t){_inherits(StreamPagePlaybackAction,t);var r=stream_playback_action_createSuper(StreamPagePlaybackAction);function StreamPagePlaybackAction(t,i,o){var a;return _classCallCheck(this,StreamPagePlaybackAction),_defineProperty(_assertThisInitialized(a=r.call(this,t,i)),"action",void 0),a.action=o,a}return StreamPagePlaybackAction}(yn);function stream_playbacks_action_createSuper(t){var r=function stream_playbacks_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Sn=function(t){_inherits(StreamPageActionsAction,t);var r=stream_playbacks_action_createSuper(StreamPageActionsAction);function StreamPageActionsAction(t,i){var o;return _classCallCheck(this,StreamPageActionsAction),_defineProperty(_assertThisInitialized(o=r.call(this)),"documentId",void 0),_defineProperty(_assertThisInitialized(o),"recordedPage",void 0),o.documentId=t,o.recordedPage=i,o}return StreamPageActionsAction}(hn);function stream_start_action_createSuper(t){var r=function stream_start_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Cn=function(t){_inherits(StreamStartAction,t);var r=stream_start_action_createSuper(StreamStartAction);function StreamStartAction(t){var i;return _classCallCheck(this,StreamStartAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"courseId",void 0),i.courseId=t,i}return StreamStartAction}(hn);function stream_speech_action_createSuper(t){var r=function stream_speech_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function stream_speech_published_action_createSuper(t){var r=function stream_speech_published_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var wn=function(t){_inherits(StreamSpeechPublishedAction,t);var r=stream_speech_published_action_createSuper(StreamSpeechPublishedAction);function StreamSpeechPublishedAction(t){return _classCallCheck(this,StreamSpeechPublishedAction),r.call(this,t)}return StreamSpeechPublishedAction}(function(t){_inherits(StreamSpeechAction,t);var r=stream_speech_action_createSuper(StreamSpeechAction);function StreamSpeechAction(t){var i;return _classCallCheck(this,StreamSpeechAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"publisherId",void 0),i.publisherId=t,i}return StreamSpeechAction}(hn)),Pn=function(){function StreamActionParser(){_classCallCheck(this,StreamActionParser)}return _createClass(StreamActionParser,null,[{key:"parse",value:function parse(t,r,i){var o=null;switch(r){case un.STREAM_INIT:break;case un.STREAM_START:o=this.startAction(t);break;case un.STREAM_PAGE_ACTION:o=this.playbackAction(t);break;case un.STREAM_PAGE_ACTIONS:o=this.playbackActions(t);break;case un.STREAM_PAGE_CREATED:o=this.pageAction(t,vn);break;case un.STREAM_PAGE_DELETED:o=this.pageAction(t,_n);break;case un.STREAM_PAGE_SELECTED:o=this.pageAction(t,An);break;case un.STREAM_DOCUMENT_CREATED:o=this.documentAction(t,gn);break;case un.STREAM_DOCUMENT_CLOSED:o=this.documentAction(t,fn);break;case un.STREAM_DOCUMENT_SELECTED:o=this.documentAction(t,mn);break;case un.STREAM_SPEECH_PUBLISHED:o=this.speechAction(t,wn)}return o}},{key:"startAction",value:function startAction(t){var r=t.getUint32();return new Cn(r)}},{key:"playbackAction",value:function playbackAction(t){var r=t.getInt64(),i=t.getInt32(),o=t.getInt32(),a=t.getInt8(),c=t.getInt32(),l=jt.parse(t,a,o);return l.timestamp=c,new bn(r,i,l)}},{key:"playbackActions",value:function playbackActions(t){var r=t.getInt64(),i=(t.getInt32(),(new Jt).parse(t));return new Sn(r,i)}},{key:"pageAction",value:function pageAction(t,r){return new r(t.getInt64(),t.getInt32())}},{key:"documentAction",value:function documentAction(t,r){var i=t.getInt64(),o=t.getInt8(),a=t.getInt32(),c=t.getInt32(),l=t.getInt32(),u=t.getString(a),d=t.getString(c);t.getString(l);return new r(i,o,u,d)}},{key:"speechAction",value:function speechAction(t,r){var i=t.getInt32(),o=t.getString(i);return new r(BigInt(o))}}]),StreamActionParser}();function page_action_createSuper(t){var r=function page_action_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var xn,kn=function(t){_inherits(PageAction,t);var r=page_action_createSuper(PageAction);function PageAction(t){var i;return _classCallCheck(this,PageAction),_defineProperty(_assertThisInitialized(i=r.call(this)),"pageNumber",void 0),i.pageNumber=t,i}return _createClass(PageAction,[{key:"execute",value:function execute(t){t.setPageNumber(this.pageNumber)}}]),PageAction}(ie),Tn=function(){function StreamActionExecutor(t){_classCallCheck(this,StreamActionExecutor),_defineProperty(this,"renderController",void 0),_defineProperty(this,"toolContext",void 0),_defineProperty(this,"document",void 0),_defineProperty(this,"tool",void 0),_defineProperty(this,"previousTool",void 0),_defineProperty(this,"pageNumber",void 0),_defineProperty(this,"pageIndexObserver",void 0),this.renderController=t,this.toolContext=new zt(t)}return _createClass(StreamActionExecutor,[{key:"setOnSelectPageIndex",value:function setOnSelectPageIndex(t){this.pageIndexObserver=t}},{key:"setKeyEvent",value:function setKeyEvent(t){this.toolContext.keyEvent=t}},{key:"setSeek",value:function setSeek(t){this.renderController.setSeek(t)}},{key:"setDocument",value:function setDocument(t){this.document=t}},{key:"setPageNumber",value:function setPageNumber(t){var r=this.document.getPage(t);this.pageNumber=t,this.toolContext.page=r,this.renderController.setPage(r),this.pageIndexObserver&&this.pageIndexObserver(t)}},{key:"setTool",value:function setTool(t){if(!t)throw new Error("Tool must not be null");(this.tool||this.tool!==t)&&(this.setPreviousTool(this.tool),this.tool=t)}},{key:"selectAndExecuteTool",value:function selectAndExecuteTool(t){this.executeAtomicTool(t)}},{key:"beginTool",value:function beginTool(t){this.tool.begin(t.clone(),this.toolContext)}},{key:"executeTool",value:function executeTool(t){this.tool.execute(t.clone())}},{key:"endTool",value:function endTool(t){this.tool.end(t.clone())}},{key:"executeAtomicTool",value:function executeAtomicTool(t){var r=re.createZero();this.setTool(t),this.beginTool(r),this.executeTool(r),this.endTool(r),this.setPreviousTool(this.previousTool)}},{key:"setPreviousTool",value:function setPreviousTool(t){t&&(t instanceof He||(this.previousTool=t))}}]),StreamActionExecutor}();!function(t){t.Created="Created",t.Initializing="Initializing",t.Initialized="Initialized",t.Starting="Starting",t.Started="Started",t.Stopping="Stopping",t.Stopped="Stopped",t.Suspending="Suspending",t.Suspended="Suspended",t.Destroying="Destroying",t.Destroyed="Destroyed",t.Error="Error"}(xn||(xn={}));var Rn=function(){function Executable(){_classCallCheck(this,Executable),_defineProperty(this,"stateEvent",new G),_defineProperty(this,"_state",xn.Created),_defineProperty(this,"_prevState",xn.Created)}return _createClass(Executable,[{key:"state",get:function get(){return this._state}},{key:"previousState",get:function get(){return this._prevState}},{key:"initialized",value:function initialized(){return this._state===xn.Initialized}},{key:"created",value:function created(){return this._state===xn.Created}},{key:"started",value:function started(){return this._state===xn.Started}},{key:"stopped",value:function stopped(){return this._state===xn.Stopped}},{key:"suspended",value:function suspended(){return this._state===xn.Suspended}},{key:"destroyed",value:function destroyed(){return this._state===xn.Destroyed}},{key:"error",value:function error(){return this._state===xn.Error}},{key:"addStateListener",value:function addStateListener(t){return this.stateEvent.subscribe(t)}},{key:"removeStateListener",value:function removeStateListener(t){this.stateEvent.unsubscribe(t)}},{key:"fireStateChanged",value:function fireStateChanged(){this.stateEvent.publish(this._state)}},{key:"setState",value:function setState(t){if(!this.validateNextState(t))throw new Error("Invalid state transition for ".concat(this.constructor.name,": [").concat(this.state,"] -> [").concat(t,"]."));this._prevState=this._state,this._state=t,this.fireStateChanged()}},{key:"validateNextState",value:function validateNextState(t){switch(this._state){case xn.Created:return this.isAllowed(t,xn.Initializing,xn.Destroying);case xn.Initializing:return this.isAllowed(t,xn.Initialized,xn.Error);case xn.Initialized:return this.isAllowed(t,xn.Starting,xn.Destroying);case xn.Starting:return this.isAllowed(t,xn.Started,xn.Error);case xn.Started:return this.isAllowed(t,xn.Suspending,xn.Stopping,xn.Destroying,xn.Error);case xn.Stopping:return this.isAllowed(t,xn.Stopped,xn.Error);case xn.Stopped:return this.isAllowed(t,xn.Starting,xn.Destroying);case xn.Suspending:return this.isAllowed(t,xn.Suspended,xn.Error);case xn.Suspended:return this.isAllowed(t,xn.Starting,xn.Stopping,xn.Destroying);case xn.Destroying:return this.isAllowed(t,xn.Destroyed,xn.Error);case xn.Destroyed:return this.isAllowed(t,xn.Initializing);case xn.Error:return this.isAllowed(t,xn.Starting,xn.Stopping,xn.Destroying);default:return!1}}},{key:"isAllowed",value:function isAllowed(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(!i)throw new Error("No allowed states provided.");for(var a=0,c=i;a<c.length;a++){var l=c[a];if(t==l)return!0}return!1}}]),Executable}();function executable_base_createSuper(t){var r=function executable_base_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var En=function(t){_inherits(ExecutableBase,t);var r=executable_base_createSuper(ExecutableBase);function ExecutableBase(){return _classCallCheck(this,ExecutableBase),r.apply(this,arguments)}return _createClass(ExecutableBase,[{key:"init",value:function init(){this.setState(xn.Initializing);try{this.initInternal()}catch(t){throw this.setState(xn.Error),new Error("Failed to init ".concat(this.constructor.name,": ").concat(t))}this.setState(xn.Initialized)}},{key:"start",value:function start(){(this.created()||this.destroyed())&&this.init(),this.setState(xn.Starting);try{this.startInternal()}catch(t){throw this.setState(xn.Error),new Error("Failed to start ".concat(this.constructor.name,": ").concat(t))}this.setState(xn.Started)}},{key:"stop",value:function stop(){this.setState(xn.Stopping);try{this.stopInternal()}catch(t){throw this.setState(xn.Error),new Error("Failed to stop ".concat(this.constructor.name,": ").concat(t))}this.setState(xn.Stopped)}},{key:"suspend",value:function suspend(){this.setState(xn.Suspending);try{this.suspendInternal()}catch(t){throw this.setState(xn.Error),new Error("Failed to suspend ".concat(this.constructor.name,": ").concat(t))}this.setState(xn.Suspended)}},{key:"suspendInternal",value:function suspendInternal(){}},{key:"destroy",value:function destroy(){(this.started()||this.suspended())&&stop(),this.setState(xn.Destroying);try{this.destroyInternal()}catch(t){throw this.setState(xn.Error),new Error("Failed to destroy ".concat(this.constructor.name,": ").concat(t))}this.setState(xn.Destroyed)}}]),ExecutableBase}(Rn);function action_player_createSuper(t){var r=function action_player_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function stream_action_player_createSuper(t){var r=function stream_action_player_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var In=function(t){_inherits(StreamActionPlayer,t);var r=stream_action_player_createSuper(StreamActionPlayer);function StreamActionPlayer(t,i){var o;return _classCallCheck(this,StreamActionPlayer),_defineProperty(_assertThisInitialized(o=r.call(this,t)),"syncState",void 0),_defineProperty(_assertThisInitialized(o),"actions",void 0),_defineProperty(_assertThisInitialized(o),"requestID",void 0),o.syncState=i,o}return _createClass(StreamActionPlayer,[{key:"addAction",value:function addAction(t){this.actions.push(t)}},{key:"setDocument",value:function setDocument(t){this.executor.setDocument(t)}},{key:"seekByTime",value:function seekByTime(t){throw new Error("Method not implemented.")}},{key:"seekByPage",value:function seekByPage(t){throw new Error("Method not implemented.")}},{key:"executeActions",value:function executeActions(){for(var t=this.actions.length;t>0;){var r=this.actions[0];this.syncState.audioTime;try{r.execute(this.executor)}catch(t){}this.actions.shift(),t=this.actions.length}}},{key:"initInternal",value:function initInternal(){this.actions=[]}},{key:"startInternal",value:function startInternal(){try{this.run()}catch(t){throw console.error(t),new Error("Execute action failed.")}}},{key:"stopInternal",value:function stopInternal(){cancelAnimationFrame(this.requestID)}},{key:"suspendInternal",value:function suspendInternal(){cancelAnimationFrame(this.requestID)}},{key:"destroyInternal",value:function destroyInternal(){this.actions.length=0}},{key:"run",value:function run(){this.executeActions(),this.requestID=requestAnimationFrame(this.run.bind(this))}}]),StreamActionPlayer}(function(t){_inherits(ActionPlayer,t);var r=action_player_createSuper(ActionPlayer);function ActionPlayer(t){var i;return _classCallCheck(this,ActionPlayer),_defineProperty(_assertThisInitialized(i=r.call(this)),"executor",void 0),i.executor=t,i}return ActionPlayer}(En)),Dn=function(){function MediaPlayer(t){_classCallCheck(this,MediaPlayer),_defineProperty(this,"media",void 0),this.media=t}return _createClass(MediaPlayer,[{key:"source",set:function set(t){this.media.src=t}},{key:"duration",get:function get(){return this.media.duration}},{key:"time",get:function get(){return this.media.currentTime},set:function set(t){this.media.currentTime=t}},{key:"muted",get:function get(){return this.media.muted},set:function set(t){this.media.muted=t}},{key:"volume",get:function get(){return this.media.volume},set:function set(t){this.media.volume=t}},{key:"start",value:function start(){this.media.play()}},{key:"stop",value:function stop(){this.media.pause()}},{key:"addDurationListener",value:function addDurationListener(t){var r=this;this.media.addEventListener("durationchange",(function(){t(r.media.duration)}),!1)}},{key:"addTimeListener",value:function addTimeListener(t){var r=this;this.media.addEventListener("timeupdate",(function(){t(r.media.currentTime)}),!1)}},{key:"addVolumeListener",value:function addVolumeListener(t){var r=this;this.media.addEventListener("volumechange",(function(){t(r.media.volume)}),!1)}},{key:"addMutedListener",value:function addMutedListener(t){var r=this;this.media.addEventListener("volumechange",(function(){t(r.media.muted)}),!1)}}]),MediaPlayer}(),Mn=function(){function HighlighterRenderer(){_classCallCheck(this,HighlighterRenderer)}return _createClass(HighlighterRenderer,[{key:"render",value:function render(t,r,i){var o=r.points,a=o.length;if(!(a<1)){var c=r.brush,l=r.isSelected()?"rgba(255, 0, 100, 0.5)":c.color.toRgba(),u=0,d=o[u++];if(u!==a){for(t.beginPath(),t.strokeStyle=l,t.lineWidth=c.width,t.lineCap="round",t.lineJoin="round",t.globalAlpha=1,t.globalCompositeOperation="multiply",t.moveTo(d.x,d.y);u<a;)d=o[u++],t.lineTo(d.x,d.y);t.stroke()}else this.drawCircle(t,c,d.x,d.y,d.p)}}},{key:"drawCircle",value:function drawCircle(t,r,i,o,a){var c=a*r.width/2;t.beginPath(),t.fillStyle=r.color.toRgba(),t.arc(i,o,c,0,2*Math.PI),t.fill()}}]),HighlighterRenderer}(),Ln=function(){function SlideRenderer(){_classCallCheck(this,SlideRenderer)}var t;return _createClass(SlideRenderer,[{key:"render",value:(t=_asyncToGenerator(X().mark((function _callee(t,r,i){var o;return X().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return o=r.getPage(),a.abrupt("return",o.render(t,r.bounds,i));case 2:case"end":return a.stop()}}),_callee)}))),function render(r,i,o){return t.apply(this,arguments)})}]),SlideRenderer}(),On=function(){function PointerRenderer(){_classCallCheck(this,PointerRenderer)}return _createClass(PointerRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0];if(o){var a=r.brush,c=a.width,l=c/2;t.beginPath(),t.fillStyle=a.color.toAlpha(.4),t.arc(o.x,o.y,c,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle=a.color.toRgb(),t.lineWidth=c/4,t.arc(o.x,o.y,l,0,2*Math.PI),t.stroke()}}}]),PointerRenderer}(),Fn=function(){function ArrowRenderer(){_classCallCheck(this,ArrowRenderer)}return _createClass(ArrowRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush;if(t.save(),this.createArrowPath(t,c,o,a,l.width),t.fillStyle=l.color.toRgba(),t.fill(),t.restore(),r.isSelected()){var u=t.getTransformExt().getScaleX();this.createArrowPath(t,c,o,a,l.width),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=2/u,t.setLineDash([5/u]),t.stroke()}}}},{key:"createArrowPath",value:function createArrowPath(t,r,i,o,a){var c=null!=r&&r.altKey,l=null!=r&&r.shiftKey,u=i.x,d=i.y,h=c?2*a:a,p=h/2,g=o.x-u,m=o.y-d,y=Math.atan2(m,g),v=Math.sqrt(g*g+m*m),_=.5,A=5*h,b=v-.5*h/_,S=v-.5*A,C=_*A*.5*.35,w=_*A,P=l?.5*h/_+.75*A:0;if(t.translate(u,d),t.rotate(y),t.beginPath(),t.moveTo(P,-p),t.lineTo(b-.75*A,-p),t.lineTo(b-A,-w),t.quadraticCurveTo(S,-C,v,0),t.quadraticCurveTo(S,C,b-A,w),t.lineTo(b-.75*A,p),t.lineTo(P,p),l){var x=P-.5*A,k=_*A*.5*.35;t.lineTo(P+.25*A,w),t.quadraticCurveTo(x,k,0,0),t.quadraticCurveTo(x,-k,P+.25*A,-w)}t.closePath()}}]),ArrowRenderer}(),Nn=function(){function RectangleRenderer(){_classCallCheck(this,RectangleRenderer)}return _createClass(RectangleRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;if(!o.isEmpty()){var a=r.getKeyEvent(),c=r.brush,l=c.color.toRgba(),u=a&&a.altKey,d=o.x,h=o.y,p=o.width,g=o.height;t.beginPath(),u?(t.fillStyle=l,t.rect(d,h,p,g),t.fill()):(t.strokeStyle=l,t.lineWidth=c.width,t.rect(d,h,p,g),t.stroke()),r.isSelected()&&(u&&(d+=c.width/2,h+=c.width/2,p-=c.width,g-=c.width),t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=c.width,t.setLineDash([5/t.getTransformExt().getScaleX()]),t.rect(d,h,p,g),t.stroke())}}}]),RectangleRenderer}(),Bn=function(){function LineRenderer(){_classCallCheck(this,LineRenderer)}return _createClass(LineRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush,u=null!=c&&c.altKey,d=u?2*l.width:l.width;if(t.beginPath(),t.strokeStyle=l.color.toRgba(),t.lineWidth=d,t.lineCap="round",t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke(),r.isSelected()){var h=t.getTransformExt().getScaleX(),p=u?7/h:5/h,g=u?15/h:12/h;t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=d,t.setLineDash([p,g]),t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke()}}}}]),LineRenderer}(),jn=function(){function EllipseRenderer(){_classCallCheck(this,EllipseRenderer)}return _createClass(EllipseRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=r.getKeyEvent(),l=r.brush,u=l.color.toRgba(),d=c&&c.altKey,h=Math.min(o.x,a.x),p=Math.min(o.y,a.y),g=Math.max(o.x,a.x),m=Math.max(o.y,a.y),y=.5*Math.abs(g-h),v=.5*Math.abs(m-p),_=h+y,A=p+v;if(t.beginPath(),d?(t.fillStyle=u,t.ellipse(_,A,y,v,0,0,2*Math.PI),t.fill()):(t.strokeStyle=u,t.lineWidth=l.width,t.ellipse(_,A,y,v,0,0,2*Math.PI),t.stroke()),r.isSelected()){var b=0;d&&(b=l.width/2),t.beginPath(),t.strokeStyle="rgb(255, 0, 100)",t.lineWidth=l.width,t.setLineDash([5/t.getTransformExt().getScaleX()]),t.ellipse(_,A,y-b,v-b,0,0,2*Math.PI),t.stroke()}}}}]),EllipseRenderer}(),Vn=function(){function SelectRenderer(){_classCallCheck(this,SelectRenderer),_defineProperty(this,"FRAME_COLOR","#FF0064")}return _createClass(SelectRenderer,[{key:"render",value:function render(t,r,i){var o=r.points[0],a=r.points[1];if(o&&a){var c=2/t.getTransformExt().getScaleX(),l=4/t.getTransformExt().getScaleY();t.beginPath(),t.strokeStyle=this.FRAME_COLOR,t.lineWidth=c,t.lineDashOffset=0,t.setLineDash([l]),t.lineCap="butt",t.lineJoin="bevel",t.rect(o.x,o.y,a.x-o.x,a.y-o.y),t.stroke()}}}]),SelectRenderer}(),Un=function(){function ZoomRenderer(){_classCallCheck(this,ZoomRenderer),_defineProperty(this,"FILL_COLOR","rgba(0, 163, 232, 0.4)"),_defineProperty(this,"FRAME_COLOR","rgb(255, 0, 100)")}return _createClass(ZoomRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;t.fillStyle=this.FILL_COLOR,t.fillRect(o.x,o.y,o.width,o.height),t.beginPath(),t.strokeStyle=this.FRAME_COLOR,t.lineWidth=2/t.getTransformExt().getScaleX(),t.rect(o.x,o.y,o.width,o.height),t.stroke()}}]),ZoomRenderer}(),Jn=function(){function TextRenderer(){_classCallCheck(this,TextRenderer)}return _createClass(TextRenderer,[{key:"render",value:function render(t,r,i){var o=r.getText();if(o&&0!==o.length){var a=r.bounds,c=r.getFont(),l=t.getTransformExt(),u=l.getScaleX(),d=c.size*u,h=l.getTranslateX()+a.x*u,p=l.getTranslateY()+a.y*u,g=new Et(c.family,d,c.style,c.weight);t.setTransform(1,0,0,1,0,0),t.font=g.toString(),t.fillStyle=r.getTextColor().toRgba(),t.fillText(o,h,p+d)}}}]),TextRenderer}(),zn=function(){function TextHighlightRenderer(){_classCallCheck(this,TextHighlightRenderer)}return _createClass(TextHighlightRenderer,[{key:"render",value:function render(t,r,i){var o=r.bounds;o.isEmpty()||(t.beginPath(),t.globalAlpha=1,t.globalCompositeOperation="multiply",t.fillStyle=r.getColor().toRgba(),t.rect(o.x,o.y,o.width,o.height),t.fill())}}]),TextHighlightRenderer}(),Hn=function(){function LatexRenderer(){_classCallCheck(this,LatexRenderer)}return _createClass(LatexRenderer,[{key:"render",value:function render(t,r,i){var o=r.getText();if(o&&0!==o.length){var a=r.bounds,c=r.getFont(),l=t.getTransformExt(),u=l.getScaleX(),d=c.size*u,h=l.getTranslateX()+a.x*u,p=l.getTranslateY()+a.y*u,g=new Et(c.family,d,c.style,c.weight);t.setTransform(1,0,0,1,0,0),t.font=g.toString(),t.fillStyle=r.getTextColor().toRgba(),t.fillText(o,h,p+d)}}}]),LatexRenderer}(),Gn=function(){function PenRenderer(){_classCallCheck(this,PenRenderer)}return _createClass(PenRenderer,[{key:"render",value:function render(t,r,i){var o=r.brush,a=r.isSelected()?"rgb(255, 0, 100)":o.color.toRgb(),c=r.getPenStroke().getStrokeList(),l=c.length,u=0,d=c[u++];for(t.beginPath(),t.fillStyle=a,t.beginPath(),t.moveTo(d.x,d.y);u<l;)d=c[u++],u<l&&t.lineTo(d.x,d.y);t.fill()}}]),PenRenderer}(),qn=function(){function RenderController(){_classCallCheck(this,RenderController),_defineProperty(this,"pageChangeListener",void 0),_defineProperty(this,"slideRenderSurface",void 0),_defineProperty(this,"actionRenderSurface",void 0),_defineProperty(this,"volatileRenderSurface",void 0),_defineProperty(this,"textLayerSurface",void 0),_defineProperty(this,"page",void 0),_defineProperty(this,"lastShape",void 0),_defineProperty(this,"lastTransform",void 0),_defineProperty(this,"seek",!1),this.pageChangeListener=this.pageChanged.bind(this),this.lastTransform=new c}return _createClass(RenderController,[{key:"setPage",value:function setPage(t){this.page&&this.disableRendering(),this.page=t,this.seek||this.enableRendering(),this.renderAllLayers()}},{key:"setSeek",value:function setSeek(t){this.seek=t,t?this.disableRendering():(this.enableRendering(),this.lastTransform.equals(this.getPageTransform())?this.refreshAnnotationLayers():this.renderAllLayers())}},{key:"setSlideRenderSurface",value:function setSlideRenderSurface(t){this.slideRenderSurface=t,this.slideRenderSurface.registerRenderer(Wt.name,new Ln),this.slideRenderSurface.addSizeListener(this.slideRenderSurfaceSizeChanged.bind(this))}},{key:"setActionRenderSurface",value:function setActionRenderSurface(t){this.actionRenderSurface=t,this.actionRenderSurface.addSizeListener(this.actionRenderSurfaceSizeChanged.bind(this)),this.registerShapeRenderers(t)}},{key:"setVolatileRenderSurface",value:function setVolatileRenderSurface(t){this.volatileRenderSurface=t,this.registerShapeRenderers(t)}},{key:"setTextLayerSurface",value:function setTextLayerSurface(t){this.textLayerSurface=t}},{key:"beginBulkRender",value:function beginBulkRender(){this.seek||this.disableRendering()}},{key:"endBulkRender",value:function endBulkRender(){this.seek||(this.refreshAnnotationLayers(),this.enableRendering())}},{key:"enableRendering",value:function enableRendering(){this.page.addChangeListener(this.pageChangeListener)}},{key:"disableRendering",value:function disableRendering(){this.page.removeChangeListener(this.pageChangeListener)}},{key:"slideRenderSurfaceSizeChanged",value:function slideRenderSurfaceSizeChanged(t){this.renderAllLayers()}},{key:"actionRenderSurfaceSizeChanged",value:function actionRenderSurfaceSizeChanged(t){this.refreshAnnotationLayers()}},{key:"pageChanged",value:function pageChanged(t){switch(t.changeType){case Vt.PageTransform:this.renderAllLayers();break;case Vt.Clear:this.clearAnnotationLayers();break;case Vt.ShapeAdded:if(this.lastShape&&this.lastShape!=t.shape){var r=this.actionRenderSurface.getSize(),i=new ue(0,0,r.width,r.height);this.renderPermanentLayer(this.lastShape,i)}this.renderVolatileLayer(t.shape,t.dirtyRegion);break;case Vt.ShapeRemoved:this.refreshAnnotationLayers();break;case Vt.ShapeModified:this.renderVolatileLayer(t.shape,t.dirtyRegion)}}},{key:"clearAnnotationLayers",value:function clearAnnotationLayers(){this.volatileRenderSurface.clear(),this.actionRenderSurface.renderSurface(this.slideRenderSurface),this.lastShape=null}},{key:"refreshAnnotationLayers",value:function refreshAnnotationLayers(){var t=this.page.getShapes(),r=t.length-1;if(r>=0){this.actionRenderSurface.renderSurface(this.slideRenderSurface),r>0&&this.actionRenderSurface.renderShapes(t.slice(0,r));var i=t[r];this.renderVolatileLayer(i,i.bounds)}else this.volatileRenderSurface.clear(),this.actionRenderSurface.renderSurface(this.slideRenderSurface),this.lastShape=null}},{key:"renderAllLayers",value:function renderAllLayers(){var t=this;this.renderSlideLayer(this.page).then((function(r){if(r){var i=t.getPageTransform();t.lastTransform.setTransform(i),t.actionRenderSurface.setTransform(i),t.volatileRenderSurface.setTransform(i),t.actionRenderSurface.renderImageSource(r),t.actionRenderSurface.renderShapes(t.page.getShapes()),t.volatileRenderSurface.clear(),t.textLayerSurface.render(t.page),t.lastShape=null}})).catch((function(t){}))}},{key:"renderPermanentLayer",value:function renderPermanentLayer(t,r){this.actionRenderSurface.renderShape(t,r)}},{key:"renderVolatileLayer",value:function renderVolatileLayer(t,r){this.volatileRenderSurface.renderSurface(this.actionRenderSurface),this.volatileRenderSurface.renderShape(t,r),this.lastShape=t}},{key:"renderSlideLayer",value:function renderSlideLayer(t){var r=this.slideRenderSurface.getSize();if(!r)return this.slideRenderSurface.renderSlideShape(t.getSlideShape(),new ue(0,0,0,0));var i=new ue(0,0,r.width,r.height);return this.slideRenderSurface.renderSlideShape(t.getSlideShape(),i)}},{key:"getPageTransform",value:function getPageTransform(){var t=this.page.getSlideShape().bounds,r=new c;return r.translate(t.x,t.y),r.scale(1/t.width,1/t.height),r}},{key:"registerShapeRenderers",value:function registerShapeRenderers(t){t.registerRenderer(ge.name,new Gn),t.registerRenderer(pe.name,new Mn),t.registerRenderer(Ce.name,new On),t.registerRenderer(ke.name,new Fn),t.registerRenderer(Me.name,new Nn),t.registerRenderer(Ee.name,new Bn),t.registerRenderer(Ne.name,new jn),t.registerRenderer(it.name,new Vn),t.registerRenderer(_t.name,new Jn),t.registerRenderer(It.name,new zn),t.registerRenderer(Lt.name,new Hn),t.registerRenderer(dt.name,new Un)}}]),RenderController}(),Wn=function(){function SyncState(t){_classCallCheck(this,SyncState),_defineProperty(this,"mediaPlayer",void 0),this.mediaPlayer=t}return _createClass(SyncState,[{key:"audioTime",get:function get(){return 1e3*this.mediaPlayer.time}}]),SyncState}();function playback_service_createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function playback_service_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return playback_service_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return playback_service_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return l=t.done,t},e:function e(t){u=!0,c=t},f:function f(){try{l||null==i.return||i.return()}finally{if(u)throw c}}}}function playback_service_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Qn=function(){function PlaybackService(t){_classCallCheck(this,PlaybackService),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"documents",void 0),_defineProperty(this,"actionPlayer",void 0),this.playbackModel=t,this.documents=new Map}return _createClass(PlaybackService,[{key:"initialize",value:function initialize(t,r,i,o){var a=this;i.forEach((function(t){a.addDocument(t)}));var c=Number(o),l=t.getSlideView(),u=new Dn(t.getMediaElement());u.muted=this.playbackModel.getMuted(),u.addTimeListener((function(){t.setDuration(Date.now()-c)})),t.setOnMute((function(t){u.muted=t})),t.setOnVolume((function(t){u.muted=!1,u.volume=t}));var d,h=r.avtiveDocument,p=null,g=playback_service_createForOfIteratorHelper(i);try{for(g.s();!(d=g.n()).done;){var m=d.value;if(m.getDocumentId()==h.documentId){p=m;break}}}catch(t){g.e(t)}finally{g.f()}var y=new qn;y.setActionRenderSurface(l.getActionRenderSurface()),y.setSlideRenderSurface(l.getSlideRenderSurface()),y.setVolatileRenderSurface(l.getVolatileRenderSurface()),y.setTextLayerSurface(l.getTextLayerSurface());var v=new Tn(y);v.setDocument(p),v.setPageNumber(h.activePage.pageNumber),this.actionPlayer=new In(v,new Wn(u)),this.actionPlayer.start()}},{key:"addAction",value:function addAction(t){this.actionPlayer.addAction(t)}},{key:"addDocument",value:function addDocument(t){this.documents.set(BigInt(t.getDocumentId()),t)}},{key:"removeDocument",value:function removeDocument(t){this.documents.delete(BigInt(t))}},{key:"selectDocument",value:function selectDocument(t){var r=this.documents.get(BigInt(t));r&&(console.log("found document to select",t),this.actionPlayer.setDocument(r))}}]),PlaybackService}();function property_createSuper(t){var r=function property_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}var Yn=function(t){_inherits(Property,t);var r=property_createSuper(Property);function Property(t){var i;return _classCallCheck(this,Property),_defineProperty(_assertThisInitialized(i=r.call(this)),"_value",void 0),i._value=t,i}return _createClass(Property,[{key:"value",get:function get(){return this._value},set:function set(t){this._value!==t&&(this._value=t,this.notify(this._value))}},{key:"notifyObservers",value:function notifyObservers(){_get(_getPrototypeOf(Property.prototype),"notify",this).call(this,this._value)}}]),Property}(function(){function Observable(){_classCallCheck(this,Observable),_defineProperty(this,"observers",void 0),this.observers=[]}return _createClass(Observable,[{key:"subscribe",value:function subscribe(t){this.observers.push(t)}},{key:"unsubscribe",value:function unsubscribe(t){this.observers=this.observers.filter((function(r){return r!==t}))}},{key:"notify",value:function notify(t){this.observers.forEach((function(r){return r(t)}))}}]),Observable}()),Xn=function(){function PlaybackModel(){_classCallCheck(this,PlaybackModel),_defineProperty(this,"_elementA",new Yn),_defineProperty(this,"_state",new Yn),_defineProperty(this,"_raisedHand",new Yn),_defineProperty(this,"_showQuiz",new Yn),_defineProperty(this,"_showQuizActive",new Yn),_defineProperty(this,"_webrtcConnected",new Yn),_defineProperty(this,"_webrtcPublisherConnected",new Yn),_defineProperty(this,"_videoAvailable",new Yn),_defineProperty(this,"_mainVideoAvailable",new Yn),_defineProperty(this,"_localVideoAvailable",new Yn),_defineProperty(this,"_selectedPageIndex",new Yn),_defineProperty(this,"_duration",new Yn),_defineProperty(this,"_time",new Yn),_defineProperty(this,"_volume",new Yn),_defineProperty(this,"_muted",new Yn)}return _createClass(PlaybackModel,[{key:"elementAProperty",get:function get(){return this._elementA}},{key:"selectedPageIndexProperty",get:function get(){return this._selectedPageIndex}},{key:"selectedPageIndex",get:function get(){return this._selectedPageIndex.value},set:function set(t){this._selectedPageIndex.value=t}},{key:"stateProperty",get:function get(){return this._state}},{key:"raisedHandProperty",get:function get(){return this._raisedHand}},{key:"raisedHand",set:function set(t){this._raisedHand.value=t}},{key:"showQuizProperty",get:function get(){return this._showQuiz}},{key:"showQuiz",set:function set(t){this._showQuiz.value=t}},{key:"showQuizActiveProperty",get:function get(){return this._showQuizActive}},{key:"showQuizActive",set:function set(t){this._showQuizActive.value=t}},{key:"webrtcConnectedProperty",get:function get(){return this._webrtcConnected}},{key:"webrtcConnected",set:function set(t){this._webrtcConnected.value=t}},{key:"webrtcPublisherConnectedProperty",get:function get(){return this._webrtcPublisherConnected}},{key:"webrtcPublisherConnected",set:function set(t){this._webrtcPublisherConnected.value=t}},{key:"videoAvailableProperty",get:function get(){return this._videoAvailable}},{key:"videoAvailable",get:function get(){return this._videoAvailable.value},set:function set(t){this._videoAvailable.value=t}},{key:"mainVideoAvailableProperty",get:function get(){return this._mainVideoAvailable}},{key:"mainVideoAvailable",get:function get(){return this._mainVideoAvailable.value},set:function set(t){this._mainVideoAvailable.value=t}},{key:"localVideoAvailableProperty",get:function get(){return this._localVideoAvailable}},{key:"localVideoAvailable",get:function get(){return this._localVideoAvailable.value},set:function set(t){this._localVideoAvailable.value=t}},{key:"getState",value:function getState(){return this._state.value}},{key:"setState",value:function setState(t){this._state.value=t}},{key:"durationProperty",get:function get(){return this._duration}},{key:"getDuration",value:function getDuration(){return this._duration.value}},{key:"setDuration",value:function setDuration(t){this._duration.value=t}},{key:"timeProperty",get:function get(){return this._time}},{key:"getTime",value:function getTime(){return this._time.value}},{key:"setTime",value:function setTime(t){this._time.value=t}},{key:"volumeProperty",get:function get(){return this._volume}},{key:"getVolume",value:function getVolume(){return this._volume.value}},{key:"setVolume",value:function setVolume(t){this._volume.value=t}},{key:"mutedProperty",get:function get(){return this._muted}},{key:"getMuted",value:function getMuted(){return this._muted.value}},{key:"setMuted",value:function setMuted(t){this._muted.value=t}}]),PlaybackModel}(),$n=function(){function LecturePlayer(){_classCallCheck(this,LecturePlayer),_defineProperty(this,"playbackModel",void 0),_defineProperty(this,"streamActionBuffer",void 0),_defineProperty(this,"courseStateService",void 0),_defineProperty(this,"janusService",void 0),_defineProperty(this,"playbackService",void 0),_defineProperty(this,"container",void 0),_defineProperty(this,"onSettingsConsumer",void 0),_defineProperty(this,"roomId",void 0),_defineProperty(this,"startTime",void 0),_defineProperty(this,"playerView",void 0),_defineProperty(this,"toolbarElementsBuffer",[]),this.playbackModel=new Xn,this.courseStateService=new an("https://"+window.location.host),this.janusService=new dn("https://"+window.location.hostname+":8089/janus",this.playbackModel),this.playbackService=new Qn(this.playbackModel)}return _createClass(LecturePlayer,[{key:"start",value:function start(){var t=this;return new Promise((function(r,i){t.courseStateService.getCourseState(t.roomId).then((function(o){for(var a=[],c=0,l=Object.values(o.documentMap);c<l.length;c++){var u=l[c],d=t.courseStateService.getStateDocument(t.roomId,u);a.push(d)}Promise.all(a).then((function(i){t.setDocuments(o,i),r()})).catch((function(t){i(t)}))})).catch((function(t){i(t)}))}))}},{key:"addPeer",value:function addPeer(t){this.janusService.addPeer(t)}},{key:"startSpeech",value:function startSpeech(t){this.janusService.startSpeech(t)}},{key:"stopSpeech",value:function stopSpeech(){this.janusService.stopSpeech(),this.setRaiseHand(!1)}},{key:"setDeviceConstraints",value:function setDeviceConstraints(t){this.janusService.setDeviceConstraints(t)}},{key:"setContainer",value:function setContainer(t){this.container=t}},{key:"setContainerA",value:function setContainerA(t){this.playbackModel.elementAProperty.value=t}},{key:"setOnConnectedState",value:function setOnConnectedState(t){this.playbackModel.webrtcConnectedProperty.subscribe(t)}},{key:"setOnConnectedSpeechState",value:function setOnConnectedSpeechState(t){this.playbackModel.webrtcPublisherConnectedProperty.subscribe(t)}},{key:"setOnSettings",value:function setOnSettings(t){this.onSettingsConsumer=t}},{key:"setOnRaiseHand",value:function setOnRaiseHand(t){this.playbackModel.raisedHandProperty.subscribe(t)}},{key:"setOnShowQuiz",value:function setOnShowQuiz(t){this.playbackModel.showQuizProperty.subscribe(t)}},{key:"setShowQuiz",value:function setShowQuiz(t){this.playbackModel.showQuiz=t}},{key:"setQuizActive",value:function setQuizActive(t){this.playbackModel.showQuizActive=t}},{key:"setRaiseHand",value:function setRaiseHand(t){this.playbackModel.raisedHand=t}},{key:"setStartTime",value:function setStartTime(t){this.startTime=t}},{key:"setMuted",value:function setMuted(t){this.playbackModel.setMuted(t)}},{key:"setUserId",value:function setUserId(t){this.janusService.setUserId(t)}},{key:"setRoomId",value:function setRoomId(t){this.roomId=t,this.janusService.setRoomId(t)}},{key:"addToolbarElement",value:function addToolbarElement(t){if(this.playerView)return this.playerView.addToolbarElement(t);this.toolbarElementsBuffer.push(t)}},{key:"loadToolbarElementBuffer",value:function loadToolbarElementBuffer(){for(;this.toolbarElementsBuffer.length;)this.playerView.addToolbarElement(this.toolbarElementsBuffer.shift())}},{key:"setDocuments",value:function setDocuments(t,r){var i=this,o=new te(this.playbackModel);this.playerView=o,this.setView(o),this.playbackService.initialize(o,t,r,this.startTime),this.janusService.setPlayerView(o),this.janusService.setOnData((function(t){t instanceof Blob?t.arrayBuffer().then((function(t){i.processData(t)})):i.processData(t)})),this.janusService.start(),this.loadToolbarElementBuffer()}},{key:"processData",value:function processData(t){var r=this,i=new ne(t),o=i.getInt32(),a=i.getInt8(),c=Pn.parse(i,a,o);if(c instanceof mn)this.bufferAction(c,c.documentId)||this.playbackService.selectDocument(c.documentId);else if(c instanceof gn)if(1===c.documentType){var l=new $t;l.setDocumentId(c.documentId),this.playbackService.addDocument(l)}else{this.streamActionBuffer={bufferedActions:[],docId:BigInt(c.documentId)};var u={activePage:null,documentFile:c.documentFile,documentId:c.documentId,documentName:c.documentTitle,pages:null,type:"pdf"};this.courseStateService.getStateDocument(this.roomId,u).then((function(t){r.playbackService.addDocument(t),r.flushActionBuffer(t.getDocumentId())})).catch((function(t){console.error(t)}))}else if(c instanceof fn)this.playbackService.removeDocument(c.documentId);else if(c instanceof An){if(!this.bufferAction(c,c.documentId)){var d=new kn(c.pageNumber);d.timestamp=0,this.playbackService.addAction(d)}}else c instanceof bn?this.bufferAction(c,c.documentId)||this.playbackService.addAction(c.action):c instanceof wn&&this.janusService.addPeer(c.publisherId)}},{key:"setView",value:function setView(t){if(!(t instanceof HTMLElement))throw new Error("View is expected to be of type HTMLElement");this.container.firstElementChild&&this.container.removeChild(this.container.firstElementChild),this.container.appendChild(t),this.onSettingsConsumer&&t.setOnSettings(this.onSettingsConsumer)}},{key:"bufferAction",value:function bufferAction(t,r){return!(!this.streamActionBuffer||this.streamActionBuffer.docId!==BigInt(r))&&(this.streamActionBuffer.bufferedActions.push(t),!0)}},{key:"flushActionBuffer",value:function flushActionBuffer(t){var r=this;this.streamActionBuffer&&this.streamActionBuffer.docId===BigInt(t)&&this.streamActionBuffer.bufferedActions.forEach((function(t){if(t instanceof mn)r.playbackService.selectDocument(t.documentId);else if(t instanceof An){var i=new kn(t.pageNumber);i.timestamp=0,r.playbackService.addAction(i)}else t instanceof bn&&r.playbackService.addAction(t.action)})),this.streamActionBuffer=null}}]),LecturePlayer}()})(),__webpack_exports__})()}));